{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"ME/CFS Biostatistics Home","text":""},{"location":"#mecfs-biostatistics-home","title":"ME/CFS Biostatistics Home","text":"<p>The ME/CFS Biostatistics repo is a home for reproducible, open-source analysis of biostatistical datasets pertaining to ME/CFS.</p>"},{"location":"project_outline/","title":"Project Outline","text":""},{"location":"project_outline/#project-outline","title":"Project Outline","text":""},{"location":"project_outline/#overview","title":"Overview","text":"<p>The ME/CFS Biostatistics repo is a home for reproducible, open-source analysis of datasets pertaining to ME/CFS and other poorly-understood diseases.</p>"},{"location":"project_outline/#principles","title":"Principles","text":"<p>There are a few key principles that govern how software should be written in this repo.</p> <p>Automated Reproducibility:  Reproducibility is a central tenet of science, but a great deal of scientific data analysis is difficult to reproduce.  Even when the requisite data is public, reproducing published analysis on this data can be laborious.  In this repo, we mitigate this problem by automating reproducibility: it should be possible to reproduce any of the main analyses with a few lines of Python code. </p> <p>Automated Testing: Software engineering is \"programming integrated over time\"<sup>1</sup>. Software engineering thus involves challenges unseen in short-lived programming projects.</p> <p>One such challenge is the tendency of new features to break previously-developed features. A powerful mitigation against this risk is the use of automated unit and integration tests.  Automated tests can verify that old features continue to function as the codebase changes.  In this repo, we aim to protect key features with automated testing.  See Winters et al.<sup>1</sup> for discussion of the principles of software testing.</p> <ol> <li> <p>Titus Winters, Tom Manshreck, and Hyrum Wright. Software engineering at google: Lessons learned from programming over time. \" O'Reilly Media, Inc.\", 2020. URL: https://abseil.io/resources/swe-book/html/toc.html.\u00a0\u21a9\u21a9</p> </li> </ol>"},{"location":"Analysis/Bellenguez_et_al_2022_%28ALZ%29/MAGMA-GTEx/","title":"MAGMA GTEx","text":""},{"location":"Analysis/Bellenguez_et_al_2022_%28ALZ%29/MAGMA-GTEx/#magma-gtex","title":"MAGMA GTEx","text":"<p>I applied MAGMA to the Alzheimer's GWAS of Bellenguez et al.<sup>1</sup> using a reference dataset derived from GTEx bulk RNAseq data<sup>2</sup>.  The gene-property analysis results are plotted below.</p> <p></p> <p>Three of the four significant tissues types (Whole blood, Spleen, Ileum Lymphode aggregate) are immune-related, which is consistent with theories of Alzheimer's as an immune-related disease.  How to interpret \"Liver portal tract\" is less obvious.</p> <ol> <li> <p>C\u00e9line Bellenguez, Fahri K\u00fc\u00e7\u00fckali, Iris E Jansen, Luca Kleineidam, Sonia Moreno-Grau, Najaf Amin, Adam C Naj, Rafael Campos-Martin, Benjamin Grenier-Boley, Victor Andrade, and others. New insights into the genetic etiology of alzheimer\u2019s disease and related dementias. Nature genetics, 54(4):412\u2013436, 2022. URL: https://www.nature.com/articles/s41588-022-01024-z.\u00a0\u21a9</p> </li> <li> <p>GTEx Consortium. The gtex consortium atlas of genetic regulatory effects across human tissues. Science, 369(6509):1318\u20131330, 2020. URL: https://www.science.org/doi/full/10.1126/science.aaz1776.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Bellenguez_et_al_2022_%28ALZ%29/MAGMA-HBA/","title":"MAGMA HBA","text":""},{"location":"Analysis/Bellenguez_et_al_2022_%28ALZ%29/MAGMA-HBA/#magma-hba","title":"MAGMA HBA","text":"<p>I applied MAGMA to the Alzheimer's GWAS of Bellenguez et al.<sup>1</sup> using scRNAseq data from the Human Brain Atlas<sup>2</sup> as a reference.</p>"},{"location":"Analysis/Bellenguez_et_al_2022_%28ALZ%29/MAGMA-HBA/#results","title":"Results","text":"<p>The results are plotted below:</p> <p></p> <p>The x-axis corresponds to HBA cluster number, while the y-axis corresponds to the \\(-\\log_{10}(p)\\) score produced by MAGMA.  Clusters are colored according to their HBA supercluster. The dotted line denotes the Bonferroni significance threshold.</p> <p>Almost all of the Bonferroni-significant cell types are in the microglia supercluster.  The only exception is a single monocyte cell type.  This is consistent with the theory of Alzheimer's as a primarily microglia-driven disease  (see pg. 1205 of Kandel et al.<sup>3</sup>).</p> <p>Applying a stepwise selection algorithm similar to the one describe in Watanabe et al.<sup>4</sup> identifies only a single independently significant cluster: Cluster 12, which consists of microglial cells.</p> <ol> <li> <p>C\u00e9line Bellenguez, Fahri K\u00fc\u00e7\u00fckali, Iris E Jansen, Luca Kleineidam, Sonia Moreno-Grau, Najaf Amin, Adam C Naj, Rafael Campos-Martin, Benjamin Grenier-Boley, Victor Andrade, and others. New insights into the genetic etiology of alzheimer\u2019s disease and related dementias. Nature genetics, 54(4):412\u2013436, 2022. URL: https://www.nature.com/articles/s41588-022-01024-z.\u00a0\u21a9</p> </li> <li> <p>Kimberly Siletti, Rebecca Hodge, Alejandro Mossi Albiach, Ka Wai Lee, Song-Lin Ding, Lijuan Hu, Peter L\u00f6nnerberg, Trygve Bakken, Tamara Casper, Michael Clark, and others. Transcriptomic diversity of cell types across the adult human brain. Science, 382(6667):eadd7046, 2023. URL: https://www.science.org/doi/abs/10.1126/science.add7046.\u00a0\u21a9</p> </li> <li> <p>Eric R. Kandel, John D. Koester, and Steven A. Mack, Sarah H. Siegelbaum. Principles of neural science 6th edition. Elsevier New York, 2021. URL: https://www.amazon.ca/Principles-Neural-Science-Sixth-Kandel-ebook-dp-B08LNXDCS3/dp/B08LNXDCS3.\u00a0\u21a9</p> </li> <li> <p>Kyoko Watanabe, Ma\u0161a Umi\u0107evi\u0107 Mirkov, Christiaan A de Leeuw, Martijn P van den Heuvel, and Danielle Posthuma. Genetic mapping of cell type specificity for complex traits. Nature communications, 10(1):3222, 2019. URL: https://www.nature.com/articles/s41467-019-11181-1.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Bellenguez_et_al_2022_%28ALZ%29/S-LDSC-ALZ_Analysis/","title":"S-LDSC ALZ Analysis","text":""},{"location":"Analysis/Bellenguez_et_al_2022_%28ALZ%29/S-LDSC-ALZ_Analysis/#s-ldsc-alz-analysis","title":"S-LDSC ALZ Analysis","text":"<p>I applied Stratified Linkage Disequilibrium Score Regression (S-LDSC)<sup>1</sup> to summary statistics from  Bellenguez et al.'s 2022 Meta-GWAS of Alzheimers' disease<sup>2</sup>.</p>"},{"location":"Analysis/Bellenguez_et_al_2022_%28ALZ%29/S-LDSC-ALZ_Analysis/#reference-data-sources","title":"Reference Data Sources","text":"<p>I used the standard reference datasets recommended and preprocessed by the authors of the S-LDSC method.</p> <ul> <li>The GTEx Project</li> <li>The Franke lab dataset</li> <li>The Roadmap Epigenetic Project</li> <li>The Corces et al. ATAC-seq dataset of 13 blood cell types.</li> <li>The ImmGen Project</li> <li>The Cahoy Mouse Central Nervous System Dataset</li> </ul>"},{"location":"Analysis/Bellenguez_et_al_2022_%28ALZ%29/S-LDSC-ALZ_Analysis/#results","title":"Results","text":""},{"location":"Analysis/Bellenguez_et_al_2022_%28ALZ%29/S-LDSC-ALZ_Analysis/#gtex-and-franke-lab-tissue-expression-data","title":"GTEx and Franke lab tissue expression data","text":"<p>Surprisingly, no cell or tissue types were significant at a FDR of 0.01 using GTEx/Franke lab reference dataset.</p> <p>Here are the cell/tissue types with the lowest p values:</p> Name Coefficient Coefficient_P_value Reject Null A15.382.680.Phagocytes 1.07416e-08 0.000303268 False A15.378.316.Bone.Marrow.Cells 1.04343e-08 0.000613866 False A15.378.316.580.Monocytes 1.03343e-08 0.000770997 False A15.382.Immune.System 5.30068e-09 0.0016483 False A15.382.812.Mononuclear.Phagocyte.System 9.23168e-09 0.00187043 False A15.382.490.315.583.Neutrophils 5.96328e-09 0.00207589 False Brain_Substantia_nigra 2.57256e-09 0.00413337 False Brain_Hippocampus 2.46114e-09 0.0054518 False <p>The non-significant cell types with the lowest p values are immune related, consistent with theories that immune processes drive Alzheimer's disease (see pg. 1205 of Kandel et al.<sup>3</sup>).</p>"},{"location":"Analysis/Bellenguez_et_al_2022_%28ALZ%29/S-LDSC-ALZ_Analysis/#roadmap-chromatin-data","title":"Roadmap Chromatin data","text":"<p>I next used reference data generated by Finucane et al.<sup>1</sup> from the Roadmap Epigenetics Project.</p> <p>The following graph and table show the results:</p> <p></p> Name Coefficient Coefficient_P_value Reject Null Primary_B_cells_from_cord_blood__H3K4me1 6.38583e-08 9.12989e-06 True Spleen_ENTEX__H3K4me3 7.63489e-08 0.000119307 False Spleen_ENTEX__H3K27ac 5.18872e-08 0.000207013 False Primary_monocytes_from_peripheral_blood__DNase 1.88703e-07 0.000219091 False Primary_monocytes_from_peripheral_blood__H3K4me1 6.35288e-08 0.000404116 False Primary_neutrophils_from_peripheral_blood__H3K4me3 9.90636e-08 0.000756243 False Spleen_ENTEX__H3K4me1 1.35523e-07 0.000863159 False Primary_B_cells_from_peripheral_blood__H3K4me1 3.53291e-08 0.000932097 False <p>In this dataset, there is one significant cell type: B-cells from cord blood. Again, this is consistent with theories of an immune-related etiology<sup>3</sup>. </p>"},{"location":"Analysis/Bellenguez_et_al_2022_%28ALZ%29/S-LDSC-ALZ_Analysis/#immgen-data","title":"ImmGen data","text":"<p>The result of applying S-LSDC to the Alzheimer's GWAS with the ImmGen reference dataset are shown below:</p> <p></p> Name Coefficient Coefficient_P_value Reject Null DC.103-11b+F4_80lo.Kd 9.23301e-09 8.0773e-06 True MF.Microglia.CNS 9.62855e-09 0.000242887 False Mo.6C-IIint.Bl 1.1929e-08 0.000415892 False Mo.6C+II+.Bl 9.99718e-09 0.000578951 False DC.103+11b-.Lu 5.33801e-09 0.00102154 False NK.49H-.Sp 5.73474e-09 0.00114727 False GN.BM 5.7906e-09 0.00151902 False GN.Bl.v2 6.00743e-09 0.00160889 False <p>Only a single cell type is significant. This cell type appears to be a form of kidney-based dendritic cell.</p>"},{"location":"Analysis/Bellenguez_et_al_2022_%28ALZ%29/S-LDSC-ALZ_Analysis/#corces-et-al-atac-seq-data","title":"Corces et al. ATAC-seq data","text":"<p>Application of S-LDSC using the Corces ATAC-seq dataset produces one significant hit.  The cell types with the lowest p values are shown below.</p> Name Coefficient Coefficient_P_value Reject Null Mono 1.92887e-07 6.37581e-05 True GMP 3.6411e-08 0.0766454 False Bcell 3.72995e-08 0.0892083 False MPP 1.92852e-08 0.19055 False HSC 1.68987e-08 0.191926 False MEP 2.10708e-08 0.214319 False CMP 1.52784e-08 0.259065 False CLP 2.07019e-08 0.282973 False <p>It is interesting that the significant hit is the \"monocyte\" cell type.  </p>"},{"location":"Analysis/Bellenguez_et_al_2022_%28ALZ%29/S-LDSC-ALZ_Analysis/#cahoy-and-gtex-brain-data","title":"Cahoy and GTEx-Brain data","text":"<p>The cell classes with the lowest p values from the Cahoy and GTEx brain datasets are shown below:</p> Name Coefficient Coefficient_P_value Reject Null Oligodendrocyte 2.08857e-09 0.154461 False Astrocyte 4.56992e-10 0.372866 False Neuron 1.05632e-10 0.467793 False Name Coefficient Coefficient_P_value Reject Null Brain_Substantia_nigra 5.26982e-09 0.00104795 False Brain_Cortex 3.42421e-09 0.0226111 False Brain_Spinal_cord_(cervical_c-1) 3.25361e-09 0.0239112 False Brain_Hippocampus 1.31903e-09 0.14029 False Brain_Nucleus_accumbens_(basal_ganglia) 1.69999e-09 0.170507 False Brain_Amygdala 9.48447e-10 0.202438 False Brain_Anterior_cingulate_cortex_(BA24) 1.07874e-09 0.215418 False Brain_Putamen_(basal_ganglia) 1.23503e-09 0.215505 False <p>The lack of significant hits is surprising if one views Alzheimer's as a straightforwardly neurological disease. However, these results make sense given theories of Alzheimer's as immune- or microglia- driven.</p>"},{"location":"Analysis/Bellenguez_et_al_2022_%28ALZ%29/S-LDSC-ALZ_Analysis/#comment","title":"Comment","text":"<p>It is interesting to contrast the above results with those produced when S-LDSC is applied to inflammatory bowel disease.  Both conditions are \"immune\" in a broad sense, but their S-LDSC results are quite different.  Alzheimer's produces a small number of cell-type hits at a moderate level of significance, whereas IBD produces a large number of highly significant cell-type hits.  A tentative explanation may be that the immune aspect of Alzheimer's is focused on microglia, and there are no microglia cell types in any of the datasets considered above.  Thus, cell types are significant for Alzheimer's only to the extent that they resemble microglia.</p> <ol> <li> <p>Hilary K Finucane, Yakir A Reshef, Verneri Anttila, Kamil Slowikowski, Alexander Gusev, Andrea Byrnes, Steven Gazal, Po-Ru Loh, Caleb Lareau, Noam Shoresh, and others. Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types. Nature genetics, 50(4):621\u2013629, 2018. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC5896795/.\u00a0\u21a9\u21a9</p> </li> <li> <p>C\u00e9line Bellenguez, Fahri K\u00fc\u00e7\u00fckali, Iris E Jansen, Luca Kleineidam, Sonia Moreno-Grau, Najaf Amin, Adam C Naj, Rafael Campos-Martin, Benjamin Grenier-Boley, Victor Andrade, and others. New insights into the genetic etiology of alzheimer\u2019s disease and related dementias. Nature genetics, 54(4):412\u2013436, 2022. URL: https://www.nature.com/articles/s41588-022-01024-z.\u00a0\u21a9</p> </li> <li> <p>Eric R. Kandel, John D. Koester, and Steven A. Mack, Sarah H. Siegelbaum. Principles of neural science 6th edition. Elsevier New York, 2021. URL: https://www.amazon.ca/Principles-Neural-Science-Sixth-Kandel-ebook-dp-B08LNXDCS3/dp/B08LNXDCS3.\u00a0\u21a9\u21a9</p> </li> </ol>"},{"location":"Analysis/DecodeME/Cis-PQTL-MR-DecodeME/","title":"cis-pQTL MR Analysis","text":""},{"location":"Analysis/DecodeME/Cis-PQTL-MR-DecodeME/#cis-pqtl-mr-analysis","title":"cis-pQTL MR Analysis","text":"<p>I applied Mendelian Randomization to DecodeME GWAS-1<sup>1</sup> using cis-pQTL from the UK Biobank Pharma Proteomics Project<sup>2</sup> as instruments.  I aimed to identify candidate proteins that may be causal in the ME/CFS disease process.</p> <p>Since each protein in the UKBB PPP has at most one cis-pQTL, I used the Wald Ratio method to estimate the causal effect of the proteins on ME/CFS.</p> <p>I used the R package <code>TwoSampleMR</code>.</p> <p>NOTE: since the controls for the DecodeME project come from the UK Biobank, and since the pQTLs from the UKBB PPP are also derived from analysis of the UK Biobank, we do not actually have two fully independent samples, so we partially violate the assumptions of <code>TwoSampleMR</code>.  This could introduce some error. </p>"},{"location":"Analysis/DecodeME/Cis-PQTL-MR-DecodeME/#results","title":"Results","text":""},{"location":"Analysis/DecodeME/Cis-PQTL-MR-DecodeME/#rabgap1l","title":"RABGAP1L","text":"<p>At a significance level of 0.01 (Bonferroni-corrected), <code>TwoSampleMR</code> identified one potentially causal plasma protein: RABGAP1L.</p> Assay Target b pval UniProt Function [CC] RABGAP1L -1.01937 8.16913e-07 FUNCTION: GTP-hydrolysis activating protein (GAP) for small GTPase RAB22A, converting active RAB22A-GTP to the inactive form RAB22A-GDP (PubMed:16923123). Plays a role in endocytosis and intracellular protein transport. Recruited by ANK2 to phosphatidylinositol 3-phosphate (PI3P)-positive early endosomes, where it inactivates RAB22A, and promotes polarized trafficking to the leading edge of the migrating cells. Part of the ANK2/RABGAP1L complex which is required for the polarized recycling of fibronectin receptor ITGA5 ITGB1 to the plasma membrane that enables continuous directional cell migration (By similarity). {ECO:0000250 |UniProtKB:A6H6A9, ECO:0000269 |PubMed:16923123}. <p>The mechanism by which RABGAP1L could affect ME/CFS is not immediately clear.  The Candidate Genes supplement to the DecodeME preprint notes that \"RABGAP1L inhibits the entry and/or promotes the expulsion of bacteria or viruses. It is a viral restriction factor. Reduction in RABGAP1L expression would be expected to enhance susceptibility to bacterial and viral infection, which often precedes initial ME/CFS symptoms.\"</p> <p>To further investigate, I generate two region plots.  The first shows the DECODE ME GWAS signal in region of the RABGAP1L gene:</p> <p></p> <p>The second shows the same region from the UK Biobank Pharma Proteomics Project GWAS of plasma RABGAP1L levels:</p> <p></p> <p>From visual inspection, it seems clear that at least the primary signals do not colocalize: the GWAS peaks are clearly in different locations.  However, it could be that there are secondary signals that do colocalize.  A colocalization algorithm may clarify the question.</p>"},{"location":"Analysis/DecodeME/Cis-PQTL-MR-DecodeME/#btn1a1","title":"BTN1A1","text":"<p>If we relax the significance threshold to 0.05, one additional potentially causal protein is identified: BTN1A1</p> Assay Target b pval UniProt Function [CC] BTN1A1 0.284424 2.38381e-05 FUNCTION: May function in the secretion of milk-fat droplets. May act as a specific membrane-associated receptor for the association of cytoplasmic droplets with the apical plasma membrane (By similarity). Inhibits the proliferation of CD4 and CD8 T-cells activated by anti-CD3 antibodies, T-cell metabolism and IL2 and IFNG secretion (By similarity). {ECO:0000250}. <p>This protein appears to be anti-inflammatory, and higher levels are associated with a greater risk of ME/CFS.</p> <p>Again, to further investigate, I compared region plots in the vicinity of BTN1A1 from DecodeME and from the UK Biobank Pharma Proteomics Project GWAS of plasma BTN1A1 levels.</p> <p>The first plot is from DecodeME:</p> <p></p> <p>The second is from UK Biobank Pharma Proteomics Project:</p> <p></p> <p>In this comparison, it seems even more obvious that the primary signals do not colocalize: they are separated by a recombination boundary.</p>"},{"location":"Analysis/DecodeME/Cis-PQTL-MR-DecodeME/#follow-up-questions","title":"Follow-up questions","text":"<ul> <li> <p>Does co-localization analysis suggest that the DecodeME causal variant and the cis-pQTL co-localize?</p> </li> <li> <p>Do the cis-pQTLs identified above co-localize with trans-pQTLs for other proteins? If so, this could suggest causal protein regulatory chains.</p> </li> </ul> <ol> <li> <p>Genetics Delivery Team, Thibaud Boutin, Andrew D Bretherick, Joshua J Dibble, Esther Ewaoluwagbemiga, Emma Northwood, Gemma L Samms, Veronique Vitart, Project, Cohort Delivery Team, \u00d8yvind Almelid, and others. Initial findings from the decodeme genome-wide association study of myalgic encephalomyelitis/chronic fatigue syndrome. medRxiv, pages 2025\u201308, 2025. URL: https://www.medrxiv.org/content/10.1101/2025.08.06.25333109v1.\u00a0\u21a9</p> </li> <li> <p>Benjamin B Sun, Joshua Chiou, Matthew Traylor, Christian Benner, Yi-Hsiang Hsu, Tom G Richardson, Praveen Surendran, Anubha Mahajan, Chloe Robins, Steven G Vasquez-Grinnell, and others. Plasma proteomic associations with genetics and health in the uk biobank. Nature, 622(7982):329\u2013338, 2023. URL: https://www.nature.com/articles/s41586-023-06592-6.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/DecodeME/Combined_Gene_List/","title":"Master Gene List","text":""},{"location":"Analysis/DecodeME/Combined_Gene_List/#master-gene-list","title":"Master Gene List","text":"<p>This file contains an aggregated list of DecodeME candidate genes generated using GWASLAB and MAGMA.  Each gene is accompanied by annotations retrieved using gget from bioinformatic databases.</p> Ensembl ID sources uniprot_id primary_gene_name subcellular_localisation ensembl_description uniprot_description ncbi_description ENSG00000028116 ['MAGMA'] ['Q86Y07'] VRK2 ['Cytoplasm', 'Endoplasmic reticulum membrane', 'Mitochondrion membrane', 'Nucleus envelope', 'Cytoplasm', 'Nucleus'] VRK serine/threonine kinase 2 [Source:HGNC Symbol;Acc:HGNC:12719] [\"Phosphorylates 'Thr-18' of p53/TP53, as well as histone H3. Reduces p53/TP53 ubiquitination by MDM2, promotes p53/TP53 acetylation by EP300 and thereby increases p53/TP53 stability and activity Serine/threonine kinase that regulates several signal transduction pathways (PubMed:14645249, PubMed:16495336, PubMed:16704422, PubMed:17709393, PubMed:18286207, PubMed:18617507, PubMed:20679487). Isoform 1 modulates the stress response to hypoxia and cytokines, such as interleukin-1 beta (IL1B) and this is dependent on its interaction with MAPK8IP1, which assembles mitogen-activated protein kinase (MAPK) complexes (PubMed:17709393). Inhibition of signal transmission mediated by the assembly of MAPK8IP1-MAPK complexes reduces JNK phosphorylation and JUN-dependent transcription (PubMed:18286207). Phosphorylates 'Thr-18' of p53/TP53, histone H3, and may also phosphorylate MAPK8IP1 (PubMed:16704422). Phosphorylates BANF1 and disrupts its ability to bind DNA and reduces its binding to LEM domain-containing proteins (PubMed:16495336). Down-regulates the transactivation of transcription induced by ERBB2, HRAS, BRAF, and MEK1 (PubMed:20679487). Blocks the phosphorylation of ERK in response to ERBB2 and HRAS (PubMed:20679487). Can also phosphorylate the following substrates that are commonly used to establish in vitro kinase activity: casein, MBP and histone H2B, but it is not sure that this is physiologically relevant (PubMed:14645249)\"] This gene encodes a member of the vaccinia-related kinase (VRK) family of serine/threonine protein kinases. The encoded protein acts as an effector of signaling pathways that regulate apoptosis and tumor cell growth. Variants in this gene have been associated with schizophrenia. Alternative splicing results in multiple transcript variants that differ in their subcellular localization and biological activity. [provided by RefSeq, Jan 2014] ENSG00000033122 ['MAGMA'] ['A0A075B6E9', 'A0A494C1A4', 'V9GYE1', 'F8WE45', 'V9GZ42', 'V9GY23', 'B1AKT2', 'K7ELH5'] LRRC7 ['Cytoplasm', 'Postsynaptic density'] leucine rich repeat containing 7 [Source:HGNC Symbol;Acc:HGNC:18531] ['Required for normal synaptic spine architecture and function. Necessary for DISC1 and GRM5 localization to postsynaptic density complexes and for both N-methyl D-aspartate receptor-dependent and metabotropic glutamate receptor-dependent long term depression'] Predicted to enable protein kinase binding activity. Predicted to be involved in several processes, including establishment or maintenance of epithelial cell apical/basal polarity; positive regulation of neuron projection development; and protein localization to membrane. Located in several cellular components, including centrosome; cytosol; and nucleoplasm. Implicated in cocaine dependence. [provided by Alliance of Genome Resources, Jul 2025] ENSG00000089220 ['MAGMA'] ['P30086'] PEBP1 ['Cytoplasm'] phosphatidylethanolamine binding protein 1 [Source:HGNC Symbol;Acc:HGNC:8630] ['Binds ATP, opioids and phosphatidylethanolamine. Has lower affinity for phosphatidylinositol and phosphatidylcholine. Serine protease inhibitor which inhibits thrombin, neuropsin and chymotrypsin but not trypsin, tissue type plasminogen activator and elastase (By similarity). Inhibits the kinase activity of RAF1 by inhibiting its activation and by dissociating the RAF1/MEK complex and acting as a competitive inhibitor of MEK phosphorylation HCNP may be involved in the function of the presynaptic cholinergic neurons of the central nervous system. HCNP increases the production of choline acetyltransferase but not acetylcholinesterase. Seems to be mediated by a specific receptor (By similarity)'] This gene encodes a member of the phosphatidylethanolamine-binding family of proteins and has been shown to modulate multiple signaling pathways, including the MAP kinase (MAPK), NF-kappa B, and glycogen synthase kinase-3 (GSK-3) signaling pathways. The encoded protein can be further processed to form a smaller cleavage product, hippocampal cholinergic neurostimulating peptide (HCNP), which may be involved in neural development. This gene has been implicated in numerous human cancers and may act as a metastasis suppressor gene. Multiple pseudogenes of this gene have been identified in the genome. [provided by RefSeq, Jul 2015] ENSG00000111707 ['MAGMA'] ['Q9H7L9'] SUDS3 ['Nucleus'] SDS3 homolog, SIN3A corepressor complex component [Source:HGNC Symbol;Acc:HGNC:29545] ['Regulatory protein which represses transcription and augments histone deacetylase activity of HDAC1. May have a potential role in tumor suppressor pathways through regulation of apoptosis. May function in the assembly and/or enzymatic activity of the mSin3A corepressor complex or in mediating interactions between the complex and other regulatory complexes'] SDS3 is a subunit of the histone deacetylase (see HDAC1; MIM 601241)-dependent SIN3A (MIM 607776) corepressor complex (Fleischer et al., 2003 [PubMed 12724404]).[supplied by OMIM, Mar 2008] ENSG00000117593 ['GWASLAB', 'MAGMA'] ['Q6PI48'] DARS2 ['Mitochondrion matrix', 'Mitochondrion membrane'] aspartyl-tRNA synthetase 2, mitochondrial [Source:HGNC Symbol;Acc:HGNC:25538] ['Catalyzes the attachment of aspartate to tRNA(Asp) in a two-step reaction: aspartate is first activated by ATP to form Asp-AMP and then transferred to the acceptor end of tRNA(Asp)'] The protein encoded by this gene belongs to the class-II aminoacyl-tRNA synthetase family. It is a mitochondrial enzyme that specifically aminoacylates aspartyl-tRNA. Mutations in this gene are associated with leukoencephalopathy with brainstem and spinal cord involvement and lactate elevation (LBSL). [provided by RefSeq, Nov 2009] ENSG00000117601 ['MAGMA'] ['P01008'] SERPINC1 ['Secreted, extracellular space'] serpin family C member 1 [Source:HGNC Symbol;Acc:HGNC:775] ['Most important serine protease inhibitor in plasma that regulates the blood coagulation cascade (PubMed:15140129, PubMed:15853774). AT-III inhibits thrombin, matriptase-3/TMPRSS7, as well as factors IXa, Xa and XIa (PubMed:15140129). Its inhibitory activity is greatly enhanced in the presence of heparin'] The protein encoded by this gene, antithrombin III, is a plasma protease inhibitor and a member of the serpin superfamily. This protein inhibits thrombin as well as other activated serine proteases of the coagulation system, and it regulates the blood coagulation cascade. The protein includes two functional domains: the heparin binding-domain at the N-terminus of the mature protein, and the reactive site domain at the C-terminus. The inhibitory activity is enhanced by the presence of heparin. Numerous mutations have been identified for this gene, many of which are known to cause antithrombin-III deficiency which constitutes a strong risk factor for thrombosis. A reduction in the serum level of this protein is associated with severe cases of Coronavirus Disease 19 (COVID-19). [provided by RefSeq, Sep 2020] ENSG00000119242 ['MAGMA'] ['Q53HC0'] CCDC92 ['Cytoplasm, cytoskeleton, microtubule organizing center, centrosome, centriole', 'Cytoplasm'] coiled-coil domain containing 92 [Source:HGNC Symbol;Acc:HGNC:29563] ['Interferon-stimulated protein that plays a role in innate immunity. Strongly inhibits ebolavirus transcription and replication. Forms a complex with viral RNA-bound nucleocapsid NP and thereby prevents the transport of NP to the cell surface'] Enables identical protein binding activity. Predicted to be involved in innate immune response and regulation of defense response to virus. Located in centriole; centrosome; and nucleoplasm. [provided by Alliance of Genome Resources, Jul 2025] ENSG00000124198 ['GWASLAB', 'MAGMA'] ['Q9Y6D5'] ARFGEF2 ['Cytoplasm', 'Membrane', 'Golgi apparatus', 'Cytoplasm, perinuclear region', 'Golgi apparatus, trans-Golgi network', 'Endosome', 'Cytoplasm, cytoskeleton, microtubule organizing center, centrosome', 'Cell projection, dendrite', 'Cytoplasmic vesicle', 'Synapse', 'Cytoplasm, cytoskeleton'] ARF guanine nucleotide exchange factor 2 [Source:HGNC Symbol;Acc:HGNC:15853] ['Promotes guanine-nucleotide exchange on ARF1 and ARF3 and to a lower extent on ARF5 and ARF6. Promotes the activation of ARF1/ARF5/ARF6 through replacement of GDP with GTP. Involved in the regulation of Golgi vesicular transport. Required for the integrity of the endosomal compartment. Involved in trafficking from the trans-Golgi network (TGN) to endosomes and is required for membrane association of the AP-1 complex and GGA1. Seems to be involved in recycling of the transferrin receptor from recycling endosomes to the plasma membrane. Probably is involved in the exit of GABA(A) receptors from the endoplasmic reticulum. Involved in constitutive release of tumor necrosis factor receptor 1 via exosome-like vesicles; the function seems to involve PKA and specifically PRKAR2B. Proposed to act as A kinase-anchoring protein (AKAP) and may mediate crosstalk between Arf and PKA pathways'] ADP-ribosylation factors (ARFs) play an important role in intracellular vesicular trafficking. The protein encoded by this gene is involved in the activation of ARFs by accelerating replacement of bound GDP with GTP and is involved in Golgi transport. It contains a Sec7 domain, which may be responsible for its guanine-nucleotide exchange activity and also brefeldin A inhibition. [provided by RefSeq, Jul 2008] ENSG00000124207 ['MAGMA'] ['P55060'] CSE1L ['Cytoplasm', 'Nucleus'] chromosome segregation 1 like [Source:HGNC Symbol;Acc:HGNC:2431] ['Export receptor for importin-alpha. Mediates importin-alpha re-export from the nucleus to the cytoplasm after import substrates (cargos) have been released into the nucleoplasm. In the nucleus binds cooperatively to importin-alpha and to the GTPase Ran in its active GTP-bound form. Docking of this trimeric complex to the nuclear pore complex (NPC) is mediated through binding to nucleoporins. Upon transit of a nuclear export complex into the cytoplasm, disassembling of the complex and hydrolysis of Ran-GTP to Ran-GDP (induced by RANBP1 and RANGAP1, respectively) cause release of the importin-alpha from the export receptor. CSE1L/XPO2 then return to the nuclear compartment and mediate another round of transport. The directionality of nuclear export is thought to be conferred by an asymmetric distribution of the GTP- and GDP-bound forms of Ran between the cytoplasm and nucleus'] Proteins that carry a nuclear localization signal (NLS) are transported into the nucleus by the importin-alpha/beta heterodimer. Importin-alpha binds the NLS, while importin-beta mediates translocation through the nuclear pore complex. After translocation, RanGTP binds importin-beta and displaces importin-alpha. Importin-alpha must then be returned to the cytoplasm, leaving the NLS protein behind. The protein encoded by this gene binds strongly to NLS-free importin-alpha, and this binding is released in the cytoplasm by the combined action of RANBP1 and RANGAP1. In addition, the encoded protein may play a role both in apoptosis and in cell proliferation. Alternatively spliced transcript variants have been found for this gene. [provided by RefSeq, Jan 2012] ENSG00000124214 ['MAGMA'] ['O95793'] STAU1 ['Cytoplasm', 'Rough endoplasmic reticulum'] staufen double-stranded RNA binding protein 1 [Source:HGNC Symbol;Acc:HGNC:11370] ['(Microbial infection) Plays a role in virus particles production of many viruses including of HIV-1, HERV-K, ebola virus and influenza virus. Acts by interacting with various viral proteins involved in particle budding process Binds double-stranded RNA (regardless of the sequence) and tubulin. May play a role in specific positioning of mRNAs at given sites in the cell by cross-linking cytoskeletal and RNA components, and in stimulating their translation at the site'] Staufen is a member of the family of double-stranded RNA (dsRNA)-binding proteins involved in the transport and/or localization of mRNAs to different subcellular compartments and/or organelles. These proteins are characterized by the presence of multiple dsRNA-binding domains which are required to bind RNAs having double-stranded secondary structures. The human homologue of staufen encoded by STAU, in addition contains a microtubule- binding domain similar to that of microtubule-associated protein 1B, and binds tubulin. The STAU gene product has been shown to be present in the cytoplasm in association with the rough endoplasmic reticulum (RER), implicating this protein in the transport of mRNA via the microtubule network to the RER, the site of translation. [provided by RefSeq, Apr 2020] ENSG00000135090 ['MAGMA'] ['Q9H2K8'] TAOK3 ['Cytoplasm', 'Cell membrane', 'Membrane raft', 'Lipid droplet'] TAO kinase 3 [Source:HGNC Symbol;Acc:HGNC:18133] [\"Serine/threonine-protein kinase that acts as a regulator of the p38/MAPK14 stress-activated MAPK cascade and of the MAPK8/JNK cascade. In response to DNA damage, involved in the G2/M transition DNA damage checkpoint by activating the p38/MAPK14 stress-activated MAPK cascade, probably by mediating phosphorylation of upstream MAP2K3 and MAP2K6 kinases. Inhibits basal activity of the MAPK8/JNK cascade and diminishes its activation in response to epidermal growth factor (EGF). Positively regulates canonical T cell receptor (TCR) signaling by preventing early PTPN6/SHP1-mediated inactivation of LCK, ensuring sustained TCR signaling that is required for optimal activation and differentiation of T cells (PubMed:30373850). Phosphorylates PTPN6/SHP1 on 'Thr-394', leading to its polyubiquitination and subsequent proteasomal degradation (PubMed:38166031). Required for cell surface expression of metalloprotease ADAM10 on type 1 transitional B cells which is necessary for their NOTCH-mediated development into marginal zone B cells (By similarity). Also required for the NOTCH-mediated terminal differentiation of splenic conventional type 2 dendritic cells (By similarity). Positively regulates osteoblast differentiation by acting as an upstream activator of the JNK pathway (PubMed:32807497). Promotes JNK signaling in hepatocytes and positively regulates hepatocyte lipid storage by inhibiting beta-oxidation and triacylglycerol secretion while enhancing lipid synthesis (PubMed:34634521). Restricts age-associated inflammation by negatively regulating differentiation of macrophages and their production of pro-inflammatory cytokines (By similarity). Plays a role in negatively regulating the abundance of regulatory T cells in white adipose tissue (By similarity)\"] The protein encoded by this gene is a serine/threonine protein kinase that activates the p38/MAPK14 stress-activated MAPK cascade but inhibits the basal activity of the MAPK8/JNK cascade. The encoded protein is a member of the GCK subfamily of STE20-like kinases. [provided by RefSeq, Oct 2016] ENSG00000137766 ['GWASLAB'] ['Q8NB66'] UNC13C ['Cytoplasm', 'Membrane', 'Presynaptic cell membrane'] unc-13 homolog C [Source:HGNC Symbol;Acc:HGNC:23149] ['May play a role in vesicle maturation during exocytosis as a target of the diacylglycerol second messenger pathway. May be involved in the regulation of synaptic transmission at parallel fiber - Purkinje cell synapses (By similarity)'] Predicted to enable calmodulin binding activity and syntaxin-1 binding activity. Predicted to be involved in glutamatergic synaptic transmission and regulated exocytosis. Predicted to be located in presynaptic active zone. Predicted to be active in several cellular components, including axon terminus; parallel fiber to Purkinje cell synapse; and synaptic vesicle membrane. [provided by Alliance of Genome Resources, Apr 2025] ENSG00000146263 ['GWASLAB'] ['Q6ZRQ5'] MMS22L ['Nucleus', 'Chromosome'] MMS22 like, DNA repair protein [Source:HGNC Symbol;Acc:HGNC:21475] ['Component of the MMS22L-TONSL complex, a complex that promotes homologous recombination-mediated repair of double-strand breaks (DSBs) at stalled or collapsed replication forks (PubMed:21055983, PubMed:21055984, PubMed:21055985, PubMed:21113133, PubMed:26527279, PubMed:27338793, PubMed:29478807). The MMS22L-TONSL complex is required to maintain genome integrity during DNA replication (PubMed:21055983, PubMed:21055984, PubMed:21055985, PubMed:27797818). It mediates the assembly of RAD51 filaments on single-stranded DNA (ssDNA): the MMS22L-TONSL complex is recruited to DSBs following histone replacement by histone chaperones and eviction of the replication protein A complex (RPA/RP-A) from DSBs (PubMed:21055983, PubMed:21055984, PubMed:21055985, PubMed:29478807). Following recruitment to DSBs, the TONSL-MMS22L complex promotes recruitment of RAD51 filaments and subsequent homologous recombination (PubMed:27797818, PubMed:29478807). Within the complex, MMS22L acts by binding ssDNA (PubMed:27797818)'] The protein encoded by this gene forms a complex with tonsoku-like, DNA repair protein (TONSL), and this complex recognizes and repairs DNA double-strand breaks at sites of stalled or collapsed replication forks. The encoded protein also can bind with the histone-associated protein NFKBIL2 to help regulate the chromatin state at stalled replication forks. Finally, this gene appears to be overexpressed in most lung and esophageal cancers. Multiple transcript variants encoding different isoforms have been found for this gene. [provided by RefSeq, Apr 2017] ENSG00000154975 ['GWASLAB'] ['Q9NS85'] CA10 carbonic anhydrase 10 [Source:HGNC Symbol;Acc:HGNC:1369] ['Does not have a catalytic activity'] This gene encodes a protein that belongs to the carbonic anhydrase family of zinc metalloenzymes, which catalyze the reversible hydration of carbon dioxide in various biological processes. The protein encoded by this gene is an acatalytic member of the alpha-carbonic anhydrase subgroup, and it is thought to play a role in the central nervous system, especially in brain development. Multiple transcript variants encoding the same protein have been found for this gene. [provided by RefSeq, Jul 2008] ENSG00000158406 ['MAGMA'] ['P62805'] H4C1 ['Nucleus', 'Chromosome'] H4 clustered histone 8 [Source:HGNC Symbol;Acc:HGNC:4788] ['Core component of nucleosome. Nucleosomes wrap and compact DNA into chromatin, limiting DNA accessibility to the cellular machineries which require DNA as a template. Histones thereby play a central role in transcription regulation, DNA repair, DNA replication and chromosomal stability. DNA accessibility is regulated via a complex set of post-translational modifications of histones, also called histone code, and nucleosome remodeling'] Histones are basic nuclear proteins that are responsible for the nucleosome structure of the chromosomal fiber in eukaryotes. Two molecules of each of the four core histones (H2A, H2B, H3, and H4) form an octamer, around which approximately 146 bp of DNA is wrapped in repeating units, called nucleosomes. The linker histone, H1, interacts with linker DNA between nucleosomes and functions in the compaction of chromatin into higher order structures. This gene is intronless and encodes a replication-dependent histone that is a member of the histone H4 family. Transcripts from this gene lack polyA tails but instead contain a palindromic termination element. This gene is found in the large histone gene cluster on chromosome 6. [provided by RefSeq, Aug 2015] ENSG00000179195 ['MAGMA'] ['Q8N3J9'] ZNF664 ['Nucleus'] zinc finger protein 664 [Source:HGNC Symbol;Acc:HGNC:25406] ['May be involved in transcriptional regulation'] Predicted to enable DNA-binding transcription factor activity, RNA polymerase II-specific and RNA polymerase II cis-regulatory region sequence-specific DNA binding activity. Predicted to be involved in regulation of DNA-templated transcription. Located in nucleus. [provided by Alliance of Genome Resources, Jul 2025] ENSG00000185278 ['MAGMA'] ['Q5TC79'] ZBTB37 ['Nucleus'] zinc finger and BTB domain containing 37 [Source:HGNC Symbol;Acc:HGNC:28365] ['May be involved in transcriptional regulation'] Enables sequence-specific double-stranded DNA binding activity. Predicted to be involved in negative regulation of transcription by RNA polymerase II; regulation of cytokine production; and regulation of immune system process. Predicted to be located in chromatin. Predicted to be active in nucleoplasm. [provided by Alliance of Genome Resources, Jul 2025] ENSG00000187323 ['MAGMA'] ['P43146'] DCC ['Membrane'] DCC netrin 1 receptor [Source:HGNC Symbol;Acc:HGNC:2701] ['Receptor for netrin required for axon guidance. Mediates axon attraction of neuronal growth cones in the developing nervous system upon ligand binding. Its association with UNC5 proteins may trigger signaling for axon repulsion. It also acts as a dependence receptor required for apoptosis induction when not associated with netrin ligand. Implicated as a tumor suppressor gene'] This gene encodes a netrin 1 receptor. The transmembrane protein is a member of the immunoglobulin superfamily of cell adhesion molecules, and mediates axon guidance of neuronal growth cones towards sources of netrin 1 ligand. The cytoplasmic tail interacts with the tyrosine kinases Src and focal adhesion kinase (FAK, also known as PTK2) to mediate axon attraction. The protein partially localizes to lipid rafts, and induces apoptosis in the absence of ligand. The protein functions as a tumor suppressor, and is frequently mutated or downregulated in colorectal cancer and esophageal carcinoma. [provided by RefSeq, Oct 2009] ENSG00000188730 ['MAGMA'] ['Q2TAL6'] VWC2 ['Secreted, extracellular space, extracellular matrix, basement membrane', 'Synapse'] von Willebrand factor C domain containing 2 [Source:HGNC Symbol;Acc:HGNC:30200] ['BMP antagonist which may play a role in neural development. Promotes cell adhesion (By similarity)'] This gene encodes a secreted bone morphogenic protein antagonist. The encoded protein is possibly involved in neural function and development and may have a role in cell adhesion.[provided by RefSeq, Oct 2009] ENSG00000197653 ['MAGMA'] ['Q8IVF4'] DNAH10 ['Cytoplasm, cytoskeleton, cilium axoneme'] dynein axonemal heavy chain 10 [Source:HGNC Symbol;Acc:HGNC:2941] ['Force generating protein of respiratory cilia. Produces force towards the minus ends of microtubules. Dynein has ATPase activity; the force-producing power stroke is thought to occur on release of ADP. Involved in sperm motility; implicated in sperm flagellar assembly (PubMed:34237282). Probable inner arm dynein heavy chain'] Dyneins are microtubule-associated motor protein complexes composed of several heavy, light, and intermediate chains. The axonemal dyneins, found in cilia and flagella, are components of the outer and inner dynein arms attached to the peripheral microtubule doublets. DNAH10 is an inner arm dynein heavy chain (Maiti et al., 2000 [PubMed 11175280]).[supplied by OMIM, Mar 2008] ENSG00000197935 ['MAGMA'] ['Q5JNZ3'] ZNF311 ['Nucleus'] zinc finger protein 311 [Source:HGNC Symbol;Acc:HGNC:13847] ['May be involved in transcriptional regulation'] Predicted to enable DNA-binding transcription factor activity, RNA polymerase II-specific and RNA polymerase II cis-regulatory region sequence-specific DNA binding activity. Predicted to be involved in regulation of transcription by RNA polymerase II. Predicted to be active in nucleus. [provided by Alliance of Genome Resources, Jul 2025] ENSG00000198216 ['MAGMA'] ['Q15878'] CACNA1E ['Membrane'] calcium voltage-gated channel subunit alpha1 E [Source:HGNC Symbol;Acc:HGNC:1392] [\"Voltage-sensitive calcium channels (VSCC) mediate the entry of calcium ions into excitable cells (PubMed:30343943). They are also involved in a variety of calcium-dependent processes, including muscle contraction, hormone or neurotransmitter release, gene expression, cell motility, cell division and cell death. The isoform alpha-1E gives rise to R-type calcium currents. R-type calcium channels belong to the 'high-voltage activated' (HVA) group and are blocked by nickel. They are however insensitive to dihydropyridines (DHP). Calcium channels containing alpha-1E subunit could be involved in the modulation of firing patterns of neurons which is important for information processing Voltage-sensitive calcium channels (VSCC) mediate the entry of calcium ions into excitable cells. They are also involved in a variety of calcium-dependent processes, including muscle contraction, hormone or neurotransmitter release, gene expression, cell motility, cell division and cell death. The isoform alpha-1E gives rise to R-type calcium currents\"] Voltage-dependent calcium channels are multisubunit complexes consisting of alpha-1, alpha-2, beta, and delta subunits in a 1:1:1:1 ratio. These channels mediate the entry of calcium ions into excitable cells, and are also involved in a variety of calcium-dependent processes, including muscle contraction, hormone or neurotransmitter release, gene expression, cell motility, cell division and cell death. This gene encodes the alpha-1E subunit of the R-type calcium channels, which belong to the 'high-voltage activated' group that maybe involved in the modulation of firing patterns of neurons important for information processing. Alternatively spliced transcript variants encoding different isoforms have been described for this gene. [provided by RefSeq, Apr 2011] ENSG00000250091 ['MAGMA'] [None] dynein axonemal heavy chain 10 opposite strand [Source:HGNC Symbol;Acc:HGNC:37121] [None] ENSG00000274618 ['GWASLAB'] ['P62805'] H4C1 ['Nucleus', 'Chromosome'] H4 clustered histone 6 [Source:HGNC Symbol;Acc:HGNC:4783] ['Core component of nucleosome. Nucleosomes wrap and compact DNA into chromatin, limiting DNA accessibility to the cellular machineries which require DNA as a template. Histones thereby play a central role in transcription regulation, DNA repair, DNA replication and chromosomal stability. DNA accessibility is regulated via a complex set of post-translational modifications of histones, also called histone code, and nucleosome remodeling'] Histones are basic nuclear proteins that are responsible for the nucleosome structure of the chromosomal fiber in eukaryotes. Two molecules of each of the four core histones (H2A, H2B, H3, and H4) form an octamer, around which approximately 146 bp of DNA is wrapped in repeating units, called nucleosomes. The linker histone, H1, interacts with linker DNA between nucleosomes and functions in the compaction of chromatin into higher order structures. This gene is intronless and encodes a replication-dependent histone that is a member of the histone H4 family. Transcripts from this gene lack polyA tails but instead contain a palindromic termination element. This gene is found in the large histone gene cluster on chromosome 6. [provided by RefSeq, Aug 2015]"},{"location":"Analysis/DecodeME/DecodeME_Lead_Variants/","title":"DecodeME Lead Variants","text":""},{"location":"Analysis/DecodeME/DecodeME_Lead_Variants/#decodeme-lead-variants","title":"DecodeME Lead Variants","text":"<p>As an initial analysis step, we apply GWASLab's procedure for extracting lead variants to the DecodeME GWAS-1 data.  This procedure groups together significant genetic variants using a sliding-window approach, then reports the most significant variant in each region.</p>"},{"location":"Analysis/DecodeME/DecodeME_Lead_Variants/#table-of-variants-from-gwaslab","title":"Table of Variants from GWASLAB","text":"<p>Here is the table of lead variants produced by GWASLab:</p> SNPID CHR POS EA NEA EAF BETA SE CHISQ MLOG10P N GENE 1:173846152:T:C 1 173846152 C T 0.325279 -0.0759185 0.0136323 31.0138 7.59142 275488 DARS2 6:26239176:A:G 6 26239176 G A 0.261233 0.0825251 0.0140356 34.5711 8.3862 275488 H4C6 6:97984426:C:CA 6 97984426 CA C 0.546314 -0.068408 0.0125368 29.7742 7.3139 275488 MMS22L 15:54866724:A:G 15 54866724 G A 0.311707 0.0785482 0.0135977 33.369 8.11788 275488 UNC13C 17:52183006:C:T 17 52183006 T C 0.329679 0.0805953 0.0134577 35.8658 8.67492 275488 CA10 20:48914387:T:TA 20 48914387 TA T 0.633808 0.0909054 0.0133414 46.4275 11.0219 275488 ARFGEF2 <p>Note that the genomic coordinates in the table above refer to genome build 38.</p>"},{"location":"Analysis/DecodeME/DecodeME_Lead_Variants/#comparison-with-lead-variants-reported-in-decodeme","title":"Comparison with lead variants reported in DecodeME","text":"<p>The lead variants reported above by GWASLAB all agree with the variants reported by the DecodeME preprint<sup>1</sup>.  However, in some cases, GWASLAB assigns these lead variants to different genes than the DecodeME preprint.</p> <p>In particular</p> <ul> <li>17:52183006:C:T is assigned to CA10 by both GWASLAB and the DecodeME preprint.</li> <li>20:48914387:T:TA is assigned to both ARFGEF2 and CSE1L by the DecodeME preprint.  GWASLAB assigns only ARFGEF2.</li> <li>The other variants are assigned to different genes by GWASLAB and the DecodeME preprint.  This reflects ambiguity about how to assign GWAS signals to genes.</li> </ul>"},{"location":"Analysis/DecodeME/DecodeME_Lead_Variants/#reproducing","title":"Reproducing","text":"<p>To reproduce this analysis, run the initial DecodeME analysis script.</p> <ol> <li> <p>Genetics Delivery Team, Thibaud Boutin, Andrew D Bretherick, Joshua J Dibble, Esther Ewaoluwagbemiga, Emma Northwood, Gemma L Samms, Veronique Vitart, Project, Cohort Delivery Team, \u00d8yvind Almelid, and others. Initial findings from the decodeme genome-wide association study of myalgic encephalomyelitis/chronic fatigue syndrome. medRxiv, pages 2025\u201308, 2025. URL: https://www.medrxiv.org/content/10.1101/2025.08.06.25333109v1.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/DecodeME/MAGMA-HBA-DecodeME/","title":"MAGMA HBA Analysis","text":""},{"location":"Analysis/DecodeME/MAGMA-HBA-DecodeME/#magma-hba-analysis","title":"MAGMA HBA Analysis","text":"<p>I applied MAGMA to the DecodeME GWAS using scRNAseq data from the Human Brain Atlas (HBA) as a reference.</p>"},{"location":"Analysis/DecodeME/MAGMA-HBA-DecodeME/#results","title":"Results","text":"<p>The results are plotted below:</p> <p></p> <p>The x-axis corresponds to HBA cluster number<sup>1</sup>, while the y-axis corresponds to the \\(-\\log_{10}(p)\\) score generated by MAGMA.  Clusters are colored according to their HBA supercluster. The dotted line denotes the Bonferroni significance threshold.  I used a conditional analysis approach based on the one described in Wanatabe et al.<sup>2</sup> to identify independent clusters.  These 3 independent clusters are labeled in plot.  I have also listed them in the table below, together with some cluster-annotations from Duncan et al.<sup>3</sup>.</p> Retained_clusters P Supercluster Class auto-annotation Neurotransmitter auto-annotation Neuropeptide auto-annotation Subtype auto-annotation Transferred MTG Label Top three regions Top Enriched Genes Cluster234 4.01e-06 Eccentric medium spiny neuron NEUR GABA CCK CHGA CHGB NAMPT NUCB PENK SCG UBL VGF proSAAS MSN-D1 Amygdala: 75.9%, Cerebral cortex: 14.6%, Thalamus: 5.4% NPFFR2, ZNF736P9Y, GABRQ, LMNTD1, EYA2, AC012078.2, AC087516.2, PCDH11Y, LINC00354, NMBR Cluster419 8.2057e-06 Amygdala excitatory NEUR VGLUT1 VGLUT2 ADCYAP CART CCK CHGA CHGB NAMPT NUCB NXPH SCG UBL VGF proSAAS 0 Amygdala: 78.9%, Cerebral cortex: 14.0%, Thalamus: 5.1% AC025244.1, AC096759.1, SCN5A, FAM9B, GABRQ, LINC01920, VWA5B1, CYP19A1, CARM1P1, LINC02498 Cluster136 1.2765e-05 Deep-layer intratelencephalic NEUR VGLUT1 VGLUT2 ADCYAP CBLN CCK CHGA CHGB CRH NAMPT NUCB PYY SCG UBL UCN VGF proSAAS 0 Amygdala: 54.6%, Cerebral cortex: 36.2%, Hypothalamus: 8.6% AC099517.1, LINC02196, AC079380.1, LINC02465, AL138927.1, AC073578.2, AL450352.1, ARHGAP15, TNNT2, LINC02378 <ol> <li> <p>Kimberly Siletti, Rebecca Hodge, Alejandro Mossi Albiach, Ka Wai Lee, Song-Lin Ding, Lijuan Hu, Peter L\u00f6nnerberg, Trygve Bakken, Tamara Casper, Michael Clark, and others. Transcriptomic diversity of cell types across the adult human brain. Science, 382(6667):eadd7046, 2023. URL: https://www.science.org/doi/abs/10.1126/science.add7046.\u00a0\u21a9</p> </li> <li> <p>Kyoko Watanabe, Ma\u0161a Umi\u0107evi\u0107 Mirkov, Christiaan A de Leeuw, Martijn P van den Heuvel, and Danielle Posthuma. Genetic mapping of cell type specificity for complex traits. Nature communications, 10(1):3222, 2019. URL: https://www.nature.com/articles/s41467-019-11181-1.\u00a0\u21a9</p> </li> <li> <p>Laramie E Duncan, Tayden Li, Madeleine Salem, Will Li, Leili Mortazavi, Hazal Senturk, Naghmeh Shahverdizadeh, Sam Vesuna, Hanyang Shen, Jong Yoon, and others. Mapping the cellular etiology of schizophrenia and complex brain phenotypes. Nature Neuroscience, 28(2):248\u2013258, 2025. URL: https://www.nature.com/articles/s41593-024-01834-w.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/DecodeME/MAGMA_DecodeME_Analysis/","title":"MAGMA DecodeME Analysis","text":""},{"location":"Analysis/DecodeME/MAGMA_DecodeME_Analysis/#magma-gtex-analysis","title":"MAGMA GTEx Analysis","text":"<p>As an initial step, I applied MAGMA to DecodeME, partially reproducing analysis from the DecodeME preprint<sup>1</sup>.  </p>"},{"location":"Analysis/DecodeME/MAGMA_DecodeME_Analysis/#magma-gene-analysis","title":"MAGMA Gene Analysis","text":"<p>I applied MAGMA's SNP-wise-mean model to the summary statistics from DecodeME's GWAS-1. </p> <p>In this step:</p> <ul> <li>Data from the 1000 genomes projects was downloaded from the MAGMA website and used as a linkage disequilibrium reference.</li> <li>Build 151 of dbSNP was used to assign RSIDs to SNPs.</li> <li>Magma's default proximity-based rules were used to assign SNPs to genes.</li> </ul> <p>MAGMA produces a table of genes, effect sizes, and p values.  Filtering these genes via the Benjamini-Hochberg procedure<sup>2</sup> at a false discovery rate of 0.01, and joining with a database of gene descriptions from Ensembl Biomart produces the following table:</p> GENE Gene name CHR P Gene description ENSG00000033122 LRRC7 1 1.724e-09 leucine rich repeat containing 7 [Source:HGNC Symbol;Acc:HGNC:18531] ENSG00000124214 STAU1 20 7.0767e-09 staufen double-stranded RNA binding protein 1 [Source:HGNC Symbol;Acc:HGNC:11370] ENSG00000124207 CSE1L 20 3.2463e-08 chromosome segregation 1 like [Source:HGNC Symbol;Acc:HGNC:2431] ENSG00000135090 TAOK3 12 2.3082e-07 TAO kinase 3 [Source:HGNC Symbol;Acc:HGNC:18133] ENSG00000124198 ARFGEF2 20 3.1435e-07 ARF guanine nucleotide exchange factor 2 [Source:HGNC Symbol;Acc:HGNC:15853] ENSG00000117593 DARS2 1 3.3379e-07 aspartyl-tRNA synthetase 2, mitochondrial [Source:HGNC Symbol;Acc:HGNC:25538] ENSG00000185278 ZBTB37 1 4.503e-07 zinc finger and BTB domain containing 37 [Source:HGNC Symbol;Acc:HGNC:28365] ENSG00000250091 DNAH10OS 12 6.5098e-07 dynein axonemal heavy chain 10 opposite strand [Source:HGNC Symbol;Acc:HGNC:37121] ENSG00000179195 ZNF664 12 1.1217e-06 zinc finger protein 664 [Source:HGNC Symbol;Acc:HGNC:25406] ENSG00000119242 CCDC92 12 1.2073e-06 coiled-coil domain containing 92 [Source:HGNC Symbol;Acc:HGNC:29563] ENSG00000197935 ZNF311 6 1.2929e-06 zinc finger protein 311 [Source:HGNC Symbol;Acc:HGNC:13847] ENSG00000158406 H4C8 6 1.8071e-06 H4 clustered histone 8 [Source:HGNC Symbol;Acc:HGNC:4788] ENSG00000198216 CACNA1E 1 2.2062e-06 calcium voltage-gated channel subunit alpha1 E [Source:HGNC Symbol;Acc:HGNC:1392] ENSG00000187323 DCC 18 2.2395e-06 DCC netrin 1 receptor [Source:HGNC Symbol;Acc:HGNC:2701] ENSG00000111707 SUDS3 12 2.4987e-06 SDS3 homolog, SIN3A corepressor complex component [Source:HGNC Symbol;Acc:HGNC:29545] ENSG00000197653 DNAH10 12 3.4281e-06 dynein axonemal heavy chain 10 [Source:HGNC Symbol;Acc:HGNC:2941] ENSG00000089220 PEBP1 12 3.9196e-06 phosphatidylethanolamine binding protein 1 [Source:HGNC Symbol;Acc:HGNC:8630] ENSG00000188730 VWC2 7 5.7778e-06 von Willebrand factor C domain containing 2 [Source:HGNC Symbol;Acc:HGNC:30200] ENSG00000028116 VRK2 2 7.4569e-06 VRK serine/threonine kinase 2 [Source:HGNC Symbol;Acc:HGNC:12719] ENSG00000117601 SERPINC1 1 8.7656e-06 serpin family C member 1 [Source:HGNC Symbol;Acc:HGNC:775]"},{"location":"Analysis/DecodeME/MAGMA_DecodeME_Analysis/#magma-gene-property-analysis","title":"MAGMA Gene Property Analysis","text":"<p>I next applied MAGMA's gene property analysis module to DecodeME.  This step combined the gene analysis results above with tissue-specific RNA expression values from the GTEx project<sup>3</sup>.  The aim was to identify tissues enriched for genes associated with ME/CFS.  The results are shown in the bar plot below:</p> <p> In this plot, the y-axis corresponds to \\(-\\log_{10}(p)\\) values, the x-axis corresponds to tissue type (only tissues with the smallest p values are shown), and bars are colored according to whether their p value meets Bonferroni-corrected significance threshold,</p> <p>These results unambiguously point to the nervous system as a major site of ME/CFS gene activity.</p>"},{"location":"Analysis/DecodeME/MAGMA_DecodeME_Analysis/#reproducing","title":"Reproducing","text":"<p>To reproduce this analysis, run the DecodeME Initial Analysis Script.</p>"},{"location":"Analysis/DecodeME/MAGMA_DecodeME_Analysis/#follow-up-questions","title":"Follow-Up Questions","text":"<ol> <li>Do other approaches to identify significant tissues from GWAS-summary statistics produce concordant or discordant results?</li> <li>How reliable is the GTEx-based MAGMA gene-set-analysis approach to identifying significant tissues?  In other words: for diseases with well-understood pathological processes, does it produce results consistent with these processes?</li> </ol> <ol> <li> <p>Genetics Delivery Team, Thibaud Boutin, Andrew D Bretherick, Joshua J Dibble, Esther Ewaoluwagbemiga, Emma Northwood, Gemma L Samms, Veronique Vitart, Project, Cohort Delivery Team, \u00d8yvind Almelid, and others. Initial findings from the decodeme genome-wide association study of myalgic encephalomyelitis/chronic fatigue syndrome. medRxiv, pages 2025\u201308, 2025. URL: https://www.medrxiv.org/content/10.1101/2025.08.06.25333109v1.\u00a0\u21a9</p> </li> <li> <p>Yoav Benjamini and Yosef Hochberg. Controlling the false discovery rate: a practical and powerful approach to multiple testing. Journal of the Royal statistical society: series B (Methodological), 57(1):289\u2013300, 1995. URL: https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/j.2517-6161.1995.tb02031.x.\u00a0\u21a9</p> </li> <li> <p>GTEx Consortium. The gtex consortium atlas of genetic regulatory effects across human tissues. Science, 369(6509):1318\u20131330, 2020. URL: https://www.science.org/doi/full/10.1126/science.aaz1776.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/DecodeME/S-LDSC_DecodeME_Analysis/","title":"S-LDSC Analysis of DecodeME","text":""},{"location":"Analysis/DecodeME/S-LDSC_DecodeME_Analysis/#s-ldsc-analysis-of-decodeme","title":"S-LDSC Analysis of DecodeME","text":"<p>Stratified Linkage Disequilibrium Score Regression (S-LDSC) was applied to summary statistics from GWAS-1 of DecodeME<sup>1</sup>.</p>"},{"location":"Analysis/DecodeME/S-LDSC_DecodeME_Analysis/#reference-data-sources","title":"Reference Data Sources","text":"<p>I used the standard reference datasets prepared by the authors of the S-LDSC method.</p> <ul> <li>The GTEx Project</li> <li>The Franke lab dataset</li> <li>The Roadmap Epigenetic Project</li> <li>The Corces et al. ATAC-seq dataset of 13 blood cell types.</li> <li>The ImmGen Project</li> <li>The Cahoy Mouse Central Nervous System Dataset</li> </ul>"},{"location":"Analysis/DecodeME/S-LDSC_DecodeME_Analysis/#results","title":"Results","text":""},{"location":"Analysis/DecodeME/S-LDSC_DecodeME_Analysis/#gtex-and-franke-lab-tissue-expression-data","title":"GTEx and Franke lab tissue expression data","text":"<p>The plot and table below show the results of the application of S-LDSC to DecodeME using the GTEx and Franke lab gene expression datasets. In the plot, the x-axis corresponds to cell type, while the y-axis corresponds to \\(-\\log_{10}(p)\\).  Points are colored according to broad tissue category.  Large points correspond to cell/tissue types deemed significant by an application of the Benjamini-Hochberg procedure at an FDR of 0.01<sup>2</sup>.  The table shows details of the cell/tissues types with the smallest p values.</p> <p></p> Name Coefficient Coefficient_P_value Reject Null A08.186.211.Brain 4.72676e-09 2.47819e-07 True A08.186.211.730.885.287.500.571.735.Visual.Cortex 4.53115e-09 1.56363e-06 True A08.186.211.464.405.Hippocampus 4.49163e-09 2.19491e-06 True Brain_Cortex 3.66873e-09 2.6085e-06 True A08.186.211.730.885.287.500.270.Frontal.Lobe 4.63607e-09 3.13473e-06 True Brain_Nucleus_accumbens_(basal_ganglia) 3.59733e-09 3.36967e-06 True Brain_Frontal_Cortex_(BA9) 3.69246e-09 3.7678e-06 True A08.186.211.730.885.287.500.Cerebral.Cortex 4.17782e-09 6.18484e-06 True A08.186.211.464.710.225.Entorhinal.Cortex 4.14964e-09 6.71693e-06 True A08.186.211.464.Limbic.System 4.20837e-09 7.01006e-06 True Brain_Substantia_nigra 3.51471e-09 8.8185e-06 True Brain_Anterior_cingulate_cortex_(BA24) 3.26788e-09 1.0814e-05 True Brain_Amygdala 3.19633e-09 2.91008e-05 True Brain_Hippocampus 3.25752e-09 3.53736e-05 True Brain_Caudate_(basal_ganglia) 3.10888e-09 7.75616e-05 True Brain_Putamen_(basal_ganglia) 3.10587e-09 0.000104439 True A08.186.211.730.317.357.352.435.Hypothalamo.Hypophyseal.System 3.61124e-09 0.000166442 True A08.186.211.730.317.357.Hypothalamus 3.24167e-09 0.00023368 True A08.186.211.730.885.287.500.670.Parietal.Lobe 3.4577e-09 0.000240607 True Brain_Hypothalamus 2.84899e-09 0.000356557 True A08.186.211.730.317.Diencephalon 2.9906e-09 0.000463437 True Brain_Cerebellar_Hemisphere 2.66524e-09 0.000644924 True A08.186.211.730.885.287.249.Basal.Ganglia 2.69897e-09 0.0010573 True A08.186.211.865.428.Metencephalon 2.44467e-09 0.0019363 False A08.186.211.730.885.287.249.487.Corpus.Striatum 2.2671e-09 0.00453931 False A08.186.211.653.Mesencephalon 2.44809e-09 0.00517217 False Brain_Cerebellum 2.21062e-09 0.00541441 False Brain_Spinal_cord_(cervical_c-1) 2.08238e-09 0.00603588 False <p>As we saw in our earlier MAGMA analysis using the GTEx dataset, the significant tissues are all CNS-related.</p>"},{"location":"Analysis/DecodeME/S-LDSC_DecodeME_Analysis/#roadmap-chromatin-data","title":"Roadmap Chromatin data","text":"<p>I next applied S-LDSC using the reference dataset derived from the Roadmap epigenetic project.  The results are in the plot and table below:</p> <p></p> Name Coefficient Coefficient_P_value Reject Null Fetal_Brain_Female__DNase 1.02689e-07 4.68419e-10 True Brain_Dorsolateral_Prefrontal_Cortex__H3K27ac 5.08217e-08 1.23002e-09 True Fetal_Brain_Male__DNase 9.55596e-08 2.73287e-09 True Fetal_Brain_Male__H3K4me1 3.78077e-08 5.22621e-09 True Brain_Dorsolateral_Prefrontal_Cortex__H3K4me3 1.70485e-07 5.98839e-09 True Fetal_Brain_Female__H3K4me1 6.20252e-08 1.37543e-08 True Brain_Anterior_Caudate__H3K27ac 3.86611e-08 3.06201e-08 True Brain_Inferior_Temporal_Lobe__H3K27ac 3.30624e-08 2.87328e-07 True Brain_Cingulate_Gyrus__H3K9ac 8.70527e-08 3.38485e-07 True Brain_Angular_Gyrus__H3K9ac 8.39789e-08 9.75539e-07 True Brain_Dorsolateral_Prefrontal_Cortex__H3K4me1 5.21768e-08 1.72804e-06 True Brain_Germinal_Matrix__H3K4me3 1.26424e-07 1.85932e-06 True Brain_Inferior_Temporal_Lobe__H3K4me3 1.03363e-07 3.9248e-06 True Brain_Anterior_Caudate__H3K4me3 1.02781e-07 4.68e-06 True Fetal_Brain_Female__H3K4me3 1.26751e-07 5.12867e-06 True Brain_Angular_Gyrus__H3K4me3 1.29751e-07 9.79109e-06 True Brain_Dorsolateral_Prefrontal_Cortex__H3K9ac 9.32505e-08 9.83818e-06 True Brain_Cingulate_Gyrus__H3K4me3 1.06995e-07 1.02402e-05 True Brain_Angular_Gyrus__H3K4me1 4.08889e-08 1.39444e-05 True Brain_Angular_Gyrus__H3K27ac 3.26885e-08 1.89114e-05 True Brain_Anterior_Caudate__H3K4me1 3.54259e-08 3.15633e-05 True Brain_Anterior_Caudate__H3K9ac 6.35599e-08 3.21619e-05 True Brain_Cingulate_Gyrus__H3K27ac 2.92786e-08 3.245e-05 True Brain_Cingulate_Gyrus__H3K4me1 3.2249e-08 4.08821e-05 True Cortex_derived_primary_cultured_neurospheres__H3K4me3 1.30409e-07 5.87376e-05 True Ganglion_Eminence_derived_primary_cultured_neurospheres__H3K4me3 9.46707e-08 8.30653e-05 True Brain_Inferior_Temporal_Lobe__H3K9ac 5.55865e-08 8.69272e-05 True Brain_Hippocampus_Middle__H3K4me3 6.50022e-08 0.000226226 True Brain_Inferior_Temporal_Lobe__H3K4me1 3.38614e-08 0.00032817 True Brain_Hippocampus_Middle__H3K4me1 1.98882e-08 0.000355901 True Fetal_Brain_Female__H3K36me3 3.17864e-08 0.000550213 True Brain_Germinal_Matrix__H3K4me1 4.83297e-08 0.000608534 True skeletal_muscle_ENTEX__H3K4me1 1.17311e-08 0.000895252 False Brain_Substantia_Nigra__H3K4me3 7.29864e-08 0.00121435 False Placenta_Amnion__H3K36me3 2.5235e-08 0.00158191 False Brain_Dorsolateral_Prefrontal_Cortex__H3K36me3 3.5113e-08 0.00163492 False Brain_Hippocampus_Middle__H3K27ac 1.91901e-08 0.00173697 False Ganglion_Eminence_derived_primary_cultured_neurospheres__H3K4me1 3.16805e-08 0.00215425 False <p>Again, the strongest and most significant associations are all with CNS cell-types.</p>"},{"location":"Analysis/DecodeME/S-LDSC_DecodeME_Analysis/#immgen-data","title":"ImmGen data","text":"<p>Next, I applied S-LDSC using reference data from the ImmGen project.</p> <p>There were no significant cell types.</p> <p>The cell types with the lowest p values are shown in the table below:</p> Name Coefficient Coefficient_P_value Reject Null DC.8-4-11b+.MLN 2.98171e-09 0.00459158 False T.4.Pa.BDC 2.5939e-09 0.00506716 False T.8Mem.LN 2.85485e-09 0.00730256 False DC.8-4-11b-.SLN 2.65688e-09 0.0116649 False preT.DN2-3.Th 2.41341e-09 0.0121964 False T.4int8+.Th 2.53226e-09 0.012314 False LN.TR.14w.B6 2.52753e-09 0.0135406 False preT.ETP-2A.Th 2.50404e-09 0.0172496 False MF.103-11b+.Lu 2.36504e-09 0.0197861 False MF.Microglia.CNS 2.40608e-09 0.0224495 False B.Mem.Sp.v2 2.06099e-09 0.026437 False Tgd.vg5-.act.IEL 2.08167e-09 0.0328614 False B.MZ.Sp 2.08844e-09 0.0348465 False T.8Eff.Sp.OT1.d15.LisOva 1.80262e-09 0.0357771 False T.4SP69+.Th 1.91234e-09 0.0394321 False"},{"location":"Analysis/DecodeME/S-LDSC_DecodeME_Analysis/#corces-et-al-atac-seq-data","title":"Corces et al. ATAC-seq data","text":"<p>The results of applying S-LDSC using the epigenetic reference data from Corces et al. ATAC-seq analysis of blood cells are shown below.  There are no significant cell types:</p> Name Coefficient Coefficient_P_value Reject Null Erythro 1.83516e-08 0.154592 False Bcell 4.60401e-09 0.351883 False CLP 4.52542e-09 0.381204 False Mono -1.51999e-09 0.530117 False MEP -1.5488e-09 0.566514 False CD4 -4.57403e-09 0.628276 False CD8 -6.41332e-09 0.669675 False LMPP -9.21299e-09 0.724051 False"},{"location":"Analysis/DecodeME/S-LDSC_DecodeME_Analysis/#cahoy-and-gtex-brain-data","title":"Cahoy and GTEx-Brain data","text":"<p>The next two reference datasets pertain to the nervous system.</p> <p>Surprisingly, when we analyze the DecodeME results using the Cahoy dataset, the neuron cell type is not even close to being significant.  This is discordant with some of the results above, in which many CNS-related cell and tissue types were marked as significant.  Moreover, the oligodendrocyte cell type is closer to being significant than the neuron cell type.</p> Name Coefficient Coefficient_P_value Reject Null Oligodendrocyte 2.12389e-09 0.0294642 False Neuron 1.20321e-09 0.104572 False Astrocyte -9.45929e-10 0.825497 False <p>When we apply the S-LDSC using the GTEx brain dataset, we find the the cortex tissue type is significant:</p> Name Coefficient Coefficient_P_value Reject Null Brain_Cortex 3.27938e-09 0.000106241 True Brain_Frontal_Cortex_(BA9) 2.09994e-09 0.00675003 False Brain_Anterior_cingulate_cortex_(BA24) 1.50154e-09 0.0256637 False Brain_Nucleus_accumbens_(basal_ganglia) 1.14427e-09 0.112026 False Brain_Cerebellum 8.97215e-10 0.182957 False Brain_Hippocampus 3.3308e-10 0.341041 False Brain_Putamen_(basal_ganglia) 3.2917e-10 0.359427 False Brain_Cerebellar_Hemisphere 2.45686e-10 0.39188 False"},{"location":"Analysis/DecodeME/S-LDSC_DecodeME_Analysis/#how-to-reproduce-this","title":"How to Reproduce This","text":"<p>To reproduce, run the DecodeME Analysis Script.</p> <ol> <li> <p>Genetics Delivery Team, Thibaud Boutin, Andrew D Bretherick, Joshua J Dibble, Esther Ewaoluwagbemiga, Emma Northwood, Gemma L Samms, Veronique Vitart, Project, Cohort Delivery Team, \u00d8yvind Almelid, and others. Initial findings from the decodeme genome-wide association study of myalgic encephalomyelitis/chronic fatigue syndrome. medRxiv, pages 2025\u201308, 2025. URL: https://www.medrxiv.org/content/10.1101/2025.08.06.25333109v1.\u00a0\u21a9</p> </li> <li> <p>Yoav Benjamini and Yosef Hochberg. Controlling the false discovery rate: a practical and powerful approach to multiple testing. Journal of the Royal statistical society: series B (Methodological), 57(1):289\u2013300, 1995. URL: https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/j.2517-6161.1995.tb02031.x.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/DecodeME/Fine_Mapping/SUSIE/a_Chr1_173M_174M_Locus/","title":"Chr1 173.5M-174.5M","text":""},{"location":"Analysis/DecodeME/Fine_Mapping/SUSIE/a_Chr1_173M_174M_Locus/#chr1-1735m-1745m","title":"Chr1 173.5M-174.5M","text":""},{"location":"Analysis/DecodeME/Fine_Mapping/SUSIE/a_Chr1_173M_174M_Locus/#methodology","title":"Methodology","text":"<p>To narrow the DecodeME<sup>1</sup> GWAS-1 signal, I fine-mapped the hit on chromosome 1 using SUSIE<sup>2</sup>.</p> <p>As a linkage disequilibrium reference, I used a UK Biobank LD matrix hosted on AWS Open Data.  Because this LD reference uses GRCh37 coordinates, I used GWASLab to liftover the DecodeME summary statistics to GRCh37.</p> <p>As a sensitivity analysis, I ran SUSIE 4 times:</p> <ul> <li>Once with \\(L=10\\),</li> <li>Once with \\(L=2\\),</li> <li>Once with \\(L=1\\),</li> <li>Once with \\(L=10\\) and strict variant filtering.</li> </ul> <p>\\(L\\) refers to the maximum number of credible sets that can found by SUSIE.  A lower \\(L\\) corresponds to increased regularization, since it decreases the ability of SUSIE to use extra credible sets to fit noise.  Weissbrod et al.<sup>3</sup> observe that setting \\(L\\) to 1 protects against mismatch between the LD reference population and the GWAS population, because when \\(L=1\\), SUSIE no longer depends on the LD matrix.   They also observe that when \\(L=2\\), even though SUSIE still depends on the LD matrix, empirically it tends to be robust to moderate levels of population mismatch. I thus used the \\(L=1\\) and \\(L=2\\) runs to evaluate whether population mismatch could be influencing SUSIE's results.</p> <p>\"Variant filtering\" refers to removal of outlier variants according to a Kriging-based likelihood ratio test.  Zou et al.<sup>4</sup> propose this filtering strategy to mitigate instability in SUSIE due to mismatch between the LD and GWAS populations.  In the first three runs above, I filter variants with a likelihood ratio (\\(\\mathrm{LR}\\)) and absolute \\(z\\) score greater than 2, consistent with the SUSIE documentation.  In the final run I instead filter variants with \\(\\mathrm{LR}\\ge 2\\) and \\(|z|\\ge 1\\), to evaluate the sensitivity of the results to the filtering threshold.</p> <p>In my SUSIE runs, I retained palindromic SNPs whose strand orientation GWASLAB was able to determine from allele frequencies in the Thousand Genomes Project, and discarded other palindromic SNPs.</p>"},{"location":"Analysis/DecodeME/Fine_Mapping/SUSIE/a_Chr1_173M_174M_Locus/#results","title":"Results","text":"<p>In all 4 runs, SUSIE found a single diffuse credible set.  Moreover, this credible set contained the same 86 variants in all four runs, as illustrated in the UpSet plot below:</p> <p></p> <p>The next figure illustrates the SUSIE results for \\(L=10\\). It is representative of the other runs.</p> <p></p> <ul> <li> <p>The top panel is a heatmap in which pixel \\((i,j)\\) is colored according to the squared correlation between variants \\(i\\) and \\(j\\).  The heatmap reveals the local linkage disequilibrium (LD) structure in the vicinity of the GWAS hit, which is a determinant of SUSIE's results when \\(L&gt;1\\).</p> </li> <li> <p>The second panel shows a local Manhattan plot.</p> </li> <li> <p>The third panel shows the SUSIE posterior inclusion probability (PIP).</p> </li> <li> <p>The bottom panel shows genes in the region of the GWAS hit. </p> </li> </ul> <p>Overall, SUSIE has returned a diffuse signal in a region with a number of plausible genes.  This makes it unclear which genes deserve follow-up investigation.</p> <p>The table below lists the full detailed SUSIE results for the \\(L=10\\) case</p> Variant List cs CHR POS EA NEA alpha mu PIP L1 1 173815290 C T 0.0349532 -0.022181 0.0349532 L1 1 173853127 C T 0.0334384 -0.0221481 0.0334384 L1 1 173865586 T C 0.0332454 -0.0221439 0.0332454 L1 1 173815111 C T 0.0332354 -0.0221436 0.0332354 L1 1 173866074 A T 0.0332311 -0.0221435 0.0332311 L1 1 173878862 C T 0.0328582 -0.0221352 0.0328582 L1 1 173812639 A C 0.0327682 -0.0221331 0.0327682 L1 1 173851310 A G 0.0313245 -0.0220996 0.0313245 L1 1 173859100 G A 0.0296411 -0.0220585 0.0296411 L1 1 173863209 A G 0.0296014 -0.0220575 0.0296014 L1 1 173863569 A T 0.0292311 -0.0220482 0.0292311 L1 1 173863567 T G 0.0292311 -0.0220482 0.0292311 L1 1 173846590 G T 0.0276321 -0.0220062 0.0276321 L1 1 173863568 T A 0.0275657 -0.0220044 0.0275657 L1 1 173832336 T C 0.0272003 -0.0219944 0.0272003 L1 1 173878832 C T 0.0261331 -0.0219645 0.0261331 L1 1 173838788 T TG 0.0261228 -0.0219642 0.0261228 L1 1 173855298 T A 0.0255997 -0.0219491 0.0255997 L1 1 173846110 A G 0.025353 -0.0219418 0.025353 L1 1 173857283 G A 0.0243066 -0.0219102 0.0243066 L1 1 173848009 G A 0.023978 -0.0219 0.023978 L1 1 173824813 T C 0.0234489 -0.0218833 0.0234489 L1 1 173842467 G A 0.0230966 -0.0218719 0.0230966 L1 1 173870321 G GTAC 0.0230538 -0.0218705 0.0230538 L1 1 173857037 T C 0.0228147 -0.0218627 0.0228147 L1 1 173881871 T C 0.0203149 -0.0217753 0.0203149 L1 1 173844051 T A 0.0184477 -0.0217024 0.0184477 L1 1 173820365 C T 0.0145082 -0.0215198 0.0145082 L1 1 173832772 CA C 0.0144368 -0.021516 0.0144368 L1 1 173878471 G A 0.0118415 -0.0213641 0.0118415 L1 1 173831882 G A 0.00912575 -0.0211628 0.00912575 L1 1 173743879 CAAAA C 0.00696391 -0.0209519 0.00696391 L1 1 173717200 ACT A 0.00675049 -0.0209275 0.00675049 L1 1 173767443 T A 0.00660937 -0.0209109 0.00660937 L1 1 173783493 C T 0.00650478 -0.0208983 0.00650478 L1 1 173699007 G A 0.00592378 -0.0208246 0.00592378 L1 1 173698510 T C 0.00585287 -0.0208151 0.00585287 L1 1 173709616 G T 0.0056909 -0.020793 0.0056909 L1 1 173734270 CAACA C 0.0056717 -0.0207903 0.0056717 L1 1 173683954 T C 0.00516697 -0.0207165 0.00516697 L1 1 173755936 TGAAG T 0.00476139 -0.0206516 0.00476139 L1 1 174210076 T TTG 0.00289739 -0.0202525 0.00289739 L1 1 174128994 G A 0.00239407 -0.0200971 0.00239407 L1 1 174158856 C T 0.00235282 -0.0200829 0.00235282 L1 1 174111115 T C 0.00229859 -0.0200638 0.00229859 L1 1 174066947 T C 0.00227798 -0.0200564 0.00227798 L1 1 174069469 CT C 0.00227531 -0.0200555 0.00227531 L1 1 174084104 A G 0.0022655 -0.0200519 0.0022655 L1 1 174152688 G A 0.00225032 -0.0200464 0.00225032 L1 1 174146656 C A 0.00222885 -0.0200385 0.00222885 L1 1 174085043 TACA T 0.00219654 -0.0200266 0.00219654 L1 1 174076864 C G 0.00218651 -0.0200228 0.00218651 L1 1 174064481 A T 0.0021761 -0.0200189 0.0021761 L1 1 174068049 A G 0.00215682 -0.0200116 0.00215682 L1 1 174069981 C T 0.00215307 -0.0200102 0.00215307 L1 1 174191694 C T 0.00214725 -0.0200079 0.00214725 L1 1 174062911 C T 0.00214307 -0.0200063 0.00214307 L1 1 174057626 T C 0.00214136 -0.0200057 0.00214136 L1 1 174241165 C G 0.0021385 -0.0200046 0.0021385 L1 1 174093837 G T 0.00213651 -0.0200038 0.00213651 L1 1 174157834 A G 0.00213405 -0.0200029 0.00213405 L1 1 174170341 C T 0.00213381 -0.0200028 0.00213381 L1 1 174086292 T C 0.00211439 -0.0199953 0.00211439 L1 1 174050667 G A 0.00210878 -0.0199931 0.00210878 L1 1 174068929 A G 0.00207848 -0.0199812 0.00207848 L1 1 174079700 G C 0.00207189 -0.0199786 0.00207189 L1 1 174118271 C G 0.00206586 -0.0199762 0.00206586 L1 1 174075924 G T 0.00206197 -0.0199746 0.00206197 L1 1 174075925 C T 0.00206197 -0.0199746 0.00206197 L1 1 174059522 C G 0.002049 -0.0199694 0.002049 L1 1 174161430 A G 0.00203663 -0.0199645 0.00203663 L1 1 174072203 G A 0.00203588 -0.0199642 0.00203588 L1 1 174078417 A G 0.00202943 -0.0199615 0.00202943 L1 1 174079584 T A 0.00202752 -0.0199608 0.00202752 L1 1 174079585 G A 0.00202752 -0.0199608 0.00202752 L1 1 174069421 T C 0.00191843 -0.0199152 0.00191843 L1 1 174176363 G A 0.00190403 -0.019909 0.00190403 L1 1 174144293 CACAT C 0.00189623 -0.0199056 0.00189623 L1 1 174197408 G A 0.00187952 -0.0198983 0.00187952 L1 1 174078860 C T 0.00187677 -0.0198971 0.00187677 L1 1 174113408 G A 0.0018707 -0.0198944 0.0018707 L1 1 174152476 C T 0.0018538 -0.0198869 0.0018538 L1 1 174150850 C T 0.00182508 -0.019874 0.00182508 L1 1 174060062 G A 0.00180084 -0.0198629 0.00180084 L1 1 174326702 G A 0.00161599 -0.0197731 0.00161599 L1 1 174288602 G A 0.00158912 -0.0197592 0.00158912 <ol> <li> <p>Genetics Delivery Team, Thibaud Boutin, Andrew D Bretherick, Joshua J Dibble, Esther Ewaoluwagbemiga, Emma Northwood, Gemma L Samms, Veronique Vitart, Project, Cohort Delivery Team, \u00d8yvind Almelid, and others. Initial findings from the decodeme genome-wide association study of myalgic encephalomyelitis/chronic fatigue syndrome. medRxiv, pages 2025\u201308, 2025. URL: https://www.medrxiv.org/content/10.1101/2025.08.06.25333109v1.\u00a0\u21a9</p> </li> <li> <p>Gao Wang, Abhishek Sarkar, Peter Carbonetto, and Matthew Stephens. A simple new approach to variable selection in regression, with application to genetic fine mapping. Journal of the Royal Statistical Society Series B: Statistical Methodology, 82(5):1273\u20131300, 2020. URL: https://academic.oup.com/jrsssb/article/82/5/1273/7056114.\u00a0\u21a9</p> </li> <li> <p>Omer Weissbrod, Farhad Hormozdiari, Christian Benner, Ran Cui, Jacob Ulirsch, Steven Gazal, Armin P Schoech, Bryce Van De Geijn, Yakir Reshef, Carla M\u00e1rquez-Luna, and others. Functionally informed fine-mapping and polygenic localization of complex trait heritability. Nature genetics, 52(12):1355\u20131363, 2020. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC7710571/.\u00a0\u21a9</p> </li> <li> <p>Yuxin Zou, Peter Carbonetto, Gao Wang, and Matthew Stephens. Fine-mapping from summary data with the \u201csum of single effects\u201d model. PLoS genetics, 18(7):e1010299, 2022. URL: https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1010299.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/DecodeME/Fine_Mapping/SUSIE/b_Chr6_26M_27M_Locus/","title":"Chr6 26M-27M","text":""},{"location":"Analysis/DecodeME/Fine_Mapping/SUSIE/b_Chr6_26M_27M_Locus/#chr6-26m-27m","title":"Chr6 26M-27M","text":""},{"location":"Analysis/DecodeME/Fine_Mapping/SUSIE/b_Chr6_26M_27M_Locus/#methodology","title":"Methodology","text":"<p>In an attempt to narrow the DecodeME<sup>1</sup> GWAS-1 signal, I fine-mapped the first hit on chromosome 6 using SUSIE<sup>2</sup>. The parameters of my SUSIE runs were the same as for the chromosome 1 hit</p> <p>None of the SUSIE runs at this locus found any credible sets.  Given that this locus lies in the HLA region, which is notorious for its complex LD structure, this result is perhaps unsurprising.</p> <ol> <li> <p>Genetics Delivery Team, Thibaud Boutin, Andrew D Bretherick, Joshua J Dibble, Esther Ewaoluwagbemiga, Emma Northwood, Gemma L Samms, Veronique Vitart, Project, Cohort Delivery Team, \u00d8yvind Almelid, and others. Initial findings from the decodeme genome-wide association study of myalgic encephalomyelitis/chronic fatigue syndrome. medRxiv, pages 2025\u201308, 2025. URL: https://www.medrxiv.org/content/10.1101/2025.08.06.25333109v1.\u00a0\u21a9</p> </li> <li> <p>Gao Wang, Abhishek Sarkar, Peter Carbonetto, and Matthew Stephens. A simple new approach to variable selection in regression, with application to genetic fine mapping. Journal of the Royal Statistical Society Series B: Statistical Methodology, 82(5):1273\u20131300, 2020. URL: https://academic.oup.com/jrsssb/article/82/5/1273/7056114.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/DecodeME/Fine_Mapping/SUSIE/c_Chr6_97M_99M_Locus/","title":"Chr6 97.5M-99M","text":""},{"location":"Analysis/DecodeME/Fine_Mapping/SUSIE/c_Chr6_97M_99M_Locus/#chr6-975m-99m","title":"Chr6 97.5M-99M","text":""},{"location":"Analysis/DecodeME/Fine_Mapping/SUSIE/c_Chr6_97M_99M_Locus/#methodology","title":"Methodology","text":"<p>To narrow the DecodeME<sup>1</sup> GWAS-1 signal, I fine-mapped the second hit on chromosome 6 using SUSIE<sup>2</sup>. The parameters of my SUSIE runs were the same as for the chromosome 1 locus.</p>"},{"location":"Analysis/DecodeME/Fine_Mapping/SUSIE/c_Chr6_97M_99M_Locus/#results","title":"Results","text":"<p>The 4 SUSIE runs each produced a single credible set containing 98 variants.  These  credible sets were largely but not entirely overlapping:</p> <p></p> <p>The stacked plot for the \\(L=10\\) run:</p> <p></p> <p>And for the \\(L=2\\) run:</p> <p></p> <p>Overall, SUSIE returns a diffuse signal in a region rather far from genes, making the genetic mechanism of action non-obvious. </p> <p>The variants in the credibles set for the \\(L=10\\) and \\(L=2\\) runs are listed below:</p> Variant List (L=10) cs CHR POS EA NEA alpha mu PIP L1 6 98432302 CA C 0.0339333 -0.0209021 0.0340642 L1 6 98537993 A G 0.0319325 -0.0208545 0.0319893 L1 6 98537145 G A 0.0288642 -0.0207752 0.0289191 L1 6 98542303 C T 0.0256115 0.020681 0.0256655 L1 6 98535730 C G 0.0250234 -0.0206626 0.0250771 L1 6 98540357 A T 0.023551 0.0206146 0.0236042 L1 6 98431805 G A 0.0215665 -0.0205447 0.0216144 L1 6 98398914 C T 0.0204441 -0.0205022 0.0204915 L1 6 98394217 C G 0.0192989 -0.0204562 0.0193461 L1 6 98448725 A G 0.0192954 -0.0204561 0.0193439 L1 6 98436938 A G 0.0189514 -0.0204417 0.0189984 L1 6 98402387 C G 0.0189412 -0.0204412 0.0189882 L1 6 98444794 A C 0.0189194 -0.0204403 0.0189676 L1 6 98390677 G T 0.0182881 -0.0204132 0.018335 L1 6 98489654 T C 0.0173721 -0.020372 0.0175614 L1 6 98390463 A T 0.0174165 -0.0203741 0.017463 L1 6 98400834 T C 0.0172352 -0.0203657 0.0172816 L1 6 98390699 G C 0.0172085 -0.0203644 0.0172555 L1 6 98403406 T C 0.0168904 -0.0203494 0.0169366 L1 6 98388730 T C 0.0165388 -0.0203325 0.016585 L1 6 98448405 A C 0.0160753 -0.0203097 0.0161225 L1 6 98392312 C T 0.0155774 -0.0202844 0.0156232 L1 6 98437655 A AC 0.0145205 -0.0202277 0.0145671 L1 6 98434438 T C 0.0143232 -0.0202166 0.0143697 L1 6 98419613 T C 0.0139924 -0.0201978 0.0140375 L1 6 98412564 C T 0.0137653 -0.0201845 0.0138103 L1 6 98436333 T A 0.0135699 -0.0201729 0.013616 L1 6 98366735 G A 0.0123164 -0.0200943 0.0125522 L1 6 98416456 T C 0.0118428 -0.0200624 0.0118877 L1 6 98450190 A T 0.0118003 0.0200594 0.0118451 L1 6 98416458 T C 0.011667 -0.0200502 0.0117119 L1 6 98392511 T TTA 0.01063 -0.0199742 0.0106739 L1 6 98416821 C A 0.0102941 -0.0199479 0.0103376 L1 6 98417147 T A 0.00984921 -0.0199117 0.00989241 L1 6 98438566 T A 0.0088468 -0.0198234 0.00891711 L1 6 98433708 C A 0.00877593 -0.0198168 0.00884611 L1 6 98413299 T C 0.00854076 -0.0197944 0.00858394 L1 6 98439152 A T 0.0085006 -0.0197905 0.00857027 L1 6 98426502 G A 0.00838434 -0.0197791 0.00842742 L1 6 98437775 C T 0.00821572 -0.0197623 0.00828487 L1 6 98445008 A C 0.00811219 -0.0197518 0.00818105 L1 6 98431600 T C 0.00807156 -0.0197477 0.00814043 L1 6 98509711 A G 0.00785555 -0.0197252 0.00792232 L1 6 98403022 T C 0.00713891 -0.0196458 0.00720467 L1 6 98401847 C T 0.00642492 -0.019558 0.00649023 L1 6 98395421 A C 0.00640626 -0.0195556 0.00647165 L1 6 98398945 G A 0.00638722 -0.0195531 0.00645239 L1 6 98396176 A G 0.00626519 -0.019537 0.00633014 L1 6 98399604 C T 0.0062293 -0.0195322 0.00629421 L1 6 98398832 T C 0.00622043 -0.019531 0.00628523 L1 6 98401483 C A 0.00616394 -0.0195233 0.00622867 L1 6 98405151 A T 0.00613886 -0.0195199 0.0062035 L1 6 98396351 G A 0.00613873 -0.0195199 0.0062034 L1 6 98399612 A T 0.00612351 -0.0195178 0.00618817 L1 6 98415905 T C 0.00609124 -0.0195134 0.00615491 L1 6 98399407 T C 0.00605283 -0.0195081 0.00611723 L1 6 98405214 G C 0.00604532 -0.0195071 0.00610974 L1 6 98406939 A G 0.0060202 -0.0195036 0.00608459 L1 6 98401808 C T 0.00597186 -0.0194968 0.00603611 L1 6 98398843 A AT 0.00586082 -0.0194811 0.00592683 L1 6 98403903 C T 0.00584561 -0.0194789 0.00590957 L1 6 98402211 T G 0.00575721 -0.0194661 0.00582099 L1 6 98405337 G C 0.00567947 -0.0194547 0.00574303 L1 6 98406850 C T 0.0055801 -0.0194399 0.00564347 L1 6 98402394 C A 0.0055769 -0.0194394 0.00564045 L1 6 98402438 C T 0.00556739 -0.019438 0.00563084 L1 6 98397820 T C 0.00548189 -0.0194249 0.00554499 L1 6 98404174 C T 0.00546584 -0.0194225 0.00552887 L1 6 98404346 C T 0.00539529 -0.0194115 0.00545816 L1 6 98418637 C T 0.00534217 -0.0194032 0.00540408 L1 6 98546394 C T 0.00528216 0.0193937 0.0053302 L1 6 98423208 A G 0.00525697 -0.0193897 0.00531947 L1 6 98416581 C A 0.00494431 -0.0193379 0.00500522 L1 6 98415577 G T 0.00492045 -0.0193338 0.00498232 L1 6 98419195 G A 0.00463716 -0.0192837 0.00469802 L1 6 98410756 A G 0.00462844 -0.0192821 0.00468929 L1 6 98517804 T G 0.00442417 -0.0192438 0.00446464 L1 6 98522102 A C 0.00441152 -0.0192414 0.00445198 L1 6 98456578 C T 0.00432927 0.0192254 0.00436958 L1 6 98476651 G T 0.00432493 0.0192245 0.00436525 L1 6 98518138 C CCAGGTACTGAAAATAGTACCCA 0.00425748 -0.0192112 0.00429785 L1 6 98517272 A G 0.00418293 -0.0191961 0.00422317 L1 6 98510530 T G 0.00397918 -0.0191536 0.00401923 L1 6 98511568 T C 0.0039301 -0.019143 0.00397007 L1 6 98512865 T C 0.00392975 -0.0191429 0.00396971 L1 6 98502762 A G 0.00391319 -0.0191393 0.00395313 L1 6 98453465 C T 0.00382927 -0.0191208 0.0038691 L1 6 98500715 G A 0.0036407 -0.0190776 0.00368034 L1 6 98486851 G A 0.00351126 -0.0190466 0.00355074 L1 6 98473185 A G 0.00348687 0.0190406 0.00352693 L1 6 98449707 A G 0.00323224 0.0189754 0.00327213 L1 6 98473269 A C 0.00317038 0.0189588 0.00321004 L1 6 98488771 G A 0.00308858 -0.0189362 0.00312758 L1 6 98460173 C G 0.00268056 0.0188136 0.00271956 L1 6 98449775 T TATA 0.0024706 0.0187426 0.00252651 L1 6 98494482 T C 0.0022754 -0.0186707 0.00231381 L1 6 98493740 T A 0.00216464 -0.018627 0.00220288 L1 6 98493210 G T 0.00198909 0.0185527 0.00202701 Variant List (L=2) cs CHR POS EA NEA alpha mu PIP L1 6 98432302 CA C 0.0530686 -0.0216425 0.0530686 L1 6 98537993 A G 0.0248035 -0.0210597 0.0248035 L1 6 98537145 G A 0.0225441 -0.0209853 0.0225441 L1 6 98542303 C T 0.0200106 0.0208922 0.0200106 L1 6 98535730 C G 0.0195324 -0.0208732 0.0195324 L1 6 98540357 A T 0.018354 0.0208244 0.018354 L1 6 98431805 G A 0.0153678 -0.0206844 0.0153678 L1 6 98438566 T A 0.0153503 -0.0206835 0.0153503 L1 6 98433708 C A 0.015218 -0.0206766 0.015218 L1 6 98448725 A G 0.0148343 -0.0206564 0.0148343 L1 6 98439152 A T 0.0147238 -0.0206505 0.0147238 L1 6 98489654 T C 0.0145216 -0.0206395 0.0145216 L1 6 98444794 A C 0.0144206 -0.020634 0.0144206 L1 6 98437775 C T 0.0142095 -0.0206223 0.0142095 L1 6 98445008 A C 0.0140166 -0.0206114 0.0140166 L1 6 98398914 C T 0.0140092 -0.020611 0.0140092 L1 6 98431600 T C 0.0139488 -0.0206076 0.0139488 L1 6 98366735 G A 0.0136979 -0.0205932 0.0136979 L1 6 98436938 A G 0.0134924 -0.0205812 0.0134924 L1 6 98394217 C G 0.0131815 -0.0205626 0.0131815 L1 6 98402387 C G 0.0131362 -0.0205599 0.0131362 L1 6 98390677 G T 0.0125465 -0.0205233 0.0125465 L1 6 98448405 A C 0.012271 -0.0205056 0.012271 L1 6 98400834 T C 0.0119244 -0.0204827 0.0119244 L1 6 98390463 A T 0.0119153 -0.0204821 0.0119153 L1 6 98390699 G C 0.0118728 -0.0204792 0.0118728 L1 6 98403406 T C 0.0116734 -0.0204657 0.0116734 L1 6 98388730 T C 0.0113775 -0.0204452 0.0113775 L1 6 98403022 T C 0.0111777 -0.020431 0.0111777 L1 6 98437655 A AC 0.0110013 -0.0204182 0.0110013 L1 6 98434438 T C 0.0108849 -0.0204097 0.0108849 L1 6 98395421 A C 0.0107332 -0.0203985 0.0107332 L1 6 98392312 C T 0.0107145 -0.0203971 0.0107145 L1 6 98398945 G A 0.0107091 -0.0203967 0.0107091 L1 6 98401847 C T 0.0107059 -0.0203964 0.0107059 L1 6 98396176 A G 0.0104524 -0.0203772 0.0104524 L1 6 98399604 C T 0.0104453 -0.0203766 0.0104453 L1 6 98398832 T C 0.0104157 -0.0203744 0.0104157 L1 6 98436333 T A 0.0103084 -0.0203661 0.0103084 L1 6 98401483 C A 0.0102638 -0.0203626 0.0102638 L1 6 98399612 A T 0.0102595 -0.0203622 0.0102595 L1 6 98398843 A AT 0.0102333 -0.0203602 0.0102333 L1 6 98405151 A T 0.0102319 -0.0203601 0.0102319 L1 6 98396351 G A 0.0102315 -0.02036 0.0102315 L1 6 98399407 T C 0.0101212 -0.0203513 0.0101212 L1 6 98405214 G C 0.0100688 -0.0203471 0.0100688 L1 6 98406939 A G 0.00999626 -0.0203413 0.00999626 L1 6 98401808 C T 0.00992673 -0.0203357 0.00992673 L1 6 98403903 C T 0.00971935 -0.0203187 0.00971935 L1 6 98419613 T C 0.00967755 -0.0203153 0.00967755 L1 6 98402211 T G 0.00956356 -0.0203057 0.00956356 L1 6 98412564 C T 0.00952048 -0.0203021 0.00952048 L1 6 98415905 T C 0.0094534 -0.0202964 0.0094534 L1 6 98405337 G C 0.00943448 -0.0202948 0.00943448 L1 6 98402394 C A 0.0092682 -0.0202804 0.0092682 L1 6 98402438 C T 0.00925004 -0.0202788 0.00925004 L1 6 98406850 C T 0.00924196 -0.0202781 0.00924196 L1 6 98397820 T C 0.00909291 -0.020265 0.00909291 L1 6 98404174 C T 0.00906227 -0.0202623 0.00906227 L1 6 98404346 C T 0.00894255 -0.0202515 0.00894255 L1 6 98509711 A G 0.00880315 -0.0202388 0.00880315 L1 6 98423208 A G 0.00866468 -0.020226 0.00866468 L1 6 98418637 C T 0.00823035 -0.0201844 0.00823035 L1 6 98450190 A T 0.00821631 0.020183 0.00821631 L1 6 98416456 T C 0.00812601 -0.020174 0.00812601 L1 6 98415577 G T 0.00808103 -0.0201695 0.00808103 L1 6 98416458 T C 0.00801795 -0.0201632 0.00801795 L1 6 98416581 C A 0.007608 -0.0201205 0.007608 L1 6 98410756 A G 0.00760571 -0.0201203 0.00760571 L1 6 98419195 G A 0.00760371 -0.0201201 0.00760371 L1 6 98416821 C A 0.00731378 -0.0200884 0.00731378 L1 6 98392511 T TTA 0.0072496 -0.0200812 0.0072496 L1 6 98417147 T A 0.00696736 -0.0200489 0.00696736 L1 6 98413299 T C 0.00627609 -0.0199634 0.00627609 L1 6 98426502 G A 0.00616976 -0.0199494 0.00616976 L1 6 98546394 C T 0.00400535 0.0195919 0.00400535 L1 6 98449775 T TATA 0.00368099 0.0195212 0.00368099 L1 6 98517804 T G 0.0028382 -0.019302 0.0028382 L1 6 98522102 A C 0.00282682 -0.0192986 0.00282682 L1 6 98456578 C T 0.00277843 0.019284 0.00277843 L1 6 98476651 G T 0.0027743 0.0192827 0.0027743 L1 6 98452818 CAGTT C 0.00276262 0.0192791 0.00276262 L1 6 98518138 C CCAGGTACTGAAAATAGTACCCA 0.00273086 -0.0192693 0.00273086 L1 6 98517272 A G 0.00267551 -0.0192519 0.00267551 L1 6 98510530 T G 0.00252295 -0.019202 0.00252295 L1 6 98512865 T C 0.00251899 -0.0192006 0.00251899 L1 6 98511568 T C 0.00251038 -0.0191977 0.00251038 L1 6 98502762 A G 0.00250904 -0.0191973 0.00250904 L1 6 98453465 C T 0.0024599 -0.0191804 0.0024599 L1 6 98473185 A G 0.0023793 0.0191519 0.0023793 L1 6 98475160 G A 0.00233744 0.0191368 0.00233744 L1 6 98500715 G A 0.00233372 -0.0191354 0.00233372 L1 6 98457356 A G 0.00227927 0.0191152 0.00227927 L1 6 98486851 G A 0.00224524 -0.0191023 0.00224524 L1 6 98449707 A G 0.00222201 0.0190934 0.00222201 L1 6 98481755 T C 0.00220151 0.0190855 0.00220151 L1 6 98473269 A C 0.00216228 0.0190701 0.00216228 L1 6 98456948 C T 0.00213903 0.0190608 0.00213903 <ol> <li> <p>Genetics Delivery Team, Thibaud Boutin, Andrew D Bretherick, Joshua J Dibble, Esther Ewaoluwagbemiga, Emma Northwood, Gemma L Samms, Veronique Vitart, Project, Cohort Delivery Team, \u00d8yvind Almelid, and others. Initial findings from the decodeme genome-wide association study of myalgic encephalomyelitis/chronic fatigue syndrome. medRxiv, pages 2025\u201308, 2025. URL: https://www.medrxiv.org/content/10.1101/2025.08.06.25333109v1.\u00a0\u21a9</p> </li> <li> <p>Gao Wang, Abhishek Sarkar, Peter Carbonetto, and Matthew Stephens. A simple new approach to variable selection in regression, with application to genetic fine mapping. Journal of the Royal Statistical Society Series B: Statistical Methodology, 82(5):1273\u20131300, 2020. URL: https://academic.oup.com/jrsssb/article/82/5/1273/7056114.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/DecodeME/Fine_Mapping/SUSIE/d_Chr15_54M_55M_Locus/","title":"Chr15 54.5M-55.5M","text":""},{"location":"Analysis/DecodeME/Fine_Mapping/SUSIE/d_Chr15_54M_55M_Locus/#chr15-545m-555m","title":"Chr15 54.5M-55.5M","text":""},{"location":"Analysis/DecodeME/Fine_Mapping/SUSIE/d_Chr15_54M_55M_Locus/#methodology","title":"Methodology","text":"<p>To narrow the DecodeME<sup>1</sup> GWAS-1 signal, I fine-mapped the hit on chromosome 15 using SUSIE<sup>2</sup>. The parameters of my SUSIE runs were the same as for the chromosome 1 locus.</p>"},{"location":"Analysis/DecodeME/Fine_Mapping/SUSIE/d_Chr15_54M_55M_Locus/#results","title":"Results","text":"<p>Each of the 4 SUSIE runs produced a single credible set containing identical variants, as illustrated by the following UpSet plot:</p> <p></p> <p>Here is a plot of the SUSIE results for the \\(L=10\\) case.  It is representative of the other runs.</p> <p></p> <p>Compare to the other loci, the SUSIE credible set at this locus is relatively concentrated on a single variant: a G \\(\\to\\) A substitution at GRCh37 position 55158922 on chromosome 15.</p> <p>The detailed results for the \\(L=10\\) run are below.</p> Variant List (L=10) cs CHR POS EA NEA alpha mu PIP L1 15 55158922 G A 0.194239 0.022945 0.194239 L1 15 55156405 G T 0.0154931 0.0210618 0.0154931 L1 15 55156404 C T 0.0135511 0.0209574 0.0135511 L1 15 55159801 G A 0.00887744 -0.020624 0.00887744 L1 15 55159342 C T 0.00869299 0.0206073 0.00869299 L1 15 55159715 A G 0.00865026 0.0206034 0.00865026 L1 15 55160462 T C 0.00863258 -0.0206018 0.00863258 L1 15 55155938 AT A 0.00843442 -0.0205833 0.00843442 L1 15 55159757 G A 0.00842407 0.0205823 0.00842407 L1 15 55159554 A G 0.00833134 0.0205735 0.00833134 L1 15 55159908 G C 0.00817564 0.0205585 0.00817564 L1 15 55159130 T G 0.00777701 0.0205186 0.00777701 L1 15 55160802 G A 0.00777479 0.0205184 0.00777479 L1 15 55159862 C A 0.00776098 0.0205169 0.00776098 L1 15 55151145 G A 0.00763584 0.020504 0.00763584 L1 15 55160634 G C 0.00750143 -0.0204898 0.00750143 L1 15 55150810 T A 0.00749837 0.0204894 0.00749837 L1 15 55160787 G A 0.00747256 0.0204867 0.00747256 L1 15 55162470 A T 0.00741571 0.0204806 0.00741571 L1 15 55150181 A G 0.00739617 -0.0204785 0.00739617 L1 15 55158509 G C 0.00729678 0.0204676 0.00729678 L1 15 55160980 G A 0.00719136 0.020456 0.00719136 L1 15 55154962 C A 0.00714397 0.0204507 0.00714397 L1 15 55152971 A C 0.00713734 0.0204499 0.00713734 L1 15 55156363 T C 0.00703595 0.0204385 0.00703595 L1 15 55150505 G C 0.00699785 -0.0204341 0.00699785 L1 15 55154631 C CA 0.0069904 -0.0204333 0.0069904 L1 15 55150921 T A 0.00688969 0.0204216 0.00688969 L1 15 55150420 T C 0.00688722 -0.0204213 0.00688722 L1 15 55158137 A G 0.00686915 0.0204192 0.00686915 L1 15 55160781 C T 0.00683767 0.0204155 0.00683767 L1 15 55161542 G A 0.00681783 0.0204132 0.00681783 L1 15 55150740 A AG 0.00675653 -0.020406 0.00675653 L1 15 55150236 C T 0.00673402 -0.0204033 0.00673402 L1 15 55150220 G A 0.00673402 -0.0204033 0.00673402 L1 15 55155773 T A 0.00672354 -0.020402 0.00672354 L1 15 55150483 T A 0.00671521 -0.020401 0.00671521 L1 15 55150469 T C 0.00671521 -0.020401 0.00671521 L1 15 55150258 C T 0.00667991 -0.0203968 0.00667991 L1 15 55156322 G C 0.00667471 0.0203962 0.00667471 L1 15 55150596 G A 0.00660857 -0.0203882 0.00660857 L1 15 55149993 T C 0.00657418 -0.020384 0.00657418 L1 15 55150322 A C 0.00656919 0.0203834 0.00656919 L1 15 55157158 C T 0.00656767 0.0203832 0.00656767 L1 15 55141309 A G 0.00648876 -0.0203735 0.00648876 L1 15 55155165 T C 0.00641002 -0.0203636 0.00641002 L1 15 55155416 G A 0.00639977 -0.0203623 0.00639977 L1 15 55156382 T TTTGA 0.00639849 0.0203622 0.00639849 L1 15 55155884 G A 0.0063085 -0.0203508 0.0063085 L1 15 55154548 T C 0.00630743 -0.0203506 0.00630743 L1 15 55163453 A T 0.00630585 0.0203504 0.00630585 L1 15 55163164 A G 0.00623856 0.0203418 0.00623856 L1 15 55153845 A T 0.00621276 -0.0203385 0.00621276 L1 15 55140913 C T 0.00620837 0.0203379 0.00620837 L1 15 55156259 T C 0.00620357 0.0203373 0.00620357 L1 15 55153804 A G 0.00615213 -0.0203306 0.00615213 L1 15 55142936 G A 0.00614562 -0.0203297 0.00614562 L1 15 55155311 A G 0.00613643 -0.0203285 0.00613643 L1 15 55154217 A G 0.00612682 -0.0203272 0.00612682 L1 15 55158666 C G 0.00612348 0.0203268 0.00612348 L1 15 55153408 T C 0.00610903 0.0203249 0.00610903 L1 15 55152773 A G 0.00604668 -0.0203166 0.00604668 L1 15 55142784 T C 0.00600083 -0.0203105 0.00600083 L1 15 55153652 G A 0.00599989 0.0203104 0.00599989 L1 15 55141109 C G 0.00594218 0.0203026 0.00594218 L1 15 55155203 C T 0.00590906 0.020298 0.00590906 L1 15 55155588 G A 0.00585259 -0.0202903 0.00585259 L1 15 55155488 G A 0.00584117 0.0202887 0.00584117 L1 15 55155705 A G 0.00578881 -0.0202814 0.00578881 L1 15 55141411 G C 0.00572153 -0.020272 0.00572153 L1 15 55155621 C A 0.00566069 -0.0202633 0.00566069 L1 15 55142751 C A 0.00561426 -0.0202567 0.00561426 L1 15 55164204 T C 0.00557786 0.0202514 0.00557786 L1 15 55179674 T A 0.00552171 0.0202432 0.00552171 L1 15 55142885 T A 0.00539448 -0.0202244 0.00539448 L1 15 55157598 C A 0.00530939 0.0202115 0.00530939 L1 15 55139964 G A 0.00524553 -0.0202017 0.00524553 L1 15 55139771 C CA 0.0050837 -0.0201762 0.0050837 L1 15 55142175 T C 0.00505264 -0.0201712 0.00505264 L1 15 55142417 C CA 0.00504953 -0.0201707 0.00504953 L1 15 55161311 A G 0.00488197 0.0201433 0.00488197 L1 15 55139544 A C 0.00488022 -0.020143 0.00488022 L1 15 55142359 T C 0.00487064 -0.0201414 0.00487064 L1 15 55142285 G A 0.00484012 -0.0201363 0.00484012 L1 15 55169774 A T 0.00479019 0.0201279 0.00479019 L1 15 55139224 A G 0.00471216 -0.0201145 0.00471216 L1 15 55139290 C G 0.00470535 -0.0201133 0.00470535 L1 15 55152652 A G 0.00461872 0.0200982 0.00461872 L1 15 55139155 G A 0.00451411 -0.0200795 0.00451411 L1 15 55163547 A G 0.00450927 -0.0200786 0.00450927 L1 15 55170143 T C 0.00450508 -0.0200778 0.00450508 L1 15 55140017 G A 0.0044235 -0.0200629 0.0044235 L1 15 55165540 T C 0.00427123 -0.0200343 0.00427123 L1 15 55139377 T A 0.00425802 -0.0200318 0.00425802 L1 15 55170256 A G 0.00425796 -0.0200317 0.00425796 L1 15 55184544 G A 0.00424669 0.0200296 0.00424669 L1 15 55139200 G C 0.00422039 -0.0200245 0.00422039 L1 15 55139422 G A 0.00421633 -0.0200237 0.00421633 L1 15 55139887 T C 0.00391255 -0.0199624 0.00391255 L1 15 55170268 C T 0.00390411 0.0199607 0.00390411 L1 15 55165718 C G 0.00374692 -0.0199269 0.00374692 L1 15 55167006 C T 0.00361574 0.0198976 0.00361574 L1 15 55171011 C T 0.00358585 0.0198907 0.00358585 L1 15 55165263 G C 0.00352309 0.0198762 0.00352309 L1 15 55165574 A C 0.00346833 -0.0198632 0.00346833 L1 15 55177426 A G 0.00311969 0.0197757 0.00311969 L1 15 55144960 T C 0.00275204 -0.0196715 0.00275204 L1 15 55150442 C T 0.00270635 -0.0196575 0.00270635 L1 15 55144812 C T 0.00266382 -0.0196443 0.00266382 L1 15 55146363 A C 0.00266234 -0.0196439 0.00266234 L1 15 55146375 T A 0.00266234 -0.0196439 0.00266234 L1 15 55148502 C A 0.00257041 -0.0196145 0.00257041 L1 15 55144024 T C 0.00255165 -0.0196084 0.00255165 L1 15 55149334 C G 0.00251331 -0.0195957 0.00251331 L1 15 55148611 A G 0.00248078 -0.0195849 0.00248078 L1 15 55146427 T C 0.00246719 0.0195803 0.00246719 L1 15 55146437 C T 0.00246719 0.0195803 0.00246719 L1 15 55146428 A AT 0.00246719 0.0195803 0.00246719 L1 15 55146430 C G 0.00246719 0.0195803 0.00246719 L1 15 55146419 A G 0.00246711 0.0195802 0.00246711 L1 15 55146422 A G 0.00246711 0.0195802 0.00246711 L1 15 55149475 A G 0.00246539 -0.0195796 0.00246539 L1 15 55144410 A T 0.00246278 -0.0195788 0.00246278 L1 15 55148803 G A 0.00244612 -0.0195731 0.00244612 L1 15 55156790 A C 0.0024296 0.0195674 0.0024296 L1 15 55149391 C T 0.00241855 -0.0195636 0.00241855 L1 15 55146402 T A 0.00241219 -0.0195614 0.00241219 L1 15 55143693 C T 0.00240553 -0.0195591 0.00240553 L1 15 55147758 G A 0.00239269 -0.0195546 0.00239269 L1 15 55148142 A C 0.00236545 -0.019545 0.00236545 L1 15 55144342 A G 0.00236339 -0.0195443 0.00236339 L1 15 55149415 C T 0.00235917 -0.0195428 0.00235917 L1 15 55144927 A G 0.00235142 -0.01954 0.00235142 L1 15 55148017 C T 0.00234663 -0.0195383 0.00234663 L1 15 55145552 C CA 0.00234551 -0.0195379 0.00234551 L1 15 55148332 G A 0.00232851 -0.0195318 0.00232851 L1 15 55149268 G C 0.00231774 -0.0195279 0.00231774 L1 15 55143433 G A 0.00231069 -0.0195253 0.00231069 L1 15 55146202 A G 0.0023089 -0.0195247 0.0023089 L1 15 55144589 C T 0.00230817 -0.0195244 0.00230817 L1 15 55144447 A T 0.00230358 -0.0195227 0.00230358 L1 15 55143681 C T 0.00226321 -0.0195079 0.00226321 L1 15 55143755 T C 0.00225717 -0.0195057 0.00225717 L1 15 55143666 G A 0.00225665 -0.0195055 0.00225665 L1 15 55142858 A C 0.00224818 -0.0195023 0.00224818 L1 15 55144666 G A 0.00224718 -0.0195019 0.00224718 L1 15 55149211 T C 0.00223003 -0.0194955 0.00223003 L1 15 55144181 G C 0.00222661 -0.0194942 0.00222661 L1 15 55143399 C G 0.00221813 -0.019491 0.00221813 <ol> <li> <p>Genetics Delivery Team, Thibaud Boutin, Andrew D Bretherick, Joshua J Dibble, Esther Ewaoluwagbemiga, Emma Northwood, Gemma L Samms, Veronique Vitart, Project, Cohort Delivery Team, \u00d8yvind Almelid, and others. Initial findings from the decodeme genome-wide association study of myalgic encephalomyelitis/chronic fatigue syndrome. medRxiv, pages 2025\u201308, 2025. URL: https://www.medrxiv.org/content/10.1101/2025.08.06.25333109v1.\u00a0\u21a9</p> </li> <li> <p>Gao Wang, Abhishek Sarkar, Peter Carbonetto, and Matthew Stephens. A simple new approach to variable selection in regression, with application to genetic fine mapping. Journal of the Royal Statistical Society Series B: Statistical Methodology, 82(5):1273\u20131300, 2020. URL: https://academic.oup.com/jrsssb/article/82/5/1273/7056114.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/DecodeME/Fine_Mapping/SUSIE/e_Chr17_50M_51M_Locus/","title":"Chr17 50M-51M","text":""},{"location":"Analysis/DecodeME/Fine_Mapping/SUSIE/e_Chr17_50M_51M_Locus/#chr17-50m-51m","title":"Chr17 50M-51M","text":""},{"location":"Analysis/DecodeME/Fine_Mapping/SUSIE/e_Chr17_50M_51M_Locus/#methodology","title":"Methodology","text":"<p>To narrow down the DecodeME<sup>1</sup> GWAS-1 signal, I fine-mapped the GWAS-1 hit on chromosome 17 using SUSIE<sup>2</sup>. The parameters of my SUSIE runs were the same as for the chromosome 1 locus.</p>"},{"location":"Analysis/DecodeME/Fine_Mapping/SUSIE/e_Chr17_50M_51M_Locus/#results","title":"Results","text":"<p>Each of the 4 SUSIE runs produced a single credible set with the same 63 variants, as illustrated by the UpSet plot below:</p> <p></p> <p>The distribution of probability mass across these variants was slightly different across the runs, as illustrated by the following UpSet plot, which is restricted to variants of \\(PIP&gt;0.01\\).</p> <p></p> <p>The stackplot below, for the \\(L=10\\) case, illustrates the typical PIP pattern across variants.</p> <p></p> <p>The credible set at this locus is focused upstream of the CA10 gene.  This would seem to make a CA10 a good candidate for further investigation.  </p> <p>The detailed variants results are below:</p> Variant List (L=10) cs CHR POS EA NEA alpha mu PIP L1 17 50260366 T C 0.055044 0.023495 0.055161 L1 17 50282834 T C 0.0412133 0.0232911 0.0413269 L1 17 50287448 A C 0.03704 0.0232154 0.0371532 L1 17 50279497 T C 0.0357889 0.023191 0.035902 L1 17 50276929 G C 0.0353752 0.0231828 0.0354882 L1 17 50294376 T C 0.0347934 0.023171 0.0349065 L1 17 50289205 T G 0.0338718 0.0231519 0.0339847 L1 17 50290356 G A 0.0326279 0.0231252 0.0327407 L1 17 50285434 A G 0.0322195 0.0231162 0.0323321 L1 17 50295022 A G 0.032076 0.0231131 0.0321887 L1 17 50272817 TA T 0.0318892 0.0231089 0.0320022 L1 17 50271517 A G 0.0315094 0.0231003 0.031622 L1 17 50270268 T C 0.0296969 0.023058 0.0298095 L1 17 50294496 G A 0.0295546 0.0230546 0.0296669 L1 17 50271048 A G 0.029051 0.0230423 0.0291633 L1 17 50271674 A G 0.0277654 0.0230099 0.0278775 L1 17 50274393 A G 0.0272457 0.0229964 0.0273578 L1 17 50261933 CA C 0.0224699 0.0228578 0.0225895 L1 17 50298441 A C 0.0164279 0.0226309 0.0165402 L1 17 50285721 CT C 0.0154185 0.0225847 0.0155312 L1 17 50297907 G A 0.0143061 0.02253 0.0144173 L1 17 50288321 T G 0.0133761 0.0224807 0.0134877 L1 17 50294365 G C 0.0129315 0.0224559 0.013043 L1 17 50291040 T C 0.0113472 0.0223598 0.0114599 L1 17 50293499 C T 0.011319 0.022358 0.0114317 L1 17 50290955 T C 0.0108259 0.0223251 0.0109383 L1 17 50299063 G A 0.0106136 0.0223105 0.0107243 L1 17 50296779 C A 0.0100429 0.0222696 0.010153 L1 17 50317099 G T 0.00958189 0.0222348 0.00969233 L1 17 50299079 A G 0.00905355 0.0221928 0.00916326 L1 17 50316842 G A 0.00902542 0.0221904 0.00913553 L1 17 50316120 G C 0.00869143 0.0221624 0.00880133 L1 17 50314751 A G 0.00863265 0.0221574 0.00874245 L1 17 50314078 T C 0.00860537 0.022155 0.00871515 L1 17 50316095 C T 0.00857642 0.0221525 0.00868625 L1 17 50315044 T C 0.00834915 0.0221325 0.0084588 L1 17 50301060 G A 0.00734718 0.0220371 0.00745657 L1 17 50314350 T C 0.00724198 0.0220263 0.00735097 L1 17 50303770 G A 0.00693928 0.0219944 0.00704804 L1 17 50298413 C T 0.00676585 0.0219754 0.00687585 L1 17 50313611 G C 0.00673919 0.0219724 0.00684788 L1 17 50309650 G A 0.00665405 0.0219629 0.00676269 L1 17 50299568 CT C 0.00665184 0.0219626 0.00676031 L1 17 50300195 G C 0.00659815 0.0219566 0.00670669 L1 17 50312430 G A 0.00653389 0.0219492 0.00664245 L1 17 50299809 C T 0.00640457 0.0219342 0.00651299 L1 17 50300935 A G 0.00639552 0.0219331 0.00650393 L1 17 50312701 T C 0.00636609 0.0219297 0.00647456 L1 17 50301112 G A 0.00625822 0.0219168 0.0063666 L1 17 50309626 T G 0.00624581 0.0219153 0.00635419 L1 17 50313435 C A 0.006139 0.0219024 0.00624731 L1 17 50311547 G C 0.00610706 0.0218984 0.00621535 L1 17 50309871 A C 0.00604867 0.0218912 0.00615692 L1 17 50300731 A G 0.00586534 0.021868 0.00597344 L1 17 50301115 T C 0.00566136 0.0218413 0.00576936 L1 17 50308625 G A 0.00536093 0.0218001 0.00546875 L1 17 50308600 G A 0.0053587 0.0217998 0.00546652 L1 17 50291181 A C 0.00402888 0.0215831 0.00413852 L1 17 50302285 G A 0.00369619 0.0215172 0.00380575 L1 17 50296459 T G 0.00315961 0.0213967 0.00326817 L1 17 50302857 T C 0.00315112 0.0213946 0.00325992 L1 17 50303110 G C 0.0030557 0.0213709 0.00316436 L1 17 50303521 T C 0.0030314 0.0213648 0.00314003 <ol> <li> <p>Genetics Delivery Team, Thibaud Boutin, Andrew D Bretherick, Joshua J Dibble, Esther Ewaoluwagbemiga, Emma Northwood, Gemma L Samms, Veronique Vitart, Project, Cohort Delivery Team, \u00d8yvind Almelid, and others. Initial findings from the decodeme genome-wide association study of myalgic encephalomyelitis/chronic fatigue syndrome. medRxiv, pages 2025\u201308, 2025. URL: https://www.medrxiv.org/content/10.1101/2025.08.06.25333109v1.\u00a0\u21a9</p> </li> <li> <p>Gao Wang, Abhishek Sarkar, Peter Carbonetto, and Matthew Stephens. A simple new approach to variable selection in regression, with application to genetic fine mapping. Journal of the Royal Statistical Society Series B: Statistical Methodology, 82(5):1273\u20131300, 2020. URL: https://academic.oup.com/jrsssb/article/82/5/1273/7056114.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/DecodeME/Fine_Mapping/SUSIE/f_Chr20_47M_48M_Locus/","title":"Chr20 47M-48.2M","text":""},{"location":"Analysis/DecodeME/Fine_Mapping/SUSIE/f_Chr20_47M_48M_Locus/#chr20-47m-482m","title":"Chr20 47M-48.2M","text":""},{"location":"Analysis/DecodeME/Fine_Mapping/SUSIE/f_Chr20_47M_48M_Locus/#methodology","title":"Methodology","text":"<p>To narrow the DecodeME<sup>1</sup> GWAS-1 signal, I fine-mapped the hit on chromosome 20 using SUSIE<sup>2</sup>. The parameters of my SUSIE runs were the same as for the chromosome 1 locus.</p>"},{"location":"Analysis/DecodeME/Fine_Mapping/SUSIE/f_Chr20_47M_48M_Locus/#results","title":"Results","text":"<p>At the chromosome 20 locus, the \\(L=10\\) SUSIE run returned two credible sets.  One of these credible sets is highly concentrated, consisting of a single \\(\\mathrm{PIP}=1.0\\) variant.  In contrast, the three other SUSIE runs return a single diffuse credible set.  Given that the concentrated credible set is absent from the SUSIE runs with regularization, I am inclined to discount it as an artifact, possibly resulting from a slight mismatch between the population used to generate the GWAS summary statistics and the population used to create the LD matrix.  It would be interesting to re-run SUSIE on this locus using individual-level data to confirm or refute this explanation.</p> <p>The UpSet plot for this locus reveals that the variants found by the \\(L=10\\) SUSIE run differ from those found by other runs. </p> <p></p> <p>The Stackplot and variant list for the \\(L=10\\) run shows the highly concentrated nature of one of the credible sets.</p> <p></p> Variant List (L=10) cs CHR POS EA NEA alpha mu PIP L2 20 47743125 A C 1 0.0465541 1 L3 20 47731228 C A 0.0942816 -0.058085 0.0942816 L3 20 47731158 C T 0.0277448 -0.0577275 0.0277448 L3 20 47779340 C T 0.0271773 -0.0577214 0.0271773 L3 20 47783770 TG T 0.0259644 -0.057708 0.0259644 L3 20 47792457 C A 0.0232865 -0.0576761 0.0232865 L3 20 47727079 A G 0.0228546 -0.0576706 0.0228546 L3 20 47789849 G C 0.0207733 -0.0576426 0.0207733 L3 20 47717405 C T 0.0205823 -0.0576399 0.0205823 L3 20 47721937 T TTTG 0.0201703 -0.0576339 0.0201703 L3 20 47687238 T TG 0.0179336 0.0575994 0.0179336 L3 20 47739415 T C 0.0175571 -0.0575932 0.0175571 L3 20 47750377 A C 0.0174729 -0.0575918 0.0174729 L3 20 47776919 T A 0.0159528 -0.057565 0.0159528 L3 20 47808070 A G 0.0156314 -0.057559 0.0156314 L3 20 47703810 A C 0.0156019 -0.0575585 0.0156019 L3 20 47770756 C A 0.0135108 -0.0575162 0.0135108 L3 20 47751708 A AAAG 0.0134858 -0.0575156 0.0134858 L3 20 47721385 A G 0.0127438 -0.057499 0.0127438 L3 20 47621372 A G 0.0123093 0.0574888 0.0123093 L3 20 47725607 G A 0.0118942 -0.0574787 0.0118942 L3 20 47762700 A G 0.0118404 -0.0574773 0.0118404 L3 20 47741556 T C 0.0118239 -0.0574769 0.0118239 L3 20 47720386 C G 0.0113099 -0.0574638 0.0113099 L3 20 47701339 G A 0.0112238 -0.0574616 0.0112238 L3 20 47692392 C T 0.0105991 0.0574447 0.0105991 L3 20 47815944 C T 0.0102166 -0.0574339 0.0102166 L3 20 47728829 G GCTTA 0.0101749 -0.0574327 0.0101749 L3 20 47727341 G A 0.00978623 -0.0574212 0.00978623 L3 20 47646210 C G 0.00951013 0.0574128 0.00951013 L3 20 47676281 A G 0.00926458 -0.057405 0.00926458 L3 20 47758549 T C 0.00924127 -0.0574043 0.00924127 L3 20 47695391 A G 0.00890339 -0.0573933 0.00890339 L3 20 47714214 C T 0.00874825 -0.0573881 0.00874825 L3 20 47690591 G T 0.00862875 0.0573841 0.00862875 L3 20 47819305 A G 0.00851096 -0.05738 0.00851096 L3 20 47792245 T C 0.0082753 -0.0573717 0.0082753 L3 20 47714370 C T 0.00811626 -0.057366 0.00811626 L3 20 47739814 T C 0.00810486 -0.0573656 0.00810486 L3 20 47820626 T G 0.00801292 -0.0573622 0.00801292 L3 20 47541600 A G 0.00785385 0.0573563 0.00785385 L3 20 47719810 A G 0.00774204 -0.0573521 0.00774204 L3 20 47719949 C T 0.00763449 -0.057348 0.00763449 L3 20 47663944 C G 0.00755216 0.0573448 0.00755216 L3 20 47718431 G C 0.00739525 -0.0573386 0.00739525 L3 20 47783095 C T 0.00734969 -0.0573367 0.00734969 L3 20 47718594 C T 0.00733531 -0.0573362 0.00733531 L3 20 47726129 C T 0.00731401 -0.0573353 0.00731401 L3 20 47663382 G A 0.00718852 0.0573302 0.00718852 L3 20 47713063 T C 0.00715927 -0.057329 0.00715927 L3 20 47720957 C T 0.00686221 -0.0573165 0.00686221 L3 20 47820667 A T 0.00669051 -0.057309 0.00669051 L3 20 47710558 A ACAG 0.00659105 -0.0573046 0.00659105 L3 20 47769837 AT A 0.00655973 -0.0573032 0.00655973 L3 20 47769838 G C 0.00655973 -0.0573032 0.00655973 L3 20 47692827 C T 0.00644522 0.057298 0.00644522 L3 20 47721723 CAGG C 0.00633593 -0.0572929 0.00633593 L3 20 47690139 C T 0.00630622 0.0572915 0.00630622 L3 20 47714291 G A 0.00620647 -0.0572868 0.00620647 L3 20 47782356 C CCT 0.00616044 -0.0572846 0.00616044 L3 20 47721759 C T 0.00582328 -0.057268 0.00582328 L3 20 47635715 A G 0.00578918 0.0572663 0.00578918 L3 20 47554392 G A 0.00569192 0.0572613 0.00569192 L3 20 47737958 C A 0.00560748 -0.0572568 0.00560748 L3 20 47739193 A G 0.00558553 -0.0572557 0.00558553 L3 20 47667056 T C 0.00557469 -0.0572551 0.00557469 L3 20 47749296 C CCAAAA 0.00535179 -0.057243 0.00535179 L3 20 47774166 G A 0.00525087 -0.0572374 0.00525087 L3 20 47724325 G C 0.00505351 -0.0572261 0.00505351 L3 20 47771274 A G 0.00495579 -0.0572203 0.00495579 L3 20 47645427 T G 0.00488911 0.0572163 0.00488911 L3 20 47690189 A G 0.00473993 0.0572071 0.00473993 L3 20 47798664 C T 0.00468602 -0.0572037 0.00468602 L3 20 47795784 C CA 0.0045752 -0.0571967 0.0045752 L3 20 47653364 CTTTG C 0.00454497 0.0571947 0.00454497 L3 20 47543604 A G 0.00448422 0.0571907 0.00448422 L3 20 47549979 T TA 0.00446201 0.0571893 0.00446201 L3 20 47678770 G A 0.00429819 0.0571782 0.00429819 L3 20 47725800 C CTG 0.00426857 -0.0571761 0.00426857 L3 20 47675525 A G 0.00423721 -0.057174 0.00423721 L3 20 47753019 T C 0.00423611 -0.0571739 0.00423611 L3 20 47760000 C T 0.00416406 -0.0571688 0.00416406 L3 20 47677017 GA G 0.00409319 -0.0571637 0.00409319 L3 20 47748375 A G 0.0039907 -0.0571562 0.0039907 L3 20 47673230 GTTT G 0.00388325 0.0571481 0.00388325 L3 20 47755742 T C 0.00384134 -0.0571449 0.00384134 L3 20 47766197 C T 0.00383843 -0.0571447 0.00383843 L3 20 47797653 A G 0.00380894 -0.0571424 0.00380894 L3 20 47755075 A G 0.00372042 -0.0571354 0.00372042 L3 20 47662823 G T 0.00368736 0.0571328 0.00368736 L3 20 47766929 T C 0.00363455 -0.0571285 0.00363455 L3 20 47774343 A G 0.00359647 -0.0571254 0.00359647 L3 20 47757963 T C 0.00342714 -0.0571111 0.00342714 L3 20 47763558 A C 0.00340866 -0.0571095 0.00340866 L3 20 47746627 AATAG A 0.00340309 -0.057109 0.00340309 L3 20 47818567 T C 0.00337018 -0.0571062 0.00337018 L3 20 47758719 A G 0.00335916 -0.0571052 0.00335916 L3 20 47640466 G C 0.00331296 0.0571011 0.00331296 L3 20 47769157 A G 0.00322367 -0.057093 0.00322367 L3 20 47647068 A G 0.00310123 0.0570815 0.00310123 L3 20 47648854 T C 0.00310093 0.0570815 0.00310093 L3 20 47745084 C G 0.00303794 -0.0570754 0.00303794 L3 20 47753265 T C 0.00300333 -0.057072 0.00300333 <p>In contrast, the stackplot and variant list for \\(L=2\\) reveal a single credible set</p> <p></p> <p>This region of chromosome 20 is relatively gene-dense, so that are a number of plausible causal genes.</p> Variant List (L=2) cs CHR POS EA NEA alpha mu PIP L1 20 47530924 TA T 0.0942184 0.027463 0.0942184 L1 20 47530801 T TTGC 0.0900384 0.0274356 0.0900384 L1 20 47532999 G A 0.0827506 0.0273843 0.0827506 L1 20 47530037 C T 0.0776545 0.0273457 0.0776545 L1 20 47529913 T C 0.074241 0.0273184 0.074241 L1 20 47533655 C T 0.0718805 0.0272987 0.0718805 L1 20 47531606 C T 0.0718423 0.0272984 0.0718423 L1 20 47535298 C A 0.0655834 0.0272428 0.0655834 L1 20 47527742 C A 0.0655829 0.0272428 0.0655829 L1 20 47523865 C A 0.0640172 0.027228 0.0640172 L1 20 47526493 G T 0.0636458 0.0272245 0.0636458 L1 20 47530150 T C 0.0478056 0.0270491 0.0478056 L1 20 47731228 C A 0.00433327 -0.0255305 0.00433327 L1 20 47731158 C T 0.00209394 -0.0250523 0.00209394 L1 20 47779340 C T 0.00206127 -0.0250418 0.00206127 L1 20 47783770 TG T 0.00200365 -0.025023 0.00200365 L1 20 47792457 C A 0.00191728 -0.0249937 0.00191728 L1 20 47717405 C T 0.00183741 -0.0249654 0.00183741 L1 20 47721937 T TTTG 0.00179731 -0.0249507 0.00179731 L1 20 47789849 G C 0.00177923 -0.0249439 0.00177923 L1 20 47623827 CT C 0.00170185 0.0249143 0.00170185 L1 20 47703810 A C 0.00169575 -0.0249119 0.00169575 L1 20 47739415 T C 0.00168367 -0.0249071 0.00168367 L1 20 47687238 T TG 0.00168216 0.0249065 0.00168216 L1 20 47701339 G A 0.00166606 -0.0249001 0.00166606 L1 20 47808070 A G 0.00166435 -0.0248994 0.00166435 L1 20 47750377 A C 0.00162562 -0.0248837 0.00162562 L1 20 47776919 T A 0.00162064 -0.0248816 0.00162064 L1 20 47770756 C A 0.00153315 -0.0248445 0.00153315 L1 20 47621372 A G 0.00147649 0.0248193 0.00147649 L1 20 47751708 A AAAG 0.00146798 -0.0248154 0.00146798 L1 20 47721385 A G 0.00145078 -0.0248075 0.00145078 L1 20 47815944 C T 0.00140705 -0.024787 0.00140705 L1 20 47762700 A G 0.00140424 -0.0247856 0.00140424 L1 20 47820626 T G 0.00140143 -0.0247843 0.00140143 L1 20 47551632 CTCTTTTTT C 0.00136966 0.0247689 0.00136966 L1 20 47819305 A G 0.00136573 -0.024767 0.00136573 L1 20 47646210 C G 0.00131549 0.0247418 0.00131549 L1 20 47820667 A T 0.00130599 -0.0247369 0.00130599 L1 20 47727079 A G 0.00128907 -0.0247282 0.00128907 L1 20 47676281 A G 0.00128729 -0.0247272 0.00128729 L1 20 47769838 G C 0.00127763 -0.0247222 0.00127763 L1 20 47769837 AT A 0.00127763 -0.0247222 0.00127763 L1 20 47677017 GA G 0.00125172 -0.0247084 0.00125172 L1 20 47758549 T C 0.00124844 -0.0247066 0.00124844 L1 20 47792245 T C 0.00122507 -0.0246939 0.00122507 L1 20 47663382 G A 0.00118616 0.0246722 0.00118616 L1 20 47645427 T G 0.00098997 0.02455 0.00098997 L1 20 47783095 C T 0.00096882 -0.0245354 0.00096882 L1 20 47725607 G A 0.000941141 -0.0245157 0.000941141 L1 20 47741556 T C 0.000935673 -0.0245117 0.000935673 L1 20 47795784 C CA 0.000925569 -0.0245044 0.000925569 L1 20 47720386 C G 0.000924296 -0.0245034 0.000924296 L1 20 47782356 C CCT 0.000911758 -0.0244942 0.000911758 L1 20 47728829 G GCTTA 0.000898548 -0.0244843 0.000898548 L1 20 47818567 T C 0.000888571 -0.0244767 0.000888571 L1 20 47744691 GA G 0.000882511 -0.024472 0.000882511 L1 20 47692392 C T 0.000862608 0.0244565 0.000862608 L1 20 47769939 TA T 0.000856973 -0.0244521 0.000856973 L1 20 47774166 G A 0.000856318 -0.0244515 0.000856318 L1 20 47727341 G A 0.000854931 -0.0244504 0.000854931 L1 20 47714214 C T 0.000843545 -0.0244413 0.000843545 L1 20 47541600 A G 0.000842737 0.0244407 0.000842737 L1 20 47749296 C CCAAAA 0.000837409 -0.0244364 0.000837409 L1 20 47771274 A G 0.000836275 -0.0244354 0.000836275 L1 20 47798664 C T 0.000823076 -0.0244246 0.000823076 L1 20 47663944 C G 0.000819583 0.0244217 0.000819583 L1 20 47714370 C T 0.000818408 -0.0244207 0.000818408 L1 20 47695391 A G 0.000800477 -0.0244056 0.000800477 L1 20 47739814 T C 0.000795636 -0.0244015 0.000795636 L1 20 47760856 G A 0.000791101 -0.0243976 0.000791101 L1 20 47690591 G T 0.000790097 0.0243968 0.000790097 L1 20 47760857 C G 0.00078917 -0.0243959 0.00078917 L1 20 47719810 A G 0.000787046 -0.0243941 0.000787046 L1 20 47753019 T C 0.000786678 -0.0243938 0.000786678 <ol> <li> <p>Genetics Delivery Team, Thibaud Boutin, Andrew D Bretherick, Joshua J Dibble, Esther Ewaoluwagbemiga, Emma Northwood, Gemma L Samms, Veronique Vitart, Project, Cohort Delivery Team, \u00d8yvind Almelid, and others. Initial findings from the decodeme genome-wide association study of myalgic encephalomyelitis/chronic fatigue syndrome. medRxiv, pages 2025\u201308, 2025. URL: https://www.medrxiv.org/content/10.1101/2025.08.06.25333109v1.\u00a0\u21a9</p> </li> <li> <p>Gao Wang, Abhishek Sarkar, Peter Carbonetto, and Matthew Stephens. A simple new approach to variable selection in regression, with application to genetic fine mapping. Journal of the Royal Statistical Society Series B: Statistical Methodology, 82(5):1273\u20131300, 2020. URL: https://academic.oup.com/jrsssb/article/82/5/1273/7056114.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/DecodeME/Specific_Genes/DCC/","title":"DCC","text":""},{"location":"Analysis/DecodeME/Specific_Genes/DCC/#dcc","title":"DCC","text":""},{"location":"Analysis/DecodeME/Specific_Genes/DCC/#ncbi-description","title":"NCBI Description","text":"<p>This gene encodes a netrin 1 receptor. The transmembrane protein is a member of the immunoglobulin superfamily of cell adhesion molecules, and mediates axon guidance of neuronal growth cones towards sources of netrin 1 ligand. The cytoplasmic tail interacts with the tyrosine kinases Src and focal adhesion kinase (FAK, also known as PTK2) to mediate axon attraction. The protein partially localizes to lipid rafts, and induces apoptosis in the absence of ligand. The protein functions as a tumor suppressor, and is frequently mutated or downregulated in colorectal cancer and esophageal carcinoma. [provided by RefSeq, Oct 2009]</p>"},{"location":"Analysis/DecodeME/Specific_Genes/DCC/#other-linked-conditions","title":"Other Linked Conditions","text":"<ul> <li>Mono and Polyneuropathy<sup>1</sup></li> </ul> <ol> <li> <p>Martin Broberg, Finn Gen, Eija Kalso, and Hanna M Ollila. Genome-wide meta-analysis identifies genetic risk loci for mono-and polyneuropathies in 983 477 individuals. Human Molecular Genetics, pages ddaf200, 2026. URL: https://academic.oup.com/hmg/advance-article/doi/10.1093/hmg/ddaf200/8419672.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Han_et_al_2020_%28ASTH%29/Cis-MR-Asthma/","title":"cis-pQTL MR Analysis","text":""},{"location":"Analysis/Han_et_al_2020_%28ASTH%29/Cis-MR-Asthma/#cis-pqtl-mr-analysis","title":"cis-pQTL MR Analysis","text":"<p>I applied Mendelian Randomization to the asthma GWAS of Han et al.<sup>1</sup> using cis-pQTLs from the UK Biobank Pharma Proteomics Project<sup>2</sup> as instruments.  I aimed to identify candidate proteins that may be causal in the asthma disease process.</p> <p>Since each protein in the UKBB PPP has at most one cis-pQTL, I used the Wald Ratio method to estimate the causal effect of the proteins on asthma.</p> <p>I used the R package <code>TwoSampleMR</code>.</p> <p>NOTE: Because  Han et al. and the UKBB PPP make use of overlapping individuals from the UK Biobank, the analysis I performed is technically one-sample-MR, not two-sample-MR.  When two-sample-MR techniques are applied to a one-sample-MR scenario, inflated type 1 error can result.  Thus, the standard errors and p values in the table below may be artificially small.  </p>"},{"location":"Analysis/Han_et_al_2020_%28ASTH%29/Cis-MR-Asthma/#results","title":"Results","text":"<p>The plot below summarizes the effect sizes and standard errors of the Bonferroni-significant proteins produced by MR analysis.  Effect sizes are expressed in asthma liability units per inverse-rank-transformed protein abundance unit.</p> <p></p> <p>The table below provides descriptions from the UniProt database for these significant asthma-affecting proteins.</p> Target UniProt Assay Target b se pval Function [CC] P01903 HLA-DRA 0.196814 0.0113675 3.7e-67 FUNCTION: An alpha chain of antigen-presenting major histocompatibility complex class II (MHCII) molecule. In complex with the beta chain HLA-DRB, displays antigenic peptides on professional antigen presenting cells (APCs) for recognition by alpha-beta T cell receptor (TCR) on HLA-DR-restricted CD4-positive T cells. This guides antigen-specific T-helper effector functions, both antibody-mediated immune response and macrophage activation, to ultimately eliminate the infectious agents and transformed cells (PubMed:15265931, PubMed:15322540, PubMed:17334368, PubMed:22327072, PubMed:24190431, PubMed:27591323, PubMed:29884618, PubMed:31495665, PubMed:8145819, PubMed:9075930). Typically presents extracellular peptide antigens of 10 to 30 amino acids that arise from proteolysis of endocytosed antigens in lysosomes (PubMed:8145819). In the tumor microenvironment, presents antigenic peptides that are primarily generated in tumor-resident APCs likely via phagocytosis of apoptotic tumor cells or macropinocytosis of secreted tumor proteins (PubMed:31495665). Presents peptides derived from intracellular proteins that are trapped in autolysosomes after macroautophagy, a mechanism especially relevant for T cell selection in the thymus and central immune tolerance (PubMed:17182262, PubMed:23783831). The selection of the immunodominant epitopes follows two processing modes: 'bind first, cut/trim later' for pathogen-derived antigenic peptides and 'cut first, bind later' for autoantigens/self-peptides (PubMed:25413013). The anchor residue at position 1 of the peptide N-terminus, usually a large hydrophobic residue, is essential for high affinity interaction with MHCII molecules (PubMed:8145819). {ECO:0000269 Q01638 IL1RL1 -0.157073 0.00911024 1.3e-66 FUNCTION: Receptor for interleukin-33 (IL-33) which plays crucial roles in innate and adaptive immunity, contributing to tissue homeostasis and responses to environmental stresses together with coreceptor IL1RAP (PubMed:35238669). Its stimulation recruits MYD88, IRAK1, IRAK4, and TRAF6, followed by phosphorylation of MAPK3/ERK1 and/or MAPK1/ERK2, MAPK14, and MAPK8. Possibly involved in helper T-cell function (Probable) (PubMed:16286016). Upon tissue injury, induces UCP2-dependent mitochondrial rewiring that attenuates the generation of reactive oxygen species and preserves the integrity of Krebs cycle required for persistent production of itaconate and subsequent GATA3-dependent differentiation of inflammation-resolving alternatively activated macrophages (By similarity). {ECO:0000250 Q15399 TLR1 -0.201045 0.0146438 6.8e-43 FUNCTION: Participates in the innate immune response to microbial agents. Specifically recognizes diacylated and triacylated lipopeptides. Cooperates with TLR2 to mediate the innate immune response to bacterial lipoproteins or lipopeptides (PubMed:21078852). Forms the activation cluster TLR2:TLR1:CD14 in response to triacylated lipopeptides, this cluster triggers signaling from the cell surface and subsequently is targeted to the Golgi in a lipid-raft dependent pathway (PubMed:16880211). Acts via MYD88 and TRAF6, leading to NF-kappa-B activation, cytokine secretion and the inflammatory response. {ECO:0000269 MICA MICB 0.069504 0.00619682 3.4e-29 Q15109 AGER -0.419182 0.0401882 1.8e-25 FUNCTION: Cell surface pattern recognition receptor that senses endogenous stress signals with a broad ligand repertoire including advanced glycation end products, S100 proteins, high-mobility group box 1 protein/HMGB1, amyloid beta/APP oligomers, nucleic acids, histones, phospholipids and glycosaminoglycans (PubMed:27572515, PubMed:28515150, PubMed:34743181, PubMed:35974093, PubMed:24081950). Advanced glycosylation end products are nonenzymatically glycosylated proteins which accumulate in vascular tissue in aging and at an accelerated rate in diabetes (PubMed:21565706). These ligands accumulate at inflammatory sites during the pathogenesis of various diseases including diabetes, vascular complications, neurodegenerative disorders and cancers, and RAGE transduces their binding into pro-inflammatory responses. Upon ligand binding, uses TIRAP and MYD88 as adapters to transduce the signal ultimately leading to the induction of inflammatory cytokines IL6, IL8 and TNFalpha through activation of NF-kappa-B (PubMed:21829704, PubMed:33436632). Interaction with S100A12 on endothelium, mononuclear phagocytes, and lymphocytes triggers cellular activation, with generation of key pro-inflammatory mediators (PubMed:19386136). Interaction with S100B after myocardial infarction may play a role in myocyte apoptosis by activating ERK1/2 and p53/TP53 signaling (By similarity). Contributes to the translocation of amyloid-beta peptide (ABPP) across the cell membrane from the extracellular to the intracellular space in cortical neurons (PubMed:19906677). ABPP-initiated RAGE signaling, especially stimulation of p38 mitogen-activated protein kinase (MAPK), has the capacity to drive a transport system delivering ABPP as a complex with RAGE to the intraneuronal space. Participates in endothelial albumin transcytosis together with HMGB1 through the RAGE/SRC/Caveolin-1 pathway, leading to endothelial hyperpermeability (PubMed:27572515). Mediates the loading of HMGB1 in extracellular vesicles (EVs) that shuttle HMGB1 to hepatocytes by transferrin-mediated endocytosis and subsequently promote hepatocyte pyroptosis by activating the NLRP3 inflammasome (PubMed:34743181). Binds to DNA and promotes extracellular hypomethylated DNA (CpG DNA) uptake by cells via the endosomal route to activate inflammatory responses (PubMed:24081950, PubMed:28515150). Mediates phagocytosis by non-professional phagocytes (NPP) and this is enhanced by binding to ligands including RNA, DNA, HMGB1 and histones (PubMed:35974093). Promotes NPP-mediated phagocytosis of Saccharomyces cerevisiae spores by binding to RNA attached to the spore wall (PubMed:35974093). Also promotes NPP-mediated phagocytosis of apoptotic cells (PubMed:35974093). Following DNA damage, recruited to DNA double-strand break sites where it colocalizes with the MRN repair complex via interaction with double-strand break repair protein MRE11 (By similarity). Enhances the endonuclease activity of MRE11, promoting the end resection of damaged DNA (By similarity). Promotes DNA damage repair in trophoblasts which enhances trophoblast invasion and contributes to placental development and maintenance (PubMed:33918759). Protects cells from DNA replication stress by localizing to damaged replication forks where it stabilizes the MCM2-7 complex and promotes faithful progression of the replication fork (PubMed:36807739). Mediates the production of reactive oxygen species (ROS) in human endothelial cells (PubMed:25401185). {ECO:0000250 P09919 CSF3 0.722037 0.0795319 1.1e-19 FUNCTION: Granulocyte/macrophage colony-stimulating factors are cytokines that act in hematopoiesis by controlling the production, differentiation, and function of 2 related white cell populations of the blood, the granulocytes and the monocytes-macrophages. This CSF induces granulocytes. Q9HB29 IL1RL2 -0.128852 0.0143347 2.5e-19 FUNCTION: Receptor for interleukin-36 (IL36A, IL36B and IL36G). After binding to interleukin-36 associates with the coreceptor IL1RAP to form the interleukin-36 receptor complex which mediates interleukin-36-dependent activation of NF-kappa-B, MAPK and other pathways (By similarity). The IL-36 signaling system is thought to be present in epithelial barriers and to take part in local inflammatory response; it is similar to the IL-1 system. Seems to be involved in skin inflammatory response by induction of the IL-23/IL-17/IL-22 pathway. {ECO:0000250 P16871 IL7R 0.0681125 0.00758114 2.6e-19 FUNCTION: Receptor for interleukin-7. Also acts as a receptor for thymic stromal lymphopoietin (TSLP). P14778 IL1R1 0.307053 0.035607 6.5e-18 FUNCTION: Receptor for IL1A, IL1B and IL1RN (PubMed:2950091, PubMed:37315560). After binding to interleukin-1 associates with the coreceptor IL1RAP to form the high affinity interleukin-1 receptor complex which mediates interleukin-1-dependent activation of NF-kappa-B, MAPK and other pathways. Signaling involves the recruitment of adapter molecules such as TOLLIP, MYD88, and IRAK1 or IRAK2 via the respective TIR domains of the receptor/coreceptor subunits. Binds ligands with comparable affinity and binding of antagonist IL1RN prevents association with IL1RAP to form a signaling complex. Involved in IL1B-mediated costimulation of IFNG production from T-helper 1 (Th1) cells (PubMed:10653850). {ECO:0000269 Q92599 SEPTIN8 -0.508966 0.0635853 1.2e-15 FUNCTION: Filament-forming cytoskeletal GTPase (By similarity). May play a role in platelet secretion (PubMed:15116257). Seems to participate in the process of SNARE complex formation in synaptic vesicles (By similarity). {ECO:0000250, ECO:0000250 P13747 HLA-E 0.153178 0.0202326 3.70814e-14 FUNCTION: Non-classical major histocompatibility class Ib molecule involved in immune self-nonself discrimination. In complex with B2M/beta-2-microglobulin binds nonamer self-peptides derived from the signal sequence of classical MHC class Ia molecules (VL9 peptides - VMAPRT[V/L][L/V/I/F]L) (PubMed:18083576, PubMed:18339401, PubMed:35705051, PubMed:37264229, PubMed:9754572). Peptide-bound HLA-E-B2M heterotrimeric complex primarily functions as a ligand for natural killer (NK) cell inhibitory receptor KLRD1-KLRC1, enabling NK cells to monitor the expression of other MHC class I molecules in healthy cells and to tolerate self (PubMed:17179229, PubMed:18083576, PubMed:37264229, PubMed:9486650, PubMed:9754572). Upon cellular stress, preferentially binds signal sequence-derived peptides from stress-induced chaperones and is no longer recognized by NK cell inhibitory receptor KLRD1-KLRC1, resulting in impaired protection from NK cells (PubMed:12461076). Binds signal sequence-derived peptides from non-classical MHC class Ib HLA-G molecules and acts as a ligand for NK cell activating receptor KLRD1-KLRC2, likely playing a role in the generation and effector functions of adaptive NK cells and in maternal-fetal tolerance during pregnancy (PubMed:30134159, PubMed:37264229, PubMed:9754572). Besides self-peptides, can also bind and present pathogen-derived peptides conformationally similar to VL9 peptides to alpha-beta T cell receptor (TCR) on unconventional CD8-positive cytotoxic T cells, ultimately triggering antimicrobial immune response (PubMed:16474394, PubMed:20195504, PubMed:30087334, PubMed:34228645). Presents HIV gag peptides (immunodominant KAFSPEVIPMF and subdominant KALGPAATL epitopes) predominantly to CD8-positive T cell clones expressing a TRAV17-containing TCR, triggering HLA-E-restricted T cell responses (PubMed:34228645). Presents mycobacterial peptides to HLA-E-restricted CD8-positive T cells eliciting both cytotoxic and immunoregulatory functions (PubMed:20195504, PubMed:35705051). {ECO:0000269 P08887 IL6R 0.0379751 0.00561936 1.4e-11 FUNCTION: Part of the receptor for interleukin 6. Binds to IL6 with low affinity, but does not transduce a signal (PubMed:28265003). Signal activation necessitate an association with IL6ST. Activation leads to the regulation of the immune response, acute-phase reactions and hematopoiesis (PubMed:30995492, PubMed:31235509). The interaction with membrane-bound IL6R and IL6ST stimulates 'classic signaling', the restricted expression of the IL6R limits classic IL6 signaling to only a few tissues such as the liver and some cells of the immune system. Whereas the binding of IL6 and soluble IL6R to IL6ST stimulates 'trans-signaling'. Alternatively, 'cluster signaling' occurs when membrane-bound IL6:IL6R complexes on transmitter cells activate IL6ST receptors on neighboring receiver cells (Probable). {ECO:0000269 Q10587 TEF 0.611629 0.096029 1.9e-10 FUNCTION: Transcription factor that binds to and transactivates the TSHB promoter. Binds to a minimal DNA-binding sequence 5'-[TC][AG][AG]TTA[TC][AG]-3'. P24394 IL4R -0.124614 0.020448 1.1e-09 FUNCTION: Receptor for both interleukin 4 and interleukin 13 (PubMed:17030238). Couples to the JAK1/2/3-STAT6 pathway. The IL4 response is involved in promoting Th2 differentiation. The IL4/IL13 responses are involved in regulating IgE production and, chemokine and mucus production at sites of allergic inflammation. In certain cell types, can signal through activation of insulin receptor substrates, IRS1/IRS2. {ECO:0000269 O95407 TNFRSF6B -0.127021 0.0211779 2e-09 FUNCTION: Decoy receptor that can neutralize the cytotoxic ligands TNFS14/LIGHT, TNFSF15 and TNFSF6/FASL. Protects against apoptosis. {ECO:0000269 P19075 TSPAN8 -0.0744569 0.0127618 5.4e-09 FUNCTION: Structural component of specialized membrane microdomains known as tetraspanin-enriched microdomains (TERMs), which act as platforms for receptor clustering and signaling (PubMed:27180357, PubMed:36078095). Participates thereby in diverse biological functions such as cell signal transduction, migration and protein trafficking (PubMed:25761241). Promotes ADAM17-mediated TNF-alpha processing through recruitment of ADAM17 to tetraspanin-enriched micro-domains (TEMs) (PubMed:36078095). Forms a complex with RICTOR and integrin alpha3/ITGA3 to mediate mTORC2 activation and AKT1 phosphorylation leading to cell migration (PubMed:25761241). Reduces apoptosis and autophagy induced by high glucose levels through forming a complex with mTOR and RICTOR (PubMed:35904232). Contributes to the maintenance of intestinal epithelial barrier and plays a role in the regulation of intestine inflammation by switching interferon gamma receptor 1/IFNGR1 from clathrin-dependent to lipid raft-dependent endocytosis route to limit STAT1 activation magnitude and duration (PubMed:37204469). Acts as a modulator of the endothelin axis by associating with endothelin converting enzyme ECE1 and regulating its activity of conversion of the endothelin-1 precursor to endothelin (PubMed:37835445). {ECO:0000269 Q92956 TNFRSF14 -0.307197 0.0529808 6.7e-09 FUNCTION: Receptor for four distinct ligands: The TNF superfamily members TNFSF14/LIGHT and homotrimeric LTA/lymphotoxin-alpha and the immunoglobulin superfamily members BTLA and CD160, altogether defining a complex stimulatory and inhibitory signaling network (PubMed:10754304, PubMed:18193050, PubMed:23761635, PubMed:9462508). Signals via the TRAF2-TRAF3 E3 ligase pathway to promote immune cell survival and differentiation (PubMed:19915044, PubMed:9153189, PubMed:9162022). Participates in bidirectional cell-cell contact signaling between antigen presenting cells and lymphocytes. In response to ligation of TNFSF14/LIGHT, delivers costimulatory signals to T cells, promoting cell proliferation and effector functions (PubMed:10754304). Interacts with CD160 on NK cells, enhancing IFNG production and anti-tumor immune response (PubMed:23761635). In the context of bacterial infection, acts as a signaling receptor on epithelial cells for CD160 from intraepithelial lymphocytes, triggering the production of antimicrobial proteins and pro-inflammatory cytokines (By similarity). Upon binding to CD160 on activated CD4+ T cells, down-regulates CD28 costimulatory signaling, restricting memory and alloantigen-specific immune response (PubMed:18193050). May interact in cis (on the same cell) or in trans (on other cells) with BTLA (By similarity) (PubMed:19915044). In cis interactions, appears to play an immune regulatory role inhibiting in trans interactions in naive T cells to maintain a resting state. In trans interactions, can predominate during adaptive immune response to provide survival signals to effector T cells (By similarity) (PubMed:19915044). {ECO:0000250 O94992 HEXIM1 0.506472 0.0886286 1.1e-08 FUNCTION: Transcriptional regulator which functions as a general RNA polymerase II transcription inhibitor (PubMed:14580347, PubMed:15201869, PubMed:15713661). Core component of the 7SK RNP complex: in cooperation with 7SK snRNA sequesters P-TEFb in a large inactive 7SK snRNP complex preventing RNA polymerase II phosphorylation and subsequent transcriptional elongation (PubMed:12832472, PubMed:14580347, PubMed:15201869, PubMed:15713661). May also regulate NF-kappa-B, ESR1, NR3C1 and CIITA-dependent transcriptional activity (PubMed:15940264, PubMed:15941832, PubMed:17088550). Plays a role in the regulation of DNA virus-mediated innate immune response by assembling into the HDP-RNP complex, a complex that serves as a platform for IRF3 phosphorylation and subsequent innate immune response activation through the cGAS-STING pathway (PubMed:28712728). {ECO:0000269 Q7KYR7 BTN2A1 0.115332 0.0216516 1e-07 Q16610 ECM1 0.0481352 0.00922327 1.8e-07 FUNCTION: Involved in endochondral bone formation as negative regulator of bone mineralization. Stimulates the proliferation of endothelial cells and promotes angiogenesis. Inhibits MMP9 proteolytic activity. {ECO:0000269 P40121 CAPG 0.0382853 0.00741196 2.4e-07 FUNCTION: Calcium-sensitive protein which reversibly blocks the barbed ends of actin filaments but does not sever preformed actin filaments. May play an important role in macrophage function. May play a role in regulating cytoplasmic and/or nuclear structures through potential interactions with actin. May bind DNA. Q8WWN9 IPCEF1 -0.373547 0.0745375 5.4e-07 FUNCTION: Enhances the promotion of guanine-nucleotide exchange by PSCD2 on ARF6 in a concentration-dependent manner. {ECO:0000250}. Q9Y2W6 TDRKH -0.0957814 0.0191257 5.5e-07 FUNCTION: Participates in the primary piRNA biogenesis pathway and is required during spermatogenesis to repress transposable elements and prevent their mobilization, which is essential for the germline integrity. The piRNA metabolic process mediates the repression of transposable elements during meiosis by forming complexes composed of piRNAs and Piwi proteins and govern the methylation and subsequent repression of transposons. Required for the final steps of primary piRNA biogenesis by participating in the processing of 31-37 nt intermediates into mature piRNAs. May act in pi-bodies and piP-bodies by transferring piRNA precursors or intermediates to or between these granules. {ECO:0000250 P78410 BTN3A2 -0.0469995 0.00939141 5.6e-07 FUNCTION: Plays a role in T-cell responses in the adaptive immune response. Inhibits the release of IFNG from activated T-cells. {ECO:0000269 O14618 CCS 0.0614329 0.0129239 2e-06 FUNCTION: Delivers copper to copper zinc superoxide dismutase (SOD1). Q16762 TST -0.302632 0.0643881 2.6e-06 FUNCTION: Formation of iron-sulfur complexes, cyanide detoxification or modification of sulfur-containing enzymes. Other thiol compounds, besides cyanide, can act as sulfur ion acceptors. Also has weak mercaptopyruvate sulfurtransferase (MST) activity (By similarity). Together with MRPL18, acts as a mitochondrial import factor for the cytosolic 5S rRNA. Only the nascent unfolded cytoplasmic form is able to bind to the 5S rRNA. {ECO:0000250, ECO:0000269 P20472 PVALB -0.0373988 0.00795698 2.6e-06 FUNCTION: In muscle, parvalbumin is thought to be involved in relaxation after contraction (By similarity). It binds two calcium ions (PubMed:15122922, PubMed:39584689). {ECO:0000250 Q5R372 RABGAP1L -0.446909 0.0972316 4.3e-06 FUNCTION: GTP-hydrolysis activating protein (GAP) for small GTPase RAB22A, converting active RAB22A-GTP to the inactive form RAB22A-GDP (PubMed:16923123). Plays a role in endocytosis and intracellular protein transport. Recruited by ANK2 to phosphatidylinositol 3-phosphate (PI3P)-positive early endosomes, where it inactivates RAB22A, and promotes polarized trafficking to the leading edge of the migrating cells. Part of the ANK2/RABGAP1L complex which is required for the polarized recycling of fibronectin receptor ITGA5 ITGB1 to the plasma membrane that enables continuous directional cell migration (By similarity). {ECO:0000250 P22455 FGFR4 0.0302336 0.00659797 4.6e-06 FUNCTION: Tyrosine-protein kinase that acts as a cell-surface receptor for fibroblast growth factors and plays a role in the regulation of cell proliferation, differentiation and migration, and in regulation of lipid metabolism, bile acid biosynthesis, glucose uptake, vitamin D metabolism and phosphate homeostasis. Required for normal down-regulation of the expression of CYP7A1, the rate-limiting enzyme in bile acid synthesis, in response to FGF19. Phosphorylates PLCG1 and FRS2. Ligand binding leads to the activation of several signaling cascades. Activation of PLCG1 leads to the production of the cellular signaling molecules diacylglycerol and inositol 1,4,5-trisphosphate. Phosphorylation of FRS2 triggers recruitment of GRB2, GAB1, PIK3R1 and SOS1, and mediates activation of RAS, MAPK1/ERK2, MAPK3/ERK1 and the MAP kinase signaling pathway, as well as of the AKT1 signaling pathway. Promotes SRC-dependent phosphorylation of the matrix protease MMP14 and its lysosomal degradation. FGFR4 signaling is down-regulated by receptor internalization and degradation; MMP14 promotes internalization and degradation of FGFR4. Mutations that lead to constitutive kinase activation or impair normal FGFR4 inactivation lead to aberrant signaling. {ECO:0000269"},{"location":"Analysis/Han_et_al_2020_%28ASTH%29/Cis-MR-Asthma/#interpretation-of-results","title":"Interpretation of results","text":"<p>The top protein hits in the table above are consistent with the known biology of asthma.  As would be expected for an immunologically-driven phenotype, these hits consist mostly of cytokine receptors, innate immune system pattern receptors, and components of the MHC/HLA molecule.</p> <p>The direction of some of the effects is surprising: for instance, TLR1, an innate-immune system receptor, is associated with lower asthma risk.  This finding may be explained by Donoghue et al.'s<sup>3</sup> observation that TLR upregulates IL-27, an anti-inflammatory cytokine that protects against asthma.</p> <ol> <li> <p>Yi Han, Qiong Jia, Pedram Shafiei Jahani, Benjamin P Hurrell, Calvin Pan, Pin Huang, Janet Gukasyan, Nicholas C Woodward, Eleazar Eskin, Frank D Gilliland, and others. Genome-wide analysis highlights contribution of immune system pathways to the genetic architecture of asthma. Nature communications, 11(1):1776, 2020. URL: https://www.nature.com/articles/s41467-020-15649-3.\u00a0\u21a9</p> </li> <li> <p>Benjamin B Sun, Joshua Chiou, Matthew Traylor, Christian Benner, Yi-Hsiang Hsu, Tom G Richardson, Praveen Surendran, Anubha Mahajan, Chloe Robins, Steven G Vasquez-Grinnell, and others. Plasma proteomic associations with genetics and health in the uk biobank. Nature, 622(7982):329\u2013338, 2023. URL: https://www.nature.com/articles/s41586-023-06592-6.\u00a0\u21a9</p> </li> <li> <p>Lauren J Donoghue, Christian Benner, Diana Chang, Flaviyan Jerome Irudayanathan, Rion K Pendergrass, Brian L Yaspan, Anubha Mahajan, and Mark I McCarthy. Integration of biobank-scale genetics and plasma proteomics reveals evidence for causal processes in asthma risk and heterogeneity. Cell Genomics, 2025. URL: https://www.cell.com/cell-genomics/fulltext/S2666-979X(25)00096-5.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Han_et_al_2020_%28ASTH%29/S-LDSC-Asthma_Analysis/","title":"S-LDSC Asthma Analysis","text":""},{"location":"Analysis/Han_et_al_2020_%28ASTH%29/S-LDSC-Asthma_Analysis/#s-ldsc-asthma-analysis","title":"S-LDSC Asthma Analysis","text":"<p>I applied Stratified Linkage Disequilibrium Score Regression (S-LDSC) to summary statistics from Han et al.'s meta-GWAS of asthma<sup>1</sup>.</p>"},{"location":"Analysis/Han_et_al_2020_%28ASTH%29/S-LDSC-Asthma_Analysis/#reference-data-sources","title":"Reference Data Sources","text":"<p>I used the standard reference datasets recommended and preprocessed by the authors of the S-LDSC method.</p> <ul> <li>The GTEx Project</li> <li>The Franke lab dataset</li> <li>The Roadmap Epigenetic Project</li> <li>The Corces et al. ATAC-seq dataset of 13 blood cell types.</li> <li>The ImmGen Project</li> <li>The Cahoy Mouse Central Nervous System Dataset</li> </ul>"},{"location":"Analysis/Han_et_al_2020_%28ASTH%29/S-LDSC-Asthma_Analysis/#results","title":"Results","text":""},{"location":"Analysis/Han_et_al_2020_%28ASTH%29/S-LDSC-Asthma_Analysis/#gtex-and-franke-lab-tissue-expression-data","title":"GTEx and Franke lab tissue expression data","text":"<p>The results are plotted below</p> <p></p> <p>The table below shows the tissue/cell types with the lowest p values.</p> Name Coefficient Coefficient_P_value Reject Null A11.118.637.555.567.569.T.Lymphocytes 1.7136e-08 1.79629e-06 True A15.145.229.637.555.567.569.200.CD4.Positive.T.Lymphocytes 1.09652e-08 3.90918e-05 True A15.382.520.604.700.Spleen 1.19426e-08 0.00010796 True A02.835.583.443.800.800.Synovial.Fluid 1.28336e-08 0.000122159 True A15.145.229.Blood.Cells 1.17864e-08 0.000122277 True A15.382.490.555.567.Lymphocytes 1.21767e-08 0.000125171 True A11.118.637.555.567.569.200.700.T.Lymphocytes..Regulatory 1.01439e-08 0.000130168 True A15.382.490.555.567.537.Killer.Cells..Natural 1.1958e-08 0.000343613 True A15.145.Blood 1.10734e-08 0.000367411 True Spleen 7.89811e-09 0.000682061 False A10.549.Lymphoid.Tissue 1.19797e-08 0.000759795 False A15.145.229.637.555.Leukocytes..Mononuclear 1.02734e-08 0.000826575 False A15.382.490.555.567.622.Lymphocytes..Null 9.92795e-09 0.000963336 False A11.118.637.Leukocytes 8.50474e-09 0.00106547 False A10.549.400.Lymph.Nodes 9.3136e-09 0.00116527 False A03.556.249.124.Ileum 1.06525e-08 0.00264645 False A03.556.124.684.Intestine..Small 9.03662e-09 0.00267725 False A15.378.316.580.Monocytes 6.43006e-09 0.00493671 False A02.165.Cartilage 5.82729e-09 0.0057413 False Esophagus_Muscularis 5.82619e-09 0.00759493 False Whole_Blood 7.87232e-09 0.00966815 False <p>These results are consistent with the well-known immunological nature of asthma</p>"},{"location":"Analysis/Han_et_al_2020_%28ASTH%29/S-LDSC-Asthma_Analysis/#roadmap-chromatin-data","title":"Roadmap Chromatin data","text":"<p>I next applied S-LDSC to the asthma GWAS using reference data generated by Finucane et al.<sup>2</sup> from the Roadmap Epigenetics Project.</p> <p>The following graph and table show the results:</p> <p></p> Name Coefficient Coefficient_P_value Reject Null Primary_T_helper_17_cells_PMA-I_stimulated__H3K4me1 2.28473e-07 1.25164e-09 True Primary_T_regulatory_cells_from_peripheral_blood__H3K4me1 1.65076e-07 1.77049e-09 True Primary_T_helper_memory_cells_from_peripheral_blood_2__H3K4me1 1.52561e-07 9.40009e-08 True Primary_T_helper_memory_cells_from_peripheral_blood_1__H3K4me1 1.78205e-07 1.5018e-07 True Primary_T_helper_cells_from_peripheral_blood__H3K4me1 1.3524e-07 3.70906e-07 True Primary_T_helper_cells_PMA-I_stimulated__H3K4me1 1.22911e-07 4.08701e-07 True Primary_T_helper_17_cells_PMA-I_stimulated__H3K27ac 3.57399e-07 5.40299e-07 True Spleen_ENTEX__H3K27ac 5.85499e-08 6.29279e-07 True Primary_T_cells_effector_memory_enriched_from_peripheral_blood__H3K4me1 2.19465e-07 9.80666e-07 True Primary_T_cells_from_peripheral_blood__H3K4me1 1.10633e-07 1.12969e-06 True Primary_Natural_Killer_cells_from_peripheral_blood__DNase 2.87209e-07 1.27231e-06 True Primary_T_helper_cells_PMA-I_stimulated__H3K27ac 1.62782e-07 1.43172e-06 True Primary_T_cells_from_peripheral_blood__DNase 2.63651e-07 6.12566e-06 True Primary_T_killer_memory_cells_from_peripheral_blood__H3K4me1 1.4703e-07 7.76036e-06 True Primary_T_cells_from_peripheral_blood__H3K27ac 1.85166e-07 9.91999e-06 True Primary_T_helper_17_cells_PMA-I_stimulated__H3K4me3 5.72705e-07 1.51429e-05 True Primary_mononuclear_cells_from_peripheral_blood__H3K9ac 2.56674e-07 1.84474e-05 True Primary_T_helper_naive_cells_from_peripheral_blood_1__H3K4me1 1.42012e-07 2.66904e-05 True Primary_T_cells_from_cord_blood__DNase 2.76964e-07 4.84287e-05 True Primary_T_regulatory_cells_from_peripheral_blood__H3K27ac 1.41208e-07 6.79159e-05 True Primary_T_helper_cells_PMA-I_stimulated__H3K4me3 3.0952e-07 0.000146238 True Primary_T_helper_memory_cells_from_peripheral_blood_1__H3K4me3 3.30703e-07 0.000190911 True Primary_T_helper_memory_cells_from_peripheral_blood_1__H3K27ac 2.38795e-07 0.000191918 True Primary_T_killer_naive_cells_from_peripheral_blood__H3K4me1 1.03862e-07 0.000234462 True Colonic_Mucosa__H3K9ac 1.69975e-07 0.000258698 True Primary_T_helper_17_cells_PMA-I_stimulated__H3K36me3 1.21335e-07 0.000361052 True Primary_T_regulatory_cells_from_peripheral_blood__H3K4me3 2.56492e-07 0.000408582 True Spleen_ENTEX__H3K36me3 2.85012e-08 0.000628698 False Primary_Natural_Killer_cells_from_peripheral_blood__H3K4me1 1.02027e-07 0.000703613 False Spleen_ENTEX__H3K4me1 1.71395e-07 0.00092961 False Primary_T_cells_effector_memory_enriched_from_peripheral_blood__H3K27ac 2.5195e-07 0.00113583 False Primary_T_helper_memory_cells_from_peripheral_blood_2__H3K4me3 2.28469e-07 0.00130371 False Primary_T_helper_naive_cells_from_peripheral_blood__H3K9ac 3.11764e-07 0.00133795 False Primary_Natural_Killer_cells_from_peripheral_blood__H3K27ac 1.54913e-07 0.00141558 False Primary_T_helper_cells_PMA-I_stimulated__H3K36me3 7.10304e-08 0.00173045 False <p>Again the focus on immunological cell and tissue types is consistent with known biology.</p> <p>The single significant intestinal cell type is of unclear importance.  It may be noise and/or artifact, or it may reflect the presence of immune cells in the gut wall.</p> <p>It is also interesting to observe that in both the GTEx and Roadmap analysis, T cells were the most significant, also consistent with known biology.</p>"},{"location":"Analysis/Han_et_al_2020_%28ASTH%29/S-LDSC-Asthma_Analysis/#immgen-data","title":"ImmGen data","text":"<p>I next applied S-LDSC to the asthma GWAS using ImmGen data as a reference.</p> <p>The results are given in the plot and table below:</p> <p></p> Name Coefficient Coefficient_P_value Reject Null T.4Mem.Sp 1.75441e-08 2.27642e-07 True NKT.4+.Lv 1.45005e-08 5.31667e-07 True NKT.4-.Sp 1.61158e-08 1.19597e-06 True T.4Mem44h62l.Sp 1.51641e-08 1.68921e-06 True LN.TR.14w.B6 1.4607e-08 3.05104e-06 True ABD.TR.14w.B6 1.61976e-08 4.36389e-06 True NKT.4-.Lv 1.31215e-08 6.96657e-06 True T.4Mem44h62l.LN 1.37984e-08 1.28985e-05 True CD4Control 1.36494e-08 5.34825e-05 True T.4FP3+25+.Sp 1.10745e-08 0.00012789 True T.8Eff.Sp.OT1.d10.LisOva 1.07401e-08 0.000175188 True Tgd.vg2-.Sp 9.08137e-09 0.000236126 True T.8Eff.Sp.OT1.d8.VSVOva 1.08524e-08 0.000238524 True NKT.44+NK1.1+.Th 1.09896e-08 0.00030989 True Tgd.vg2-.act.Sp 8.33486e-09 0.000323691 True Tgd.vg2+.Sp 1.07736e-08 0.000392383 True NKT.4+.Sp 1.1554e-08 0.000465112 True NK.b2m-.Sp 8.96422e-09 0.000602208 True T.4.Pa.BDC 1.00297e-08 0.000664139 False T.4Mem.LN 9.51501e-09 0.00070779 False T.8Eff.Sp.OT1.d8.LisOva 9.7501e-09 0.000785852 False T.4SP69+.Th 1.01601e-08 0.000789917 False Tgd.vg2+24alo.Th 1.27289e-08 0.000825648 False Tgd.vg2-.Sp.TCRbko 8.78036e-09 0.000952023 False Tgd.vg2+24ahi.Th 1.09829e-08 0.00101376 False T.8Mem.Sp.OT1.d45.LisOva 1.01302e-08 0.00112147 False <p>Here, all significant cell types are either T cell or natural killer cells.  The significance of natural killer cells may reflect their real role in asthma, or their strong transcriptomic overlap with T cells<sup>3</sup>, or both.</p>"},{"location":"Analysis/Han_et_al_2020_%28ASTH%29/S-LDSC-Asthma_Analysis/#corces-et-al-atac-seq-data","title":"Corces et al. ATAC-seq data","text":"<p>Next, I applied S-LDSC using the Corces blood-cell ATAC-seq data as a reference.</p> Name Coefficient Coefficient_P_value Reject Null CD4 2.0966e-07 3.20707e-05 True CD8 1.78171e-07 8.74402e-05 True NK 1.52311e-07 0.0025469 False Bcell 4.71654e-08 0.0924839 False HSC 2.82408e-08 0.137143 False MPP 2.86087e-08 0.137208 False LMPP 1.76042e-08 0.314867 False Mono 2.26418e-08 0.334303 False CLP 1.45358e-08 0.345982 False MEP 7.94853e-09 0.350748 False GMP 8.7878e-09 0.373874 False CMP 2.81872e-09 0.455809 False Erythro -8.14228e-08 0.931757 False <p>Yet again, we see strong significance of T-cell types.</p>"},{"location":"Analysis/Han_et_al_2020_%28ASTH%29/S-LDSC-Asthma_Analysis/#cahoy-and-gtex-brain-data","title":"Cahoy and GTEx-Brain data","text":"<p>Consistent with a disease that is not primarily neurological, there were not significant cell types in the Cahoy or GTEx-brain datasets.</p> Name Coefficient Coefficient_P_value Reject Null Astrocyte 2.68341e-09 0.134337 False Neuron -7.26051e-11 0.51659 False Oligodendrocyte -3.19043e-09 0.905963 False Name Coefficient Coefficient_P_value Reject Null Brain_Cerebellum 7.49537e-09 0.00285985 False Brain_Cerebellar_Hemisphere 2.88573e-09 0.0952969 False Brain_Spinal_cord_(cervical_c-1) 7.39534e-10 0.336336 False Brain_Cortex 5.27257e-10 0.373407 False Brain_Amygdala 1.55599e-10 0.469241 False Brain_Frontal_Cortex_(BA9) -4.11044e-10 0.622353 False Brain_Nucleus_accumbens_(basal_ganglia) -8.97294e-10 0.716098 False Brain_Anterior_cingulate_cortex_(BA24) -1.45618e-09 0.853186 False Brain_Putamen_(basal_ganglia) -2.16576e-09 0.885143 False Brain_Caudate_(basal_ganglia) -1.98446e-09 0.910509 False Brain_Hippocampus -2.43085e-09 0.921089 False Brain_Hypothalamus -2.56127e-09 0.928584 False Brain_Substantia_nigra -3.06368e-09 0.974794 False <ol> <li> <p>Yi Han, Qiong Jia, Pedram Shafiei Jahani, Benjamin P Hurrell, Calvin Pan, Pin Huang, Janet Gukasyan, Nicholas C Woodward, Eleazar Eskin, Frank D Gilliland, and others. Genome-wide analysis highlights contribution of immune system pathways to the genetic architecture of asthma. Nature communications, 11(1):1776, 2020. URL: https://www.nature.com/articles/s41467-020-15649-3.\u00a0\u21a9</p> </li> <li> <p>Hilary K Finucane, Yakir A Reshef, Verneri Anttila, Kamil Slowikowski, Alexander Gusev, Andrea Byrnes, Steven Gazal, Po-Ru Loh, Caleb Lareau, Noam Shoresh, and others. Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types. Nature genetics, 50(4):621\u2013629, 2018. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC5896795/.\u00a0\u21a9</p> </li> <li> <p>Stephanie Vargas Aguilar, Oscar Aguilar, Rhys Allan, El Ad David Amir, Veronique Angeli, Maxim N Artyomov, Natasha Asinovski, Jilian Astarita, K Frank Austen, Geetika Bajpai, and others. Immgen at 15. Nature immunology, 21(7):700\u2013703, 2020. URL: https://escholarship.org/content/qt75r8v4bt/qt75r8v4bt.pdf.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Johnston_et_al_2019_%28Pain%29/1_Overview/","title":"Overview","text":""},{"location":"Analysis/Johnston_et_al_2019_%28Pain%29/1_Overview/#overview","title":"Overview","text":"<p>Johnston et al. performed a genome-wide association study (GWAS) of Multisite Chronic Pain (MCP) using data from 387,649 UK Biobank participants. To quantify MCP, participants reported the number of body sites where they had experienced pain recently and for at least 3 months, with values ranging from 0 to 7. The study identified 76 independent SNPs at 39 loci which were significantly associated with MCP.<sup>1</sup></p> <p>Notably, the DecodeME study found that ME/CFS colocalized with MCP near the gene that encodes carbonic anhydrase-related protein 10 (CA10). This locus on chromosome 17 was also found to colocalize with a variant which is associated with increased expression of CA10 in the prostate.<sup>2</sup> CA10 is most highly expressed in tissues of the central nervous system.<sup>3</sup><sup>4</sup> Research suggests that CA10 localizes to neural synapses and binds to neurexins, which are proteins involved in synaptogenesis.<sup>5</sup> These links between CA10 and the nervous system align with other findings which suggest nervous system involvement in both chronic pain and ME/CFS, such as significant MAGMA brain tissue enrichment in both of the above studies.<sup>1</sup><sup>2</sup></p> <p>Several studies have also noted a high rate of pain in individuals with ME/CFS.<sup>6</sup> Consistent with previous research, the DecodeME study found that 86.1% of 16,730 ME/CFS cases reported experiencing muscle pain.<sup>2</sup> </p> <p>To potentially gain further insights into both chronic pain and ME/CFS, the <code>mecfs_bioinformatics</code> repo was used to further analyze Johnston et al.'s MCP study.</p> <p>To reproduce this analysis run the Multisite Chronic Pain GWAS Analysis Script.</p> <ol> <li> <p>Keira JA Johnston, Mark J Adams, Barbara I Nicholl, Joey Ward, Rona J Strawbridge, Amy Ferguson, Andrew M McIntosh, Mark ES Bailey, and Daniel J Smith. Genome-wide association study of multisite chronic pain in uk biobank. PLoS genetics, 15(6):e1008164, 2019. URL: https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1008164.\u00a0\u21a9\u21a9</p> </li> <li> <p>Genetics Delivery Team, Thibaud Boutin, Andrew D Bretherick, Joshua J Dibble, Esther Ewaoluwagbemiga, Emma Northwood, Gemma L Samms, Veronique Vitart, Project, Cohort Delivery Team, \u00d8yvind Almelid, and others. Initial findings from the decodeme genome-wide association study of myalgic encephalomyelitis/chronic fatigue syndrome. medRxiv, pages 2025\u201308, 2025. URL: https://www.medrxiv.org/content/10.1101/2025.08.06.25333109v1.\u00a0\u21a9\u21a9\u21a9</p> </li> <li> <p>Mathias Uhl\u00e9n, Linn Fagerberg, Bj\u00f6rn M Hallstr\u00f6m, Cecilia Lindskog, Per Oksvold, Adil Mardinoglu, \u00c5sa Sivertsson, Caroline Kampf, Evelina Sj\u00f6stedt, Anna Asplund, and others. Tissue-based map of the human proteome. Science, 347(6220):1260419, 2015. URL: https://www.science.org/doi/10.1126/science.1260419.\u00a0\u21a9</p> </li> <li> <p>Tissue expression of CA10 - Summary - The Human Protein Atlas. [Accessed 24-02-2026]. URL: https://www.proteinatlas.org/ENSG00000154975-CA10/tissue.\u00a0\u21a9</p> </li> <li> <p>Fredrik H Sterky, Justin H Trotter, Sung-Jin Lee, Christian V Recktenwald, Xiao Du, Bo Zhou, Peng Zhou, Jochen Schwenk, Bernd Fakler, and Thomas C S\u00fcdhof. Carbonic anhydrase-related protein CA10 is an evolutionarily conserved pan-neurexin ligand. Proceedings of the National Academy of Sciences, 114(7):E1253\u2013E1262, 2017. URL: https://pnas.org/doi/full/10.1073/pnas.1621321114.\u00a0\u21a9</p> </li> <li> <p>Board on the Health of Select Populations and Committee on the Diagnostic Criteria for Myalgic Encephalomyelitis/Chronic Fatigue Syndrome. Beyond myalgic encephalomyelitis/chronic fatigue syndrome: redefining an illness. National Academies Press, 2015. URL: https://www.ncbi.nlm.nih.gov/books/NBK274235/.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Johnston_et_al_2019_%28Pain%29/2_MAGMA-GTEx/","title":"MAGMA GTEx","text":""},{"location":"Analysis/Johnston_et_al_2019_%28Pain%29/2_MAGMA-GTEx/#magma-gtex","title":"MAGMA GTEx","text":"<p>Johnston et al.<sup>1</sup> tested MAGMA tissue enrichment in their study of Multisite Chronic Pain (MCP) using bulk RNAseq expression data for 53 tissues from the GTEx database<sup>2</sup>. The significant tissues from that study, starting from most significant, were: </p> <ol> <li>Brain_Cortex</li> <li>Frontal_Cortex_BA9_Brain_Frontal_Cortex_BA9</li> <li>Brain_Cerebellar_Hemisphere</li> <li>Brain_Cerebellum</li> <li>Brain_Anterior_cingulate_cortex_BA24</li> <li>Brain_Nucleus_accumbens_basal_ganglia</li> <li>Brain_Caudate_basal_ganglia</li> <li>Brain_Putamen_basal_ganglia</li> </ol> <p>MAGMA gene-property analysis was repeated here using the <code>mecfs_bioinformatics</code> repo to compare the results to those in the paper. The analysis results are plotted below.</p> <p></p> <p>As in the original study, all of the significant tissues are brain regions. Interestingly, two additional tissues were significant in this analysis, amygdala and hippocampus, and the order of the significant tissues has changed. These differences might be attributed to the usage of different linkage disequilibrium (LD) panels as reference data for MAGMA. The original study likely used an LD panel based on the UK Biobank, as the study cohort was sampled from the UK Biobank, while the present analysis used an LD panel for Europeans from the 1000 Genomes project.</p> <ol> <li> <p>Keira JA Johnston, Mark J Adams, Barbara I Nicholl, Joey Ward, Rona J Strawbridge, Amy Ferguson, Andrew M McIntosh, Mark ES Bailey, and Daniel J Smith. Genome-wide association study of multisite chronic pain in uk biobank. PLoS genetics, 15(6):e1008164, 2019. URL: https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1008164.\u00a0\u21a9</p> </li> <li> <p>GTEx Consortium. The gtex consortium atlas of genetic regulatory effects across human tissues. Science, 369(6509):1318\u20131330, 2020. URL: https://www.science.org/doi/full/10.1126/science.aaz1776.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Johnston_et_al_2019_%28Pain%29/3_MAGMA-HBA/","title":"MAGMA HBA","text":""},{"location":"Analysis/Johnston_et_al_2019_%28Pain%29/3_MAGMA-HBA/#magma-hba","title":"MAGMA HBA","text":"<p>MAGMA was used to test the Johnston 2019<sup>1</sup> GWAS of Multisite Chronic Pain (MCP) using scRNAseq data from the Human Brain Atlas<sup>2</sup> as a reference.</p>"},{"location":"Analysis/Johnston_et_al_2019_%28Pain%29/3_MAGMA-HBA/#results","title":"Results","text":"<p>The results are plotted below:</p> <p></p> <p>The x-axis corresponds to HBA cluster number, while the y-axis corresponds to the \\(-\\log_{10}(p)\\) score produced by MAGMA.  Clusters are colored according to their HBA supercluster. The dotted line denotes the Bonferroni significance threshold.</p> <p>The most significant cell types are in the Caudate ganglionic eminences (CGE) interneuron supercluster.</p> <p>After applying a stepwise selection algorithm similar to the one describe in Watanabe et al.<sup>3</sup>, three clusters were identified as independently significant:</p> Retained_clusters P Supercluster Class auto-annotation Neurotransmitter auto-annotation Neuropeptide auto-annotation Subtype auto-annotation Transferred MTG Label Top three regions Top Enriched Genes Cluster286 1.8883e-07 CGE interneuron NEUR GABA CBLN CCK CHGA CHGB CORT CRH IGF NAMPT NPW NPY NUCB NXPH PNOC SCG SST UBL VGF proSAAS INT-LAMP5 Lamp5 Cerebral cortex: 70.6%, Hippocampus: 13.8%, Amygdala: 10.2% NDNF, CXCL14, AC005064.1, RELN, NMBR, LINC00298, MYH11, AC092819.3, NR2E1, SLC25A48 Cluster132 1.1917e-05 Miscellaneous NEUR VGLUT1 VGLUT2 CBLN CCK CHGA CHGB NAMPT NUCB SCG UBL VGF proSAAS 0 Cerebral cortex: 98.4%, Hippocampus: 0.8%, Midbrain: 0.8% CD53, DPP4, AC060765.1, LINC01721, AC112770.1, AL157769.1, VIPR2, PCSK1, AC016687.2, QRFPR Cluster137 1.7584e-05 Deep-layer intratelencephalic NEUR VGLUT1 VGLUT2 CBLN CCK CHGA CHGB CRH NAMPT NUCB SCG UBL UCN VGF proSAAS 0 L5 IT Cerebral cortex: 94.4%, Basal forebrain: 2.1%, Hippocampus: 1.9% LINC02196, AC099517.1, AC079380.1, AC073578.2, ADGRL4, PKD2L1, AC021134.1, AL450352.1, TRIM22, ARHGAP15 <ol> <li> <p>Keira JA Johnston, Mark J Adams, Barbara I Nicholl, Joey Ward, Rona J Strawbridge, Amy Ferguson, Andrew M McIntosh, Mark ES Bailey, and Daniel J Smith. Genome-wide association study of multisite chronic pain in uk biobank. PLoS genetics, 15(6):e1008164, 2019. URL: https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1008164.\u00a0\u21a9</p> </li> <li> <p>Kimberly Siletti, Rebecca Hodge, Alejandro Mossi Albiach, Ka Wai Lee, Song-Lin Ding, Lijuan Hu, Peter L\u00f6nnerberg, Trygve Bakken, Tamara Casper, Michael Clark, and others. Transcriptomic diversity of cell types across the adult human brain. Science, 382(6667):eadd7046, 2023. URL: https://www.science.org/doi/abs/10.1126/science.add7046.\u00a0\u21a9</p> </li> <li> <p>Kyoko Watanabe, Ma\u0161a Umi\u0107evi\u0107 Mirkov, Christiaan A de Leeuw, Martijn P van den Heuvel, and Danielle Posthuma. Genetic mapping of cell type specificity for complex traits. Nature communications, 10(1):3222, 2019. URL: https://www.nature.com/articles/s41467-019-11181-1.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Johnston_et_al_2019_%28Pain%29/4_S-LDSC/","title":"S-LDSC","text":""},{"location":"Analysis/Johnston_et_al_2019_%28Pain%29/4_S-LDSC/#s-ldsc","title":"S-LDSC","text":"<p>Stratified Linkage Disequilibrium Score Regression (S-LDSC)<sup>1</sup> was applied to summary statistics from Bellenguez et al.'s 2019 Meta-GWAS of Multisite Chronic Pain (MCP)<sup>2</sup>.</p>"},{"location":"Analysis/Johnston_et_al_2019_%28Pain%29/4_S-LDSC/#reference-data-sources","title":"Reference Data Sources","text":"<p>This analysis used standard reference datasets recommended and preprocessed by the authors of the S-LDSC method:</p> <ul> <li>The GTEx Project</li> <li>The Franke lab dataset</li> <li>The Roadmap Epigenetic Project</li> <li>The Corces et al. ATAC-seq dataset of 13 blood cell types.</li> <li>The ImmGen Project</li> <li>The Cahoy Mouse Central Nervous System Dataset</li> </ul>"},{"location":"Analysis/Johnston_et_al_2019_%28Pain%29/4_S-LDSC/#results","title":"Results","text":""},{"location":"Analysis/Johnston_et_al_2019_%28Pain%29/4_S-LDSC/#gtex-and-franke-lab-tissue-expression-data","title":"GTEx and Franke lab tissue expression data","text":"<p>Similarly to the GTEx MAGMA results, all of the significant tissues in the S-LDSC analysis were related to the brain. Here are the cell/tissue types which were significant after correction using FDR &lt; 0.01:</p> <p></p> Name Coefficient Coefficient_P_value Reject Null Brain_Putamen_(basal_ganglia) 4.34441e-09 3.82164e-06 True Brain_Hippocampus 3.82353e-09 1.05092e-05 True Brain_Anterior_cingulate_cortex_(BA24) 4.01219e-09 1.20613e-05 True A08.186.211.464.Limbic.System 4.46162e-09 1.69685e-05 True A08.186.211.Brain 4.63755e-09 2.05309e-05 True A08.186.211.730.885.287.500.Cerebral.Cortex 4.40563e-09 2.35024e-05 True Brain_Caudate_(basal_ganglia) 3.86268e-09 2.77883e-05 True A08.186.211.464.710.225.Entorhinal.Cortex 4.31141e-09 3.79579e-05 True Brain_Nucleus_accumbens_(basal_ganglia) 3.90441e-09 3.98038e-05 True Brain_Substantia_nigra 3.64814e-09 7.10008e-05 True A08.186.211.464.405.Hippocampus 4.02239e-09 9.10287e-05 True A08.186.211.132.Brain.Stem 3.93812e-09 9.55746e-05 True Brain_Cortex 3.33234e-09 0.000107207 True Brain_Frontal_Cortex_(BA9) 3.37624e-09 0.000121439 True Brain_Hypothalamus 3.49643e-09 0.000125905 True A08.186.211.730.885.287.500.670.Parietal.Lobe 3.92277e-09 0.000169976 True A08.186.211.730.885.287.500.571.735.Visual.Cortex 3.86084e-09 0.000205957 True A09.371.729.Retina 3.80165e-09 0.000437482 True Brain_Cerebellar_Hemisphere 3.2938e-09 0.000438075 True Brain_Cerebellum 3.3889e-09 0.000656342 True"},{"location":"Analysis/Johnston_et_al_2019_%28Pain%29/4_S-LDSC/#roadmap-chromatin-data","title":"Roadmap chromatin data","text":"<p>Next, reference data generated by Finucane et al.<sup>1</sup> from the Roadmap Epigenetics Project was used in S-LDSC.</p> <p>In this analysis, almost all significant cell types were again related to the brain, though there were also significant cell types related to the thymus and pancreas. The results can be seen in the plot and table below.</p> <p></p> Name Coefficient Coefficient_P_value Reject Null Fetal_Brain_Male__DNase 1.43001e-07 2.73722e-14 True Brain_Dorsolateral_Prefrontal_Cortex__H3K27ac 6.61265e-08 2.54719e-12 True Fetal_Brain_Female__DNase 1.47145e-07 2.80074e-12 True Fetal_Brain_Male__H3K4me1 5.76271e-08 4.75756e-11 True Fetal_Brain_Female__H3K4me3 2.05782e-07 8.23918e-11 True Brain_Germinal_Matrix__H3K4me3 2.18197e-07 3.26595e-10 True Fetal_Brain_Female__H3K4me1 8.26879e-08 1.78154e-09 True Brain_Dorsolateral_Prefrontal_Cortex__H3K9ac 1.36486e-07 3.0457e-09 True Brain_Angular_Gyrus__H3K27ac 5.53797e-08 6.53728e-09 True Brain_Inferior_Temporal_Lobe__H3K27ac 4.16002e-08 9.83202e-09 True Brain_Cingulate_Gyrus__H3K9ac 1.05355e-07 1.33459e-08 True Brain_Anterior_Caudate__H3K27ac 4.3185e-08 3.52913e-08 True Brain_Germinal_Matrix__H3K4me1 9.23593e-08 4.07106e-08 True Brain_Inferior_Temporal_Lobe__H3K4me3 1.45077e-07 4.87189e-08 True Ganglion_Eminence_derived_primary_cultured_neurospheres__H3K4me3 1.55603e-07 5.02739e-08 True Brain_Dorsolateral_Prefrontal_Cortex__H3K4me1 6.95193e-08 5.60795e-08 True Cortex_derived_primary_cultured_neurospheres__H3K4me3 1.8869e-07 3.12638e-07 True Brain_Hippocampus_Middle__H3K4me3 1.02857e-07 3.66736e-07 True Brain_Angular_Gyrus__H3K9ac 9.12812e-08 9.82823e-07 True Brain_Dorsolateral_Prefrontal_Cortex__H3K4me3 1.3679e-07 1.31053e-06 True Brain_Cingulate_Gyrus__H3K4me3 1.35205e-07 1.49391e-06 True Brain_Cingulate_Gyrus__H3K27ac 3.84211e-08 2.11232e-06 True Brain_Anterior_Caudate__H3K4me1 4.59498e-08 2.50698e-06 True Thymus__H3K36me3 6.10717e-08 4.4298e-06 True Brain_Angular_Gyrus__H3K4me1 4.81968e-08 7.71062e-06 True Brain_Angular_Gyrus__H3K4me3 1.30377e-07 1.11768e-05 True Brain_Inferior_Temporal_Lobe__H3K9ac 6.47697e-08 1.46867e-05 True Brain_Anterior_Caudate__H3K9ac 7.81552e-08 2.02698e-05 True Brain_Anterior_Caudate__H3K4me3 1.0891e-07 3.78601e-05 True Brain_Hippocampus_Middle__H3K27ac 2.76599e-08 4.79293e-05 True Brain_Cingulate_Gyrus__H3K4me1 3.80237e-08 5.54432e-05 True Brain_Hippocampus_Middle__H3K4me1 2.86062e-08 7.46838e-05 True Brain_Inferior_Temporal_Lobe__H3K4me1 4.24281e-08 0.00014697 True Brain_Substantia_Nigra__H3K4me3 9.29301e-08 0.000196596 True Brain_Germinal_Matrix__H3K36me3 4.96089e-08 0.000445616 True Ganglion_Eminence_derived_primary_cultured_neurospheres__H3K4me1 3.96413e-08 0.000473806 True Pancreatic_Islets__H3K27ac 1.04942e-07 0.00051186 True Fetal_Thymus__H3K36me3 1.97113e-08 0.000667859 True"},{"location":"Analysis/Johnston_et_al_2019_%28Pain%29/4_S-LDSC/#immgen-data","title":"ImmGen data","text":"<p>In the ImmGen dataset, there were no significant cell types. The following graph and table show the cell types with the lowest p values.</p> <p></p> Name Coefficient Coefficient_P_value Reject Null T.DPsm.Th 2.63206e-09 0.0065909 False T.8Eff.Sp.OT1.d15.LisOva 2.24374e-09 0.0173596 False Tgd.vg2+24ahi.Th 2.24909e-09 0.0210461 False T.8Eff.Sp.OT1.d8.VSVOva 1.94559e-09 0.0306731 False T.DP69+.Th.v2 2.07881e-09 0.0313165 False"},{"location":"Analysis/Johnston_et_al_2019_%28Pain%29/4_S-LDSC/#corces-et-al-atac-seq-data","title":"Corces et al. ATAC-seq data","text":"<p>There were no significant hematopoietic-related cell types in the Corces ATAC-seq dataset.</p> Name Coefficient Coefficient_P_value Reject Null HSC 9.54732e-09 0.237687 False GMP 7.81531e-09 0.273387 False LMPP 7.72366e-09 0.306756 False CMP 5.13328e-09 0.335868 False Erythro 7.49673e-09 0.355135 False MEP 3.51756e-09 0.394091 False MPP 2.5947e-09 0.416588 False Bcell -7.28211e-09 0.717223 False Mono -1.5232e-08 0.775996 False NK -1.02646e-08 0.791595 False CLP -1.81887e-08 0.872501 False CD4 -2.39266e-08 0.968438 False CD8 -2.37645e-08 0.971765 False"},{"location":"Analysis/Johnston_et_al_2019_%28Pain%29/4_S-LDSC/#cahoy-and-gtex-brain-data","title":"Cahoy and GTEx-Brain data","text":"<p>There were no significant cell types when analyzing the neurological cell types in the Cahoy dataset using S-LDSC:</p> Name Coefficient Coefficient_P_value Reject Null Neuron 2.57912e-09 0.0117611 False Oligodendrocyte 8.92979e-10 0.217456 False Astrocyte -8.78228e-10 0.816394 False <p>Similarly, there were no significant tissues when testing the GTEx brain tissues using S-LDSC:</p> Name Coefficient Coefficient_P_value Reject Null Brain_Cortex 2.57871e-09 0.00388189 False Brain_Anterior_cingulate_cortex_(BA24) 2.07682e-09 0.0103041 False Brain_Cerebellum 2.05731e-09 0.0341111 False Brain_Cerebellar_Hemisphere 1.69167e-09 0.0639314 False Brain_Frontal_Cortex_(BA9) 1.15989e-09 0.0914603 False Brain_Nucleus_accumbens_(basal_ganglia) 1.05259e-09 0.125348 False Brain_Caudate_(basal_ganglia) 6.12944e-10 0.263903 False Brain_Putamen_(basal_ganglia) 1.48494e-10 0.440862 False Brain_Amygdala -5.54761e-10 0.722775 False Brain_Hippocampus -1.10526e-09 0.887114 False Brain_Hypothalamus -1.22832e-09 0.904589 False Brain_Spinal_cord_(cervical_c-1) -1.70661e-09 0.97087 False Brain_Substantia_nigra -2.03971e-09 0.986552 False <p>In this S-LDSC analysis, tissue gene sets were defined as those genes specifically expressed in a tissue relative to other tissues. Thus, a dataset restricted to only brain tissues will exclude general brain genes which are highly expressed in multiple brain tissues. If these general genes are truly causal, excluding them can reduce the ability for S-LDSC to detect true effects. This likely explains why there were no brain tissues significant in this analysis, while several brain tissues were significant in the GTEx MAGMA analysis which instead controlled for average expression across all GTEx body tissues.</p> <ol> <li> <p>Hilary K Finucane, Yakir A Reshef, Verneri Anttila, Kamil Slowikowski, Alexander Gusev, Andrea Byrnes, Steven Gazal, Po-Ru Loh, Caleb Lareau, Noam Shoresh, and others. Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types. Nature genetics, 50(4):621\u2013629, 2018. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC5896795/.\u00a0\u21a9\u21a9</p> </li> <li> <p>Keira JA Johnston, Mark J Adams, Barbara I Nicholl, Joey Ward, Rona J Strawbridge, Amy Ferguson, Andrew M McIntosh, Mark ES Bailey, and Daniel J Smith. Genome-wide association study of multisite chronic pain in uk biobank. PLoS genetics, 15(6):e1008164, 2019. URL: https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1008164.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Keaton_et_al_2024%20%28DBP%29/MAGA-GTEx_DBP_Analysis/","title":"MAGMA-GTEx Analysis","text":""},{"location":"Analysis/Keaton_et_al_2024%20%28DBP%29/MAGA-GTEx_DBP_Analysis/#magma-gtex-analysis","title":"MAGMA-GTEx Analysis","text":"<p>I applied MAGMA to Keaton et al.'s<sup>1</sup> meta-GWAS of diastolic blood pressure, using the GTEx bulk RNAseq<sup>2</sup> as a reference.  The significant and top non-significant tissue types are plotted below.</p> <p></p> <p>Besides the expected arterial, heart-related tissues, and kidney-related tissues, a large number of reproductive tissues are found to be significant.  As discussed here, this may be due to common smooth-muscle transcriptional programs, or due to the influence of sex hormones on blood pressure.</p> <ol> <li> <p>Jacob M Keaton, Zoha Kamali, Tian Xie, Ahmad Vaez, Ariel Williams, Slavina B Goleva, Alireza Ani, Evangelos Evangelou, Jacklyn N Hellwege, Loic Yengo, and others. Genome-wide analysis in over 1 million individuals of european ancestry yields improved polygenic risk scores for blood pressure traits. Nature genetics, 56(5):778\u2013791, 2024. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC11096100/.\u00a0\u21a9</p> </li> <li> <p>GTEx Consortium. The gtex consortium atlas of genetic regulatory effects across human tissues. Science, 369(6509):1318\u20131330, 2020. URL: https://www.science.org/doi/full/10.1126/science.aaz1776.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Keaton_et_al_2024%20%28DBP%29/MAGMA-HBA/","title":"MAGMA HBA Analysis","text":""},{"location":"Analysis/Keaton_et_al_2024%20%28DBP%29/MAGMA-HBA/#magma-hba-analysis","title":"MAGMA HBA Analysis","text":"<p>I applied MAGMA to the Diastolic Blood Pressure GWAS of Keaton et al.<sup>1</sup>  using scRNAseq data from the Human Brain Atlas<sup>2</sup> as a reference.</p>"},{"location":"Analysis/Keaton_et_al_2024%20%28DBP%29/MAGMA-HBA/#results","title":"Results","text":"<p>The results are plotted below:</p> <p></p> <p>The x-axis corresponds to HBA cluster number<sup>2</sup>, while the y-axis corresponds to the \\(-\\log_{10}(p)\\) score produced by MAGMA.  Clusters are colored according to their HBA supercluster. The dotted line denotes the Bonferroni significance threshold.  I used a conditional analysis approach based on the one described in Wanatabe et al.<sup>3</sup> to identify independent clusters.  These 3 independent clusters are labeled in plot.  I have also listed them in the table below, together with some cluster-annotations from Duncan et al.<sup>4</sup>.</p> Retained_clusters P Supercluster Class auto-annotation Neurotransmitter auto-annotation Neuropeptide auto-annotation Subtype auto-annotation Transferred MTG Label Top three regions Top Enriched Genes Cluster20 7.291e-13 Vascular VSMC 0 AGT NAMPT UBL 0 Thalamus: 21.8%, Cerebral cortex: 13.7%, Medulla: 12.4%  MYL9, CARMN, ADIRF, FHL5, ACTA2, VIM, TBX18, MUSTN1, TBX2, NOTCH3 Cluster57 4.5477e-08 Astrocyte ASTRO 0 AGT 0 Astro Hippocampus: 66.8%, Basal forebrain: 25.3%, Cerebral cortex: 4.0% CD38, OBI1-AS1, FGFR3, AL627316.1, AC012405.1, AL137139.2, TNC, LINC02649, GLI3, SLC14A1 Cluster16 1.4648e-07 Vascular ENDO 0 NAMPT NUCB CAP Endo Cerebral cortex: 25.5%, Hippocampus: 17.8%, Midbrain: 8.4% CLDN5, MECOM, VWF, FLT1, ABCG2, FLI1, NOSTRIN, LINC02147, TGM2, CFH <p>The significance of Cluster20 and Cluster16, which are auto-annotated as vascular smooth muscle cells (VSMC) and endothelial cells (ENDO) is unsurprising: the importance of vascular cell types to blood pressure is well-known.  This finding probably does not reflect brain-specific physiology, but rather the general causal connection between vascular cells and blood pressure.</p> <p>In contrast, the significance of the astrocyte cell type does reflect brain-specific physiology.  As seen in the neuropeptide auto-annotation column in the table above, astrocytes are producers of angiotensinogen (AGT), precursor to angiotensin, which in turn is a key blood-pressure-modulating hormone.  There are numerous confirmatory experimental studies demonstrating the role of astrocytes in the control of blood pressure<sup>5</sup><sup>6</sup>.</p> <ol> <li> <p>Jacob M Keaton, Zoha Kamali, Tian Xie, Ahmad Vaez, Ariel Williams, Slavina B Goleva, Alireza Ani, Evangelos Evangelou, Jacklyn N Hellwege, Loic Yengo, and others. Genome-wide analysis in over 1 million individuals of european ancestry yields improved polygenic risk scores for blood pressure traits. Nature genetics, 56(5):778\u2013791, 2024. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC11096100/.\u00a0\u21a9</p> </li> <li> <p>Kimberly Siletti, Rebecca Hodge, Alejandro Mossi Albiach, Ka Wai Lee, Song-Lin Ding, Lijuan Hu, Peter L\u00f6nnerberg, Trygve Bakken, Tamara Casper, Michael Clark, and others. Transcriptomic diversity of cell types across the adult human brain. Science, 382(6667):eadd7046, 2023. URL: https://www.science.org/doi/abs/10.1126/science.add7046.\u00a0\u21a9\u21a9</p> </li> <li> <p>Kyoko Watanabe, Ma\u0161a Umi\u0107evi\u0107 Mirkov, Christiaan A de Leeuw, Martijn P van den Heuvel, and Danielle Posthuma. Genetic mapping of cell type specificity for complex traits. Nature communications, 10(1):3222, 2019. URL: https://www.nature.com/articles/s41467-019-11181-1.\u00a0\u21a9</p> </li> <li> <p>Laramie E Duncan, Tayden Li, Madeleine Salem, Will Li, Leili Mortazavi, Hazal Senturk, Naghmeh Shahverdizadeh, Sam Vesuna, Hanyang Shen, Jong Yoon, and others. Mapping the cellular etiology of schizophrenia and complex brain phenotypes. Nature Neuroscience, 28(2):248\u2013258, 2025. URL: https://www.nature.com/articles/s41593-024-01834-w.\u00a0\u21a9</p> </li> <li> <p>Javier E Stern, Sookjin Son, Vinicia C Biancardi, Hong Zheng, Neeru Sharma, and Kaushik P Patel. Astrocytes contribute to angiotensin ii stimulation of hypothalamic neuronal activity and sympathetic outflow. Hypertension, 68(6):1483\u20131493, 2016. URL: https://www.ahajournals.org/doi/full/10.1161/HYPERTENSIONAHA.116.07747.\u00a0\u21a9</p> </li> <li> <p>Himanshu Verma and Yumei Feng Earley. Emerging roles of astrocytes in autonomic control of blood pressure and hypertension. American Journal of Physiology-Cell Physiology, 329(6):C2013\u2013C2021, 2025. URL: https://journals.physiology.org/doi/full/10.1152/ajpcell.00587.2025.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Keaton_et_al_2024%20%28DBP%29/S-LDSC-DBP_Analysis/","title":"S-LDSC DBP Analysis","text":""},{"location":"Analysis/Keaton_et_al_2024%20%28DBP%29/S-LDSC-DBP_Analysis/#s-ldsc-dbp-analysis","title":"S-LDSC DBP Analysis","text":"<p>I applied Stratified Linkage Disequilibrium Score Regression (S-LDSC) to summary statistics from Keaton et al.'s meta-GWAS of blood pressure<sup>1</sup>.  Here I focused on diastolic blood pressure (DBP).</p>"},{"location":"Analysis/Keaton_et_al_2024%20%28DBP%29/S-LDSC-DBP_Analysis/#reference-data-sources","title":"Reference Data Sources","text":"<p>I used the standard reference datasets recommended and preprocessed by the authors of the S-LDSC method.</p> <ul> <li>The GTEx Project</li> <li>The Franke lab dataset</li> <li>The Roadmap Epigenetic Project</li> <li>The Corces et al. ATAC-seq dataset of 13 blood cell types.</li> <li>The ImmGen Project</li> <li>The Cahoy Mouse Central Nervous System Dataset</li> </ul>"},{"location":"Analysis/Keaton_et_al_2024%20%28DBP%29/S-LDSC-DBP_Analysis/#results","title":"Results","text":""},{"location":"Analysis/Keaton_et_al_2024%20%28DBP%29/S-LDSC-DBP_Analysis/#gtex-and-franke-lab-tissue-expression-data","title":"GTEx and Franke lab tissue expression data","text":"<p>Surprisingly, no cell types were significant using this reference dataset under a false discovery rate of 0.01.</p> <p>The cell types with the lowest p values are given below:</p> Name Coefficient Coefficient_P_value Reject Null A05.360.319.679.690.Myometrium 8.9244e-09 0.000945108 False A05.810.453.Kidney 8.58043e-09 0.00118444 False A05.360.319.679.Uterus 1.0349e-08 0.00173672 False Heart_Atrial_Appendage 6.83951e-09 0.0030787 False A03.556.875.875.Stomach 1.05254e-08 0.00345681 False Heart_Left_Ventricle 7.51812e-09 0.00353501 False Artery_Tibial 8.10254e-09 0.00454901 False A03.556.124.684.Intestine..Small 7.02051e-09 0.0076707 False <p>The failure to find a significant cell type despite the very large size of the Keaton et al. meta-GWAS is surprising.  I discuss this more below.</p> <p>Looking at the top non-significant cell types, the presence of arterial and heart-related cell types as contributors to blood pressure is unsurprising.  What is more surprising is the presence of reproductive tissue at low p values: myometrium and uterus.  There are at least two potential explanations:</p> <ol> <li>Siricilla et al.<sup>2</sup> state that \"RNA sequencing also revealed that the myometrial and vascular SMCs [smooth muscle cells] were more than 90% similar in their transcriptome\".  Thus, one plausible explanation is that S-LDSC is picking up on associations of blood pressure with transcriptional programs that are active in vascular smooth muscle, and these transcriptional programs are similar to those of myometrial smooth muscle.  This is biologically plausible: the importance of vascular smooth muscle to blood pressure is well known.  </li> <li>S-LDSC may be picking up on a sex hormone effect on blood pressure.  Blood pressure is well known to be sexually dimorphic. </li> </ol>"},{"location":"Analysis/Keaton_et_al_2024%20%28DBP%29/S-LDSC-DBP_Analysis/#roadmap-chromatin-data","title":"Roadmap Chromatin data","text":"<p>I next applied S-LDSC to the DBP GWAS using reference data generated by Finucane et al.<sup>3</sup> from the Roadmap Epigenetics Project.</p> <p>The following graph and table show the results:</p> Name Coefficient Coefficient_P_value Reject Null Right_Atrium__H3K4me1 1.35454e-07 1.40926e-07 True Right_Ventricle__H3K4me3 4.75769e-07 1.47786e-07 True Right_Atrium__H3K27ac 2.27715e-07 2.29194e-07 True Aorta__H3K27ac 1.73281e-07 1.31198e-06 True Left_Ventricle__H3K27ac 1.44065e-07 1.37252e-06 True Fetal_Kidney__DNase 2.02354e-07 3.77236e-06 True Right_Atrium__H3K4me3 4.0257e-07 4.91503e-06 True Left_Ventricle__H3K4me1 1.20989e-07 4.97588e-06 True Fetal_Lung__H3K4me1 1.0149e-07 6.22595e-06 True Lung__H3K27ac 1.73477e-07 7.23294e-06 True Fetal_Adrenal_Gland__H3K4me3 5.20417e-07 9.76305e-06 True Adipose_Nuclei__H3K4me1 9.18524e-08 9.86468e-06 True Colonic_Mucosa__H3K4me1 1.73559e-07 1.00295e-05 True Fetal_Stomach__DNase 2.56155e-07 1.10398e-05 True Lung__H3K4me1 1.51356e-07 1.18822e-05 True Right_Ventricle__H3K4me1 1.22013e-07 1.3042e-05 True Fetal_Stomach__H3K27ac 1.08069e-07 1.57813e-05 True Adipose_Nuclei__H3K27ac 8.34657e-08 3.44702e-05 True Aorta__H3K4me1 2.50867e-07 3.54758e-05 True Right_Ventricle__H3K27ac 1.70317e-07 5.12232e-05 True Ovary__H3K4me3 3.5071e-07 5.38539e-05 True Stomach_Smooth_Muscle__H3K4me3 2.211e-07 6.47863e-05 True Left_Ventricle__H3K4me3 4.85369e-07 7.96825e-05 True Fetal_Lung__DNase 1.62032e-07 8.89937e-05 True Fetal_Stomach__H3K4me3 4.01725e-07 9.7844e-05 True Fetal_Stomach__H3K4me1 7.13326e-08 0.00010137 True Duodenum_Smooth_Muscle__H3K4me1 1.41764e-07 0.00012871 True Fetal_Kidney__H3K9ac 4.31301e-07 0.000141293 True Skeletal_Muscle_Male__H3K4me1 7.46959e-08 0.000153192 True Fetal_Heart__H3K9ac 1.47374e-07 0.000180017 True Skeletal_Muscle_Male__H3K9ac 1.40079e-07 0.000193951 True Spleen__H3K4me1 1.03075e-07 0.000282654 True Aorta__H3K4me3 5.18442e-07 0.000283657 True Skeletal_Muscle_Male__H3K4me3 2.48575e-07 0.000312901 True Fetal_Muscle_Leg__H3K4me3 4.9079e-07 0.000318039 True Fetal_Adrenal_Gland__H3K36me3 9.39596e-08 0.0006646 True Small_Intestine__H3K27ac 1.42644e-07 0.000743932 True Fetal_Adrenal_Gland__H3K4me1 1.42379e-07 0.00108434 False Colonic_Mucosa__H3K4me3 2.74248e-07 0.00125257 False Psoas_Muscle__H3K4me3 2.92573e-07 0.00125564 False Fetal_Muscle_Leg__H3K27ac 8.85931e-08 0.00157292 False Fetal_Adrenal_Gland__H3K27ac 1.40667e-07 0.00162927 False Foreskin_Fibroblast_Primary_Cells_skin02__H3K4me3 1.35138e-07 0.00165603 False Ovary__H3K27ac 1.13578e-07 0.0017744 False Skeletal_Muscle_Female__H3K4me3 1.65886e-07 0.00189594 False Rectal_Smooth_Muscle__H3K4me3 3.193e-07 0.00209098 False Adipose_Nuclei__H3K9ac 1.45823e-07 0.00211634 False Fetal_Stomach__H3K36me3 4.77451e-08 0.00236169 False <p></p> <p>The contrast with the previous section is striking.  Whereas using gene expression reference data produced no significant cell types, using epigenetic reference data produces a wide range of significant cell types across multiple categories.</p> <p>The most significant cell types are heart, blood vessel, or kidney related, which is biologically plausible.</p>"},{"location":"Analysis/Keaton_et_al_2024%20%28DBP%29/S-LDSC-DBP_Analysis/#immgen-data","title":"ImmGen data","text":"<p>No cell types were significant from the ImmGen data, consistent with diastolic blood pressure not being a primarily immune condition.</p> Name Coefficient Coefficient_P_value Reject Null DN.SLN.CFA.d6.v2 9.12756e-09 0.000235668 False DN.SLN.v2 8.84128e-09 0.000593548 False BEC.SLN.OT 1.09635e-08 0.000885477 False BEC.SLN 1.02689e-08 0.00217312 False B.T1.Sp 7.36352e-09 0.00286334 False B.Mem.Sp.v2 8.22723e-09 0.00413403 False BEC.MLN 9.61318e-09 0.00437598 False B.FrE.BM 7.62703e-09 0.00465458 False Fi.MTS15+.Th 6.49713e-09 0.00470782 False St.31-38-44-.SLN 7.1822e-09 0.00508416 False LEC.SLN.CFA.d6.v2 6.93733e-09 0.00588418 False SC.LT34F.BM 9.02238e-09 0.00704497 False B.Fo.LN 7.54089e-09 0.00963479 False B.FrE.FL 7.46381e-09 0.014395 False SC.LTSL.FL 8.5851e-09 0.0175241 False T.4int8+.Th 4.59416e-09 0.0265722 False"},{"location":"Analysis/Keaton_et_al_2024%20%28DBP%29/S-LDSC-DBP_Analysis/#corces-et-al-atac-seq-data","title":"Corces et al. ATAC-seq data","text":"<p>Again, as expected, there were no significant hematopoietic-related cell types in the Corces ATAC-seq dataset.</p> Name Coefficient Coefficient_P_value Reject Null HSC 4.74203e-08 0.10657 False Erythro 6.07373e-08 0.109014 False MPP 3.33285e-08 0.173504 False CMP 2.92056e-08 0.200355 False MEP 3.31256e-08 0.24754 False CLP -1.67977e-09 0.516239 False LMPP -1.89293e-09 0.518985 False Bcell -6.86252e-09 0.579055 False GMP -7.54583e-09 0.592731 False NK -4.80328e-08 0.938961 False Mono -1.13595e-07 0.985252 False CD8 -1.15941e-07 0.996904 False CD4 -1.27186e-07 0.999554 False"},{"location":"Analysis/Keaton_et_al_2024%20%28DBP%29/S-LDSC-DBP_Analysis/#cahoy-and-gtex-brain-data","title":"Cahoy and GTEx-Brain data","text":"<p>There were no significant neurological cell types.  One might expect to find a significant neurological cell type, given how blood pressure is tightly controlled by the nervous system.  The failure to find this may reflect a limitation of the present reference dataset, or of the S-LDSC method itself.</p> Name Coefficient Coefficient_P_value Reject Null Neuron 3.72999e-09 0.067606 False Oligodendrocyte -2.21628e-09 0.815887 False Astrocyte -3.53281e-09 0.933489 False Name Coefficient Coefficient_P_value Reject Null Brain_Cerebellum 2.85144e-09 0.13386 False Brain_Cerebellar_Hemisphere 2.4761e-09 0.156651 False Brain_Putamen_(basal_ganglia) -2.62188e-11 0.504228 False Brain_Frontal_Cortex_(BA9) -1.16454e-10 0.523032 False Brain_Substantia_nigra -3.23304e-10 0.55205 False Brain_Amygdala -4.74749e-10 0.594472 False Brain_Anterior_cingulate_cortex_(BA24) -1.66269e-09 0.809254 False Brain_Caudate_(basal_ganglia) -2.25646e-09 0.819346 False Brain_Nucleus_accumbens_(basal_ganglia) -2.07221e-09 0.839876 False Brain_Hippocampus -2.18755e-09 0.855084 False Brain_Cortex -2.1191e-09 0.876525 False Brain_Hypothalamus -2.26791e-09 0.904322 False Brain_Spinal_cord_(cervical_c-1) -5.35052e-09 0.994565 False"},{"location":"Analysis/Keaton_et_al_2024%20%28DBP%29/S-LDSC-DBP_Analysis/#comment-on-contrast-between-gtexfranke-lab-dataset-and-roadmap-dataset-results","title":"Comment on contrast between GTEx/Franke Lab dataset and Roadmap dataset results","text":"<p>As noted above, it is striking that using the GTEx/Franke lab dataset produces no S-LDSC hits for diastolic blood pressure, while using the Roadmap epigenetics dataset produces many hits.</p> <p>This contrast implies that:</p> <ul> <li>A) The DBP GWAS identified signal in regions of the genome that are epigenetically differentially regulated in the heart, blood-vessels, kidney, etc. </li> <li>B) These GWAS-signal-enriched regions of the genome do not lie close to genes that  are strongly differentially expressed in the heart, blood-vessels, kidney, etc.</li> </ul> <p>I see two interpretations:</p> <ul> <li>The genetic regulation of blood pressure is sufficiently complex that the genetic variants involved in BP control cannot be identified by simply taking a 100-kb window around key genes (which is how the GTEx/Franke lab dataset is generated).  The use of epigenetics allows a much more precise identification of the key regulatory regions. </li> <li>Bulk RNAseq is too crude a tool:  the differences in bulk gene expression levels in the key cell types may be too small or too variable for S-LDSC to pick up.  It would be interesting to test this interpretation by using a single-cell RNAseq dataset with S-LDSC. </li> </ul>"},{"location":"Analysis/Keaton_et_al_2024%20%28DBP%29/S-LDSC-DBP_Analysis/#how-to-reproduce","title":"How to reproduce","text":"<p>Use this script to reproduce the above analysis.</p> <ol> <li> <p>Jacob M Keaton, Zoha Kamali, Tian Xie, Ahmad Vaez, Ariel Williams, Slavina B Goleva, Alireza Ani, Evangelos Evangelou, Jacklyn N Hellwege, Loic Yengo, and others. Genome-wide analysis in over 1 million individuals of european ancestry yields improved polygenic risk scores for blood pressure traits. Nature genetics, 56(5):778\u2013791, 2024. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC11096100/.\u00a0\u21a9</p> </li> <li> <p>Shajila Siricilla, Kelsi M Knapp, Jackson H Rogers, Courtney Berger, Elaine L Shelton, Dehui Mi, Paige Vinson, Jennifer Condon, Bibhash C Paria, Jeff Reese, and others. Comparative analysis of myometrial and vascular smooth muscle cells to determine optimal cells for use in drug discovery. Pharmacological research, 146:104268, 2019. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC6889064/.\u00a0\u21a9</p> </li> <li> <p>Hilary K Finucane, Yakir A Reshef, Verneri Anttila, Kamil Slowikowski, Alexander Gusev, Andrea Byrnes, Steven Gazal, Po-Ru Loh, Caleb Lareau, Noam Shoresh, and others. Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types. Nature genetics, 50(4):621\u2013629, 2018. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC5896795/.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Lee_et_al_2018_%28EDU%29/MAGMA-HBA/","title":"MAGMA HBA Analysis","text":""},{"location":"Analysis/Lee_et_al_2018_%28EDU%29/MAGMA-HBA/#magma-hba-analysis","title":"MAGMA HBA Analysis","text":"<p>I applied MAGMA to the educational attainment GWAS of Lee et al.<sup>1</sup> using scRNAseq data from the Human Brain Atlas as a reference.</p> <p>In the plot below, the x-axis corresponds to HBA cluster number<sup>2</sup>, while the y-axis corresponds to the \\(-\\log_{10}(p)\\) score produced by MAGMA.  Clusters are colored according to their HBA supercluster. The dotted line denotes the Bonferroni significance threshold.  I used a conditional analysis approach based on the one described in Wanatabe et al.<sup>3</sup> to identify independent clusters.  These independent clusters are labeled in plot.  </p> <p></p> <p>The independent clusters are listed in more detail in the table below:</p> Retained_clusters P Supercluster Class auto-annotation Neurotransmitter auto-annotation Neuropeptide auto-annotation Subtype auto-annotation Transferred MTG Label Top three regions Top Enriched Genes Cluster234 1.6139e-14 Eccentric medium spiny neuron NEUR GABA CCK CHGA CHGB NAMPT NUCB PENK SCG UBL VGF proSAAS MSN-D1 Amygdala: 75.9%, Cerebral cortex: 14.6%, Thalamus: 5.4% NPFFR2, ZNF736P9Y, GABRQ, LMNTD1, EYA2, AC012078.2, AC087516.2, PCDH11Y, LINC00354, NMBR Cluster146 1.0347e-12 Deep-layer intratelencephalic NEUR VGLUT1 VGLUT2 ADCYAP CBLN CCK CHGA CHGB NAMPT NUCB SCG UBL VGF proSAAS 0 Amygdala: 65.4%, Cerebral cortex: 33.1%, Hypothalamus: 0.8% CCN4, STPG2-AS1, AC105450.1, LINC00683, ATP10A, SNTG2, UCMA, TMEM244, FGF10, LINC02008 Cluster280 7.3007e-09 CGE interneuron NEUR GABA CCK CHGA CHGB CRH IGF NAMPT NUCB PNOC SCG UBL VIP proSAAS INT-VIP Cerebral cortex: 73.7%, Amygdala: 13.3%, Hippocampus: 7.8% AC006305.1, LINC01416, AL391832.4, LINC01905, SP8, DCN, CHRNB3, CXCL14, CHRNA7, CRH Cluster202 4.4341e-08 Hippocampal dentate gyrus NEUR VGLUT1 CBLN CHGB GRP NAMPT NUCB UBL proSAAS DG-GRAN Hippocampus: 100.0%, Cerebral cortex: 0.0%, Amygdala: 0.0% TTR, FOLR1, LINC01697, AC097528.1, AC097487.1, AL672167.1, NTF3, AL591518.1, TARID, AJ006995.1 Cluster133 1.1749e-07 Upper-layer intratelencephalic NEUR VGLUT1 VGLUT2 ADCYAP CBLN CCK CHGA CHGB NAMPT NUCB SCG UBL VGF proSAAS 0 Cerebral cortex: 100.0%, Basal forebrain: 0.0%, Hypothalamus: 0.0% LINC02388, AC112770.1, AC092448.1, AC126182.3, VIPR2, TRPC3, AC020637.1, IGFBP2, SLC38A11, LINC02296 Cluster404 2.9387e-07 Miscellaneous NEUR VGLUT1 CBLN CCK CHGA CHGB IGF NAMPT NUCB NXPH SCG SST TAC VGF proSAAS 0 Cerebral cortex: 94.4%, Amygdala: 2.5%, Basal forebrain: 1.2% AC016687.2, AC021134.1, LINC02378, LINC02263, LINC01915, CXCL14, AL033539.2, AC004862.1, AC073578.2, LINC02306 Cluster439 6.1461e-07 Midbrain-derived inhibitory NEUR GABA CBLN CHGA CHGB IGF NAMPT NPPC NUCB NXPH SCG UBL proSAAS 0 Midbrain: 52.8%, Thalamus: 31.3%, Pons: 10.7% DMBX1, OTX2-AS1, OTX2, LINC01210, GATA3, AC008163.1, AL161757.4, LINC02055, SOX14, PRSS12 <ol> <li> <p>James J Lee, Robbee Wedow, Aysu Okbay, Edward Kong, Omeed Maghzian, Meghan Zacher, Tuan Anh Nguyen-Viet, Peter Bowers, Julia Sidorenko, Richard Karlsson Linn\u00e9r, and others. Gene discovery and polygenic prediction from a genome-wide association study of educational attainment in 1.1 million individuals. Nature genetics, 50(8):1112\u20131121, 2018. URL: https://www.nature.com/articles/s41588-018-0147-3.\u00a0\u21a9</p> </li> <li> <p>Kimberly Siletti, Rebecca Hodge, Alejandro Mossi Albiach, Ka Wai Lee, Song-Lin Ding, Lijuan Hu, Peter L\u00f6nnerberg, Trygve Bakken, Tamara Casper, Michael Clark, and others. Transcriptomic diversity of cell types across the adult human brain. Science, 382(6667):eadd7046, 2023. URL: https://www.science.org/doi/abs/10.1126/science.add7046.\u00a0\u21a9</p> </li> <li> <p>Kyoko Watanabe, Ma\u0161a Umi\u0107evi\u0107 Mirkov, Christiaan A de Leeuw, Martijn P van den Heuvel, and Danielle Posthuma. Genetic mapping of cell type specificity for complex traits. Nature communications, 10(1):3222, 2019. URL: https://www.nature.com/articles/s41467-019-11181-1.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Lee_et_al_2018_%28EDU%29/MAGMA_EDU_analysis/","title":"MAGMA EDU Analysis","text":""},{"location":"Analysis/Lee_et_al_2018_%28EDU%29/MAGMA_EDU_analysis/#magma-edu-analysis","title":"MAGMA EDU Analysis","text":"<p>As another follow-up to the application of MAGMA to the DecodeME summary statistics, I applied MAGMA to the educational attainment study of Lee et al. (2018)<sup>1</sup>, to see if the results recapitulated known biology.</p>"},{"location":"Analysis/Lee_et_al_2018_%28EDU%29/MAGMA_EDU_analysis/#data","title":"Data","text":"<p>I used summary statistics from Lee et al.'s GWAS of Educational attainment.</p>"},{"location":"Analysis/Lee_et_al_2018_%28EDU%29/MAGMA_EDU_analysis/#results","title":"Results","text":"<p>As before, I ran the gene analysis set, followed by the gene property analysis step.  In the gene property analysis step, I used tissue-specific RNAseq data from GTEx<sup>2</sup> to try to link genes associated with educational attainment to specific tissues.  The results are shown in the bar plot below:</p> <p></p> <p>The significant tissues identified by MAGMA lie exclusively in the brain, consistent with leading theories of the biology of the genetic component of educational attainment.</p>"},{"location":"Analysis/Lee_et_al_2018_%28EDU%29/MAGMA_EDU_analysis/#how-to-reproduce-this","title":"How to Reproduce this","text":"<p>To reproduce this analysis run the Educational Attainment GWAS Analysis Script.</p> <ol> <li> <p>James J Lee, Robbee Wedow, Aysu Okbay, Edward Kong, Omeed Maghzian, Meghan Zacher, Tuan Anh Nguyen-Viet, Peter Bowers, Julia Sidorenko, Richard Karlsson Linn\u00e9r, and others. Gene discovery and polygenic prediction from a genome-wide association study of educational attainment in 1.1 million individuals. Nature genetics, 50(8):1112\u20131121, 2018. URL: https://www.nature.com/articles/s41588-018-0147-3.\u00a0\u21a9</p> </li> <li> <p>GTEx Consortium. The gtex consortium atlas of genetic regulatory effects across human tissues. Science, 369(6509):1318\u20131330, 2020. URL: https://www.science.org/doi/full/10.1126/science.aaz1776.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Lee_et_al_2018_%28EDU%29/S-LDSC_EDU_Analysis/","title":"S-LDSC EDU Analysis","text":""},{"location":"Analysis/Lee_et_al_2018_%28EDU%29/S-LDSC_EDU_Analysis/#s-ldsc-edu-analysis","title":"S-LDSC EDU Analysis","text":"<p>I applied Stratified Linkage Disequilibrium Score Regression<sup>1</sup> (S-LDSC) to summary statistics from a GWAS of educational attainment by Lee et al.<sup>2</sup>. The goal was to identify possible key tissue and cell types affecting educational attainment levels, and in so doing learn about the strengths and weaknesses of the S-LDSC method.</p>"},{"location":"Analysis/Lee_et_al_2018_%28EDU%29/S-LDSC_EDU_Analysis/#reference-data-sources","title":"Reference Data Sources","text":"<p>I used the standard reference datasets recommended and preprocessed by the authors of the S-LDSC method. </p> <ul> <li>The GTEx Project</li> <li>The Franke lab dataset</li> <li>The Roadmap Epigenetic Project</li> <li>The Corces et al. ATAC-seq dataset of 13 blood cell types.</li> <li>The ImmGen Project</li> <li>The Cahoy Mouse Central Nervous System Dataset</li> </ul>"},{"location":"Analysis/Lee_et_al_2018_%28EDU%29/S-LDSC_EDU_Analysis/#results","title":"Results","text":""},{"location":"Analysis/Lee_et_al_2018_%28EDU%29/S-LDSC_EDU_Analysis/#gtex-and-franke-lab-tissue-expression-data","title":"GTEx and Franke lab tissue expression data","text":"<p>The graph below shows the coefficient p values for the cell types in the GTEx/Franke Lab dataset when S-LDSC is applied to the EDU GWAS.  Cell types are grouped into categories according to the same scheme used in the original S-LDSC paper<sup>1</sup>.</p> <p></p> <p>We can see that at a false discovery rate of 0.01, the significant tissues are exclusively in the central nervous system.</p> <p>Here is a more detailed look at the top cells/tissues:</p> Name Coefficient Coefficient_P_value Reject Null A08.186.211.730.885.287.500.Cerebral.Cortex 1.7625e-08 1.58411e-15 True A08.186.211.464.405.Hippocampus 1.62863e-08 4.5446e-15 True A08.186.211.464.710.225.Entorhinal.Cortex 1.68218e-08 6.89181e-15 True A08.186.211.464.Limbic.System 1.67997e-08 3.90973e-14 True A08.186.211.Brain 1.5237e-08 1.38319e-11 True Brain_Frontal_Cortex_(BA9) 1.56443e-08 1.45016e-11 True A08.186.211.730.885.287.500.571.735.Visual.Cortex 1.42092e-08 4.7507e-11 True A08.186.211.730.885.287.500.270.Frontal.Lobe 1.51812e-08 1.03359e-10 True Brain_Cortex 1.5203e-08 2.22635e-10 True Brain_Anterior_cingulate_cortex_(BA24) 1.3785e-08 4.33289e-09 True A08.186.211.132.810.428.200.Cerebellum 1.14043e-08 1.34142e-08 True A08.186.211.730.885.287.500.670.Parietal.Lobe 1.26008e-08 1.82969e-08 True A08.186.211.865.428.Metencephalon 1.10862e-08 5.21843e-08 True Brain_Nucleus_accumbens_(basal_ganglia) 1.27456e-08 5.76169e-08 True A08.186.211.132.Brain.Stem 1.15633e-08 6.33204e-08 True Brain_Hippocampus 1.20156e-08 2.71743e-07 True Brain_Amygdala 1.18184e-08 5.00604e-07 True Brain_Hypothalamus 1.12805e-08 7.01388e-07 True A11.872.653.Neural.Stem.Cells 1.17742e-08 2.32653e-06 True Brain_Caudate_(basal_ganglia) 1.03365e-08 4.98279e-06 True Brain_Putamen_(basal_ganglia) 1.04866e-08 6.18148e-06 True Brain_Substantia_nigra 1.00114e-08 1.14614e-05 True Brain_Cerebellum 8.55503e-09 1.65288e-05 True A08.186.211.730.317.Diencephalon 8.06071e-09 3.4515e-05 True Brain_Cerebellar_Hemisphere 8.30636e-09 4.29508e-05 True A09.371.729.Retina 8.27211e-09 5.85128e-05 True A08.186.211.730.885.287.249.Basal.Ganglia 8.17562e-09 0.000179368 True A08.186.211.653.Mesencephalon 7.99799e-09 0.000264251 True A08.186.211.730.317.357.Hypothalamus 9.02518e-09 0.000393007 True A08.186.211.730.317.357.352.435.Hypothalamo.Hypophyseal.System 8.70071e-09 0.000577608 True Brain_Spinal_cord_(cervical_c-1) 6.92728e-09 0.00131103 True A15.145.Blood 9.14095e-09 0.00198242 False A15.145.229.637.555.567.569.200.CD4.Positive.T.Lymphocytes 6.37535e-09 0.0049859 False A11.118.637.555.567.562.440.Precursor.Cells..B.Lymphoid 5.41722e-09 0.0309822 False A15.145.229.637.555.Leukocytes..Mononuclear 4.94614e-09 0.0312297 False A11.118.637.Leukocytes 4.90028e-09 0.0324434 False A08.186.211.730.885.287.249.487.Corpus.Striatum 3.80127e-09 0.0324954 False A15.378.316.580.Monocytes 5.15141e-09 0.035767 False <p>Of note is that these results are not very specific: basically all CNS regions are deemed significant.  This non-specificity could be a consequence of the details of the definition of cell-type-specific genes used to create the GTEx/Franke lab datasets.  In particular, when S-LDSC is applied to the standard GTEx and Franke lab data, brain regions are not used as controls for one another.  For example, when the regression for the Cerebral Cortex is run, no other brain regions are used as controls.  This prevents us from assessing whether one brain region is better at explaining the GWAS data than another, and promotes non-specific results.</p>"},{"location":"Analysis/Lee_et_al_2018_%28EDU%29/S-LDSC_EDU_Analysis/#roadmap-chromatin-data","title":"Roadmap Chromatin data","text":"<p>I next applied S-LDSC to the educational attainment GWAS using reference data generated by Finucane et al.<sup>1</sup> from the Roadmap Epigenetics Project.</p> <p>The following graph and table show the results:</p> <p></p> Name Coefficient Coefficient_P_value Reject Null Fetal_Brain_Female__H3K4me1 3.3967e-07 1.48993e-29 True Fetal_Brain_Male__DNase 4.52644e-07 1.46684e-25 True Fetal_Brain_Female__DNase 4.54212e-07 8.02637e-25 True Fetal_Brain_Male__H3K4me1 1.89696e-07 1.13027e-19 True Fetal_Brain_Female__H3K4me3 6.47189e-07 2.23976e-15 True Brain_Dorsolateral_Prefrontal_Cortex__H3K27ac 1.90671e-07 8.73872e-15 True Brain_Germinal_Matrix__H3K4me3 5.93144e-07 1.71767e-13 True Brain_Inferior_Temporal_Lobe__H3K27ac 1.2265e-07 1.02115e-12 True Ganglion_Eminence_derived_primary_cultured_neurospheres__H3K4me3 4.56066e-07 5.04233e-12 True Brain_Angular_Gyrus__H3K27ac 1.41502e-07 6.34447e-11 True Brain_Germinal_Matrix__H3K4me1 2.78071e-07 6.92384e-11 True Brain_Anterior_Caudate__H3K27ac 1.20617e-07 4.10239e-10 True Brain_Dorsolateral_Prefrontal_Cortex__H3K4me3 5.32015e-07 4.71654e-10 True Brain_Dorsolateral_Prefrontal_Cortex__H3K9ac 4.49235e-07 1.12064e-09 True Cortex_derived_primary_cultured_neurospheres__H3K4me3 5.92022e-07 3.65116e-09 True Brain_Dorsolateral_Prefrontal_Cortex__H3K4me1 1.92453e-07 6.29012e-09 True Fetal_Brain_Female__H3K36me3 1.35901e-07 1.00633e-08 True Brain_Angular_Gyrus__H3K4me3 4.09788e-07 1.86578e-08 True Brain_Anterior_Caudate__H3K4me3 3.15918e-07 3.9166e-08 True Brain_Angular_Gyrus__H3K9ac 2.47642e-07 4.53828e-08 True Ganglion_Eminence_derived_primary_cultured_neurospheres__H3K4me1 1.55274e-07 5.48653e-08 True Brain_Inferior_Temporal_Lobe__H3K4me3 3.60108e-07 6.96504e-08 True Brain_Anterior_Caudate__H3K4me1 1.21433e-07 2.15232e-07 True Cortex_derived_primary_cultured_neurospheres__H3K4me1 1.0066e-07 2.91758e-07 True Brain_Anterior_Caudate__H3K9ac 2.20957e-07 6.50058e-07 True Brain_Cingulate_Gyrus__H3K4me3 3.26012e-07 1.20709e-06 True Brain_Germinal_Matrix__H3K36me3 1.46017e-07 1.23627e-06 True Brain_Cingulate_Gyrus__H3K9ac 2.32592e-07 2.80626e-06 True Brain_Inferior_Temporal_Lobe__H3K9ac 1.75209e-07 4.73495e-06 True Brain_Cingulate_Gyrus__H3K27ac 8.32185e-08 6.05097e-06 True Brain_Angular_Gyrus__H3K4me1 1.02775e-07 7.61444e-06 True Brain_Dorsolateral_Prefrontal_Cortex__H3K36me3 1.32893e-07 3.58725e-05 True Brain_Cingulate_Gyrus__H3K4me1 8.40684e-08 4.28436e-05 True skeletal_muscle_ENTEX__H3K4me1 3.55999e-08 6.17961e-05 True Brain_Hippocampus_Middle__H3K27ac 6.5831e-08 6.30559e-05 True Brain_Hippocampus_Middle__H3K4me3 1.87842e-07 0.000196819 True Brain_Hippocampus_Middle__H3K4me1 5.8769e-08 0.000200932 True Brain_Inferior_Temporal_Lobe__H3K4me1 9.74402e-08 0.000227256 True Brain_Inferior_Temporal_Lobe__H3K36me3 9.70243e-08 0.000449288 True Pancreatic_Islets__H3K27ac 1.52361e-07 0.00230255 False Brain_Angular_Gyrus__H3K36me3 1.0321e-07 0.00275453 False Brain_Anterior_Caudate__H3K36me3 7.73984e-08 0.00310657 False Esoph-GJ_ENTEX__H3K27ac 4.55769e-08 0.00313903 False Colon-Sigm_ENTEX__H3K36me3 6.8338e-08 0.00367321 False Esoph-Muscularis_ENTEX__H3K4me3 1.53155e-07 0.00454078 False Foreskin_Fibroblast_Primary_Cells_skin02__H3K4me3 6.39511e-08 0.00565107 False Esoph-Muscularis_ENTEX__H3K27ac 4.31421e-08 0.00586156 False Spleen__H3K36me3 4.78941e-08 0.00599588 False Esoph-GJ_ENTEX__H3K4me3 1.3337e-07 0.00875963 False Brain_Substantia_Nigra__H3K4me1 4.42562e-08 0.0114508 False Brain_Cingulate_Gyrus__H3K36me3 6.88419e-08 0.0126657 False Esoph-Mucosa_ENTEX__H3K36me3 5.47652e-08 0.0216056 False Fetal_Brain_Male__H3K4me3 4.21314e-07 0.0237894 False Colon-Sigm_ENTEX__H3K27ac 3.46076e-08 0.0241773 False Brain_Substantia_Nigra__H3K4me3 1.31624e-07 0.0253406 False Heart-LV_ENTEX__H3K4me1 4.07981e-08 0.0254759 False Nerve-Tibial_ENTEX__H3K4me3 1.51766e-07 0.026091 False Brain_Hippocampus_Middle__H3K36me3 5.12254e-08 0.0268535 False <p>Consistent with the GTEX/Franke results, here many regions of the brain are deemed significant.  Because the Roadmap epigenetics dataset is entirely separate from the GTEx gene expression dataset, these results can be seen as an independent piece of evidence for the significance of the brain to educational attainment.</p> <p>Similarly to the GTEx/Franke case, the non-specificity of the brain results may also be a consequence of the lack of brain controls in the regressions used to define cell-type-specific regions.</p> <p>The presence of a single significant skeletal muscle cell type is unexpected.  It is unclear if this is a real effect or an artifact.</p>"},{"location":"Analysis/Lee_et_al_2018_%28EDU%29/S-LDSC_EDU_Analysis/#immgen-data","title":"ImmGen data","text":"<p>The next step is to use the S-LDSC reference data derived from the ImmGen project.  There are no significant hits.  The top non-significant results are:</p> Name Coefficient Coefficient_P_value Reject Null Tgd.vg2+24ahi.Th 8.06392e-09 0.00297249 False NKT.4+.Sp 7.13596e-09 0.00592045 False T.8Eff.Sp.OT1.d15.LisOva 5.48845e-09 0.0103446 False T.DPsm.Th 6.48315e-09 0.0113907 False B.FrE.BM 5.14779e-09 0.0116146 False B.T2.Sp 5.60899e-09 0.0119636 False CD8.1h.LN 6.08251e-09 0.0120099 False NK.Sp 5.82532e-09 0.0122281 False"},{"location":"Analysis/Lee_et_al_2018_%28EDU%29/S-LDSC_EDU_Analysis/#corces-et-al-atac-seq-data","title":"Corces et al. ATAC-seq data","text":"<p>The next step is to use the Corces et al. dataset from ATAC-seq applied to blood cells.</p> <p>Again, there were no significant results.  The top non-significant results are:</p> Name Coefficient Coefficient_P_value Reject Null Erythro 4.19012e-08 0.148498 False MEP 2.21546e-08 0.285599 False Bcell 1.09094e-08 0.360172 False MPP 7.66168e-09 0.402965 False CMP 5.85289e-09 0.426029 False CLP 6.38071e-09 0.431636 False HSC -1.82334e-09 0.521691 False GMP -1.83842e-08 0.735746 False"},{"location":"Analysis/Lee_et_al_2018_%28EDU%29/S-LDSC_EDU_Analysis/#cahoy-and-gtex-brain-data","title":"Cahoy and GTEx-Brain data","text":"<p>The next two reference datasets pertain to the nervous system.</p> <p>The Cahoy CNS datasets points to neurons as the key site of activity driving educational attainment, as opposed to oligodendrocytes or astrocytes:</p> Name Coefficient Coefficient_P_value Reject Null Neuron 1.23199e-08 4.25819e-08 True Oligodendrocyte -2.70708e-09 0.862452 False Astrocyte -2.84009e-09 0.902723 False <p>Using the GTEx-brain dataset points to the cortex as the key region of the brain for educational attainment:</p> Name Coefficient Coefficient_P_value Reject Null Brain_Frontal_Cortex_(BA9) 9.64677e-09 6.32016e-07 True Brain_Cortex 9.55629e-09 7.00572e-06 True Brain_Anterior_cingulate_cortex_(BA24) 6.67343e-09 0.000201072 True Brain_Cerebellar_Hemisphere 4.16361e-09 0.02365 False Brain_Nucleus_accumbens_(basal_ganglia) 4.34605e-09 0.0319243 False Brain_Cerebellum 2.81524e-09 0.107455 False Brain_Putamen_(basal_ganglia) -2.16168e-10 0.535069 False Brain_Amygdala -1.67611e-09 0.828353 False <p>The strong contrast between these results (which are highly specific to the cortex) and the results from the general GTEx dataset  above (which mark all brain regions) is explained in the Methods section of the Finucane et al. paper<sup>1</sup>. In the GTEx brain S-LDSC reference dataset, a gene is associated with a particular brain region only if that gene is a strongly significant predictor in a regression  aimed at distinguishing the given brain region from all other brain regions. Thus we should expect the GTEx brain dataset to be more informative than the general GTEx dataset when we aim to determine the specific brain region driving the educational attainment phenotype.</p>"},{"location":"Analysis/Lee_et_al_2018_%28EDU%29/S-LDSC_EDU_Analysis/#reproducing-analysis","title":"Reproducing Analysis","text":"<p>To reproduce this analysis, run the script here.</p> <ol> <li> <p>Hilary K Finucane, Yakir A Reshef, Verneri Anttila, Kamil Slowikowski, Alexander Gusev, Andrea Byrnes, Steven Gazal, Po-Ru Loh, Caleb Lareau, Noam Shoresh, and others. Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types. Nature genetics, 50(4):621\u2013629, 2018. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC5896795/.\u00a0\u21a9\u21a9\u21a9\u21a9</p> </li> <li> <p>James J Lee, Robbee Wedow, Aysu Okbay, Edward Kong, Omeed Maghzian, Meghan Zacher, Tuan Anh Nguyen-Viet, Peter Bowers, Julia Sidorenko, Richard Karlsson Linn\u00e9r, and others. Gene discovery and polygenic prediction from a genome-wide association study of educational attainment in 1.1 million individuals. Nature genetics, 50(8):1112\u20131121, 2018. URL: https://www.nature.com/articles/s41588-018-0147-3.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Liu_et_al_2023_%28IBD%29/CIS-MR_IBD_Analysis/","title":"MR with cis-pQTLs","text":""},{"location":"Analysis/Liu_et_al_2023_%28IBD%29/CIS-MR_IBD_Analysis/#mr-with-cis-pqtls","title":"MR with cis-pQTLs","text":"<p>I applied Mendelian Randomization to the European-ancestry subset of the IBD GWAS of Liu et al.<sup>1</sup>, using cis-pQTLs from the UK Biobank Pharma Proteomics Project<sup>2</sup> as instruments.</p> <p>Since each protein in the UKBB PPP has at most one cis-pQTL, I used the Wald Ratio to estimate the causal effects of the proteins on IBD.</p> <p>I used the R package <code>TwoSampleMR</code>.</p>"},{"location":"Analysis/Liu_et_al_2023_%28IBD%29/CIS-MR_IBD_Analysis/#results","title":"Results","text":"<p>The plot below summarizes the effect sizes and standard errors of the Bonferroni-significant proteins found by MR analysis with cis-pQTLs.  Effect sizes are expressed in IBD liability units per inverse-normal rank-transformed protein abundance unit.</p> <p></p> <p>Mostly, these results make sense.  For instance:</p> <ul> <li>IL-12 is a cytokine linked to autoimmunity. It makes sense that increased levels of both the heterodimeric Il-12 (IL12A_IL12B) and the B sub-unit (IL12B) increase risk of IBD.</li> <li>IL-10 is a powerful anti-inflammatory cytokine. It makes sense that increased levels of IL-10 reduce risk of IBD.</li> </ul> <p>However, the meaning of some of these results are less clear.  For instance </p> <ul> <li>CEP43 has been found in mouse models to be important to gut epithelial renewal<sup>3</sup>.  But if this is the case, why would higher levels of CEP43 increase rather than reduce liability to inflammatory bowel disease?  One possibility is that higher plasma levels of CEP43 may reciprocally correspond to lower gut levels, but this is speculation.  Overall, the mechanism of action for this protein is unclear.</li> <li>IL1R2 is an anti-inflammatory decoy receptor, so it is unclear why higher levels would be associated with a greater IBD liability.</li> </ul> <p>The table below lists all significant plasma proteins together with their UniProt descriptions.</p> Assay Target b pval Function [CC] IL10 -1.40027 4.2399e-31 FUNCTION: Major immune regulatory cytokine that acts on many cells of the immune system where it has profound anti-inflammatory functions, limiting excessive tissue disruption caused by inflammation. Mechanistically, IL10 binds to its heterotetrameric receptor comprising IL10RA and IL10RB leading to JAK1 and STAT2-mediated phosphorylation of STAT3 (PubMed:16982608). In turn, STAT3 translocates to the nucleus where it drives expression of anti-inflammatory mediators (PubMed:18025162). Targets antigen-presenting cells (APCs) such as macrophages and monocytes and inhibits their release of pro-inflammatory cytokines including granulocyte-macrophage colony-stimulating factor /GM-CSF, granulocyte colony-stimulating factor/G-CSF, IL-1 alpha, IL-1 beta, IL-6, IL-8 and TNF-alpha (PubMed:11564774, PubMed:1940799, PubMed:7512027). Also interferes with antigen presentation by reducing the expression of MHC-class II and co-stimulatory molecules, thereby inhibiting their ability to induce T cell activation (PubMed:8144879). In addition, controls the inflammatory response of macrophages by reprogramming essential metabolic pathways including mTOR signaling (By similarity). {ECO:0000250 EBI3_IL27 -1.3326 1.44198e-11 FUNCTION: Associates with EBI3 to form the IL-27 interleukin, a heterodimeric cytokine which functions in innate immunity. IL-27 has pro- and anti-inflammatory properties, that can regulate T-helper cell development, suppress T-cell proliferation, stimulate cytotoxic T-cell activity, induce isotype switching in B-cells, and that has diverse effects on innate immune cells. Among its target cells are CD4 T-helper cells which can differentiate in type 1 effector cells (TH1), type 2 effector cells (TH2) and IL17 producing helper T-cells (TH17). It drives rapid clonal expansion of naive but not memory CD4 T-cells. It also strongly synergizes with IL-12 to trigger interferon-gamma/IFN-gamma production of naive CD4 T-cells, binds to the cytokine receptor WSX-1/TCCR which appears to be required but not sufficient for IL-27-mediated signal transduction. IL-27 potentiate the early phase of TH1 response and suppress TH2 and TH17 differentiation. It induces the differentiation of TH1 cells via two distinct pathways, p38 MAPK/TBX21- and ICAM1/ITGAL/ERK-dependent pathways. It also induces STAT1, STAT3, STAT4 and STAT5 phosphorylation and activates TBX21/T-Bet via STAT1 with resulting IL12RB2 up-regulation, an event crucial to TH1 cell commitment. It suppresses the expression of GATA3, the inhibitor TH1 cells development. In CD8 T-cells, it activates STATs as well as GZMB. IL-27 reveals to be a potent inhibitor of TH17 cell development and of IL-17 production. Indeed IL27 alone is also able to inhibit the production of IL17 by CD4 and CD8 T-cells. While IL-27 suppressed the development of pro-inflammatory Th17 cells via STAT1, it inhibits the development of anti-inflammatory inducible regulatory T-cells, iTreg, independently of STAT1. IL-27 also has an effect on cytokine production, it suppresses pro-inflammatory cytokine production such as IL2, IL4, IL5 and IL6 and activates suppressors of cytokine signaling such as SOCS1 and SOCS3. Apart from suppression of cytokine production, IL-27 also antagonizes the effects of some cytokines such as IL6 through direct effects on T-cells. Another important role of IL-27 is its antitumor activity as well as its antiangiogenic activity with activation of production of antiangiogenic chemokines such as IP-10/CXCL10 and MIG/CXCL9. In vein endothelial cells, it induces IRF1/interferon regulatory factor 1 and increase the expression of MHC class II transactivator/CIITA with resulting up-regulation of major histocompatibility complex class II. IL-27 also demonstrates antiviral activity with inhibitory properties on HIV-1 replication. {ECO:0000269 SCAMP3 -0.9715 5.21962e-08 FUNCTION: Functions in post-Golgi recycling pathways. Acts as a recycling carrier to the cell surface. CSF3 -0.923493 1.72941e-08 FUNCTION: Granulocyte/macrophage colony-stimulating factors are cytokines that act in hematopoiesis by controlling the production, differentiation, and function of 2 related white cell populations of the blood, the granulocytes and the monocytes-macrophages. This CSF induces granulocytes. SHISA5 -0.5838 1.36452e-07 FUNCTION: Can induce apoptosis in a caspase-dependent manner and plays a role in p53/TP53-dependent apoptosis. {ECO:0000269 TNFRSF14 -0.575475 1.90887e-07 FUNCTION: Receptor for four distinct ligands: The TNF superfamily members TNFSF14/LIGHT and homotrimeric LTA/lymphotoxin-alpha and the immunoglobulin superfamily members BTLA and CD160, altogether defining a complex stimulatory and inhibitory signaling network (PubMed:10754304, PubMed:18193050, PubMed:23761635, PubMed:9462508). Signals via the TRAF2-TRAF3 E3 ligase pathway to promote immune cell survival and differentiation (PubMed:19915044, PubMed:9153189, PubMed:9162022). Participates in bidirectional cell-cell contact signaling between antigen presenting cells and lymphocytes. In response to ligation of TNFSF14/LIGHT, delivers costimulatory signals to T cells, promoting cell proliferation and effector functions (PubMed:10754304). Interacts with CD160 on NK cells, enhancing IFNG production and anti-tumor immune response (PubMed:23761635). In the context of bacterial infection, acts as a signaling receptor on epithelial cells for CD160 from intraepithelial lymphocytes, triggering the production of antimicrobial proteins and pro-inflammatory cytokines (By similarity). Upon binding to CD160 on activated CD4+ T cells, down-regulates CD28 costimulatory signaling, restricting memory and alloantigen-specific immune response (PubMed:18193050). May interact in cis (on the same cell) or in trans (on other cells) with BTLA (By similarity) (PubMed:19915044). In cis interactions, appears to play an immune regulatory role inhibiting in trans interactions in naive T cells to maintain a resting state. In trans interactions, can predominate during adaptive immune response to provide survival signals to effector T cells (By similarity) (PubMed:19915044). {ECO:0000250 PARK7 -0.572845 6.58981e-12 FUNCTION: Multifunctional protein with controversial molecular function which plays an important role in cell protection against oxidative stress and cell death acting as oxidative stress sensor and redox-sensitive chaperone and protease (PubMed:12796482, PubMed:17015834, PubMed:18711745, PubMed:19229105, PubMed:20304780, PubMed:25416785, PubMed:26995087, PubMed:28993701). It is involved in neuroprotective mechanisms like the stabilization of NFE2L2 and PINK1 proteins, male fertility as a positive regulator of androgen signaling pathway as well as cell growth and transformation through, for instance, the modulation of NF-kappa-B signaling pathway (PubMed:12612053, PubMed:14749723, PubMed:15502874, PubMed:17015834, PubMed:18711745, PubMed:21097510). Has been described as a protein and nucleotide deglycase that catalyzes the deglycation of the Maillard adducts formed between amino groups of proteins or nucleotides and reactive carbonyl groups of glyoxals (PubMed:25416785, PubMed:28596309). But this function is rebuted by other works (PubMed:27903648, PubMed:31653696). As a protein deglycase, repairs methylglyoxal- and glyoxal-glycated proteins, and releases repaired proteins and lactate or glycolate, respectively. Deglycates cysteine, arginine and lysine residues in proteins, and thus reactivates these proteins by reversing glycation by glyoxals. Acts on early glycation intermediates (hemithioacetals and aminocarbinols), preventing the formation of advanced glycation endproducts (AGE) that cause irreversible damage (PubMed:25416785, PubMed:26995087, PubMed:28013050). Also functions as a nucleotide deglycase able to repair glycated guanine in the free nucleotide pool (GTP, GDP, GMP, dGTP) and in DNA and RNA. Is thus involved in a major nucleotide repair system named guanine glycation repair (GG repair), dedicated to reversing methylglyoxal and glyoxal damage via nucleotide sanitization and direct nucleic acid repair (PubMed:28596309). Protects histones from adduction by methylglyoxal, controls the levels of methylglyoxal-derived argininine modifications on chromatin (PubMed:30150385). Able to remove the glycations and restore histone 3, histone glycation disrupts both local and global chromatin architecture by altering histone-DNA interactions as well as histone acetylation and ubiquitination levels (PubMed:30150385, PubMed:30894531). Displays a very low glyoxalase activity that may reflect its deglycase activity (PubMed:22523093, PubMed:28993701, PubMed:31653696). Eliminates hydrogen peroxide and protects cells against hydrogen peroxide-induced cell death (PubMed:16390825). Required for correct mitochondrial morphology and function as well as for autophagy of dysfunctional mitochondria (PubMed:16632486, PubMed:19229105). Plays a role in regulating expression or stability of the mitochondrial uncoupling proteins SLC25A14 and SLC25A27 in dopaminergic neurons of the substantia nigra pars compacta and attenuates the oxidative stress induced by calcium entry into the neurons via L-type channels during pacemaking (PubMed:18711745). Regulates astrocyte inflammatory responses, may modulate lipid rafts-dependent endocytosis in astrocytes and neuronal cells (PubMed:23847046). In pancreatic islets, involved in the maintenance of mitochondrial reactive oxygen species (ROS) levels and glucose homeostasis in an age- and diet dependent manner. Protects pancreatic beta cells from cell death induced by inflammatory and cytotoxic setting (By similarity). Binds to a number of mRNAs containing multiple copies of GG or CC motifs and partially inhibits their translation but dissociates following oxidative stress (PubMed:18626009). Metal-binding protein able to bind copper as well as toxic mercury ions, enhances the cell protection mechanism against induced metal toxicity (PubMed:23792957). In macrophages, interacts with the NADPH oxidase subunit NCF1 to direct NADPH oxidase-dependent ROS production, and protects against sepsis (By similarity). {ECO:0000250 ATP6V1G2 -0.422545 5.39136e-07 FUNCTION: Subunit of the V1 complex of vacuolar(H+)-ATPase (V-ATPase), a multisubunit enzyme composed of a peripheral complex (V1) that hydrolyzes ATP and a membrane integral complex (V0) that translocates protons. V-ATPase is responsible for acidifying and maintaining the pH of intracellular compartments and in some cell types, is targeted to the plasma membrane, where it is responsible for acidifying the extracellular environment. {ECO:0000250 TNFRSF6B -0.387361 3.73556e-18 FUNCTION: Decoy receptor that can neutralize the cytotoxic ligands TNFS14/LIGHT, TNFSF15 and TNFSF6/FASL. Protects against apoptosis. {ECO:0000269 ENTR1 -0.264038 2.04965e-06 FUNCTION: Endosome-associated protein that plays a role in membrane receptor sorting, cytokinesis and ciliogenesis (PubMed:23108400, PubMed:25278552, PubMed:27767179). Involved in the endosome-to-plasma membrane trafficking and recycling of SNX27-retromer-dependent cargo proteins, such as GLUT1 (PubMed:25278552). Involved in the regulation of cytokinesis; the function may involve PTPN13 and GIT1 (PubMed:23108400). Plays a role in the formation of cilia (PubMed:27767179). Involved in cargo protein localization, such as PKD2, at primary cilia (PubMed:27767179). Involved in the presentation of the tumor necrosis factor (TNF) receptor TNFRSF1A on the cell surface, and hence in the modulation of the TNF-induced apoptosis (By similarity). {ECO:0000250 NADK -0.246446 1.05074e-06 HYAL1 -0.242018 2.67381e-07 FUNCTION: May have a role in promoting tumor progression. May block the TGFB1-enhanced cell growth. {ECO:0000269 EFNA1 -0.238485 3.07732e-09 FUNCTION: Cell surface GPI-bound ligand for Eph receptors, a family of receptor tyrosine kinases which are crucial for migration, repulsion and adhesion during neuronal, vascular and epithelial development. Binds promiscuously Eph receptors residing on adjacent cells, leading to contact-dependent bidirectional signaling into neighboring cells. Plays an important role in angiogenesis and tumor neovascularization. The recruitment of VAV2, VAV3 and PI3-kinase p85 subunit by phosphorylated EPHA2 is critical for EFNA1-induced RAC1 GTPase activation and vascular endothelial cell migration and assembly. Exerts anti-oncogenic effects in tumor cells through activation and down-regulation of EPHA2. Activates EPHA2 by inducing tyrosine phosphorylation which leads to its internalization and degradation. Acts as a negative regulator in the tumorigenesis of gliomas by down-regulating EPHA2 and FAK. Can evoke collapse of embryonic neuronal growth cone and regulates dendritic spine morphogenesis. {ECO:0000269 RNASET2 -0.207629 6.45874e-10 FUNCTION: Ribonuclease that plays an essential role in innate immune response by recognizing and degrading RNAs from microbial pathogens that are subsequently sensed by TLR8 (PubMed:31778653). Cleaves preferentially single-stranded RNA molecules between purine and uridine residues, which critically contributes to the supply of catabolic uridine and the generation of purine-2',3'-cyclophosphate-terminated oligoribonucleotides (PubMed:31778653, PubMed:38697119). In turn, RNase T2 degradation products promote the RNA-dependent activation of TLR8 (PubMed:31778653). In plasmacytoid dendritic cells, it cooperates with PLD3 or PLD4 5'-&gt;3' exonucleases to process RNA fragments and release 2',3'-cyclic guanosine monophosphate (2',3'-cGMP), a potent stimulatory ligand for TLR7 (PubMed:38697119). Also plays a key role in degradation of mitochondrial RNA and processing of non-coding RNA imported from the cytosol into mitochondria (PubMed:28730546, PubMed:30184494). Participates as well in degradation of mitochondrion-associated cytosolic rRNAs (PubMed:30385512). {ECO:0000269 CD274 -0.203286 1.13766e-06 FUNCTION: Plays a critical role in induction and maintenance of immune tolerance to self (PubMed:11015443, PubMed:28813410, PubMed:28813417, PubMed:31399419). As a ligand for the inhibitory receptor PDCD1/PD-1, modulates the activation threshold of T-cells and limits T-cell effector response (PubMed:11015443, PubMed:28813410, PubMed:28813417, PubMed:36727298). Through a yet unknown activating receptor, may costimulate T-cell subsets that predominantly produce interleukin-10 (IL10) (PubMed:10581077). Can also act as a transcription coactivator: in response to hypoxia, translocates into the nucleus via its interaction with phosphorylated STAT3 and promotes transcription of GSDMC, leading to pyroptosis (PubMed:32929201). {ECO:0000269 CD40 -0.156387 3.06125e-06 FUNCTION: Receptor for TNFSF5/CD40LG (PubMed:31331973). Transduces TRAF6- and MAP3K8-mediated signals that activate ERK in macrophages and B cells, leading to induction of immunoglobulin secretion (By similarity). {ECO:0000250 MST1 -0.156192 1.26479e-35 LTA -0.0970648 4.26769e-08 FUNCTION: Cytokine that in its homotrimeric form binds to TNFRSF1A/TNFR1, TNFRSF1B/TNFBR and TNFRSF14/HVEM (PubMed:9462508). In its heterotrimeric form with LTB binds to TNFRSF3/LTBR (PubMed:24248355). Lymphotoxin is produced by lymphocytes and is cytotoxic for a wide range of tumor cells in vitro and in vivo. {ECO:0000269 APOBR -0.0875593 1.27144e-14 FUNCTION: Macrophage receptor that binds to the apolipoprotein B48 (APOB) of dietary triglyceride (TG)-rich lipoproteins (TRL) or to a like domain of APOB in hypertriglyceridemic very low density lipoprotein (HTG-VLDL). Binds and internalizes TRL when out of the context of the macrophage. May provide essential lipids to reticuloendothelial cells. Could also be involved in foam cell formation with elevated TRL and remnant lipoprotein (RLP). Mediates the rapid high-affinity uptake of chylomicrons (CM), HTG-VLDL, and trypsinized (tryp) VLDL devoid of APOE in vitro in macrophages. {ECO:0000269 ADAM15 -0.08608 3.51388e-07 FUNCTION: Active metalloproteinase with gelatinolytic and collagenolytic activity. Plays a role in the wound healing process. Mediates both heterotypic intraepithelial cell/T-cell interactions and homotypic T-cell aggregation. Inhibits beta-1 integrin-mediated cell adhesion and migration of airway smooth muscle cells. Suppresses cell motility on or towards fibronectin possibly by driving alpha-v/beta-1 integrin (ITAGV-ITGB1) cell surface expression via ERK1/2 inactivation. Cleaves E-cadherin in response to growth factor deprivation. Plays a role in glomerular cell migration. Plays a role in pathological neovascularization. May play a role in cartilage remodeling. May be proteolytically processed, during sperm epididymal maturation and the acrosome reaction. May play a role in sperm-egg binding through its disintegrin domain. {ECO:0000269 KLK1 0.0650078 4.06561e-06 FUNCTION: Glandular kallikreins cleave Met-Lys and Arg-Ser bonds in kininogen to release Lys-bradykinin.; FUNCTION: (Microbial infection) Cleaves Neisseria meningitidis NHBA in saliva; Neisseria is an obligate commensal of the nasopharyngeal mucosa. {ECO:0000269 CD6 0.0768883 2.13236e-06 FUNCTION: Cell adhesion molecule that mediates cell-cell contacts and regulates T-cell responses via its interaction with ALCAM/CD166 (PubMed:15048703, PubMed:15294938, PubMed:16352806, PubMed:16914752, PubMed:24584089, PubMed:24945728). Contributes to signaling cascades triggered by activation of the TCR/CD3 complex (PubMed:24584089). Functions as a costimulatory molecule; promotes T-cell activation and proliferation (PubMed:15294938, PubMed:16352806, PubMed:16914752). Contributes to the formation and maturation of the immunological synapse (PubMed:15294938, PubMed:16352806). Functions as a calcium-dependent pattern receptor that binds and aggregates both Gram-positive and Gram-negative bacteria. Binds both lipopolysaccharide (LPS) from Gram-negative bacteria and lipoteichoic acid from Gram-positive bacteria (PubMed:17601777). LPS binding leads to the activation of signaling cascades and down-stream MAP kinases (PubMed:17601777). Mediates activation of the inflammatory response and the secretion of pro-inflammatory cytokines in response to LPS (PubMed:17601777). {ECO:0000269 IL18R1 0.0989958 6.38764e-10 FUNCTION: Within the IL18 receptor complex, responsible for the binding of the pro-inflammatory cytokine IL18, but not IL1A nor IL1B (PubMed:14528293, PubMed:25261253, PubMed:25500532, PubMed:37993714, PubMed:8626725). Involved in IL18-mediated IFNG synthesis from T-helper 1 (Th1) cells (PubMed:10653850). Contributes to IL18-induced cytokine production, either independently of SLC12A3, or as a complex with SLC12A3 (By similarity). {ECO:0000250 IL1R2 0.113032 3.43624e-06 FUNCTION: Non-signaling receptor for IL1A, IL1B and IL1RN. Reduces IL1B activities. Serves as a decoy receptor by competitive binding to IL1B and preventing its binding to IL1R1. Also modulates cellular response through non-signaling association with IL1RAP after binding to IL1B. IL1R2 (membrane and secreted forms) preferentially binds IL1B and poorly IL1A and IL1RN. The secreted IL1R2 recruits secreted IL1RAP with high affinity; this complex formation may be the dominant mechanism for neutralization of IL1B by secreted/soluble receptors. {ECO:0000269 IL1RL1 0.12761 2.85531e-11 FUNCTION: Receptor for interleukin-33 (IL-33) which plays crucial roles in innate and adaptive immunity, contributing to tissue homeostasis and responses to environmental stresses together with coreceptor IL1RAP (PubMed:35238669). Its stimulation recruits MYD88, IRAK1, IRAK4, and TRAF6, followed by phosphorylation of MAPK3/ERK1 and/or MAPK1/ERK2, MAPK14, and MAPK8. Possibly involved in helper T-cell function (Probable) (PubMed:16286016). Upon tissue injury, induces UCP2-dependent mitochondrial rewiring that attenuates the generation of reactive oxygen species and preserves the integrity of Krebs cycle required for persistent production of itaconate and subsequent GATA3-dependent differentiation of inflammation-resolving alternatively activated macrophages (By similarity). {ECO:0000250 FCGR2B 0.216214 7.87207e-14 FUNCTION: Receptor for the Fc region of complexed or aggregated immunoglobulins gamma. Low affinity receptor. Involved in a variety of effector and regulatory functions such as phagocytosis of immune complexes and modulation of antibody production by B-cells. Binding to this receptor results in down-modulation of previous state of cell activation triggered via antigen receptors on B-cells (BCR), T-cells (TCR) or via another Fc receptor. Isoform IIB1 fails to mediate endocytosis or phagocytosis. Isoform IIB2 does not trigger phagocytosis. IL12B 0.292814 1.83315e-31 FUNCTION: Cytokine that can act as a growth factor for activated T and NK cells, enhance the lytic activity of NK/lymphokine-activated killer cells, and stimulate the production of IFN-gamma by resting PBMC. {ECO:0000269 IL12A_IL12B 0.301707 1.83315e-31 FUNCTION: Cytokine that can act as a growth factor for activated T and NK cells, enhance the lytic activity of NK/lymphokine-activated killer cells, and stimulate the production of IFN-gamma by resting PBMC. {ECO:0000269 CCL13 0.31369 5.15988e-07 FUNCTION: Chemotactic factor that attracts monocytes, lymphocytes, basophils and eosinophils, but not neutrophils. Signals through CCR2B and CCR3 receptors. Plays a role in the accumulation of leukocytes at both sides of allergic and non-allergic inflammation. May be involved in the recruitment of monocytes into the arterial wall during the disease process of atherosclerosis. May play a role in the monocyte attraction in tissues chronically exposed to exogenous pathogens. LSP1 0.469931 2.49742e-07 FUNCTION: May play a role in mediating neutrophil activation and chemotaxis. {ECO:0000250}. TNFRSF9 0.544854 1.11883e-09 FUNCTION: Receptor for TNFSF9/4-1BBL. Conveys a signal that enhances CD8(+) T-cell survival, cytotoxicity, and mitochondrial activity, thereby promoting immunity against viruses and tumors (Probable). {ECO:0000305 CEP43 1.32751 3.09298e-15 FUNCTION: Required for anchoring microtubules to the centrosomes (PubMed:16314388, PubMed:28659385). Required for ciliation (PubMed:28625565, PubMed:28659385). {ECO:0000269 <ol> <li> <p>Zhanju Liu, Ruize Liu, Han Gao, Seulgi Jung, Xiang Gao, Ruicong Sun, Xiaoming Liu, Yongjae Kim, Ho-Su Lee, Yosuke Kawai, and others. Genetic architecture of the inflammatory bowel diseases across east asian and european ancestries. Nature genetics, 55(5):796\u2013806, 2023. URL: https://www.nature.com/articles/s41588-023-01384-0.\u00a0\u21a9</p> </li> <li> <p>Benjamin B Sun, Joshua Chiou, Matthew Traylor, Christian Benner, Yi-Hsiang Hsu, Tom G Richardson, Praveen Surendran, Anubha Mahajan, Chloe Robins, Steven G Vasquez-Grinnell, and others. Plasma proteomic associations with genetics and health in the uk biobank. Nature, 622(7982):329\u2013338, 2023. URL: https://www.nature.com/articles/s41586-023-06592-6.\u00a0\u21a9</p> </li> <li> <p>Tihana Trsan, Vincent Peng, Chirag Krishna, Takahiro E Ohara, Wandy L Beatty, Raki Sudan, Masahiro Kanai, Praveen Krishnamoorthy, Patrick Fernandes Rodrigues, Jose L Fachi, and others. The centrosomal protein fgfr1op controls myosin function in murine intestinal epithelial cells. Developmental cell, 59(18):2460\u20132476, 2024. URL: https://www.cell.com/developmental-cell/fulltext/S1534-5807(24)00379-4.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Liu_et_al_2023_%28IBD%29/HBA-MAGMA-Analysis/","title":"MAGMA HBA Analysis","text":""},{"location":"Analysis/Liu_et_al_2023_%28IBD%29/HBA-MAGMA-Analysis/#magma-hba-analysis","title":"MAGMA HBA Analysis","text":"<p>I applied MAGMA to the Liu et al.<sup>1</sup> GWAS of inflammatory bowel disease  using scRNAseq data from the Human Brain Atlas as a reference.</p>"},{"location":"Analysis/Liu_et_al_2023_%28IBD%29/HBA-MAGMA-Analysis/#results","title":"Results","text":"<p>The results are plotted below:</p> <p></p> <p>The x-axis corresponds to HBA cluster number<sup>2</sup>, while the y-axis corresponds to the \\(-\\log_{10}(p)\\) score produced by MAGMA.  Clusters are colored according to their HBA supercluster. The dotted line denotes the Bonferroni significance threshold.  I used a conditional analysis approach based on the one described in Wanatabe et al.<sup>3</sup> to identify independent clusters.  These 2 independent clusters are labeled in plot.  I have also listed them in the table below, together with some cluster-annotations from Duncan et al.<sup>4</sup>.</p> Retained_clusters P Supercluster Class auto-annotation Neurotransmitter auto-annotation Neuropeptide auto-annotation Subtype auto-annotation Transferred MTG Label Top three regions Top Enriched Genes Cluster4 4.6356e-14 Microglia MGL 0 NAMPT 0 Micro-PVM Spinal cord: 31.8%, Pons: 26.0%, Medulla: 13.2% SRGN, RGS1, GPR183, CD69, HLA-DRA, OLR1, TNFRSF1B, IFI30, CXCR4, CD74 Cluster1 3.3757e-10 Miscellaneous TCELL 0 0 0 Midbrain: 15.0%, Basal forebrain: 14.0%, Pons: 13.2% CD2, IL7R, PTPRC, SLFN12L, IL32, CCL5, GRAP2, RUNX3, CD69, CD3E <ul> <li>Cluster2 (T-cells) is consistent with the known biology of inflammatory bowel disease.  The importance of T-cells to inflammatory bowel disease is well known.</li> <li>Cluster4 (Microglia) is more surprising.  While there are some (\"Gut-Brain-Axis\") theories that give a role to the CNS in the development of Crohn's disease, it seems to me more likely that the significance of this cluster in MAGMA analysis is an artifact. Probably, IBD is associated with certain myeloid transcriptional programs, and microglia are the best representatives of these transcriptional programs in the human brain atlas dataset. </li> </ul> <ol> <li> <p>Zhanju Liu, Ruize Liu, Han Gao, Seulgi Jung, Xiang Gao, Ruicong Sun, Xiaoming Liu, Yongjae Kim, Ho-Su Lee, Yosuke Kawai, and others. Genetic architecture of the inflammatory bowel diseases across east asian and european ancestries. Nature genetics, 55(5):796\u2013806, 2023. URL: https://www.nature.com/articles/s41588-023-01384-0.\u00a0\u21a9</p> </li> <li> <p>Kimberly Siletti, Rebecca Hodge, Alejandro Mossi Albiach, Ka Wai Lee, Song-Lin Ding, Lijuan Hu, Peter L\u00f6nnerberg, Trygve Bakken, Tamara Casper, Michael Clark, and others. Transcriptomic diversity of cell types across the adult human brain. Science, 382(6667):eadd7046, 2023. URL: https://www.science.org/doi/abs/10.1126/science.add7046.\u00a0\u21a9</p> </li> <li> <p>Kyoko Watanabe, Ma\u0161a Umi\u0107evi\u0107 Mirkov, Christiaan A de Leeuw, Martijn P van den Heuvel, and Danielle Posthuma. Genetic mapping of cell type specificity for complex traits. Nature communications, 10(1):3222, 2019. URL: https://www.nature.com/articles/s41467-019-11181-1.\u00a0\u21a9</p> </li> <li> <p>Laramie E Duncan, Tayden Li, Madeleine Salem, Will Li, Leili Mortazavi, Hazal Senturk, Naghmeh Shahverdizadeh, Sam Vesuna, Hanyang Shen, Jong Yoon, and others. Mapping the cellular etiology of schizophrenia and complex brain phenotypes. Nature Neuroscience, 28(2):248\u2013258, 2025. URL: https://www.nature.com/articles/s41593-024-01834-w.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Liu_et_al_2023_%28IBD%29/MAGMA_IBD_Analysis/","title":"MAGMA IBD Analysis","text":""},{"location":"Analysis/Liu_et_al_2023_%28IBD%29/MAGMA_IBD_Analysis/#magma-ibd-analysis","title":"MAGMA IBD Analysis","text":"<p>After applying MAGMA to the DecodeME summary statistics, I decided to apply it to summary statistics of a number of other conditions whose biology is better understood.  The aim here was to assess the reliability of MAGMA.  If MAGMA recapitulates known aspects of the pathophysiology of other diseases, this increases our confidence in the results of applying MAGMA to ME/CFS.</p>"},{"location":"Analysis/Liu_et_al_2023_%28IBD%29/MAGMA_IBD_Analysis/#data","title":"Data","text":"<p>I decided to start with Inflammatory bowel disease (IBD).</p> <p>I used summary statistics from Liu et al.'s 2023 cross-ancestry meta-GWAS of inflammatory bowel disease<sup>1</sup>. Because my reference data is from the European population, I extracted only the summary statistics corresponding to non-Finish Europeans, excluding those summary statistics from other populations. I passed these summary statistics through the same MAGMA pipeline I applied to DecodeME.</p>"},{"location":"Analysis/Liu_et_al_2023_%28IBD%29/MAGMA_IBD_Analysis/#results","title":"Results","text":"<p>As before, I ran the gene analysis set, followed by the gene-set analysis step.  In the gene property analysis step, I used tissue-specific RNAseq data from GTEx<sup>2</sup> to try to link genes associated with IBD to specific tissues.  The results are shown in the bar plot below:</p> <p></p> <p>Of note, the associations with colon and intestinal tissue make sense. These findings increase my confidence in MAGMA.</p> <p>The association with whole blood may be a consequence of genes expressed in leukocytes, and may reflect the autoimmune nature of IBD. Finucane et al.<sup>3</sup> hypothesized that the lungs of post-mortem donors from which the GTEx is derived may have contained a significant quantity of blood.  If this hypothesis is correct, it would also explain the significant association of IBD with lung tissue observed here.</p>"},{"location":"Analysis/Liu_et_al_2023_%28IBD%29/MAGMA_IBD_Analysis/#reproducing","title":"Reproducing","text":"<p>To reproduce the above, run the IBD GWAS Analysis Script.</p> <ol> <li> <p>Zhanju Liu, Ruize Liu, Han Gao, Seulgi Jung, Xiang Gao, Ruicong Sun, Xiaoming Liu, Yongjae Kim, Ho-Su Lee, Yosuke Kawai, and others. Genetic architecture of the inflammatory bowel diseases across east asian and european ancestries. Nature genetics, 55(5):796\u2013806, 2023. URL: https://www.nature.com/articles/s41588-023-01384-0.\u00a0\u21a9</p> </li> <li> <p>GTEx Consortium. The gtex consortium atlas of genetic regulatory effects across human tissues. Science, 369(6509):1318\u20131330, 2020. URL: https://www.science.org/doi/full/10.1126/science.aaz1776.\u00a0\u21a9</p> </li> <li> <p>Hilary K Finucane, Yakir A Reshef, Verneri Anttila, Kamil Slowikowski, Alexander Gusev, Andrea Byrnes, Steven Gazal, Po-Ru Loh, Caleb Lareau, Noam Shoresh, and others. Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types. Nature genetics, 50(4):621\u2013629, 2018. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC5896795/.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Liu_et_al_2023_%28IBD%29/S-LDSC_IBD_Analysis/","title":"S-LDSC Analysis of IBD","text":""},{"location":"Analysis/Liu_et_al_2023_%28IBD%29/S-LDSC_IBD_Analysis/#s-ldsc-analysis-of-ibd","title":"S-LDSC Analysis of IBD","text":"<p>I used Stratified Linkage Disequilibrium Score Regression (S-LDSC) to analyze summary statistics from a GWAS of inflammatory bowel disease from Liu et al.  For the current analysis, I focused only European participants.</p> <p>I used the standard reference data sources to associate chromatin regions with cell or tissue types. These reference data sources were:</p> <ul> <li>The GTEx Project</li> <li>The Franke lab dataset</li> <li>The Roadmap Epigenetic Project</li> <li>The Corces et al. ATAC-seq dataset of 13 blood cell types.</li> <li>The ImmGen Project</li> <li>The Cahoy Mouse Central Nervous System Dataset</li> </ul>"},{"location":"Analysis/Liu_et_al_2023_%28IBD%29/S-LDSC_IBD_Analysis/#results","title":"Results","text":""},{"location":"Analysis/Liu_et_al_2023_%28IBD%29/S-LDSC_IBD_Analysis/#gtex-and-franke-lab-tissue-expression-data","title":"GTEx and Franke lab tissue expression data","text":"<p>The plot below illustrates the pattern of S-LDSC p values across cell types. The table shows the cell types with the lowest p values.</p> <p></p> Name Coefficient Coefficient_P_value Reject Null A02.835.583.443.800.800.Synovial.Fluid 7.21343e-08 5.86657e-07 True A15.145.Blood 7.55841e-08 6.92179e-07 True Whole_Blood 5.70557e-08 7.05793e-07 True A11.118.637.555.567.569.T.Lymphocytes 6.95136e-08 9.21119e-07 True A15.145.229.Blood.Cells 7.04224e-08 2.83664e-06 True A11.118.637.Leukocytes 6.44595e-08 1.21546e-05 True A15.382.490.555.567.Lymphocytes 6.05795e-08 1.25194e-05 True A15.382.520.604.700.Spleen 5.3496e-08 2.10229e-05 True A15.145.229.637.555.Leukocytes..Mononuclear 6.53729e-08 2.13756e-05 True Lung 3.36683e-08 7.06633e-05 True A11.118.637.555.567.569.200.700.T.Lymphocytes..Regulatory 4.73932e-08 0.000110028 True A15.378.316.Bone.Marrow.Cells 5.04105e-08 0.000112991 True Spleen 4.95452e-08 0.000114937 True A15.382.490.555.567.537.Killer.Cells..Natural 5.06096e-08 0.000275746 True A10.549.Lymphoid.Tissue 4.5808e-08 0.00027864 True A15.382.812.260.Dendritic.Cells 4.13252e-08 0.000439731 True A15.378.316.580.Monocytes 3.77876e-08 0.000972786 False A10.549.400.Lymph.Nodes 3.91855e-08 0.00113796 False <p>Interestingly, no gastrointestinal tissue/cell types are significant in this analysis.  Instead, the significant tissue/cell types overwhelmingly pertain to the blood or immune system, consistent with the autoimmune nature of IBD.  </p> <p>The significance of lung tissue may reflect sample contamination: as noted by Finucane et al.<sup>1</sup>, there was likely blood in the lungs of the post-mortem donors from which the GTEx samples were extracted.</p>"},{"location":"Analysis/Liu_et_al_2023_%28IBD%29/S-LDSC_IBD_Analysis/#roadmap-chromatin-data","title":"Roadmap Chromatin data","text":"<p>I next applied S-LDSC to the IBD GWAS using reference data generated by Finucane et al.<sup>1</sup> from the Roadmap Epigenetics Project</p> <p>The results are shown in the graph and table below.</p> <p></p> Name Coefficient Coefficient_P_value Reject Null SI-Term-Ileum_ENTEX__H3K27ac 5.88187e-07 7.43564e-11 True Primary_T_helper_17_cells_PMA-I_stimulated__H3K4me1 6.64904e-07 7.46228e-11 True Spleen_ENTEX__H3K27ac 3.68515e-07 1.06777e-09 True Primary_Natural_Killer_cells_from_peripheral_blood__H3K4me1 4.7694e-07 2.18101e-08 True Primary_T_helper_17_cells_PMA-I_stimulated__H3K27ac 1.11335e-06 2.54249e-08 True Spleen_ENTEX__H3K4me1 1.33146e-06 3.25759e-08 True Primary_T_helper_17_cells_PMA-I_stimulated__H3K4me3 1.80868e-06 8.50234e-08 True Primary_T_helper_memory_cells_from_peripheral_blood_2__H3K4me1 4.64748e-07 1.34853e-07 True Primary_T_helper_memory_cells_from_peripheral_blood_1__H3K4me1 4.72349e-07 1.51893e-07 True Sigmoid_Colon__H3K27ac 8.40826e-07 4.7277e-07 True Primary_T_cells_from_peripheral_blood__H3K4me1 4.22743e-07 5.38612e-07 True Rectal_Mucosa_Donor_29__H3K9ac 1.76888e-06 6.48073e-07 True Primary_Natural_Killer_cells_from_peripheral_blood__DNase 1.29915e-06 6.731e-07 True Primary_T_helper_cells_PMA-I_stimulated__H3K4me1 3.5459e-07 1.09551e-06 True Spleen_ENTEX__H3K4me3 5.57333e-07 1.22639e-06 True Primary_T_killer_memory_cells_from_peripheral_blood__H3K4me1 4.83526e-07 1.40831e-06 True Primary_T_regulatory_cells_from_peripheral_blood__H3K4me1 4.89971e-07 1.86403e-06 True Primary_T_cells_from_peripheral_blood__DNase 9.94548e-07 2.40567e-06 True Small_Intestine__H3K27ac 7.45908e-07 2.50416e-06 True Primary_T_helper_cells_from_peripheral_blood__H3K4me1 3.77567e-07 3.48901e-06 True Rectal_Mucosa_Donor_29__H3K27ac 6.65295e-07 4.27993e-06 True Primary_T_cells_effector_memory_enriched_from_peripheral_blood__H3K4me1 6.57463e-07 4.43318e-06 True Primary_Natural_Killer_cells_from_peripheral_blood__H3K36me3 3.91359e-07 5.88324e-06 True Primary_B_cells_from_cord_blood__H3K4me1 3.63687e-07 6.66304e-06 True Primary_T_cells_from_cord_blood__DNase 1.11004e-06 6.88901e-06 True Primary_T_killer_naive_cells_from_peripheral_blood__H3K4me1 3.26511e-07 8.15872e-06 True Primary_B_cells_from_peripheral_blood__DNase 6.63583e-07 9.29237e-06 True Primary_T_cells_from_peripheral_blood__H3K27ac 5.92792e-07 1.11938e-05 True Colonic_Mucosa__H3K27ac 7.41473e-07 1.45139e-05 True Primary_T_helper_naive_cells_from_peripheral_blood_1__H3K4me1 3.7948e-07 2.28038e-05 True Primary_Natural_Killer_cells_from_peripheral_blood__H3K27ac 5.91881e-07 2.33956e-05 True Primary_T_helper_memory_cells_from_peripheral_blood_1__H3K4me3 1.22213e-06 2.97356e-05 True Spleen_ENTEX__H3K36me3 1.6328e-07 3.59535e-05 True Primary_T_helper_cells_PMA-I_stimulated__H3K27ac 4.39121e-07 4.74836e-05 True Primary_monocytes_from_peripheral_blood__H3K4me1 2.44401e-07 5.10902e-05 True Stomach_ENTEX__H3K27ac 2.52371e-07 5.36711e-05 True Primary_monocytes_from_peripheral_blood__DNase 9.03028e-07 6.30244e-05 True Primary_T_helper_cells_PMA-I_stimulated__H3K4me3 9.27811e-07 7.92555e-05 True Primary_B_cells_from_peripheral_blood__H3K4me1 2.61357e-07 8.03756e-05 True Primary_T_killer_naive_cells_from_peripheral_blood__H3K9ac 8.23659e-07 0.000106447 True Primary_hematopoietic_stem_cells_short_term_culture__H3K4me1 3.07194e-07 0.000117984 True Primary_hematopoietic_stem_cells__H3K4me1 5.61429e-07 0.000124149 True SI-Term-Ileum_ENTEX__H3K4me3 9.26661e-07 0.000127295 True Duodenum_Mucosa__H3K9ac 9.40654e-07 0.000129292 True Primary_T_helper_17_cells_PMA-I_stimulated__H3K36me3 3.36529e-07 0.000131691 True Rectal_Mucosa_Donor_31__H3K27ac 4.86019e-07 0.000208176 True Primary_T_helper_memory_cells_from_peripheral_blood_1__H3K27ac 6.57625e-07 0.000311747 True Primary_T_regulatory_cells_from_peripheral_blood__H3K27ac 3.87157e-07 0.000400567 True Stomach_ENTEX__H3K4me3 8.02303e-07 0.000434599 True SI-Term-Ileum_ENTEX__H3K4me1 5.14523e-07 0.000449404 True Primary_T_helper_cells_PMA-I_stimulated__H3K36me3 2.40795e-07 0.00044978 True Primary_mononuclear_cells_from_peripheral_blood__H3K4me1 1.03073e-06 0.000582293 True Rectal_Mucosa_Donor_31__H3K9ac 9.00682e-07 0.000614263 True Primary_T_helper_memory_cells_from_peripheral_blood_2__H3K4me3 1.09624e-06 0.000697011 True Primary_T_cells_from_cord_blood__H3K4me1 4.83073e-07 0.000734568 True Colonic_Mucosa__H3K9ac 9.28271e-07 0.000768319 True Sigmoid_Colon__H3K36me3 4.13158e-07 0.000776354 True Primary_T_cells_effector_memory_enriched_from_peripheral_blood__H3K27ac 5.63262e-07 0.000930381 True Primary_B_cells_from_peripheral_blood__H3K27ac 3.84286e-07 0.000958017 True Primary_T_cells_effector_memory_enriched_from_peripheral_blood__H3K4me3 1.00685e-06 0.000989186 True Sigmoid_Colon__H3K4me3 9.21358e-07 0.0013546 False Rectal_Mucosa_Donor_29__H3K36me3 3.3545e-07 0.00152473 False Primary_Natural_Killer_cells_from_peripheral_blood__H3K4me3 1.38162e-06 0.00166122 False Primary_B_cells_from_cord_blood__H3K4me3 1.27467e-06 0.00178815 False Duodenum_Mucosa__H3K36me3 2.54483e-07 0.00196143 False Rectal_Mucosa_Donor_29__H3K4me3 7.34082e-07 0.00200658 False Primary_B_cells_from_peripheral_blood__H3K36me3 1.49602e-07 0.00208217 False Primary_neutrophils_from_peripheral_blood__H3K4me3 4.61673e-07 0.0022148 False <p>Of note, in contrast the analysis using gene-expression data, in the present epigenetics analysis, both immune-related and gastrointestinal-related cell types are significant, consistent with our understanding of the disease process. This may reflect differences in the specificity of gene expression versus epigenetic reference data.</p>"},{"location":"Analysis/Liu_et_al_2023_%28IBD%29/S-LDSC_IBD_Analysis/#immgen-data","title":"ImmGen Data","text":"<p>The next step is to use the S-LDSC reference data derived from the ImmGen project. The results are below</p> <p></p> Name Coefficient Coefficient_P_value Reject Null LN.TR.14w.B6 5.88377e-08 1.45162e-06 True T.4Mem.Sp 5.91919e-08 6.75222e-06 True T.4Mem44h62l.Sp 5.42097e-08 7.67268e-06 True NKT.4+.Lv 5.21078e-08 8.54374e-06 True T.8SP69+.Th 4.98414e-08 8.69673e-06 True T.4.Pa.BDC 5.27413e-08 1.02889e-05 True NKT.4-.Lv 5.8454e-08 1.22672e-05 True CD4Control 5.34947e-08 1.45635e-05 True NK.b2m-.Sp 4.04081e-08 1.63948e-05 True NKT.4-.Sp 5.15357e-08 1.71259e-05 True Tgd.vg2+24alo.Th 4.52212e-08 2.66825e-05 True T.4Nve.LN 5.42156e-08 2.80202e-05 True T.4SP24-.Th 4.91772e-08 2.88841e-05 True T.4.LN.BDC 5.56221e-08 3.43062e-05 True T.4Nve.Sp 5.44986e-08 5.18253e-05 True NKT.44+NK1.1+.Th 5.08155e-08 5.95247e-05 True T.4Mem44h62l.LN 5.41904e-08 6.65735e-05 True T.4FP3+25+.Sp 4.24075e-08 9.1964e-05 True T.4Nve.MLN 4.42292e-08 0.000128944 True T.4Mem.LN 4.91063e-08 0.000130168 True T.4int8+.Th 4.08383e-08 0.000143531 True T.4SP69+.Th 4.46602e-08 0.000178913 True T.4SP24int.Th 4.48964e-08 0.000244919 True B.MZ.Sp 4.36416e-08 0.00024541 True ABD.TR.14w.B6 4.15646e-08 0.000284172 True B.T2.Sp 4.33163e-08 0.000293517 True B.FrF.BM 4.12463e-08 0.000299895 True T.8SP24-.Th 4.50035e-08 0.000338027 True B.Fo.PC 3.803e-08 0.000345648 True NK.49H-.Sp 4.17266e-08 0.000367327 True NKT.44-NK1.1-.Th 3.7553e-08 0.000629513 True B.Fo.LN 3.84346e-08 0.000632388 True CD4.96h.LN 3.84236e-08 0.000720856 True T.8Nve.LN 4.29127e-08 0.000723785 True DC.4+.Sp.ST 3.47431e-08 0.00075239 True Tgd.vg5-.act.IEL 3.8971e-08 0.00078216 True T.8SP24int.Th 3.47183e-08 0.000788441 True CD4.CTR.LN 3.75766e-08 0.00084666 True DC.8-4-11b+.MLN 3.65043e-08 0.000933421 True NK.H+.MCMV1.Sp 3.88649e-08 0.000943415 True T.4.PLN.BDC 4.0467e-08 0.00096887 True CD8.5h.LN 3.67386e-08 0.000995926 True T.8Nve.MLN 4.05e-08 0.00113565 True CD4.5h.LN 4.06854e-08 0.00119258 True DC.8-4-11b-.SLN 3.63301e-08 0.00125689 True T.4FP3-.Sp 3.66733e-08 0.00137885 True B.T1.Sp 3.74316e-08 0.00148824 True B.T3.Sp 3.41897e-08 0.00172218 False <p>Overall these results are rather non-specific: there are significant cell types in all the categories.  However, the lowest p values are associated with T and natural-killer cell types (and NK cells have broadly similar gene expression patterns to T cells).  This finding is consistent with the view of inflammatory bowel disease as primarily T-cell driven</p>"},{"location":"Analysis/Liu_et_al_2023_%28IBD%29/S-LDSC_IBD_Analysis/#corces-et-al-atac-seq-data","title":"Corces et al. ATAC-seq data","text":"<p>Looking at the Corces et al. ATAC-seq dataset, we again see broad significance with T and NK cell attaining the lowest p values:</p> Name Coefficient Coefficient_P_value Reject Null CD8 8.38248e-07 3.26601e-07 True CD4 7.77934e-07 5.8346e-06 True NK 7.14325e-07 1.23519e-05 True Bcell 5.69139e-07 3.08321e-05 True Mono 8.27562e-07 4.07921e-05 True HSC 2.69509e-07 0.00922097 False MPP 2.37462e-07 0.0106805 False LMPP 2.71358e-07 0.0182358 False"},{"location":"Analysis/Liu_et_al_2023_%28IBD%29/S-LDSC_IBD_Analysis/#cahoy-and-gtex-brain-data","title":"Cahoy and GTEx-Brain data","text":"<p>As expected, there are no significant cell types in these datasets, consistent with IBD being a non-neural disease.</p> Name Coefficient Coefficient_P_value Reject Null Oligodendrocyte 3.8018e-09 0.350595 False Neuron -1.63365e-09 0.57887 False Astrocyte -4.33476e-09 0.678332 False Name Coefficient Coefficient_P_value Reject Null Brain_Spinal_cord_(cervical_c-1) 5.27018e-09 0.255 False Brain_Cerebellum 3.8986e-09 0.332546 False Brain_Amygdala 2.29904e-09 0.364457 False Brain_Putamen_(basal_ganglia) 2.49498e-09 0.365589 False Brain_Frontal_Cortex_(BA9) 2.41676e-09 0.372215 False Brain_Cortex 2.0825e-09 0.392953 False Brain_Anterior_cingulate_cortex_(BA24) 1.6171e-09 0.408329 False Brain_Cerebellar_Hemisphere -1.74109e-09 0.582644 False"},{"location":"Analysis/Liu_et_al_2023_%28IBD%29/S-LDSC_IBD_Analysis/#reproducing","title":"Reproducing","text":"<p>To reproduce, run the IBD  analysis script here.</p> <ol> <li> <p>Hilary K Finucane, Yakir A Reshef, Verneri Anttila, Kamil Slowikowski, Alexander Gusev, Andrea Byrnes, Steven Gazal, Po-Ru Loh, Caleb Lareau, Noam Shoresh, and others. Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types. Nature genetics, 50(4):621\u2013629, 2018. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC5896795/.\u00a0\u21a9\u21a9</p> </li> </ol>"},{"location":"Analysis/Multitrait/Genetic_Correlation/CT-LDSC_Study/","title":"CT-LDSC Study","text":""},{"location":"Analysis/Multitrait/Genetic_Correlation/CT-LDSC_Study/#ct-ldsc-study","title":"CT-LDSC Study","text":"<p>I applied cross-trait linkage disequilibrium score regression<sup>3</sup> to estimate genetic correlation between diverse phenotypes, including the ME/CFS phenotype defined in DecodeME<sup>4</sup>.  The genetic correlations are plotted in the heatmap below. Asterisks denote Bonferroni-corrected statistically significant correlations.</p>    Fullscreen Plot \u2922  <p> </p> <p>The traits are:</p> <ul> <li>Asthma from the GWAS of Han et al.<sup>5</sup>  Numerous authors have theorized a relationship between autonomic dysfunction, ME/CFS, and the activation of mast cells<sup>6</sup>, but the evidence supporting these theories typically comes from small studies. I added asthma as a prototypical example of a common disease involving the IgE/ mast cell immune axis<sup>2</sup>.</li> <li>Diastolic blood pressure (DBP) from the Keaton et al.<sup>7</sup> It has been postulated that ME/CFS is related to dysregulation of blood flow<sup>8</sup>.  I included the Keaton study as a well-powered, well-measured GWAS of a blood-flow related trait.</li> <li>Educational attainment from Lee et al<sup>9</sup>, an example of an extremely complex trait with many determinants, some which lie in the central nervous system.</li> <li>ME/CFS, from DecodeME<sup>4</sup>.</li> <li>Multi-site pain, from Johnston et al.<sup>10</sup> The DecodeME preprint reported colocalization between the ME/CFS signal and a multi-site chronic pain signal at a locus on chromosome 17.  I added multi-site pain to investigate whether there was evidence of genome-wide matching between pain and ME/CFS, in addition to localized matching.</li> <li>Inflammatory bowel disease from Liu et al.<sup>11</sup> Like asthma, IBD is an immunological disease, but it operates via a different subsystem of the immune system.  I was interested in observing how this contrast is reflected in genetic correlations.</li> <li>Schizophrenia from the 2022 PGC study<sup>12</sup>. Unlike certain other common complex diseases of the central nervous system, schizophrenia has a severe and relatively distinctive phenotype, which reduces the likelihood of diagnostic error.  In addition to involving genes active in neurons, genetic risk for schizophrenia appears to also be driven by the immunological genes<sup>1</sup>.  It may thus be reasonable to describe schizophrenia as a neuroimmune condition. ME/CFS has also been called a neuroimmune condition, though the phenotypes of the two diseases are vastly different.</li> </ul>"},{"location":"Analysis/Multitrait/Genetic_Correlation/CT-LDSC_Study/#comment-on-results","title":"Comment on results","text":"<ul> <li>The trait most strongly genetically correlated with ME/CFS is multi-site pain. This is consistent with the observation that the Manhattan plots for DecodeME and multi-site pain appear to match closely at several loci.  This intriguing finding  deserves follow-up.</li> <li>ME/CFS has two other significant genetic correlations: with schizophrenia and with asthma.  As is often the case in genetic correlation studies, these correlations are difficult to interpret. There are numerous possible theories.  For instance, the correlation between asthma and ME/CFS could reflect an IgE-related immune etiology, while the correlation between ME/CFS and Schizophrenia could reflect neurological etiology; or both correlations could reflect some common immune pathway. </li> </ul>"},{"location":"Analysis/Multitrait/Genetic_Correlation/CT-LDSC_Study/#next-steps","title":"Next steps","text":"<ul> <li>Techniques like GenomicSEM<sup>13</sup>, LCV<sup>14</sup>, and MiXeR<sup>15</sup> may elucidate the causal structure of correlations discovered so far.</li> <li>The inclusion of additional well-chosen phenotypes in the correlation study may shed light through triangulation.</li> </ul>"},{"location":"Analysis/Multitrait/Genetic_Correlation/CT-LDSC_Study/#reproducing","title":"Reproducing","text":"<p>To reproduce these results, use this script.</p> <ol> <li> <p>See \"Identification of Genes for Schizophrenia Highlights the Interplay of Rare and Common Risk Variants\" in Chapter 1 of Kandel et al.<sup>16</sup> and also the S-LDSC analysis of schizophrenia in this repo.\u00a0\u21a9</p> </li> <li> <p>See Janeway's Immunobiology,<sup>17</sup> Chapter 14: Allergic Diseases.\u00a0\u21a9</p> </li> <li> <p>Brendan Bulik-Sullivan, Hilary K Finucane, Verneri Anttila, Alexander Gusev, Felix R Day, Po-Ru Loh, ReproGen Consortium, Psychiatric Genomics Consortium, Genetic Consortium for Anorexia Nervosa of the Wellcome Trust Case Control Consortium 3, Laramie Duncan, and others. An atlas of genetic correlations across human diseases and traits. Nature genetics, 47(11):1236\u20131241, 2015. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC4797329/.\u00a0\u21a9</p> </li> <li> <p>Genetics Delivery Team, Thibaud Boutin, Andrew D Bretherick, Joshua J Dibble, Esther Ewaoluwagbemiga, Emma Northwood, Gemma L Samms, Veronique Vitart, Project, Cohort Delivery Team, \u00d8yvind Almelid, and others. Initial findings from the decodeme genome-wide association study of myalgic encephalomyelitis/chronic fatigue syndrome. medRxiv, pages 2025\u201308, 2025. URL: https://www.medrxiv.org/content/10.1101/2025.08.06.25333109v1.\u00a0\u21a9\u21a9</p> </li> <li> <p>Yi Han, Qiong Jia, Pedram Shafiei Jahani, Benjamin P Hurrell, Calvin Pan, Pin Huang, Janet Gukasyan, Nicholas C Woodward, Eleazar Eskin, Frank D Gilliland, and others. Genome-wide analysis highlights contribution of immune system pathways to the genetic architecture of asthma. Nature communications, 11(1):1776, 2020. URL: https://www.nature.com/articles/s41467-020-15649-3.\u00a0\u21a9</p> </li> <li> <p>Peter Novak, Matthew P Giannetti, Emily Weller, Matthew J Hamilton, and Mariana Castells. Mast cell disorders are associated with decreased cerebral blood flow and small fiber neuropathy. Annals of Allergy, Asthma &amp; Immunology, 128(3):299\u2013306, 2022. URL: https://www.sciencedirect.com/science/article/abs/pii/S1081120621011558.\u00a0\u21a9</p> </li> <li> <p>Jacob M Keaton, Zoha Kamali, Tian Xie, Ahmad Vaez, Ariel Williams, Slavina B Goleva, Alireza Ani, Evangelos Evangelou, Jacklyn N Hellwege, Loic Yengo, and others. Genome-wide analysis in over 1 million individuals of european ancestry yields improved polygenic risk scores for blood pressure traits. Nature genetics, 56(5):778\u2013791, 2024. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC11096100/.\u00a0\u21a9</p> </li> <li> <p>C Linda MC van Campen, Freek WA Verheugt, Peter C Rowe, and Frans C Visser. Cerebral blood flow is reduced in me/cfs during head-up tilt testing even in the absence of hypotension or tachycardia: a quantitative, controlled study using doppler echography. Clinical Neurophysiology Practice, 5:50\u201358, 2020. URL: https://www.sciencedirect.com/science/article/pii/S2467981X20300044.\u00a0\u21a9</p> </li> <li> <p>James J Lee, Robbee Wedow, Aysu Okbay, Edward Kong, Omeed Maghzian, Meghan Zacher, Tuan Anh Nguyen-Viet, Peter Bowers, Julia Sidorenko, Richard Karlsson Linn\u00e9r, and others. Gene discovery and polygenic prediction from a genome-wide association study of educational attainment in 1.1 million individuals. Nature genetics, 50(8):1112\u20131121, 2018. URL: https://www.nature.com/articles/s41588-018-0147-3.\u00a0\u21a9</p> </li> <li> <p>Keira JA Johnston, Mark J Adams, Barbara I Nicholl, Joey Ward, Rona J Strawbridge, Amy Ferguson, Andrew M McIntosh, Mark ES Bailey, and Daniel J Smith. Genome-wide association study of multisite chronic pain in uk biobank. PLoS genetics, 15(6):e1008164, 2019. URL: https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1008164.\u00a0\u21a9</p> </li> <li> <p>Zhanju Liu, Ruize Liu, Han Gao, Seulgi Jung, Xiang Gao, Ruicong Sun, Xiaoming Liu, Yongjae Kim, Ho-Su Lee, Yosuke Kawai, and others. Genetic architecture of the inflammatory bowel diseases across east asian and european ancestries. Nature genetics, 55(5):796\u2013806, 2023. URL: https://www.nature.com/articles/s41588-023-01384-0.\u00a0\u21a9</p> </li> <li> <p>Vassily Trubetskoy, Antonio F Pardi\u00f1as, Ting Qi, Georgia Panagiotaropoulou, Swapnil Awasthi, Tim B Bigdeli, Julien Bryois, Chia-Yen Chen, Charlotte A Dennison, Lynsey S Hall, and others. Mapping genomic loci implicates genes and synaptic biology in schizophrenia. Nature, 604(7906):502\u2013508, 2022. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC9392466/.\u00a0\u21a9</p> </li> <li> <p>Andrew D Grotzinger, Mijke Rhemtulla, Ronald de Vlaming, Stuart J Ritchie, Travis T Mallard, W David Hill, Hill F Ip, Riccardo E Marioni, Andrew M McIntosh, Ian J Deary, and others. Genomic structural equation modelling provides insights into the multivariate genetic architecture of complex traits. Nature human behaviour, 3(5):513\u2013525, 2019. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC6520146/.\u00a0\u21a9</p> </li> <li> <p>Luke J O\u2019Connor and Alkes L Price. Distinguishing genetic correlation from causation across 52 diseases and complex traits. Nature genetics, 50(12):1728\u20131734, 2018. URL: https://www.nature.com/articles/s41588-018-0255-0.\u00a0\u21a9</p> </li> <li> <p>Oleksandr Frei, Dominic Holland, Olav B Smeland, Alexey A Shadrin, Chun Chieh Fan, Steffen Maeland, Kevin S O\u2019Connell, Yunpeng Wang, Srdjan Djurovic, Wesley K Thompson, and others. Bivariate causal mixture model quantifies polygenic overlap between complex traits beyond genetic correlation. Nature communications, 10(1):2417, 2019. URL: https://www.nature.com/articles/s41467-019-10310-0.\u00a0\u21a9</p> </li> <li> <p>Eric R. Kandel, John D. Koester, and Steven A. Mack, Sarah H. Siegelbaum. Principles of neural science 6th edition. Elsevier New York, 2021. URL: https://www.amazon.ca/Principles-Neural-Science-Sixth-Kandel-ebook-dp-B08LNXDCS3/dp/B08LNXDCS3.\u00a0\u21a9</p> </li> <li> <p>Kenneth Murphy, Casey Weaver, and Leslie Berg. Janeway's immunobiology. Norton, 2022. URL: https://wwnorton.com/books/9780393884890.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/PGC_2022_%28SCH%29/MAGMA-GTEx-analysis/","title":"MAGMA GTEx analysis","text":""},{"location":"Analysis/PGC_2022_%28SCH%29/MAGMA-GTEx-analysis/#magma-gtex-analysis","title":"MAGMA GTEx analysis","text":"<p>I applied MAGMA to the PGC 2022 GWAS of Schizophrenia<sup>1</sup> using the GTEx bulk RNAseq dataset <sup>2</sup> as a reference.  The results are plotted below:</p> <p>.</p> <p>Similar to the results when S-LDSC is applied to this GWAS using the GTEx/Franke lab reference, GTEx MAGMA analysis identifies the brain as a key site of disease activity, but is unable to pinpoint a specific region.</p> <ol> <li> <p>Vassily Trubetskoy, Antonio F Pardi\u00f1as, Ting Qi, Georgia Panagiotaropoulou, Swapnil Awasthi, Tim B Bigdeli, Julien Bryois, Chia-Yen Chen, Charlotte A Dennison, Lynsey S Hall, and others. Mapping genomic loci implicates genes and synaptic biology in schizophrenia. Nature, 604(7906):502\u2013508, 2022. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC9392466/.\u00a0\u21a9</p> </li> <li> <p>GTEx Consortium. The gtex consortium atlas of genetic regulatory effects across human tissues. Science, 369(6509):1318\u20131330, 2020. URL: https://www.science.org/doi/full/10.1126/science.aaz1776.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/PGC_2022_%28SCH%29/MAGMA-HBA/","title":"MAGMA HBA Analysis","text":""},{"location":"Analysis/PGC_2022_%28SCH%29/MAGMA-HBA/#magma-hba-analysis","title":"MAGMA HBA Analysis","text":"<p>I applied MAGMA to the PGC 2022 GWAS of schizophrenia using single-cell RNAseq read-counts from the Human Brain Atlas<sup>1</sup> as reference data. This was an attempt to verify that I could reproduce the results of Duncan et al.<sup>2</sup>.</p>"},{"location":"Analysis/PGC_2022_%28SCH%29/MAGMA-HBA/#results","title":"Results","text":"<p>The results are plotted below:</p> <p></p> <p>These results closely match those of Duncan et al.  Like Duncan et al., we find that the most significant cell type for Schizophrenia is the Somatostatin MGE Interneuron.</p> <p>When we apply a technique based on Watanabe et al.'s to identify independently significant clusters, we get the following results:</p> Retained_clusters P Supercluster Class auto-annotation Neurotransmitter auto-annotation Neuropeptide auto-annotation Subtype auto-annotation Transferred MTG Label Top three regions Top Enriched Genes Cluster239 5.4105e-16 MGE interneuron NEUR GABA CCK CHGA CHGB CORT IGF NAMPT NMU NPPC NUCB NXPH PNOC SCG SST TAC UBL VGF proSAAS INT-SST Cerebral cortex: 95.4%, Hippocampus: 1.5%, Basal forebrain: 1.2% AC022905.1, NMU, MAFB, SCARA5, PRDM1, TRBC2, MYO5B, PDCL2, BLM, PNOC Cluster280 1.8714e-15 CGE interneuron NEUR GABA CCK CHGA CHGB CRH IGF NAMPT NUCB PNOC SCG UBL VIP proSAAS INT-VIP Cerebral cortex: 73.7%, Amygdala: 13.3%, Hippocampus: 7.8% AC006305.1, LINC01416, AL391832.4, LINC01905, SP8, DCN, CHRNB3, CXCL14, CHRNA7, CRH Cluster132 2.4393e-13 Miscellaneous NEUR VGLUT1 VGLUT2 CBLN CCK CHGA CHGB NAMPT NUCB SCG UBL VGF proSAAS 0 Cerebral cortex: 98.4%, Hippocampus: 0.8%, Midbrain: 0.8% CD53, DPP4, AC060765.1, LINC01721, AC112770.1, AL157769.1, VIPR2, PCSK1, AC016687.2, QRFPR Cluster231 1.9584e-12 Eccentric medium spiny neuron NEUR GABA CHGB NAMPT NUCB PDYN PENK SCG VGF proSAAS MSN-D1 Amygdala: 60.2%, Basal forebrain: 16.4%, Cerebral cortex: 13.7% LMNTD1, NPFFR2, AC012078.2, ZNF736P9Y, GABRQ, EYA2, PCDH11Y, CAPSL, DRAXIN, ITGA6 Cluster404 6.6585e-08 Miscellaneous NEUR VGLUT1 CBLN CCK CHGA CHGB IGF NAMPT NUCB NXPH SCG SST TAC VGF proSAAS 0 Cerebral cortex: 94.4%, Amygdala: 2.5%, Basal forebrain: 1.2% AC016687.2, AC021134.1, LINC02378, LINC02263, LINC01915, CXCL14, AL033539.2, AC004862.1, AC073578.2, LINC02306 Cluster407 7.0269e-06 Amygdala excitatory NEUR VGLUT2 VGLUT3 CART CCK CHGA CHGB NAMPT NUCB NXPH SCG TAC UBL VGF proSAAS 0 Amygdala: 72.6%, Cerebral cortex: 23.5%, Hippocampus: 2.7% TFAP2C, PAPPA2, CARTPT, BARHL2, LINC01798, MEIS1-AS3, AC006065.4, LHX9, GALR1, POU2F3 Cluster456 1.6412e-05 Thalamic excitatory NEUR VGLUT2 ADCYAP CART CBLN CCK CHGA CHGB CRH NAMPT NUCB NXPH SCG UBL VGF proSAAS 0 Thalamus: 99.8%, Hippocampus: 0.2%, Cerebral cortex: 0.0% ST8SIA6, AC012535.1, AC093334.1, ST8SIA6-AS1, AP000331.1, AC006487.1, SHOX2, ANXA3, AC087482.1, VANGL1 <p>Here is a the plot of significant clusters again, this time with independently significant clusters labeled:</p> <p></p> <p>It is interesting to observe the fairly significant overlap with the significant clusters found in the analysis of the educational attainment GWAS.</p> <ol> <li> <p>Kimberly Siletti, Rebecca Hodge, Alejandro Mossi Albiach, Ka Wai Lee, Song-Lin Ding, Lijuan Hu, Peter L\u00f6nnerberg, Trygve Bakken, Tamara Casper, Michael Clark, and others. Transcriptomic diversity of cell types across the adult human brain. Science, 382(6667):eadd7046, 2023. URL: https://www.science.org/doi/abs/10.1126/science.add7046.\u00a0\u21a9</p> </li> <li> <p>Laramie E Duncan, Tayden Li, Madeleine Salem, Will Li, Leili Mortazavi, Hazal Senturk, Naghmeh Shahverdizadeh, Sam Vesuna, Hanyang Shen, Jong Yoon, and others. Mapping the cellular etiology of schizophrenia and complex brain phenotypes. Nature Neuroscience, 28(2):248\u2013258, 2025. URL: https://www.nature.com/articles/s41593-024-01834-w.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/PGC_2022_%28SCH%29/S-LDSC_SCH_Analysis/","title":"S-LDSC Analysis of SCH","text":""},{"location":"Analysis/PGC_2022_%28SCH%29/S-LDSC_SCH_Analysis/#s-ldsc-analysis-of-sch","title":"S-LDSC Analysis of SCH","text":"<p>I used Stratified Linkage Disequilibrium Score Regression (S-LDSC) to analyze summary statistics from a GWAS of Schizophrenia from the Psychiatric Genetic Consortium<sup>1</sup>.  For the current analysis, I focused only European participants.</p> <p>I used the standard reference data sources to associate chromatin regions with cell or tissue types. These reference data sources were:</p> <ul> <li>The GTEx Project</li> <li>The Franke lab dataset</li> <li>The Roadmap Epigenetic Project</li> <li>The Corces et al. ATAC-seq dataset of 13 blood cell types.</li> <li>The ImmGen Project</li> <li>The Cahoy Mouse Central Nervous System Dataset</li> </ul>"},{"location":"Analysis/PGC_2022_%28SCH%29/S-LDSC_SCH_Analysis/#results","title":"Results","text":""},{"location":"Analysis/PGC_2022_%28SCH%29/S-LDSC_SCH_Analysis/#gtex-and-franke-lab-tissue-expression-data","title":"GTEx and Franke lab tissue expression data","text":"<p>The plot below illustrates the pattern of S-LDSC p values across cell types. The table shows the cell types with the lowest p values.</p> <p></p> Name Coefficient Coefficient_P_value Reject Null A08.186.211.730.885.287.500.Cerebral.Cortex 8.47046e-08 3.98912e-19 True A08.186.211.464.710.225.Entorhinal.Cortex 8.82079e-08 5.25314e-19 True A08.186.211.464.Limbic.System 8.59402e-08 5.35036e-19 True Brain_Frontal_Cortex_(BA9) 7.50537e-08 2.70948e-18 True Brain_Cortex 7.43564e-08 3.53839e-18 True Brain_Anterior_cingulate_cortex_(BA24) 7.3208e-08 1.8928e-16 True A08.186.211.464.405.Hippocampus 7.93705e-08 2.02728e-16 True A08.186.211.Brain 8.6903e-08 2.41997e-16 True Brain_Hippocampus 6.32123e-08 8.39121e-15 True Brain_Cerebellar_Hemisphere 5.94796e-08 7.06571e-14 True Brain_Amygdala 6.0501e-08 3.274e-13 True Brain_Putamen_(basal_ganglia) 6.33216e-08 1.64665e-12 True A08.186.211.132.Brain.Stem 6.74624e-08 2.27026e-12 True Brain_Cerebellum 5.66552e-08 4.05769e-12 True A08.186.211.730.885.287.500.571.735.Visual.Cortex 6.7991e-08 8.32935e-12 True Brain_Nucleus_accumbens_(basal_ganglia) 5.99918e-08 1.19195e-11 True Brain_Caudate_(basal_ganglia) 6.11288e-08 2.41973e-11 True A08.186.211.730.885.287.500.270.Frontal.Lobe 6.86582e-08 1.13253e-10 True Brain_Substantia_nigra 5.53578e-08 1.26689e-10 True A08.186.211.730.885.287.500.670.Parietal.Lobe 6.54824e-08 1.3482e-10 True A08.186.211.132.810.428.200.Cerebellum 6.13038e-08 4.10792e-10 True Brain_Hypothalamus 4.90558e-08 1.61256e-09 True A08.186.211.865.428.Metencephalon 5.9104e-08 3.64513e-09 True A08.186.211.730.885.287.249.Basal.Ganglia 5.14062e-08 9.02497e-07 True Brain_Spinal_cord_(cervical_c-1) 4.00887e-08 2.68969e-06 True A08.186.211.730.317.Diencephalon 5.77876e-08 5.75561e-06 True A08.186.211.653.Mesencephalon 3.83026e-08 8.03001e-05 True A08.186.211.730.317.357.Hypothalamus 5.184e-08 0.000119281 True A08.186.211.730.885.287.249.487.Corpus.Striatum 3.79874e-08 0.000125097 True A09.371.729.Retina 3.16838e-08 0.000147619 True A11.872.653.Neural.Stem.Cells 4.28784e-08 0.00020438 True A08.186.211.730.317.357.352.435.Hypothalamo.Hypophyseal.System 4.51566e-08 0.00146605 True A11.118.637.555.567.562.440.Precursor.Cells..B.Lymphoid 3.17402e-08 0.00412467 False A11.118.637.555.567.569.T.Lymphocytes 3.0355e-08 0.00699123 False A15.145.229.637.555.567.569.200.CD4.Positive.T.Lymphocytes 2.72466e-08 0.0118845 False A15.145.Blood 2.7143e-08 0.022607 False A11.118.637.555.567.569.200.700.T.Lymphocytes..Regulatory 1.71779e-08 0.060104 False A15.145.229.Blood.Cells 2.08363e-08 0.0640231 False A11.872.378.590.635.Granulocyte.Macrophage.Progenitor.Cells 1.63959e-08 0.0854463 False A15.382.490.315.583.Neutrophils 1.63362e-08 0.10354 False A11.118.637.Leukocytes 1.58603e-08 0.115801 False Muscle_Skeletal 1.10094e-08 0.129756 False Artery_Tibial 1.03624e-08 0.176228 False A15.378.316.580.Monocytes 1.13324e-08 0.199719 False A15.382.520.604.800.Palatine.Tonsil 8.02661e-09 0.223744 False Pituitary 7.09361e-09 0.236527 False A15.145.229.637.555.Leukocytes..Mononuclear 5.93882e-09 0.28341 False A15.382.490.555.567.Lymphocytes 6.12958e-09 0.299802 False <p>The specificity of the signal for central nervous system cell types is consistent with the known biology of schizophrenia as a neurological condition.  Of the non-significant cell types, immune cells are closest to being significant, which is consistent with theories of the role of the immune system in the development of Schizophrenia  (See pg. 50 and pg. 1647 in Kandel et al.<sup>2</sup>).</p>"},{"location":"Analysis/PGC_2022_%28SCH%29/S-LDSC_SCH_Analysis/#roadmap-chromatin-data","title":"Roadmap Chromatin data","text":"<p>I next applied S-LDSC to the schizophrenia GWAS using reference data generated by Finucane et al.<sup>3</sup> from the Roadmap Epigenetics Project</p> <p>The results are shown in the graph and table below.</p> <p></p> Name Coefficient Coefficient_P_value Reject Null Fetal_Brain_Male__DNase 1.68738e-06 4.74122e-22 True Fetal_Brain_Female__DNase 1.72679e-06 2.12598e-19 True Fetal_Brain_Female__H3K4me3 2.77978e-06 4.96519e-17 True Fetal_Brain_Male__H3K4me1 7.68472e-07 1.65669e-14 True Brain_Germinal_Matrix__H3K4me3 2.7504e-06 2.05815e-14 True Brain_Dorsolateral_Prefrontal_Cortex__H3K27ac 9.67876e-07 6.35169e-14 True Brain_Anterior_Caudate__H3K4me1 6.73639e-07 2.08363e-12 True Brain_Inferior_Temporal_Lobe__H3K27ac 6.39341e-07 2.33773e-12 True Brain_Dorsolateral_Prefrontal_Cortex__H3K4me3 2.8196e-06 2.69558e-12 True Brain_Angular_Gyrus__H3K4me3 2.71607e-06 5.17278e-12 True Brain_Angular_Gyrus__H3K4me1 8.00012e-07 9.72589e-12 True Brain_Inferior_Temporal_Lobe__H3K4me3 2.19647e-06 1.18606e-11 True Brain_Anterior_Caudate__H3K27ac 5.85791e-07 1.32123e-11 True Brain_Angular_Gyrus__H3K27ac 8.13771e-07 1.40954e-11 True Brain_Dorsolateral_Prefrontal_Cortex__H3K4me1 1.01035e-06 4.05928e-11 True Fetal_Brain_Female__H3K4me1 1.05581e-06 1.26443e-10 True Brain_Dorsolateral_Prefrontal_Cortex__H3K9ac 2.26479e-06 3.4872e-10 True Brain_Anterior_Caudate__H3K9ac 1.0844e-06 4.82425e-10 True Fetal_Brain_Female__H3K36me3 5.79725e-07 7.90235e-10 True Brain_Cingulate_Gyrus__H3K9ac 1.47375e-06 1.69795e-09 True Brain_Angular_Gyrus__H3K9ac 1.38489e-06 5.17934e-09 True Brain_Cingulate_Gyrus__H3K4me1 5.86637e-07 5.19947e-09 True Ganglion_Eminence_derived_primary_cultured_neurospheres__H3K4me3 1.57836e-06 5.34906e-09 True Brain_Cingulate_Gyrus__H3K4me3 2.03552e-06 8.42614e-09 True Brain_Anterior_Caudate__H3K4me3 1.5262e-06 2.21405e-08 True Brain_Germinal_Matrix__H3K4me1 9.61141e-07 2.70825e-08 True Brain_Germinal_Matrix__H3K36me3 7.31311e-07 3.62691e-08 True Cortex_derived_primary_cultured_neurospheres__H3K4me3 1.9088e-06 7.93075e-08 True Brain_Cingulate_Gyrus__H3K27ac 5.22876e-07 1.20097e-07 True Brain_Hippocampus_Middle__H3K4me1 3.88849e-07 1.44024e-07 True Brain_Dorsolateral_Prefrontal_Cortex__H3K36me3 7.34169e-07 8.23128e-07 True Brain_Inferior_Temporal_Lobe__H3K9ac 9.45094e-07 1.01577e-06 True Brain_Angular_Gyrus__H3K36me3 7.09494e-07 1.26005e-06 True Brain_Inferior_Temporal_Lobe__H3K4me1 6.24768e-07 2.82109e-06 True Brain_Hippocampus_Middle__H3K4me3 9.85198e-07 1.80801e-05 True Ganglion_Eminence_derived_primary_cultured_neurospheres__H3K4me1 5.15632e-07 2.35424e-05 True Brain_Inferior_Temporal_Lobe__H3K36me3 4.74221e-07 2.69696e-05 True Brain_Hippocampus_Middle__H3K27ac 3.29051e-07 6.20309e-05 True Primary_T_cells_from_cord_blood__DNase 7.41953e-07 0.000137651 True Primary_B_cells_from_peripheral_blood__DNase 6.10191e-07 0.000146033 True Brain_Substantia_Nigra__H3K4me1 3.04377e-07 0.000193331 True Brain_Anterior_Caudate__H3K36me3 4.48397e-07 0.000217432 True Cortex_derived_primary_cultured_neurospheres__H3K36me3 4.0351e-07 0.000398369 True Spleen_ENTEX__H3K27ac 1.54866e-07 0.000520367 True Ganglion_Eminence_derived_primary_cultured_neurospheres__H3K36me3 3.65732e-07 0.000644606 True Brain_Hippocampus_Middle__H3K36me3 3.00257e-07 0.000730833 True Cortex_derived_primary_cultured_neurospheres__H3K4me1 2.95148e-07 0.000907247 True Brain_Cingulate_Gyrus__H3K36me3 4.24078e-07 0.00107608 False Pancreatic_Islets__H3K4me1 2.63705e-07 0.00111471 False Brain_Substantia_Nigra__H3K9ac 5.91492e-07 0.00140614 False Esoph-GJ_ENTEX__H3K4me3 7.76109e-07 0.0014798 False Heart-Atrial_ENTEX__H3K27ac 1.7608e-07 0.0020061 False skeletal_muscle_ENTEX__H3K4me1 1.2165e-07 0.00232854 False <p>As we saw with the gene expression data, signal is highly concentrated in central nervous system tissues.  Unlike with the gene expression data, with the roadmap data we also seem some immune-related tissues and cell types reaching significance, consistent with the purposed role of the immune system in schizophrenia pathogenesis<sup>2</sup>.</p>"},{"location":"Analysis/PGC_2022_%28SCH%29/S-LDSC_SCH_Analysis/#immgen-data","title":"ImmGen Data","text":"<p>The next step is to use the S-LDSC reference data derived from the ImmGen project. In this case, no cell types are significant. The top non-significant cell types are shown below:</p> Name Coefficient Coefficient_P_value Reject Null B.FrE.BM 3.69752e-08 0.000926076 False preT.ETP-2A.Th 3.41931e-08 0.0023043 False NKT.44-NK1.1-.Th 3.05201e-08 0.00344786 False B.T1.Sp 2.71268e-08 0.00707957 False CD19Control 2.72862e-08 0.00819193 False T.4int8+.Th 2.81369e-08 0.00889715 False B.Fo.Sp 2.81622e-08 0.00942477 False proB.FrA.BM 2.62878e-08 0.01131 False <p>This inability to localize the signal to a specific immune cell type using the ImmGen data may reflect insufficient power in the schhizophrenia GWAS, or a weakness of the mouse-derived ImmGen data as a reference for S-LDSC.</p>"},{"location":"Analysis/PGC_2022_%28SCH%29/S-LDSC_SCH_Analysis/#corces-et-al-atac-seq-data","title":"Corces et al. ATAC-seq data","text":"<p>Similarly, we are not able to identify any specific cell type using the Corces ATAC-seq dataset:</p> Name Coefficient Coefficient_P_value Reject Null Bcell 3.05376e-07 0.0179416 False CD8 1.30937e-07 0.180235 False Erythro 4.99447e-08 0.399927 False NK 2.49454e-08 0.426503 False CD4 3.11632e-09 0.490951 False MEP -1.24416e-08 0.542468 False Mono -6.1538e-08 0.610702 False CMP -9.74273e-08 0.797071 False"},{"location":"Analysis/PGC_2022_%28SCH%29/S-LDSC_SCH_Analysis/#cahoy-and-gtex-brain-data","title":"Cahoy and GTEx-Brain data","text":"<p>As expected, the Cahoy dataset strongly localizes the Schizophrenia GWAS signal in neurons:</p> Name Coefficient Coefficient_P_value Reject Null Neuron 4.48721e-08 5.83951e-06 True Oligodendrocyte 1.91268e-08 0.0638051 False Astrocyte -1.22911e-08 0.872973 False <p>The GTEx brain dataset points to the cortex as a key site of disease activity. Here are tissue types with the lowest p values:</p> Name Coefficient Coefficient_P_value Reject Null Brain_Frontal_Cortex_(BA9) 4.66646e-08 1.63948e-09 True Brain_Cortex 5.20674e-08 2.42723e-09 True Brain_Anterior_cingulate_cortex_(BA24) 3.91227e-08 3.47957e-06 True Brain_Cerebellar_Hemisphere 2.96201e-08 0.00209779 True Brain_Cerebellum 1.97362e-08 0.0162309 False Brain_Putamen_(basal_ganglia) 5.0827e-10 0.479543 False Brain_Nucleus_accumbens_(basal_ganglia) -5.24356e-10 0.523653 False Brain_Hippocampus -2.20603e-09 0.584205 False Brain_Amygdala -2.75695e-09 0.623402 False Brain_Caudate_(basal_ganglia) -4.64408e-09 0.697234 False Brain_Hypothalamus -2.18885e-08 0.993308 False Brain_Spinal_cord_(cervical_c-1) -2.66567e-08 0.996263 False Brain_Substantia_nigra -3.35068e-08 0.999814 False"},{"location":"Analysis/PGC_2022_%28SCH%29/S-LDSC_SCH_Analysis/#reproducing","title":"Reproducing","text":"<p>Reproduce these results using the Schizophrenia Analysis Script.</p> <ol> <li> <p>Vassily Trubetskoy, Antonio F Pardi\u00f1as, Ting Qi, Georgia Panagiotaropoulou, Swapnil Awasthi, Tim B Bigdeli, Julien Bryois, Chia-Yen Chen, Charlotte A Dennison, Lynsey S Hall, and others. Mapping genomic loci implicates genes and synaptic biology in schizophrenia. Nature, 604(7906):502\u2013508, 2022. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC9392466/.\u00a0\u21a9</p> </li> <li> <p>Eric R. Kandel, John D. Koester, and Steven A. Mack, Sarah H. Siegelbaum. Principles of neural science 6th edition. Elsevier New York, 2021. URL: https://www.amazon.ca/Principles-Neural-Science-Sixth-Kandel-ebook-dp-B08LNXDCS3/dp/B08LNXDCS3.\u00a0\u21a9\u21a9</p> </li> <li> <p>Hilary K Finucane, Yakir A Reshef, Verneri Anttila, Kamil Slowikowski, Alexander Gusev, Andrea Byrnes, Steven Gazal, Po-Ru Loh, Caleb Lareau, Noam Shoresh, and others. Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types. Nature genetics, 50(4):621\u2013629, 2018. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC5896795/.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Pirruccello_et_al_2022_%28Heart%29/S_LDSC_RVEF_Analysis/","title":"S-LDSC Analysis of RVEF","text":""},{"location":"Analysis/Pirruccello_et_al_2022_%28Heart%29/S_LDSC_RVEF_Analysis/#s-ldsc-analysis-of-rvef","title":"S-LDSC Analysis of RVEF","text":"<p>I used Stratified Linkage Disequilibrium Score Regression (S-LDSC) to analyze summary statistics from a GWAS of MRI-determined right ventricular ejection fraction (RVEF) by Pirruccello et al.<sup>1</sup> </p> <p>I used the standard reference data sources to associate chromatin regions with cell or tissue types. These reference data sources were:</p> <ul> <li>The GTEx Project</li> <li>The Franke lab dataset</li> <li>The Roadmap Epigenetic Project</li> <li>The Corces et al. ATAC-seq dataset of 13 blood cell types.</li> <li>The ImmGen Project</li> <li>The Cahoy Mouse Central Nervous System Dataset</li> </ul>"},{"location":"Analysis/Pirruccello_et_al_2022_%28Heart%29/S_LDSC_RVEF_Analysis/#results","title":"Results","text":""},{"location":"Analysis/Pirruccello_et_al_2022_%28Heart%29/S_LDSC_RVEF_Analysis/#gtex-and-franke-lab-tissue-expression-data","title":"GTEx and Franke lab tissue expression data","text":"<p>The plot below illustrates the pattern of S-LDSC p values across cell types. The table shows the cell types with the lowest p values.</p> <p></p> Name Coefficient Coefficient_P_value Reject Null Heart_Left_Ventricle 2.59059e-08 4.37654e-05 True Muscle_Skeletal 2.28636e-08 0.000112161 False A07.541.560.Heart.Ventricles 2.25644e-08 0.000183698 False A07.541.Heart 2.16562e-08 0.000203794 False Heart_Atrial_Appendage 1.91676e-08 0.000272105 False A07.541.358.Heart.Atria 1.68989e-08 0.00406107 False A02.633.567.850.Quadriceps.Muscle 1.82694e-08 0.00554677 False A07.541.358.100.Atrial.Appendage 1.5286e-08 0.00909596 False <p>Given that our phenotype is related to the contractive power of a ventricle, this makes sense.  I assume that the match with  left ventricular tissue type is caused by transcriptomic overlap between the left and right ventricles</p> <p>It is also interesting to observe that all the top cell types are musculoskeletal. This indicates that the key expression patterns that LDSC is picking up are likely characteristic of muscle.</p>"},{"location":"Analysis/Pirruccello_et_al_2022_%28Heart%29/S_LDSC_RVEF_Analysis/#roadmap-chromatin-data","title":"Roadmap Chromatin data","text":"<p>I next applied S-LDSC to the RVEF GWAS using reference data generated by Finucane et al.<sup>2</sup> from the Roadmap Epigenetics Project</p> <p>The results are shown in the graph and table below.</p> <p></p> Name Coefficient Coefficient_P_value Reject Null Right_Ventricle__H3K27ac 3.94707e-07 1.33824e-06 True Left_Ventricle__H3K27ac 2.80259e-07 1.34429e-06 True Fetal_Heart__H3K9ac 3.62558e-07 2.31896e-06 True Stomach_Smooth_Muscle__H3K4me3 6.11652e-07 2.7594e-06 True Fetal_Heart__DNase 3.67744e-07 5.20833e-06 True Right_Atrium__H3K27ac 3.42679e-07 1.7163e-05 True Colon_Smooth_Muscle__H3K4me3 6.20742e-07 7.11116e-05 True Skeletal_Muscle_Male__H3K4me3 5.99152e-07 0.000103465 True Ovary__H3K4me1 2.59535e-07 0.000340226 False Fetal_Heart__H3K4me1 1.3078e-07 0.000356224 False Ovary__H3K27ac 3.01364e-07 0.000510812 False Colon_Smooth_Muscle__H3K27ac 1.74983e-07 0.000570302 False Esoph-GJ_ENTEX__H3K4me3 5.49898e-07 0.00060134 False Heart-Atrial_ENTEX__H3K27ac 1.24243e-07 0.000604863 False Colon_Smooth_Muscle__H3K4me1 1.71125e-07 0.000623398 False Fetal_Muscle_Leg__H3K4me3 9.45169e-07 0.00067477 False Skeletal_Muscle_Female__H3K4me3 4.72043e-07 0.00123306 False NHDF-Ad_Adult_Dermal_Fibroblast_Primary_Cells__H3K36me3 4.26679e-07 0.00133146 False <p>Impressively, the most significant tissue here is the right ventricle, consistent with the phenotype.  Moreover, all other significant tissues are types of muscle, reinforcing the impression that LDSC has  picked up on muscle-specific gene expression patterns.</p> <p>The presence of \"Ovary\" at a low but insignificant p value may be noise, or may point to a sex-hormone effect on heart function.</p>"},{"location":"Analysis/Pirruccello_et_al_2022_%28Heart%29/S_LDSC_RVEF_Analysis/#immgen-data","title":"ImmGen Data","text":"<p>No ImmGen cell types were significant, consistent with RVEF being a mainly non-immune phenotype.</p> <p>Here are the lowest p values:</p> Name Coefficient Coefficient_P_value Reject Null Tgd.vg4+24ahi.e17.Th 2.82104e-08 0.00539746 False Tgd.vg2+24ahi.e17.Th.v2 2.13139e-08 0.00648692 False CD4.24h.LN 2.13795e-08 0.010458 False B.Fo.LN 1.39012e-08 0.0130979 False B1a.PC 1.20947e-08 0.0233794 False CD8.24h.LN 1.64771e-08 0.0254857 False DC.pDC.8+.Sp 1.2325e-08 0.0278243 False LEC.SLN.CFA.d6.v2 1.25117e-08 0.0288681 False preB.FrD.BM 1.15162e-08 0.0325545 False B.Fo.MLN 1.17467e-08 0.0338449 False preB.FrD.FL 1.72978e-08 0.035241 False Tgd.vg2+24ahi.Th 1.4413e-08 0.038868 False"},{"location":"Analysis/Pirruccello_et_al_2022_%28Heart%29/S_LDSC_RVEF_Analysis/#corces-et-al-atac-seq-data","title":"Corces et al. ATAC-seq data","text":"<p>Similar to the above, no cell types were significant when we used the Corces ATAC-seq dataset. The lowest p values are below</p> Name Coefficient Coefficient_P_value Reject Null Erythro 2.35709e-07 0.119 False Bcell 4.14389e-08 0.337901 False MEP -3.19943e-08 0.632292 False MPP -4.04893e-08 0.694066 False HSC -4.9625e-08 0.733438 False CMP -6.57733e-08 0.768703 False CLP -1.05289e-07 0.789269 False GMP -1.24871e-07 0.931607 False"},{"location":"Analysis/Pirruccello_et_al_2022_%28Heart%29/S_LDSC_RVEF_Analysis/#cahoy-and-gtex-brain-data","title":"Cahoy and GTEx-Brain data","text":"<p>No cell types were significant in the Cahoy or GTEx brain datasets, indicating that the GWAS did not detect significant associations between neurological cell types and right ventricular function.</p> Name Coefficient Coefficient_P_value Reject Null Neuron 8.00207e-09 0.124024 False Oligodendrocyte -6.04124e-09 0.823426 False Astrocyte -5.98411e-09 0.867185 False Name Coefficient Coefficient_P_value Reject Null Brain_Cerebellar_Hemisphere 1.10584e-08 0.10896 False Brain_Cerebellum 7.64012e-09 0.196354 False Brain_Frontal_Cortex_(BA9) 8.0182e-10 0.434653 False Brain_Cortex 2.58682e-10 0.48244 False Brain_Substantia_nigra 3.19984e-11 0.497729 False Brain_Hippocampus -3.92956e-10 0.520903 False Brain_Anterior_cingulate_cortex_(BA24) -4.1335e-10 0.534662 False Brain_Hypothalamus -1.52283e-09 0.613854 False Brain_Amygdala -1.59616e-09 0.620004 False Brain_Spinal_cord_(cervical_c-1) -4.26574e-09 0.754433 False Brain_Caudate_(basal_ganglia) -6.2817e-09 0.92293 False Brain_Putamen_(basal_ganglia) -1.20152e-08 0.986481 False Brain_Nucleus_accumbens_(basal_ganglia) -1.4452e-08 0.992423 False"},{"location":"Analysis/Pirruccello_et_al_2022_%28Heart%29/S_LDSC_RVEF_Analysis/#reproducing","title":"Reproducing","text":"<p>To reproduce this analysis, use the right heart analysis script.</p> <ol> <li> <p>James P Pirruccello, Paolo Di Achille, Victor Nauffal, Mahan Nekoui, Samuel F Friedman, Marcus DR Klarqvist, Mark D Chaffin, Lu-Chen Weng, Jonathan W Cunningham, Shaan Khurshid, and others. Genetic analysis of right heart structure and function in 40,000 people. Nature genetics, 54(6):792\u2013803, 2022. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC10313645/.\u00a0\u21a9</p> </li> <li> <p>Hilary K Finucane, Yakir A Reshef, Verneri Anttila, Kamil Slowikowski, Alexander Gusev, Andrea Byrnes, Steven Gazal, Po-Ru Loh, Caleb Lareau, Noam Shoresh, and others. Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types. Nature genetics, 50(4):621\u2013629, 2018. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC5896795/.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Pirruccello_et_al_2022_%28Heart%29/rvef_master_gene_list/","title":"Master Gene List for RVEF","text":""},{"location":"Analysis/Pirruccello_et_al_2022_%28Heart%29/rvef_master_gene_list/#master-gene-list-for-rvef","title":"Master Gene List for RVEF","text":"Ensembl ID sources uniprot_id primary_gene_name subcellular_localisation ensembl_description uniprot_description ncbi_description ENSG00000079150 ['MAGMA'] ['Q9Y680'] ['FKBP7'] ['Endoplasmic reticulum lumen'] FKBP prolyl isomerase 7 [Source:HGNC Symbol;Acc:HGNC:3723] ['PPIases accelerate the folding of proteins during protein synthesis'] The protein encoded by this gene belongs to the FKBP-type peptidyl-prolyl cis/trans isomerase (PPIase) family. Members of this family exhibit PPIase activity and function as molecular chaperones. A similar protein in mouse is located in the endoplasmic reticulum and binds calcium. [provided by RefSeq, Jul 2008] ENSG00000079257 ['MAGMA'] ['Q9BS40'] ['LXN'] ['Cytoplasm'] latexin [Source:HGNC Symbol;Acc:HGNC:13347] ['Hardly reversible, non-competitive, and potent inhibitor of CPA1, CPA2 and CPA4. May play a role in inflammation'] This gene encodes the only known protein inhibitor of zinc-dependent metallocarboxypeptidases. The encoded protein, latexin, downregulates the population size of hematopoietic stem cells. This protein is found to be downregulated in cancer cells because of promoter hypermethylation. [provided by RefSeq, Jul 2020] ENSG00000079459 ['MAGMA'] ['P37268'] ['FDFT1'] ['Endoplasmic reticulum membrane'] farnesyl-diphosphate farnesyltransferase 1 [Source:HGNC Symbol;Acc:HGNC:3629] ['Catalyzes the condensation of 2 farnesyl pyrophosphate (FPP) moieties to form squalene. Proceeds in two distinct steps. In the first half-reaction, two molecules of FPP react to form the stable presqualene diphosphate intermediate (PSQPP), with concomitant release of a proton and a molecule of inorganic diphosphate. In the second half-reaction, PSQPP undergoes heterolysis, isomerization, and reduction with NADPH or NADH to form squalene. It is the first committed enzyme of the sterol biosynthesis pathway'] This gene encodes a membrane-associated enzyme located at a branch point in the mevalonate pathway. The encoded protein is the first specific enzyme in cholesterol biosynthesis, catalyzing the dimerization of two molecules of farnesyl diphosphate in a two-step reaction to form squalene. [provided by RefSeq, Jul 2008] ENSG00000091583 ['MAGMA'] ['P02749'] ['APOH'] ['Secreted'] apolipoprotein H [Source:HGNC Symbol;Acc:HGNC:616] ['Binds to various kinds of negatively charged substances such as heparin, phospholipids, and dextran sulfate. May prevent activation of the intrinsic blood coagulation cascade by binding to phospholipids on the surface of damaged cells'] Apolipoprotein H, also known as beta-2-glycoprotein I, is a component of circulating plasma lipoproteins. It has been implicated in a variety of physiologic pathways including lipoprotein metabolism, coagulation, hemostasis, and the production of antiphospholipid autoantibodies. APOH may be a required cofactor for anionic phospholipid binding by the antiphospholipid autoantibodies found in sera of many patients with lupus and primary antiphospholipid syndrome (APS). The anti-beta (2) glycoprotein I antibodies from APS patients, mediate inhibition of activated protein C which has anticoagulant properties. Because beta-2-GPI is the main autoantigen in patients with APS, the disruption of this pathway by autoantibodies may be an important mechanism for thrombosis in patients with APS.[provided by RefSeq, Dec 2019] ENSG00000100629 ['GWASLAB'] ['Q6ZU80'] ['CEP128'] ['Cytoplasm, cytoskeleton, microtubule organizing center, centrosome', 'Cytoplasm, cytoskeleton, microtubule organizing center, centrosome, centriole', 'Cytoplasm, cytoskeleton, spindle pole'] centrosomal protein 128 [Source:HGNC Symbol;Acc:HGNC:20359] [] Involved in protein localization. Located in Golgi apparatus; microtubule cytoskeleton; and nuclear membrane. Part of centriolar subdistal appendage. [provided by Alliance of Genome Resources, Jul 2025] ENSG00000104626 ['MAGMA'] ['Q8IV48'] ['ERI1'] ['Cytoplasm', 'Nucleus', 'Nucleus, nucleolus'] exoribonuclease 1 [Source:HGNC Symbol;Acc:HGNC:23994] [\"RNA exonuclease that binds to the 3'-end of histone mRNAs and degrades them, suggesting that it plays an essential role in histone mRNA decay after replication (PubMed:14536070, PubMed:16912046, PubMed:17135487, PubMed:37352860). A 2' and 3'-hydroxyl groups at the last nucleotide of the histone 3'-end is required for efficient 3'-end histone mRNA exonuclease activity and degradation of RNA substrates (PubMed:14536070, PubMed:16912046, PubMed:17135487). Also able to degrade the 3'-overhangs of short interfering RNAs (siRNAs) in vitro, suggesting a possible role as regulator of RNA interference (RNAi) (PubMed:14961122). Required for binding the 5'-ACCCA-3' sequence present in stem-loop structure (PubMed:14536070, PubMed:16912046). Able to bind other mRNAs (PubMed:14536070, PubMed:16912046). Required for 5.8S rRNA 3'-end processing (PubMed:37352860). Also binds to 5.8s ribosomal RNA (By similarity). Binds with high affinity to the stem-loop structure of replication-dependent histone pre-mRNAs (PubMed:14536070, PubMed:16912046, PubMed:17135487). In vitro, does not have sequence specificity (PubMed:17135487). In vitro, has weak DNA exonuclease activity (PubMed:17135487). In vitro, shows biphasic kinetics such that there is rapid hydrolysis of the last three unpaired RNA nucleotides in the 39 flanking sequence followed by a much slower cleavage through the stem that occurs over a longer incubation period in the order of hours (PubMed:17135487). ERI1-mediated RNA metabolism plays a key role in chondrogenesis (PubMed:37352860)\"] Enables 3'-5' exonuclease activity. Involved in maturation of 5.8S rRNA. Located in cytoplasm and nucleolus. [provided by Alliance of Genome Resources, Jul 2025] ENSG00000104643 ['MAGMA'] ['Q96QG7'] ['MTMR9'] ['Cytoplasm', 'Cell projection, ruffle membrane', 'Cytoplasm, perinuclear region', 'Endoplasmic reticulum'] myotubularin related protein 9 [Source:HGNC Symbol;Acc:HGNC:14596] ['Acts as an adapter for myotubularin-related phosphatases (PubMed:19038970, PubMed:22647598). Increases lipid phosphatase MTMR6 catalytic activity, specifically towards phosphatidylinositol 3,5-bisphosphate and MTMR6 binding affinity for phosphorylated phosphatidylinositols (PubMed:19038970, PubMed:22647598). Positively regulates lipid phosphatase MTMR7 catalytic activity (By similarity). Increases MTMR8 catalytic activity towards phosphatidylinositol 3-phosphate (PubMed:22647598). The formation of the MTMR6-MTMR9 complex, stabilizes both MTMR6 and MTMR9 protein levels (PubMed:19038970). Stabilizes MTMR8 protein levels (PubMed:22647598). Plays a role in the late stages of macropinocytosis possibly by regulating MTMR6-mediated dephosphorylation of phosphatidylinositol 3-phosphate in membrane ruffles (PubMed:24591580). Negatively regulates autophagy, in part via its association with MTMR8 (PubMed:22647598). Negatively regulates DNA damage-induced apoptosis, in part via its association with MTMR6 (PubMed:19038970, PubMed:22647598). Does not bind mono-, di- and tri-phosphorylated phosphatidylinositols, phosphatidic acid and phosphatidylserine (PubMed:19038970)'] This gene encodes a myotubularin-related protein that is atypical to most other members of the myotubularin-related protein family because it has no dual-specificity phosphatase domain. The encoded protein contains a double-helical motif similar to the SET interaction domain, which is thought to have a role in the control of cell proliferation. In mouse, a protein similar to the encoded protein binds with MTMR7, and together they dephosphorylate phosphatidylinositol 3-phosphate and inositol 1,3-bisphosphate. [provided by RefSeq, Jul 2008] ENSG00000116095 ['MAGMA'] ['Q9HB20'] ['PLEKHA3'] ['Golgi apparatus, trans-Golgi network membrane'] pleckstrin homology domain containing A3 [Source:HGNC Symbol;Acc:HGNC:14338] [\"Plays a role in regulation of vesicular cargo transport from the trans-Golgi network (TGN) to the plasma membrane (PubMed:15107860). Regulates Golgi phosphatidylinositol 4-phosphate (PtdIns(4)P) levels and activates the PtdIns(4)P phosphatase activity of SACM1L when it binds PtdIns(4)P in 'trans' configuration (PubMed:30659099). Binds preferentially to PtdIns(4)P (PubMed:11001876, PubMed:15107860). Negatively regulates APOB secretion from hepatocytes (PubMed:30659099)\"] Enables identical protein binding activity and phosphatidylinositol-4-phosphate binding activity. Predicted to be involved in endosome organization; receptor recycling; and retrograde transport, endosome to Golgi. Located in Golgi apparatus. [provided by Alliance of Genome Resources, Jul 2025] ENSG00000116809 ['MAGMA'] ['Q13105'] ['ZBTB17'] ['Nucleus'] zinc finger and BTB domain containing 17 [Source:HGNC Symbol;Acc:HGNC:12936] ['Transcription factor that can function as an activator or repressor depending on its binding partners, and by targeting negative regulators of cell cycle progression. Plays a critical role in early lymphocyte development, where it is essential to prevent apoptosis in lymphoid precursors, allowing them to survive in response to IL7 and undergo proper lineage commitment. Has been shown to bind to the promoters of adenovirus major late protein and cyclin D1 and activate transcription. Required for early embryonic development during gastrulation. Represses RB1 transcription; this repression can be blocked by interaction with ZBTB49 isoform 3/ZNF509S1 (PubMed:25245946)'] This gene encodes a zinc finger protein involved in the regulation of c-myc. The symbol MIZ1 has also been associated with PIAS2 which is a different gene located on chromosome 18. [provided by RefSeq, Jul 2008] ENSG00000118849 ['MAGMA'] ['P49788'] ['RARRES1'] ['Membrane', 'Secreted'] retinoic acid receptor responder 1 [Source:HGNC Symbol;Acc:HGNC:9867] ['Inhibitor of the cytoplasmic carboxypeptidase AGBL2, may regulate the alpha-tubulin tyrosination cycle'] This gene was identified as a retinoid acid (RA) receptor-responsive gene. It encodes a type 1 membrane protein. The expression of this gene is upregulated by tazarotene as well as by retinoic acid receptors. The expression of this gene is found to be downregulated in prostate cancer, which is caused by the methylation of its promoter and CpG island. Alternatively spliced transcript variant encoding distinct isoforms have been observed. [provided by RefSeq, Jul 2008] ENSG00000134775 ['MAGMA', 'GWASLAB'] ['Q2V2M9'] ['FHOD3'] ['Cytoplasm, cytoskeleton', 'Cytoplasm, myofibril, sarcomere, Z line'] formin homology 2 domain containing 3 [Source:HGNC Symbol;Acc:HGNC:26178] ['Actin-organizing protein that may cause stress fiber formation together with cell elongation (By similarity). Isoform 4 may play a role in actin filament polymerization in cardiomyocytes'] The protein encoded by this gene is a member of the diaphanous-related formins (DRF), and contains multiple domains, including GBD (GTPase-binding domain), DID (diaphanous inhibitory domain), FH1 (formin homology 1), FH2 (formin homology 2), and DAD (diaphanous auto-regulatory domain) domains. This protein is thought to play a role in actin filament polymerization in cardiomyocytes. Mutations in this gene have been associated with dilated cardiomyopathy (DCM), characterized by dilation of the ventricular chamber, leading to impairment of systolic pump function and subsequent heart failure. Increased levels of the protein encoded by this gene have been observed in individuals with hypertrophic cardiomyopathy (HCM). Alternative splicing results in multiple transcript variants encoding different isoforms. A muscle-specific isoform has been shown to possess a casein kinase 2 (CK2) phosphorylation site at the C-terminal end of the FH2 domain. Phosphorylation of this site alters its interaction with sequestosome 1 (SQSTM1), and targets this isoform to myofibrils, while other isoforms form cytoplasmic aggregates. [provided by RefSeq, Aug 2015] ENSG00000136573 ['MAGMA', 'GWASLAB'] ['P51451'] ['BLK'] ['Cell membrane'] BLK proto-oncogene, Src family tyrosine kinase [Source:HGNC Symbol;Acc:HGNC:1057] [\"Non-receptor tyrosine kinase involved in B-lymphocyte development, differentiation and signaling (By similarity). B-cell receptor (BCR) signaling requires a tight regulation of several protein tyrosine kinases and phosphatases, and associated coreceptors (By similarity). Binding of antigen to the B-cell antigen receptor (BCR) triggers signaling that ultimately leads to B-cell activation (By similarity). Signaling through BLK plays an important role in transmitting signals through surface immunoglobulins and supports the pro-B to pre-B transition, as well as the signaling for growth arrest and apoptosis downstream of B-cell receptor (By similarity). Specifically binds and phosphorylates CD79A at 'Tyr-188'and 'Tyr-199', as well as CD79B at 'Tyr-196' and 'Tyr-207' (By similarity). Also phosphorylates the immunoglobulin G receptors FCGR2A, FCGR2B and FCGR2C (PubMed:8756631). With FYN and LYN, plays an essential role in pre-B-cell receptor (pre-BCR)-mediated NF-kappa-B activation (By similarity). Also contributes to BTK activation by indirectly stimulating BTK intramolecular autophosphorylation (By similarity). In pancreatic islets, acts as a modulator of beta-cells function through the up-regulation of PDX1 and NKX6-1 and consequent stimulation of insulin secretion in response to glucose (PubMed:19667185). Phosphorylates CGAS, promoting retention of CGAS in the cytosol (PubMed:30356214)\"] This gene encodes a nonreceptor tyrosine-kinase of the src family of proto-oncogenes that are typically involved in cell proliferation and differentiation. The protein has a role in B-cell receptor signaling and B-cell development. The protein also stimulates insulin synthesis and secretion in response to glucose and enhances the expression of several pancreatic beta-cell transcription factors. [provided by RefSeq, Aug 2010] ENSG00000136574 ['MAGMA'] ['P43694'] ['GATA4'] ['Nucleus'] GATA binding protein 4 [Source:HGNC Symbol;Acc:HGNC:4173] [\"Transcriptional activator that binds to the consensus sequence 5'-AGATAG-3' and plays a key role in cardiac development and function (PubMed:24000169, PubMed:27984724, PubMed:35182466). In cooperation with TBX5, it binds to cardiac super-enhancers and promotes cardiomyocyte gene expression, while it down-regulates endocardial and endothelial gene expression (PubMed:27984724). Involved in bone morphogenetic protein (BMP)-mediated induction of cardiac-specific gene expression. Binds to BMP response element (BMPRE) DNA sequences within cardiac activating regions (By similarity). Acts as a transcriptional activator of ANF in cooperation with NKX2-5 (By similarity). Promotes cardiac myocyte enlargement (PubMed:20081228). Required during testicular development (PubMed:21220346). May play a role in sphingolipid signaling by regulating the expression of sphingosine-1-phosphate degrading enzyme, sphingosine-1-phosphate lyase (PubMed:15734735)\"] This gene encodes a member of the GATA family of zinc-finger transcription factors. Members of this family recognize the GATA motif which is present in the promoters of many genes. This protein is thought to regulate genes involved in embryogenesis and in myocardial differentiation and function, and is necessary for normal testicular development. Mutations in this gene have been associated with cardiac septal defects. Additionally, alterations in gene expression have been associated with several cancer types. Alternative splicing results in multiple transcript variants. [provided by RefSeq, Apr 2015] ENSG00000141696 ['MAGMA'] ['Q92791'] ['P3H4'] ['Endoplasmic reticulum'] prolyl 3-hydroxylase family member 4 (inactive) [Source:HGNC Symbol;Acc:HGNC:16946] ['Part of a complex composed of PLOD1, P3H3 and P3H4 that catalyzes hydroxylation of lysine residues in collagen alpha chains and is required for normal assembly and cross-linking of collagen fibrils. Required for normal bone density and normal skin stability via its role in hydroxylation of lysine residues in collagen alpha chains and in collagen fibril assembly'] This nucleolar protein was first characterized because it was an autoantigen in cases on interstitial cystitis. The protein, with a predicted molecular weight of 50 kDa, appears to be localized in the particulate compartment of the interphase nucleolus, with a distribution distinct from that of nucleolar protein B23. During mitosis it is associated with chromosomes. [provided by RefSeq, Jul 2008] ENSG00000141698 ['MAGMA'] ['Q969T7'] ['NT5C3B'] ['Cytoplasm'] 5'-nucleotidase, cytosolic IIIB [Source:HGNC Symbol;Acc:HGNC:28300] ['Specifically hydrolyzes 7-methylguanosine monophosphate (m(7)GMP) to 7-methylguanosine and inorganic phosphate (PubMed:23223233, PubMed:24603684). The specific activity for m(7)GMP may protect cells against undesired salvage of m(7)GMP and its incorporation into nucleic acids (PubMed:23223233). Also has weak activity for CMP (PubMed:23223233, PubMed:24603684). UMP and purine nucleotides are poor substrates (PubMed:23223233)'] Predicted to enable 5'-nucleotidase activity. Predicted to be involved in nuclear-transcribed mRNA catabolic process, deadenylation-dependent decay. Predicted to be located in cytosol. Predicted to be active in cytoplasm. [provided by Alliance of Genome Resources, Jul 2025] ENSG00000141756 ['MAGMA'] ['Q96AY3'] ['FKBP10'] ['Endoplasmic reticulum lumen'] FKBP prolyl isomerase 10 [Source:HGNC Symbol;Acc:HGNC:18169] ['PPIases accelerate the folding of proteins during protein synthesis'] The protein encoded by this gene belongs to the FKBP-type peptidyl-prolyl cis/trans isomerase (PPIase) family. This protein localizes to the endoplasmic reticulum and acts as a molecular chaperone. Alternatively spliced variants encoding different isoforms have been reported, but their biological validity has not been determined.[provided by RefSeq, Nov 2009] ENSG00000147324 ['MAGMA'] ['Q9Y4C4'] ['MFHAS1'] ['Cytoplasm'] multifunctional ROCO family signaling regulator 1 [Source:HGNC Symbol;Acc:HGNC:16982] ['Probable GTP-binding protein (PubMed:24286120). Functions in innate immunity and more specifically the inflammatory response as a regulator of the Toll-like receptor TLR2 and TLR4 signaling pathways (PubMed:26599367, PubMed:28471450, PubMed:28609714). Negatively regulates the part of the TLR4 signaling pathway that leads to the activation of the transcription factor AP-1. By retaining the phosphatase complex PP2A into the cytoplasm, prevents the dephosphorylation of the AP-1 subunit JUN which is required for proper activation of the transcription factor (PubMed:28609714). Both inhibits and activates the TLR2-dependent signaling pathway (PubMed:26599367). Positively regulates the TLR2 signaling pathway to activate specifically the downstream p38 and JNK MAP kinases and promote the polarization of macrophages toward the pro-inflammatory M1 phenotype (PubMed:28471450). It may also play a role in the regulation of inflammation induced by high glucose through the PKB/AKT signaling pathway (PubMed:29168081). Also involved in erythrocyte differentiation through activation of the ERK1/ERK2 signaling pathway (PubMed:23327923)'] Identified in a human 8p amplicon, this gene is a potential oncogene whose expression is enhanced in some malignant fibrous histiocytomas (MFH). The primary structure of its product includes an ATP/GTP-binding site, three leucine zipper domains, and a leucine-rich tandem repeat, which are structural or functional elements for interactions among proteins related to the cell cycle, and which suggest that overexpression might be oncogenic with respect to MFH. [provided by RefSeq, Jul 2008] ENSG00000151929 ['MAGMA', 'GWASLAB'] ['O95817'] ['BAG3'] ['Nucleus', 'Cytoplasm'] BAG cochaperone 3 [Source:HGNC Symbol;Acc:HGNC:939] ['Co-chaperone and adapter protein that connects different classes of molecular chaperones including heat shock proteins 70 (HSP70s), e.g. HSPA1A/HSP70 or HSPA8/HSC70, and small heat shock proteins (sHSPs), e.g. HSPB8 (PubMed:27884606, PubMed:30559338). Acts as a nucleotide-exchange factor (NEF) promoting the release of ADP from HSP70s, thereby triggering client protein release (PubMed:27884606, PubMed:30559338). Nucleotide release is mediated via BAG3 binding to the nucleotide-binding domain (NBD) of HSP70s, whereas client release is mediated via binding to the substrate-binding domain (SBD) (PubMed:27474739, PubMed:9873016). Has anti-apoptotic activity (PubMed:10597216). Plays a role in the HSF1 nucleocytoplasmic transport (PubMed:26159920)'] BAG proteins compete with Hip for binding to the Hsc70/Hsp70 ATPase domain and promote substrate release. All the BAG proteins have an approximately 45-amino acid BAG domain near the C terminus but differ markedly in their N-terminal regions. The protein encoded by this gene contains a WW domain in the N-terminal region and a BAG domain in the C-terminal region. The BAG domains of BAG1, BAG2, and BAG3 interact specifically with the Hsc70 ATPase domain in vitro and in mammalian cells. All 3 proteins bind with high affinity to the ATPase domain of Hsc70 and inhibit its chaperone activity in a Hip-repressible manner. [provided by RefSeq, Jul 2008] ENSG00000153531 ['GWASLAB'] ['Q8NDY3'] ['ADPRHL1'] ['Cytoplasm, myofibril, sarcomere'] ADP-ribosylhydrolase like 1 [Source:HGNC Symbol;Acc:HGNC:21303] ['Required for myofibril assembly and outgrowth of the cardiac chambers in the developing heart (By similarity). Appears to be catalytically inactive, showing no activity against O-acetyl-ADP-ribose (By similarity)'] ADP-ribosylation is a reversible posttranslational modification used to regulate protein function. ADP-ribosyltransferases (see ART1; MIM 601625) transfer ADP-ribose from NAD+ to the target protein, and ADP-ribosylhydrolases, such as ADPRHL1, reverse the reaction (Glowacki et al., 2002 [PubMed 12070318]).[supplied by OMIM, Mar 2008] ENSG00000154319 ['MAGMA'] ['Q96KS9'] ['FAM167A'] family with sequence similarity 167 member A [Source:HGNC Symbol;Acc:HGNC:15549] [] ENSG00000154328 ['MAGMA'] ['Q969S2'] ['NEIL2'] ['Nucleus'] nei like DNA glycosylase 2 [Source:HGNC Symbol;Acc:HGNC:18956] [\"Involved in base excision repair of DNA damaged by oxidation or by mutagenic agents. Has DNA glycosylase activity towards 5-hydroxyuracil and other oxidized derivatives of cytosine with a preference for mismatched double-stranded DNA (DNA bubbles). Has low or no DNA glycosylase activity towards thymine glycol, 2-hydroxyadenine, hypoxanthine and 8-oxoguanine. Has AP (apurinic/apyrimidinic) lyase activity and introduces nicks in the DNA strand. Cleaves the DNA backbone by beta-delta elimination to generate a single-strand break at the site of the removed base with both 3'- and 5'-phosphates\"] This gene encodes a member of the Fpg/Nei family of DNA glycosylases. These glycosylases initiate the first step in base excision repair by cleaving oxidatively damaged bases and introducing a DNA strand break via their abasic site lyase activity. This enzyme is primarily associated with DNA repair during transcription and acts prefentially on cytosine-derived lesions, particularly 5-hydroxyuracil and 5-hydroxycytosine. It contains an N-terminal catalytic domain, a hinge region, and a C-terminal DNA-binding domain with helix-two-turn-helix and zinc finger motifs. This enzyme interacts with the X-ray cross complementing factor 1 scaffold protein as part of a multi-protein DNA repair complex. A pseudogene of this gene has been identified. [provided by RefSeq, Mar 2017] ENSG00000155657 ['MAGMA', 'GWASLAB'] ['Q8WZ42'] ['TTN'] ['Cytoplasm', 'Nucleus'] titin [Source:HGNC Symbol;Acc:HGNC:12403] ['Key component in the assembly and functioning of vertebrate striated muscles. By providing connections at the level of individual microfilaments, it contributes to the fine balance of forces between the two halves of the sarcomere. The size and extensibility of the cross-links are the main determinants of sarcomere extensibility properties of muscle. In non-muscle cells, seems to play a role in chromosome condensation and chromosome segregation during mitosis. Might link the lamina network to chromatin or nuclear actin, or both during interphase'] This gene encodes a large abundant protein of striated muscle. The product of this gene is divided into two regions, a N-terminal I-band and a C-terminal A-band. The I-band, which is the elastic part of the molecule, contains two regions of tandem immunoglobulin domains on either side of a PEVK region that is rich in proline, glutamate, valine and lysine. The A-band, which is thought to act as a protein-ruler, contains a mixture of immunoglobulin and fibronectin repeats, and possesses kinase activity. An N-terminal Z-disc region and a C-terminal M-line region bind to the Z-line and M-line of the sarcomere, respectively, so that a single titin molecule spans half the length of a sarcomere. Titin also contains binding sites for muscle associated proteins so it serves as an adhesion template for the assembly of contractile machinery in muscle cells. It has also been identified as a structural protein for chromosomes. Alternative splicing of this gene results in multiple transcript variants. Considerable variability exists in the I-band, the M-line and the Z-disc regions of titin. Variability in the I-band region contributes to the differences in elasticity of different titin isoforms and, therefore, to the differences in elasticity of different muscle types. Mutations in this gene are associated with familial hypertrophic cardiomyopathy 9, and autoantibodies to titin are produced in patients with the autoimmune disease scleroderma. [provided by RefSeq, Feb 2012] ENSG00000168148 ['MAGMA'] ['Q16695'] ['H3-4'] ['Nucleus', 'Chromosome'] H3.4 histone, cluster member [Source:HGNC Symbol;Acc:HGNC:4778] ['Core component of nucleosome. Nucleosomes wrap and compact DNA into chromatin, limiting DNA accessibility to the cellular machineries which require DNA as a template. Histones thereby play a central role in transcription regulation, DNA repair, DNA replication and chromosomal stability. DNA accessibility is regulated via a complex set of post-translational modifications of histones, also called histone code, and nucleosome remodeling'] Histones are basic nuclear proteins that are responsible for the nucleosome structure of the chromosomal fiber in eukaryotes. Nucleosomes consist of approximately 146 bp of DNA wrapped around a histone octamer composed of pairs of each of the four core histones (H2A, H2B, H3, and H4). The chromatin fiber is further compacted through the interaction of a linker histone, H1, with the DNA between the nucleosomes to form higher order chromatin structures. This gene is intronless and encodes a replication-dependent histone that is a member of the histone H3 family. Transcripts from this gene lack polyA tails; instead, they contain a palindromic termination element. This gene is located separately from the other H3 genes that are in the histone gene cluster on chromosome 6p22-p21.3. [provided by RefSeq, Aug 2015] ENSG00000168827 ['MAGMA'] ['Q96RP9'] ['GFM1'] ['Mitochondrion'] G elongation factor mitochondrial 1 [Source:HGNC Symbol;Acc:HGNC:13780] ['Mitochondrial GTPase that catalyzes the GTP-dependent ribosomal translocation step during translation elongation. During this step, the ribosome changes from the pre-translocational (PRE) to the post-translocational (POST) state as the newly formed A-site-bound peptidyl-tRNA and P-site-bound deacylated tRNA move to the P and E sites, respectively. Catalyzes the coordinated movement of the two tRNA molecules, the mRNA and conformational changes in the ribosome. Does not mediate the disassembly of ribosomes from messenger RNA at the termination of mitochondrial protein biosynthesis'] Eukaryotes contain two protein translational systems, one in the cytoplasm and one in the mitochondria. Mitochondrial translation is crucial for maintaining mitochondrial function and mutations in this system lead to a breakdown in the respiratory chain-oxidative phosphorylation system and to impaired maintenance of mitochondrial DNA. This gene encodes one of the mitochondrial translation elongation factors. Its role in the regulation of normal mitochondrial function and in different disease states attributed to mitochondrial dysfunction is not known. [provided by RefSeq, Jul 2008] ENSG00000170860 ['GWASLAB'] ['P62310'] ['LSM3'] ['Nucleus'] LSM3 homolog, U6 small nuclear RNA and mRNA degradation associated [Source:HGNC Symbol;Acc:HGNC:17874] [\"Plays a role in pre-mRNA splicing as component of the U4/U6-U5 tri-snRNP complex that is involved in spliceosome assembly, and as component of the precatalytic spliceosome (spliceosome B complex) (PubMed:28781166). The heptameric LSM2-8 complex binds specifically to the 3'-terminal U-tract of U6 snRNA (PubMed:10523320)\"] Sm-like proteins were identified in a variety of organisms based on sequence homology with the Sm protein family (see SNRPD2; MIM 601061). Sm-like proteins contain the Sm sequence motif, which consists of 2 regions separated by a linker of variable length that folds as a loop. The Sm-like proteins are thought to form a stable heteromer present in tri-snRNP particles, which are important for pre-mRNA splicing.[supplied by OMIM, Apr 2004] ENSG00000170873 ['GWASLAB'] ['O43312'] ['MTSS1'] ['Cytoplasm, cytoskeleton'] MTSS I-BAR domain containing 1 [Source:HGNC Symbol;Acc:HGNC:20443] ['May be related to cancer progression or tumor metastasis in a variety of organ sites, most likely through an interaction with the actin cytoskeleton'] Enables actin monomer binding activity; identical protein binding activity; and signaling receptor binding activity. Predicted to be involved in several processes, including adherens junction maintenance; positive regulation of actin filament bundle assembly; and renal tubule development. Predicted to act upstream of or within several processes, including actin filament polymerization; bone mineralization; and magnesium ion homeostasis. Located in actin cytoskeleton. [provided by Alliance of Genome Resources, Jul 2025] ENSG00000171044 ['MAGMA'] ['Q5GH73'] ['XKR6'] ['Cell membrane'] XK related 6 [Source:HGNC Symbol;Acc:HGNC:27806] [] Predicted to be involved in apoptotic process involved in development; engulfment of apoptotic cell; and phosphatidylserine exposure on apoptotic cell surface. Predicted to be located in membrane. Predicted to be active in plasma membrane. [provided by Alliance of Genome Resources, Jul 2025] ENSG00000171056 ['MAGMA'] ['Q9BT81'] ['SOX7'] ['Nucleus', 'Cytoplasm'] SRY-box transcription factor 7 [Source:HGNC Symbol;Acc:HGNC:18196] [\"Binds to and activates the CDH5 promoter, hence plays a role in the transcriptional regulation of genes expressed in the hemogenic endothelium and blocks further differentiation into blood precursors (By similarity). May be required for the survival of both hematopoietic and endothelial precursors during specification (By similarity). Competes with GATA4 for binding and activation of the FGF3 promoter (By similarity). Represses Wnt/beta-catenin-stimulated transcription, probably by targeting CTNNB1 to proteasomal degradation. Binds the DNA sequence 5'-AACAAT-3'\"] This gene encodes a member of the SOX (SRY-related HMG-box) family of transcription factors involved in the regulation of embryonic development and in the determination of the cell fate. The encoded protein may act as a transcriptional regulator after forming a protein complex with other proteins. The protein may play a role in tumorigenesis. A similar protein in mice is involved in the regulation of the wingless-type MMTV integration site family (Wnt) pathway. [provided by RefSeq, Jul 2008] ENSG00000173641 ['MAGMA'] ['Q9UBY9'] ['HSPB7'] ['Cytoplasm', 'Nucleus', 'Nucleus, Cajal body'] heat shock protein family B (small) member 7 [Source:HGNC Symbol;Acc:HGNC:5249] [] This gene encodes a small heat shock family B member that can heterodimerize with similar heat shock proteins. Defects in this gene are associated with advanced heart failure. In addition, the encoded protein may be a tumor suppressor in the p53 pathway, with defects in this gene being associated with renal cell carcinoma. [provided by RefSeq, Mar 2017] ENSG00000174891 ['MAGMA'] ['Q96IZ7'] ['RSRC1'] ['Nucleus', 'Nucleus speckle', 'Cytoplasm'] arginine and serine rich coiled-coil 1 [Source:HGNC Symbol;Acc:HGNC:24152] [\"Has a role in alternative splicing and transcription regulation (PubMed:29522154). Involved in both constitutive and alternative pre-mRNA splicing. May have a role in the recognition of the 3' splice site during the second step of splicing\"] This gene encodes a member of the serine and arginine rich-related protein family. The encoded protein is involved in both constitutive and alternative mRNA splicing. This gene may be associated with schizophrenia. A pseudogene of this gene is located on chromosome 9. Alternative splicing results in multiple transcript variants encoding different isoforms. [provided by RefSeq, Nov 2012] ENSG00000175806 ['MAGMA'] [None] [None] methionine sulfoxide reductase A [Source:HGNC Symbol;Acc:HGNC:7377] [None] ENSG00000177045 ['MAGMA'] ['Q8N196'] ['SIX5'] ['Cytoplasm', 'Nucleus'] SIX homeobox 5 [Source:HGNC Symbol;Acc:HGNC:10891] [\"Transcription factor that is thought to be involved in regulation of organogenesis. May be involved in determination and maintenance of retina formation. Binds a 5'-GGTGTCAG-3' motif present in the ARE regulatory element of ATP1A1. Binds a 5'-TCA [AG] [AG] TTNC-3' motif present in the MEF3 element in the myogenin promoter, and in the IGFBP5 promoter (By similarity). Thought to be regulated by association with Dach and Eya proteins, and seems to be coactivated by EYA1, EYA2 and EYA3 (By similarity)\"] The protein encoded by this gene is a homeodomain-containing transcription factor that appears to function in the regulation of organogenesis. This gene is located downstream of the dystrophia myotonica-protein kinase gene. Mutations in this gene are a cause of branchiootorenal syndrome type 2. [provided by RefSeq, Jul 2009] ENSG00000177051 ['MAGMA', 'GWASLAB'] ['Q6PJ61'] ['FBXO46'] F-box protein 46 [Source:HGNC Symbol;Acc:HGNC:25069] ['Substrate-recognition component of the SCF(FBXO46) protein ligase complex, which mediates the ubiquitination and degradation of target proteins (PubMed:30171069). In absence of stress, the SCF(FBXO46) complex catalyzes ubiquitination and degradation of MTOR-phosphorylated FBXO31 (PubMed:30171069)'] Members of the F-box protein family, such as FBXO46, are characterized by an approximately 40-amino acid F-box motif. SCF complexes, formed by SKP1 (MIM 601434), cullin (see CUL1; MIM 603134), and F-box proteins, act as protein-ubiquitin ligases. F-box proteins interact with SKP1 through the F box, and they interact with ubiquitination targets through other protein interaction domains (Jin et al., 2004 [PubMed 15520277]).[supplied by OMIM, Mar 2008] ENSG00000177710 ['MAGMA'] ['Q96KT7'] ['SLC35G5'] ['Membrane'] solute carrier family 35 member G5 [Source:HGNC Symbol;Acc:HGNC:15546] [] This gene is intronless and probably arose from retrotransposition of a similar gene. It has high sequence similarity to the gene encoding acyl-malonyl condensing enzyme on chromosome 17. [provided by RefSeq, Aug 2011] ENSG00000178053 ['MAGMA', 'GWASLAB'] ['P58340'] ['MLF1'] ['Cytoplasm', 'Nucleus', 'Cell projection, cilium', 'Cytoplasm, cytoskeleton, cilium basal body'] myeloid leukemia factor 1 [Source:HGNC Symbol;Acc:HGNC:7125] ['Involved in lineage commitment of primary hemopoietic progenitors by restricting erythroid formation and enhancing myeloid formation. Interferes with erythropoietin-induced erythroid terminal differentiation by preventing cells from exiting the cell cycle through suppression of CDKN1B/p27Kip1 levels. Suppresses COP1 activity via CSN3 which activates p53 and induces cell cycle arrest. Binds DNA and affects the expression of a number of genes so may function as a transcription factor in the nucleus'] This gene encodes an oncoprotein which is thought to play a role in the phenotypic determination of hemopoetic cells. Translocations between this gene and nucleophosmin have been associated with myelodysplastic syndrome and acute myeloid leukemia. Multiple transcript variants encoding different isoforms have been found for this gene. [provided by RefSeq, Sep 2010] ENSG00000178209 ['GWASLAB'] ['Q15149'] ['PLEC'] ['Cytoplasm, cytoskeleton', 'Cell junction, hemidesmosome', 'Cell projection, podosome'] plectin [Source:HGNC Symbol;Acc:HGNC:9069] ['Interlinks intermediate filaments with microtubules and microfilaments and anchors intermediate filaments to desmosomes or hemidesmosomes. Could also bind muscle proteins such as actin to membrane complexes in muscle. May be involved not only in the filaments network, but also in the regulation of their dynamics. Structural component of muscle. Isoform 9 plays a major role in the maintenance of myofiber integrity'] Plectin is a prominent member of an important family of structurally and in part functionally related proteins, termed plakins or cytolinkers, that are capable of interlinking different elements of the cytoskeleton. Plakins, with their multi-domain structure and enormous size, not only play crucial roles in maintaining cell and tissue integrity and orchestrating dynamic changes in cytoarchitecture and cell shape, but also serve as scaffolding platforms for the assembly, positioning, and regulation of signaling complexes (reviewed in PMID: 9701547, 11854008, and 17499243). Plectin is expressed as several protein isoforms in a wide range of cell types and tissues from a single gene located on chromosome 8 in humans (PMID: 8633055, 8698233). Until 2010, this locus was named plectin 1 (symbol PLEC1 in human; Plec1 in mouse and rat) and the gene product had been referred to as \"hemidesmosomal protein 1\" or \"plectin 1, intermediate filament binding 500kDa\". These names were superseded by plectin. The plectin gene locus in mouse on chromosome 15 has been analyzed in detail (PMID: 10556294, 14559777), revealing a genomic exon-intron organization with well over 40 exons spanning over 62 kb and an unusual 5' transcript complexity of plectin isoforms. Eleven exons (1-1j) have been identified that alternatively splice directly into a common exon 2 which is the first exon to encode plectin's highly conserved actin binding domain (ABD). Three additional exons (-1, 0a, and 0) splice into an alternative first coding exon (1c), and two additional exons (2alpha and 3alpha) are optionally spliced within the exons encoding the acting binding domain (exons 2-8). Analysis of the human locus has identified eight of the eleven alternative 5' exons found in mouse and rat (PMID: 14672974); exons 1i, 1j and 1h have not been confirmed in human. Furthermore, isoforms lacking the central rod domain encoded by exon 31 have been detected in mouse (PMID:10556294), rat (PMID: 9177781), and human (PMID: 11441066, 10780662, 20052759). The short alternative amino-terminal sequences encoded by the different first exons direct the targeting of the various isoforms to distinct subcellular locations (PMID: 14559777). As the expression of specific plectin isoforms was found to be dependent on cell type (tissue) and stage of development (PMID: 10556294, 12542521, 17389230) it appears that each cell type (tissue) contains a unique set (proportion and composition) of plectin isoforms, as if custom-made for specific requirements of the particular cells. Concordantly, individual isoforms were found to carry out distinct and specific functions (PMID: 14559777, 12542521, 18541706). In 1996, a number of groups reported that patients suffering from epidermolysis bullosa simplex with muscular dystrophy (EBS-MD) lacked plectin expression in skin and muscle tissues due to defects in the plectin gene (PMID: 8698233, 8941634, 8636409, 8894687, 8696340). Two other subtypes of plectin-related EBS have been described: EBS-pyloric atresia (PA) and EBS-Ogna. For reviews of plectin-related diseases see PMID: 15810881, 19945614. Mutations in the plectin gene related to human diseases should be named based on the position in NM_000445 (variant 1, isoform 1c), unless the mutation is located within one of the other alternative first exons, in which case the position in the respective Reference Sequence should be used. [provided by RefSeq, Aug 2011] ENSG00000179344 ['MAGMA', 'GWASLAB'] ['Q5SU54', 'A2AAZ0', 'Q5Y7D6', 'A2AAY8', 'E9PIB1'] ['HLA-DQB1'] ['Endosome membrane', 'Lysosome membrane', 'Membrane'] major histocompatibility complex, class II, DQ beta 1 [Source:HGNC Symbol;Acc:HGNC:4944] [] HLA-DQB1 belongs to the HLA class II beta chain paralogs. This class II molecule is a heterodimer consisting of an alpha (DQA) and a beta chain (DQB), both anchored in the membrane. It plays a central role in the immune system by presenting peptides derived from extracellular proteins. Class II molecules are expressed in antigen presenting cells (APC: B lymphocytes, dendritic cells, macrophages). The beta chain is approximately 26-28 kDa and it contains six exons. Exon 1 encodes the leader peptide, exons 2 and 3 encode the two extracellular domains, exon 4 encodes the transmembrane domain and exon 5 encodes the cytoplasmic tail. Within the DQ molecule both the alpha chain and the beta chain contain the polymorphisms specifying the peptide binding specificities, resulting in up to four different molecules. Typing for these polymorphisms is routinely done for bone marrow transplantation. Alternative splicing results in multiple transcript variants. [provided by RefSeq, Sep 2011] ENSG00000180228 ['MAGMA'] ['O75569'] ['PRKRA'] ['Cytoplasm, perinuclear region', 'Cytoplasm'] protein activator of interferon induced protein kinase EIF2AK2 [Source:HGNC Symbol;Acc:HGNC:9438] [\"Activates EIF2AK2/PKR in the absence of double-stranded RNA (dsRNA), leading to phosphorylation of EIF2S1/EFI2-alpha and inhibition of translation and induction of apoptosis. Required for siRNA production by DICER1 and for subsequent siRNA-mediated post-transcriptional gene silencing. Does not seem to be required for processing of pre-miRNA to miRNA by DICER1. Promotes UBC9-p53/TP53 association and sumoylation and phosphorylation of p53/TP53 at 'Lys-386' at 'Ser-392' respectively and enhances its activity in a EIF2AK2/PKR-dependent manner (By similarity)\"] This gene encodes a protein kinase activated by double-stranded RNA which mediates the effects of interferon in response to viral infection. Mutations in this gene have been associated with dystonia. Alternative splicing results in multiple transcript variants. [provided by RefSeq, Nov 2008] ENSG00000182319 ['MAGMA'] [None] [None] [None] ENSG00000183638 ['MAGMA'] ['Q8IWN7'] ['RP1L1'] ['Cytoplasm, cytoskeleton, cilium axoneme', 'Cell projection, cilium, photoreceptor outer segment'] RP1 like 1 [Source:HGNC Symbol;Acc:HGNC:15946] ['Required for the differentiation of photoreceptor cells. Plays a role in the organization of outer segment of rod and cone photoreceptors (By similarity)'] This gene encodes a member of the doublecortin family. The protein encoded by this gene contains two N-terminal doublecortin domains, which bind microtubules and regulate microtubule polymerization, and two C-terminal large repetitive regions, both of which contain a high percentage of glutamine and glutamic acid residues. This protein is a retinal-specific protein. Its exact length varies among individuals due to the presence of a 16aa repeat in the first C-terminal repetitive region. The 16aa repeat is encoded by the highly polymorphic 48-bp repeat, and 1-6 copies of the 16aa repeat have been identified in normal individuals. The current reference sequence shown here has a single copy of the 16aa repeat. This protein and the RP1 protein, another retinal-specific protein, play essential and synergistic roles in affecting photosensitivity and outer segment morphogenesis of rod photoreceptors. Mutations in this gene cause occult macular dystrophy (OMD). [provided by RefSeq, Sep 2010] ENSG00000184608 ['MAGMA'] [None] [None] FAM167A antisense RNA 1 [Source:HGNC Symbol;Acc:HGNC:15548] [None] ENSG00000185800 ['MAGMA'] ['Q09019'] ['DMWD'] ['Cytoplasm', 'Nucleus', 'Perikaryon', 'Cell projection, dendrite'] DM1 locus, WD repeat containing [Source:HGNC Symbol;Acc:HGNC:2936] ['Regulator of the deubiquitinating USP12/DMWD/WDR48 complex (PubMed:33844468). Functions as a cofactor that promotes USP12 enzymatic activity (PubMed:33844468)'] Enables deubiquitinase activator activity. Located in cytoplasm and nucleus. [provided by Alliance of Genome Resources, Jul 2025] ENSG00000186510 ['MAGMA'] ['P51800'] ['CLCNKA'] ['Basolateral cell membrane'] chloride voltage-gated channel Ka [Source:HGNC Symbol;Acc:HGNC:2026] [\"Anion-selective channel permeable to small monovalent anions with ion selectivity for chloride &gt; bromide &gt; nitrate &gt; iodide (PubMed:11734858, PubMed:12111250). Forms a homodimeric channel where each subunit has its own ion conduction pathway. May conduct double-barreled currents controlled by two types of gates, two fast gates that control each subunit independently and a slow common gate that opens and shuts off both subunits simultaneously (PubMed:11734858, PubMed:12111250, PubMed:18310267, PubMed:18776122, PubMed:19646679, PubMed:20538786). Assembles with the regulatory subunit BSND/Barttin for sorting at the basolateral plasma membrane domain and functional switch to the ion conducting state. CLCNKA:BSND channels display mostly a linear current-voltage relationship with fast gating at negative potentials (PubMed:11734858, PubMed:12111250, PubMed:18310267, PubMed:18776122, PubMed:20538786). Mediates transepithelial chloride transport from the lumen to interstitial compartment along the thin ascending limb of Henle's loop, contributing to generation of hypertonic medullary interstitium as a countercurrent system to achieve urine concentration (By similarity) (PubMed:15044642). Conducts chloride currents in the stria vascularis of the inner ear to establish the endocochlear potential necessary for normal hearing (PubMed:15044642, PubMed:18310267, PubMed:19646679)\"] This gene is a member of the CLC family of voltage-gated chloride channels. The encoded protein is predicted to have 12 transmembrane domains, and requires a beta subunit called barttin to form a functional channel. It is thought to function in salt reabsorption in the kidney and potassium recycling in the inner ear. The gene is highly similar to CLCNKB, which is located 10 kb downstream from this gene. Multiple transcript variants encoding different isoforms have been found for this gene. [provided by RefSeq, Jul 2008] ENSG00000203760 ['MAGMA'] ['Q5EE01'] ['CENPW'] ['Nucleus', 'Chromosome, centromere', 'Chromosome, centromere, kinetochore', 'Nucleus matrix', 'Nucleus, nucleolus'] centromere protein W [Source:HGNC Symbol;Acc:HGNC:21488] ['Component of the CENPA-NAC (nucleosome-associated) complex, a complex that plays a central role in assembly of kinetochore proteins, mitotic progression and chromosome segregation (By similarity). The CENPA-NAC complex recruits the CENPA-CAD (nucleosome distal) complex and may be involved in incorporation of newly synthesized CENPA into centromeres (By similarity). Part of a nucleosome-associated complex that binds specifically to histone H3-containing nucleosomes at the centromere, as opposed to nucleosomes containing CENPA. Component of the heterotetrameric CENP-T-W-S-X complex that binds and supercoils DNA, and plays an important role in kinetochore assembly. CENPW has a fundamental role in kinetochore assembly and function. It is one of the inner kinetochore proteins, with most further proteins binding downstream. Required for normal chromosome organization and normal progress through mitosis'] Predicted to enable DNA binding activity and protein heterodimerization activity. Involved in chromosome segregation; kinetochore assembly; and mitotic cell cycle. Located in kinetochore and nucleoplasm. Part of inner kinetochore. [provided by Alliance of Genome Resources, Jul 2025] ENSG00000204311 ['MAGMA'] ['Q0ZLH3'] ['PJVK'] ['Peroxisome membrane', 'Cell projection, cilium'] pejvakin [Source:HGNC Symbol;Acc:HGNC:29502] ['Peroxisome-associated protein required to protect auditory hair cells against noise-induced damage. Acts by regulating noise-induced peroxisome proliferation in auditory hair cells and neurons, and promoting autophagic degradation of damaged peroxisomes (pexophagy). Noise overexposure increases reactive oxygen species (ROS) levels, causing oxidative damage to auditory hair cells and resulting in hearing loss. PJVK acts as a ROS sensor that recruits the autophagy machinery to trigger pexophagy of peroxisomes damaged by oxidative stress. In addition to pexophagy, also required to promote peroxisome proliferation in response to sound overstimulation'] The protein encoded by this gene is a member of the gasdermin family, a family which is found only in vertebrates. The encoded protein is required for the proper function of auditory pathway neurons. Defects in this gene are a cause of non-syndromic sensorineural deafness autosomal recessive type 59 (DFNB59). [provided by RefSeq, Dec 2008] ENSG00000205882 ['MAGMA'] ['Q4QY38'] ['DEFB134'] ['Secreted'] defensin beta 134 [Source:HGNC Symbol;Acc:HGNC:32399] ['Has antibacterial activity'] Defensins are cysteine-rich cationic polypeptides that are important in the immunologic response to invading microorganisms. The antimicrobial protein encoded by this gene is secreted and is a member of the beta defensin protein family. Beta defensin genes are found in several clusters throughout the genome, with this gene mapping to a cluster at 8p23. [provided by RefSeq, Nov 2014] ENSG00000205884 ['MAGMA'] ['Q30KP8'] ['DEFB136'] ['Secreted'] defensin beta 136 [Source:HGNC Symbol;Acc:HGNC:34433] ['Host defense peptide that exhibits antibacterial and antifungal activity (PubMed:34481960). Exhibits antimicrobial activity against E.coli, S.aureus and C.albicans (in vitro) (PubMed:34481960). Has high lipopolysaccharide (LPS)-binding affinity, and may thereby be involved in immunoregulation through LPS neutralization (PubMed:34481960)'] Defensins are cysteine-rich cationic polypeptides that are important in the immunologic response to invading microorganisms. The antimicrobial protein encoded by this gene is secreted and is a member of the beta defensin protein family. Beta defensin genes are found in several clusters throughout the genome, with this gene mapping to a cluster at 8p23. [provided by RefSeq, Nov 2014] ENSG00000206237 ['GWASLAB'] ['Q5Y7D3'] ['HLA-DQB1'] ['Endosome membrane', 'Lysosome membrane'] major histocompatibility complex, class II, DQ beta 1 [Source:HGNC Symbol;Acc:HGNC:4944] [] ENSG00000206302 ['GWASLAB'] ['Q5Y7D3', 'A0A140T8Z1'] ['HLA-DQB1'] ['Endosome membrane', 'Lysosome membrane'] major histocompatibility complex, class II, DQ beta 1 [Source:HGNC Symbol;Acc:HGNC:4944] [] ENSG00000215346 ['MAGMA'] [None] [None] [None] ENSG00000225824 ['GWASLAB'] ['P01920'] ['HLA-DQB1'] ['Cell membrane', 'Endoplasmic reticulum membrane', 'Golgi apparatus, trans-Golgi network membrane', 'Endosome membrane', 'Lysosome membrane'] major histocompatibility complex, class II, DQ beta 1 [Source:HGNC Symbol;Acc:HGNC:4944] ['Binds peptides derived from antigens that access the endocytic route of antigen presenting cells (APC) and presents them on the cell surface for recognition by the CD4 T-cells. The peptide binding cleft accommodates peptides of 10-30 residues. The peptides presented by MHC class II molecules are generated mostly by degradation of proteins that access the endocytic route, where they are processed by lysosomal proteases and other hydrolases. Exogenous antigens that have been endocytosed by the APC are thus readily available for presentation via MHC II molecules, and for this reason this antigen presentation pathway is usually referred to as exogenous. As membrane proteins on their way to degradation in lysosomes as part of their normal turn-over are also contained in the endosomal/lysosomal compartments, exogenous antigens must compete with those derived from endogenous components. Autophagy is also a source of endogenous peptides, autophagosomes constitutively fuse with MHC class II loading compartments. In addition to APCs, other cells of the gastrointestinal tract, such as epithelial cells, express MHC class II molecules and CD74 and act as APCs, which is an unusual trait of the GI tract. To produce a MHC class II molecule that presents an antigen, three MHC class II molecules (heterodimers of an alpha and a beta chain) associate with a CD74 trimer in the ER to form a heterononamer. Soon after the entry of this complex into the endosomal/lysosomal system where antigen processing occurs, CD74 undergoes a sequential degradation by various proteases, including CTSS and CTSL, leaving a small fragment termed CLIP (class-II-associated invariant chain peptide). The removal of CLIP is facilitated by HLA-DM via direct binding to the alpha-beta-CLIP complex so that CLIP is released. HLA-DM stabilizes MHC class II molecules until primary high affinity antigenic peptides are bound. The MHC II molecule bound to a peptide is then transported to the cell membrane surface. In B-cells, the interaction between HLA-DM and MHC class II molecules is regulated by HLA-DO. Primary dendritic cells (DCs) also to express HLA-DO. Lysosomal microenvironment has been implicated in the regulation of antigen loading into MHC II molecules, increased acidification produces increased proteolysis and efficient peptide loading'] ENSG00000231286 ['GWASLAB'] ['P01920'] ['HLA-DQB1'] ['Cell membrane', 'Endoplasmic reticulum membrane', 'Golgi apparatus, trans-Golgi network membrane', 'Endosome membrane', 'Lysosome membrane'] major histocompatibility complex, class II, DQ beta 1 [Source:HGNC Symbol;Acc:HGNC:4944] ['Binds peptides derived from antigens that access the endocytic route of antigen presenting cells (APC) and presents them on the cell surface for recognition by the CD4 T-cells. The peptide binding cleft accommodates peptides of 10-30 residues. The peptides presented by MHC class II molecules are generated mostly by degradation of proteins that access the endocytic route, where they are processed by lysosomal proteases and other hydrolases. Exogenous antigens that have been endocytosed by the APC are thus readily available for presentation via MHC II molecules, and for this reason this antigen presentation pathway is usually referred to as exogenous. As membrane proteins on their way to degradation in lysosomes as part of their normal turn-over are also contained in the endosomal/lysosomal compartments, exogenous antigens must compete with those derived from endogenous components. Autophagy is also a source of endogenous peptides, autophagosomes constitutively fuse with MHC class II loading compartments. In addition to APCs, other cells of the gastrointestinal tract, such as epithelial cells, express MHC class II molecules and CD74 and act as APCs, which is an unusual trait of the GI tract. To produce a MHC class II molecule that presents an antigen, three MHC class II molecules (heterodimers of an alpha and a beta chain) associate with a CD74 trimer in the ER to form a heterononamer. Soon after the entry of this complex into the endosomal/lysosomal system where antigen processing occurs, CD74 undergoes a sequential degradation by various proteases, including CTSS and CTSL, leaving a small fragment termed CLIP (class-II-associated invariant chain peptide). The removal of CLIP is facilitated by HLA-DM via direct binding to the alpha-beta-CLIP complex so that CLIP is released. HLA-DM stabilizes MHC class II molecules until primary high affinity antigenic peptides are bound. The MHC II molecule bound to a peptide is then transported to the cell membrane surface. In B-cells, the interaction between HLA-DM and MHC class II molecules is regulated by HLA-DO. Primary dendritic cells (DCs) also to express HLA-DO. Lysosomal microenvironment has been implicated in the regulation of antigen loading into MHC II molecules, increased acidification produces increased proteolysis and efficient peptide loading'] ENSG00000231939 ['GWASLAB'] ['A0A0U5Q247'] ['HLA-DQB1'] ['Endosome membrane', 'Lysosome membrane'] major histocompatibility complex, class II, DQ beta 1 [Source:HGNC Symbol;Acc:HGNC:4944] [] ENSG00000233209 ['GWASLAB'] ['P01920'] ['HLA-DQB1'] ['Cell membrane', 'Endoplasmic reticulum membrane', 'Golgi apparatus, trans-Golgi network membrane', 'Endosome membrane', 'Lysosome membrane'] major histocompatibility complex, class II, DQ beta 1 [Source:HGNC Symbol;Acc:HGNC:4944] ['Binds peptides derived from antigens that access the endocytic route of antigen presenting cells (APC) and presents them on the cell surface for recognition by the CD4 T-cells. The peptide binding cleft accommodates peptides of 10-30 residues. The peptides presented by MHC class II molecules are generated mostly by degradation of proteins that access the endocytic route, where they are processed by lysosomal proteases and other hydrolases. Exogenous antigens that have been endocytosed by the APC are thus readily available for presentation via MHC II molecules, and for this reason this antigen presentation pathway is usually referred to as exogenous. As membrane proteins on their way to degradation in lysosomes as part of their normal turn-over are also contained in the endosomal/lysosomal compartments, exogenous antigens must compete with those derived from endogenous components. Autophagy is also a source of endogenous peptides, autophagosomes constitutively fuse with MHC class II loading compartments. In addition to APCs, other cells of the gastrointestinal tract, such as epithelial cells, express MHC class II molecules and CD74 and act as APCs, which is an unusual trait of the GI tract. To produce a MHC class II molecule that presents an antigen, three MHC class II molecules (heterodimers of an alpha and a beta chain) associate with a CD74 trimer in the ER to form a heterononamer. Soon after the entry of this complex into the endosomal/lysosomal system where antigen processing occurs, CD74 undergoes a sequential degradation by various proteases, including CTSS and CTSL, leaving a small fragment termed CLIP (class-II-associated invariant chain peptide). The removal of CLIP is facilitated by HLA-DM via direct binding to the alpha-beta-CLIP complex so that CLIP is released. HLA-DM stabilizes MHC class II molecules until primary high affinity antigenic peptides are bound. The MHC II molecule bound to a peptide is then transported to the cell membrane surface. In B-cells, the interaction between HLA-DM and MHC class II molecules is regulated by HLA-DO. Primary dendritic cells (DCs) also to express HLA-DO. Lysosomal microenvironment has been implicated in the regulation of antigen loading into MHC II molecules, increased acidification produces increased proteolysis and efficient peptide loading'] ENSG00000237452 ['MAGMA'] ['C9JSJ3'] ['MEIOSIN'] ['Nucleus'] meiosis initiator [Source:HGNC Symbol;Acc:HGNC:44318] ['Gatekeeper of meiotic initiation in both male and female germ cells. In complex with STRA8, directly activates the transcription of a subset of critical meiotic genes playing a central role in cell-cycle switching from mitosis to meiosis. Temporal expression of MEIOSIN is required for meiotic entry decision'] Predicted to enable DNA binding activity and protein dimerization activity. Predicted to be involved in several processes, including activation of meiosis; cellular response to retinoic acid; and regulation of transcription by RNA polymerase II. Predicted to be located in nucleus. [provided by Alliance of Genome Resources, Jul 2025] ENSG00000253426 ['MAGMA'] [None] [None] [None] ENSG00000254093 ['MAGMA'] [None] [None] PIN2 (TERF1) interacting telomerase inhibitor 1 [Source:HGNC Symbol;Acc:HGNC:30046] [None] ENSG00000255098 ['MAGMA'] [None] [None] [None] ENSG00000258677 ['MAGMA'] ['H3BMM0'] [None] novel  protein, UBE2W-STAU2 readthrough [] This gene encodes a nuclear-localized ubiquitin-conjugating enzyme (E2) that, along with ubiquitin-activating (E1) and ligating (E3) enzymes, coordinates the addition of a ubiquitin moiety to existing proteins. The encoded protein promotes the ubiquitination of Fanconi anemia complementation group proteins and may be important in the repair of DNA damage. There is a pseudogene for this gene on chromosome 1. Alternative splicing results in multiple transcript variants. [provided by RefSeq, Aug 2012] ENSG00000258724 ['MAGMA'] ['Q9BT81'] ['SOX7'] ['Nucleus', 'Cytoplasm'] PIN2 (TERF1) interacting telomerase inhibitor 1 [Source:HGNC Symbol;Acc:HGNC:30046] [\"Binds to and activates the CDH5 promoter, hence plays a role in the transcriptional regulation of genes expressed in the hemogenic endothelium and blocks further differentiation into blood precursors (By similarity). May be required for the survival of both hematopoietic and endothelial precursors during specification (By similarity). Competes with GATA4 for binding and activation of the FGF3 promoter (By similarity). Represses Wnt/beta-catenin-stimulated transcription, probably by targeting CTNNB1 to proteasomal degradation. Binds the DNA sequence 5'-AACAAT-3'\"] ENSG00000268434 ['MAGMA'] ['M0R0L4', 'M0QX08', 'M0R256', 'M0QYC6'] [None, None, None, None] [None, None, None, None] novel protein [] ENSG00000285369 ['GWASLAB'] ['P51451'] ['BLK'] ['Cell membrane'] BLK proto-oncogene, Src family tyrosine kinase [Source:HGNC Symbol;Acc:HGNC:1057] [\"Non-receptor tyrosine kinase involved in B-lymphocyte development, differentiation and signaling (By similarity). B-cell receptor (BCR) signaling requires a tight regulation of several protein tyrosine kinases and phosphatases, and associated coreceptors (By similarity). Binding of antigen to the B-cell antigen receptor (BCR) triggers signaling that ultimately leads to B-cell activation (By similarity). Signaling through BLK plays an important role in transmitting signals through surface immunoglobulins and supports the pro-B to pre-B transition, as well as the signaling for growth arrest and apoptosis downstream of B-cell receptor (By similarity). Specifically binds and phosphorylates CD79A at 'Tyr-188'and 'Tyr-199', as well as CD79B at 'Tyr-196' and 'Tyr-207' (By similarity). Also phosphorylates the immunoglobulin G receptors FCGR2A, FCGR2B and FCGR2C (PubMed:8756631). With FYN and LYN, plays an essential role in pre-B-cell receptor (pre-BCR)-mediated NF-kappa-B activation (By similarity). Also contributes to BTK activation by indirectly stimulating BTK intramolecular autophosphorylation (By similarity). In pancreatic islets, acts as a modulator of beta-cells function through the up-regulation of PDX1 and NKX6-1 and consequent stimulation of insulin secretion in response to glucose (PubMed:19667185). Phosphorylates CGAS, promoting retention of CGAS in the cytosol (PubMed:30356214)\"]"},{"location":"Analysis/Verma_et_al_%28LDL%29/LDL_Overview/","title":"LDL Overview","text":""},{"location":"Analysis/Verma_et_al_%28LDL%29/LDL_Overview/#ldl","title":"LDL","text":"<p>Cholesterol is transported in the blood via lipid-protein particles called low-density lipoproteins (LDL) (See Alberts et al. pg 791<sup>1</sup>).</p> <p>High levels of LDL in the blood can cause atherosclerosis, which in turn increases the risk of a cardiovascular event.</p> <ol> <li> <p>Bruce Alberts, Rebecca Heald, Alexander Johnson, David Morgan, Martin Raff, Keith Roberts, and Peter Walter. Molecular Biology of the Cell: Seventh Edition. WW Norton &amp; Company, 2022.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Verma_et_al_%28LDL%29/MAGMA_LDL_Analysis/","title":"MAGMA Analysis of LDL","text":""},{"location":"Analysis/Verma_et_al_%28LDL%29/MAGMA_LDL_Analysis/#magma-analysis-of-ldl","title":"MAGMA Analysis of LDL","text":""},{"location":"Analysis/Verma_et_al_%28LDL%29/MAGMA_LDL_Analysis/#magma-results","title":"MAGMA Results","text":"<p>I applied the MAGMA pipeline to summary statistics from a GWAS of LDL from the Million Veterans Program<sup>1</sup>.  In the gene set analysis step, I incorporated tissue-specific RNAseq data from GTEx<sup>2</sup> to try to link genes associated with LDL to specific tissues.</p> <p>The results are shown below:</p> <p></p> <p>indicating that genes that increase LDL tend to be expressed in the liver. This is consistent with known biology: the liver plays a major role in clearing excess LDL from the bloodstream.</p>"},{"location":"Analysis/Verma_et_al_%28LDL%29/MAGMA_LDL_Analysis/#reproducing-analysis","title":"Reproducing Analysis","text":"<p>To reproduce this analysis, run the LDL GWAS Analysis Script.</p> <ol> <li> <p>Anurag Verma, Jennifer E Huffman, Alex Rodriguez, Mitchell Conery, Molei Liu, Yuk-Lam Ho, Youngdae Kim, David A Heise, Lindsay Guare, Vidul Ayakulangara Panickan, and others. Diversity and scale: genetic architecture of 2068 traits in the va million veteran program. Science, 385(6706):eadj1182, 2024. URL: https://www.science.org/doi/10.1126/science.adj1182.\u00a0\u21a9</p> </li> <li> <p>GTEx Consortium. The gtex consortium atlas of genetic regulatory effects across human tissues. Science, 369(6509):1318\u20131330, 2020. URL: https://www.science.org/doi/full/10.1126/science.aaz1776.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Verma_et_al_%28LDL%29/S-LDSC_LDL_Analysis/","title":"S-LDSC LDL Analysis","text":""},{"location":"Analysis/Verma_et_al_%28LDL%29/S-LDSC_LDL_Analysis/#s-ldsc-ldl-analysis","title":"S-LDSC LDL Analysis","text":"<p>I applied Stratified Linkage Disequilibrium Score Regression (S-LDSC) to summary statistics from a GWAS of LDL from the Million Veterans Program to identify possible key tissue and cell types affecting LDL levels.</p>"},{"location":"Analysis/Verma_et_al_%28LDL%29/S-LDSC_LDL_Analysis/#reference-data-sources","title":"Reference Data Sources","text":"<p>I used the reference datasets recommended and preprocessed by the authors of the S-LSDC method.  These reference datasets are ultimately drawn from the following data sources:</p> <ul> <li>The GTEx Project</li> <li>The Franke lab dataset</li> <li>The Roadmap Epigenetic Project</li> <li>The Corces et al. ATAC-seq dataset of 13 blood cell types.</li> <li>The ImmGen Project</li> <li>The Cahoy Mouse Central Nervous System Dataset</li> </ul>"},{"location":"Analysis/Verma_et_al_%28LDL%29/S-LDSC_LDL_Analysis/#results","title":"Results","text":""},{"location":"Analysis/Verma_et_al_%28LDL%29/S-LDSC_LDL_Analysis/#gtex-and-franke-lab-tissue-expression-data","title":"GTEx and Franke lab tissue expression data","text":"<p>When S-LSDC is applied to GWAS summary statistics using a reference dataset of cell types, S-LSDC will return cell-type \\(\\tau_i\\) coefficients together with associated \\(p\\)-values.  A large coefficient and a small \\(p\\) value for a given cell type \\(i\\) suggests that genes related to cell-type \\(i\\) are over-represented in the heritability of the phenotype of interest.</p> <p>The graph below shows the coefficient p values for the cell types in the GTEx/Franke Lab dataset when S-LDSC is applied to the LDL GWAS.  Cell types are grouped into categories according to the same scheme used in the original S-LDSC paper<sup>1</sup>.</p> <p></p> <p>Of note: the main 3 statistically significant cell types are all liver cell types.  Consistently with the results of MAGMA, this suggests that the liver is  central the physiological process determining LDL levels.  Note, however, that since both S-LDSC and MAGMA use the GTEx dataset, this is not truly an independent piece of evidence.</p> <p>There is also one significant kidney cell type (on the right side of the graph).  It is unclear to me whether this reflects real biology, or is an artifact.</p> <p>It is also of interest that several adipose-related cell types are just below the threshold of significance, suggesting that a larger study might implicate adipose tissue in the LDL disease process. This is consistent with the known association of high BMI with LDL levels.</p> <p>Here are the top associations in tabular form:</p> Name Coefficient Coefficient_P_value Reject Null A03.620.Liver 1.5215e-08 0.000211744 True A11.436.348.Hepatocytes 2.30756e-08 0.000254927 True Liver 1.82315e-08 0.000335455 True Kidney_Cortex 9.50672e-09 0.00045596 True A10.165.114.830.500.750.Subcutaneous.Fat..Abdominal 1.13522e-08 0.00205337 False A10.165.114.830.750.Subcutaneous.Fat 1.11345e-08 0.00237814 False A11.497.497.600.Oocytes 7.96733e-09 0.00312142 False A06.407.071.Adrenal.Glands 8.71681e-09 0.00736218 False A15.382.490.315.583.Neutrophils 8.68251e-09 0.00957292 False Pancreas 8.30563e-09 0.00992878 False A05.360.490.Germ.Cells 6.45252e-09 0.0110824 False A06.407.071.140.Adrenal.Cortex 7.33265e-09 0.013978 False A03.556.249.124.Ileum 1.43982e-08 0.0146156 False"},{"location":"Analysis/Verma_et_al_%28LDL%29/S-LDSC_LDL_Analysis/#roadmap-chromatin-data","title":"Roadmap Chromatin data","text":"<p>I next applied S-LDSC to the LDL GWAS using reference data generated by Finucane et al.<sup>1</sup> from the Roadmap Epigenetics Project. This dataset annotates regions of the genome with the epigenetic marks expressed on those regions in particular tissues. These annotations can then be used for S-LSDC.  The rationale is that if a GWAS finds a region of the genome to be significantly associated with a trait, and epigenetics shows that that region is being up-regulated in a tissue, the tissue may be important to the trait.</p> <p>The following graph and table show the result:</p> <p></p> Name Coefficient Coefficient_P_value Reject Null liver_ENTEX__H3K27ac 1.34601e-07 7.4945e-05 True Liver__H3K27ac 1.83538e-07 8.36467e-05 True Liver__H3K4me1 1.36859e-07 0.000236273 True Adipose_Nuclei__H3K9ac 2.31322e-07 0.000333111 True Adipose_Nuclei__H3K27ac 9.55665e-08 0.000401196 True Liver__H3K9ac 3.69786e-07 0.000448776 True Adipose_Nuclei__H3K4me1 9.55984e-08 0.000469102 True liver_ENTEX__H3K4me3 4.77665e-07 0.000918027 False Fetal_Adrenal_Gland__H3K4me3 3.23248e-07 0.00133247 False Fetal_Intestine_Large__H3K4me1 1.07869e-07 0.0018057 False Liver__H3K36me3 1.40152e-07 0.00203915 False Liver__H3K4me3 3.02922e-07 0.00208174 False Duodenum_Mucosa__H3K4me1 9.94451e-08 0.00223099 False <p>Note that all the histone modifications (H3K27ac,H3K4me1,H3K9ac, H3K36me3) in the table above are associated with increased gene expression.</p> <p>Consistent with our findings above, these results point to the liver as a key site of LDL physiology.  Unlike the GTEx results above, they also significantly implicate adipose tissue as a site of important physiology.</p>"},{"location":"Analysis/Verma_et_al_%28LDL%29/S-LDSC_LDL_Analysis/#immgen-data","title":"ImmGen data","text":"<p>The next step is to use the S-LDSC reference data derived from the ImmGen project.  This results in no significant tissue-type hits.  The top non-significant hits are:</p> Name Coefficient Coefficient_P_value Reject Null T.4SP69+.Th 2.09672e-08 0.00229273 False T.4Nve.Sp 1.61296e-08 0.0091171 False Mo.6C-IIint.Bl 1.24572e-08 0.0098925 False T.4Nve.LN 1.37083e-08 0.0120702 False T.4.LN.BDC 1.47838e-08 0.012287 False LN.TR.14w.B6 1.06239e-08 0.0138859 False MF.480int.LV.Naive 8.75148e-09 0.014214 False MF.480hi.LV.Naive 9.3381e-09 0.0170341 False <p>This is to be expected, as LDL levels are not primarily the consequence of an autoimmune process.</p>"},{"location":"Analysis/Verma_et_al_%28LDL%29/S-LDSC_LDL_Analysis/#corces-atac-seq-data","title":"Corces ATAC-seq data","text":"<p>We can use another immunological reference dataset: the Corces ATAC-seq dataset.  In this case, there are also no significant hits.  The top non-significant hits are:</p> Name Coefficient Coefficient_P_value Reject Null Mono 3.39149e-08 0.236073 False MEP -8.09368e-09 0.588996 False Erythro -3.47455e-08 0.694423 False NK -3.37224e-08 0.753868 False HSC -2.53803e-08 0.772651 False CMP -2.52663e-08 0.777761 False CD4 -4.49983e-08 0.783817 False CLP -7.29466e-08 0.886496 False"},{"location":"Analysis/Verma_et_al_%28LDL%29/S-LDSC_LDL_Analysis/#cahoy-and-gtex-brain-data","title":"Cahoy and GTEx-Brain data","text":"<p>The next two reference datasets pertain to the central nervous system.  Again, there are no significant hits.  The top non-significant hits are:</p> Name Coefficient Coefficient_P_value Reject Null Astrocyte 1.97982e-09 0.291024 False Neuron 2.33232e-10 0.466565 False Oligodendrocyte -5.54881e-09 0.936155 False <p>and </p> Name Coefficient Coefficient_P_value Reject Null Brain_Nucleus_accumbens_(basal_ganglia) 6.56949e-09 0.0297949 False Brain_Caudate_(basal_ganglia) 4.43273e-09 0.0727096 False Brain_Putamen_(basal_ganglia) 3.45177e-09 0.0808186 False Brain_Anterior_cingulate_cortex_(BA24) 1.83247e-09 0.249405 False Brain_Cortex 1.85239e-09 0.282159 False Brain_Cerebellar_Hemisphere 1.55714e-09 0.334468 False Brain_Substantia_nigra 8.98458e-10 0.387369 False Brain_Cerebellum -9.68139e-10 0.584834 False <p>This is perhaps to be expected, given the lack of significant hits on any CNS-related categories in the coarse-grained chromatin and gene expression datasets.</p>"},{"location":"Analysis/Verma_et_al_%28LDL%29/S-LDSC_LDL_Analysis/#reproducing-analysis","title":"Reproducing Analysis","text":"<p>To reproduce this analysis, run the LDL GWAS Analysis Script.</p> <ol> <li> <p>Hilary K Finucane, Yakir A Reshef, Verneri Anttila, Kamil Slowikowski, Alexander Gusev, Andrea Byrnes, Steven Gazal, Po-Ru Loh, Caleb Lareau, Noam Shoresh, and others. Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types. Nature genetics, 50(4):621\u2013629, 2018. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC5896795/.\u00a0\u21a9\u21a9</p> </li> </ol>"},{"location":"Analysis/Verma_et_al_%28RBC_Volume%29/MAMGA_RBCV_Analysis/","title":"MAGMA Analysis of RBC Volume","text":""},{"location":"Analysis/Verma_et_al_%28RBC_Volume%29/MAMGA_RBCV_Analysis/#magma-analysis-of-rbc-volume","title":"MAGMA Analysis of RBC Volume","text":"<p>I applied the MAGMA pipeline to summary statistics from a GWAS of red blood cell (RBC) volume from the Million Veterans Program<sup>1</sup>.  I incorporated tissue-specific RNAseq data from GTEx<sup>2</sup> to try to link genes associated with RBC volume to specific tissues.</p>"},{"location":"Analysis/Verma_et_al_%28RBC_Volume%29/MAMGA_RBCV_Analysis/#gene-set-gene-property-analysis","title":"Gene set/ Gene property analysis","text":"<p>The graph below shows the significant cells/tissues when MAGMA gene property analysis applied to the RBC volume GWAS using reference data from the GTEx project:</p> <p></p> <p>The presence of \"whole blood\" is intuitive.  The other four significant tissues are EBV-transformed lymphocytes, the spleen, and \"Lymphode aggregate\" from the small intestine.  The significance of these white-blood-cell-related tissues might be explained by their similarity to erythrocytes. Erythrocytes and leukocytes share a common lineage, descending from haematopoietic stem cells (see Figure below).  Thus it could be that MAGMA is picking up genes that play a role in all myeloid cells.</p> <p> Figure: By A. Rad and M. H\u00e4ggstr\u00f6m. CC-BY-SA 3.0 license</p> <ol> <li> <p>Anurag Verma, Jennifer E Huffman, Alex Rodriguez, Mitchell Conery, Molei Liu, Yuk-Lam Ho, Youngdae Kim, David A Heise, Lindsay Guare, Vidul Ayakulangara Panickan, and others. Diversity and scale: genetic architecture of 2068 traits in the va million veteran program. Science, 385(6706):eadj1182, 2024. URL: https://www.science.org/doi/10.1126/science.adj1182.\u00a0\u21a9</p> </li> <li> <p>GTEx Consortium. The gtex consortium atlas of genetic regulatory effects across human tissues. Science, 369(6509):1318\u20131330, 2020. URL: https://www.science.org/doi/full/10.1126/science.aaz1776.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Verma_et_al_%28RBC_Volume%29/RBC_Volume/","title":"RBC Volume","text":""},{"location":"Analysis/Verma_et_al_%28RBC_Volume%29/RBC_Volume/#rbc-volume","title":"RBC Volume","text":"<p>Red blood cell volume is also known as mean corpuscular volume.  Abnormal values can be indicative of various forms of anemia.</p>"},{"location":"Analysis/Verma_et_al_%28RBC_Volume%29/S-LDSC_RBCV_Analysis/","title":"S-LDSC RBCV Analysis","text":""},{"location":"Analysis/Verma_et_al_%28RBC_Volume%29/S-LDSC_RBCV_Analysis/#s-ldsc-rbcv-analysis","title":"S-LDSC RBCV Analysis","text":"<p>I applied Stratified Linkage Disequilibrium Score Regression<sup>1</sup> (S-LDSC) to summary statistics from a GWAS of Red Blood Cell Volume from the Million Veterans Program.</p> <p>I used standard S-LDSC reference datasets. These reference datasets were originally derived from:</p> <ul> <li>The GTEx Project</li> <li>The Franke lab dataset</li> <li>The Roadmap Epigenetic Project</li> <li>The Corces et al. ATAC-seq dataset of 13 blood cell types.</li> <li>The ImmGen Project</li> <li>The Cahoy Mouse Central Nervous System Dataset</li> </ul>"},{"location":"Analysis/Verma_et_al_%28RBC_Volume%29/S-LDSC_RBCV_Analysis/#results","title":"Results","text":""},{"location":"Analysis/Verma_et_al_%28RBC_Volume%29/S-LDSC_RBCV_Analysis/#gtex-and-franke-lab-tissue-expression-data","title":"GTEx and Franke lab tissue expression data","text":"<p>The plot below illustrates the pattern of S-LDSC p values across cell types. The table shows the cell types with the lowest p values.</p> <p></p> Name Coefficient Coefficient_P_value Reject Null A15.145.300.Fetal.Blood 8.02657e-08 6.59384e-09 True A15.145.Blood 5.94179e-08 7.3992e-06 True A11.443.Erythroid.Cells 4.41781e-08 1.19728e-05 True A11.627.635.Myeloid.Progenitor.Cells 4.62524e-08 0.000107559 True A11.872.378.Hematopoietic.Stem.Cells 4.41011e-08 0.000172671 True A15.382.Immune.System 3.99963e-08 0.000342322 False Whole_Blood 3.64886e-08 0.000399347 False A15.145.229.188.Blood.Platelets 3.14462e-08 0.000464739 False A11.872.378.590.817.Megakaryocyte.Erythroid.Progenitor.Cells 3.67321e-08 0.000603583 False A15.145.229.Blood.Cells 4.13485e-08 0.000654442 False A11.118.637.555.567.562.B.Lymphocytes 3.57229e-08 0.000800263 False Spleen 3.89864e-08 0.000854701 False A11.118.637.555.567.569.T.Lymphocytes 2.90771e-08 0.00104616 False Colon_Transverse 2.6992e-08 0.00126636 False A15.145.229.637.555.567.569.200.CD4.Positive.T.Lymphocytes 2.53835e-08 0.00230767 False A15.382.490.555.567.537.Killer.Cells..Natural 3.36356e-08 0.00263635 False A11.627.340.360.Granulocyte.Precursor.Cells 2.73892e-08 0.00301885 False A15.145.229.637.555.567.562.725.Plasma.Cells 3.18685e-08 0.0035067 False A11.118.637.Leukocytes 3.64806e-08 0.00398084 False A15.382.520.604.800.Palatine.Tonsil 2.93966e-08 0.00419334 False A11.118.637.555.567.569.200.700.T.Lymphocytes..Regulatory 2.38386e-08 0.00485846 False A11.872.Stem.Cells 2.63215e-08 0.00487292 False A11.118.637.555.567.562.440.Precursor.Cells..B.Lymphoid 2.5128e-08 0.00587332 False A11.872.378.590.635.Granulocyte.Macrophage.Progenitor.Cells 2.81929e-08 0.00629756 False A03.556.124.684.Intestine..Small 2.71434e-08 0.0065321 False A15.382.490.555.567.Lymphocytes 3.1885e-08 0.00745577 False A03.556.249.124.Ileum 2.81618e-08 0.00763379 False Cells_EBV-transformed_lymphocytes 2.55655e-08 0.00789262 False <p>The 5 significant cell types are: \"A15.145.300.Fetal.Blood\", \"A15.145.Blood\", \"A11.443.Erythroid.Cells\", \"A11.627.635.Myeloid.Progenitor.Cells\".</p> <p>These findings makes sense, and are consistent with known biology: \"Erethryoid cells\" are a class that includes standard red blood cells (erythrocytes), while myeloid progenitor cells are ancestors to red blood cells (see the figure below). </p> <p></p> <p>Figure: By A. Rad and M. H\u00e4ggstr\u00f6m. CC-BY-SA 3.0 license</p>"},{"location":"Analysis/Verma_et_al_%28RBC_Volume%29/S-LDSC_RBCV_Analysis/#roadmap-chromatin-data","title":"Roadmap Chromatin data","text":"<p>I next applied S-LDSC to the red blood cell volume GWAS using reference data generated by Finucane et al.<sup>1</sup> from the Roadmap Epigenetics Project.</p> <p>The following graph and table show the results:</p> <p></p> Name Coefficient Coefficient_P_value Reject Null Primary_hematopoietic_stem_cells_G-CSF-mobilized_Female__H3K27ac 9.7986e-07 4.30062e-07 True Primary_hematopoietic_stem_cells_G-CSF-mobilized_Female__H3K4me1 3.89211e-07 7.36713e-07 True Primary_hematopoietic_stem_cells_G-CSF-mobilized_Female__DNase 9.67532e-07 1.22959e-06 True Primary_hematopoietic_stem_cells__H3K4me1 7.08867e-07 3.25765e-06 True Primary_hematopoietic_stem_cells_G-CSF-mobilized_Male__H3K4me1 4.06036e-07 3.37892e-06 True Primary_T_killer_memory_cells_from_peripheral_blood__H3K27ac 8.61697e-07 3.55327e-06 True Primary_hematopoietic_stem_cells_short_term_culture__H3K4me3 1.833e-06 5.35886e-06 True Primary_hematopoietic_stem_cells_G-CSF-mobilized_Male__DNase 8.90935e-07 7.23909e-06 True Primary_T_helper_memory_cells_from_peripheral_blood_2__H3K27ac 6.6463e-07 2.52533e-05 True Primary_hematopoietic_stem_cells_G-CSF-mobilized_Male__H3K4me3 1.0486e-06 2.63718e-05 True Spleen_ENTEX__H3K27ac 2.05768e-07 4.87077e-05 True Fetal_Thymus__H3K36me3 2.79975e-07 5.17104e-05 True Primary_hematopoietic_stem_cells_short_term_culture__H3K4me1 3.5475e-07 8.47972e-05 True Primary_hematopoietic_stem_cells_G-CSF-mobilized_Female__H3K4me3 1.75499e-06 0.000127767 True Primary_hematopoietic_stem_cells_short_term_culture__H3K36me3 3.44274e-07 0.000129613 True Spleen_ENTEX__H3K4me3 3.49278e-07 0.000195307 True Primary_neutrophils_from_peripheral_blood__H3K4me3 6.33005e-07 0.000318123 True Primary_B_cells_from_peripheral_blood__DNase 4.68288e-07 0.000512658 False Primary_neutrophils_from_peripheral_blood__H3K4me1 1.87677e-07 0.000658363 False Spleen_ENTEX__H3K4me1 9.59291e-07 0.00107238 False Rectal_Mucosa_Donor_31__H3K9ac 5.6792e-07 0.00116076 False Stomach_ENTEX__H3K4me3 7.71536e-07 0.00122671 False SI-Term-Ileum_ENTEX__H3K4me3 6.86199e-07 0.00140399 False Primary_hematopoietic_stem_cells__H3K4me3 1.4126e-06 0.00167475 False Primary_T_helper_cells_from_peripheral_blood__H3K4me3 7.52953e-07 0.00177749 False Fetal_Thymus__DNase 4.10651e-07 0.00233247 False SI-Term-Ileum_ENTEX__H3K27ac 2.38673e-07 0.0023326 False Primary_Natural_Killer_cells_from_peripheral_blood__H3K4me1 2.12516e-07 0.00384186 False <p>Again, consistent with known biology, the significant cell types are all in the blood/immune category and related to or descended from haematopoietic stem cells.  </p> <p>The presence of lymphocytes like T-cells on the list of significant cell types is interesting.  My guess is that this may reflect epigenetic features shared by all cells in haematopoietic stem cell lineage, rather than true etiological role for lymphocytes in red blood cell volume.</p>"},{"location":"Analysis/Verma_et_al_%28RBC_Volume%29/S-LDSC_RBCV_Analysis/#immgen-data","title":"ImmGen Data","text":"<p>The next step is to use the S-LDSC reference data derived from the ImmGen project.</p> <p></p> Name Coefficient Coefficient_P_value Reject Null preT.DN2.Th 7.01741e-08 7.55644e-08 True T.8SP69+.Th 6.10773e-08 4.08943e-07 True preT.ETP-2A.Th 6.13855e-08 4.64764e-07 True preT.DN2-3.Th 5.88185e-08 5.87392e-07 True T.4int8+.Th 5.54558e-08 6.74419e-07 True preT.DN2A.Th 5.66926e-08 1.21757e-06 True Tgd.vg2+24ahi.Th 5.37253e-08 2.51879e-06 True CD4.96h.LN 5.33706e-08 4.68263e-06 True T.8SP24int.Th 4.98821e-08 4.85374e-06 True Tgd.Th 5.3534e-08 6.5081e-06 True preT.DN3-4.Th 5.45315e-08 7.09887e-06 True preT.DN3B.Th 5.52977e-08 1.07887e-05 True SC.LT34F.BM 4.19728e-08 1.54079e-05 True Tgd.vg2-.Sp 4.27974e-08 1.98276e-05 True preT.ETP.Th 5.19913e-08 2.82895e-05 True T.8SP24-.Th 4.95349e-08 3.34413e-05 True T.DP.69-.e17.Th.v2 4.53702e-08 3.40748e-05 True proB.FrBC.FL 4.98927e-08 3.65938e-05 True MF.BM 6.94982e-08 3.83549e-05 True SC.MDP.BM 4.9775e-08 3.98549e-05 True proB.CLP.FL 4.93602e-08 4.49107e-05 True T.4Nve.Sp 4.0749e-08 4.70371e-05 True CD4.48h.LN 5.13317e-08 4.90148e-05 True Tgd.vg2+24ahi.e17.Th 3.98931e-08 5.05495e-05 True T.4+8int.Th 3.81905e-08 5.49732e-05 True T.DP69+.Th.v2 5.14471e-08 5.7412e-05 True NKT.44-NK1.1-.Th 3.6643e-08 6.27774e-05 True T.4SP69+.Th 4.45522e-08 6.57873e-05 True <p>These results are somewhat surprising: all categories of immune-cell are tagged as significant.  Moreover, T-helper cells are highly significant.  My guess is that this again reflects shared features of cells descended from haematopoietic stem cells.</p>"},{"location":"Analysis/Verma_et_al_%28RBC_Volume%29/S-LDSC_RBCV_Analysis/#corces-et-al-atac-seq-data","title":"Corces et al. ATAC-seq data","text":"<p>Looking at the Corces et al. ATAC-seq dataset, we again see broad cross cell-type significance.</p> Name Coefficient Coefficient_P_value Reject Null Erythro 2.20621e-06 5.0373e-11 True MEP 5.39479e-07 4.68085e-08 True CMP 3.95866e-07 7.26445e-05 True HSC 3.3574e-07 0.000577361 True MPP 2.90813e-07 0.00059752 True Bcell 3.08234e-07 0.00107073 True NK 3.10655e-07 0.00186229 True GMP 2.39349e-07 0.00305697 True <p>However, here we also note that erythrocyte cells are by far the most significant, followed by their direct ancestors the Megakaryocytic-Erythroid Progenitors (MEP).  This is consistent with the idea that erythrocytes are the cell type truly driving the phenotype, and the other cell types are significant to the extent that they share regulatory pathways with erythrocytes.</p>"},{"location":"Analysis/Verma_et_al_%28RBC_Volume%29/S-LDSC_RBCV_Analysis/#cahoy-and-gtex-brain-data","title":"Cahoy and GTEx-Brain data","text":"Name Coefficient Coefficient_P_value Reject Null Astrocyte 8.37248e-09 0.137796 False Oligodendrocyte 9.32556e-10 0.452566 False Neuron -4.38565e-10 0.526099 False Name Coefficient Coefficient_P_value Reject Null Brain_Anterior_cingulate_cortex_(BA24) 1.51946e-08 0.00662582 False Brain_Cerebellar_Hemisphere 1.18609e-08 0.0269974 False Brain_Putamen_(basal_ganglia) 1.1835e-08 0.0664447 False Brain_Cerebellum 7.09048e-09 0.164615 False Brain_Nucleus_accumbens_(basal_ganglia) 5.70585e-09 0.170502 False Brain_Cortex 6.52218e-09 0.180797 False Brain_Caudate_(basal_ganglia) 4.90205e-09 0.237016 False Brain_Amygdala 3.25693e-09 0.272557 False <p>None of the neurological cell types in these datasets are significant. This is consistent with RBC volume being a non-neurological phenotype.</p>"},{"location":"Analysis/Verma_et_al_%28RBC_Volume%29/S-LDSC_RBCV_Analysis/#reproducing","title":"Reproducing","text":"<p>To reproduce these results, run the analysis script here.</p> <ol> <li> <p>Hilary K Finucane, Yakir A Reshef, Verneri Anttila, Kamil Slowikowski, Alexander Gusev, Andrea Byrnes, Steven Gazal, Po-Ru Loh, Caleb Lareau, Noam Shoresh, and others. Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types. Nature genetics, 50(4):621\u2013629, 2018. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC5896795/.\u00a0\u21a9\u21a9</p> </li> </ol>"},{"location":"Analysis/Verweiji_et_al_2018%20%28HRR%29/MAGMA_GTEx_HRR_Analysis/","title":"MAGMA GTEx","text":""},{"location":"Analysis/Verweiji_et_al_2018%20%28HRR%29/MAGMA_GTEx_HRR_Analysis/#magma-gtex","title":"MAGMA GTEx","text":"<p>I applied MAGMA analysis to the Verweiji et al.'s GWAS of heart rate recovery after exercise<sup>1</sup>, using GTEx bulk RNAseq data<sup>2</sup> as a reference.</p>"},{"location":"Analysis/Verweiji_et_al_2018%20%28HRR%29/MAGMA_GTEx_HRR_Analysis/#results","title":"Results","text":"<p>The results are shown in the bar plot below: </p> <p>There are two significant tissue types: the atrial appendage and the gastroesophageal junction. The atrial appendage may be stand-in for cardiac tissue in general, and could reflect the role of general heart health in recovery from exercise.  Alternatively, this could reflect the importance of pacemaker cells near the atrial appendage in controlling heart rate. The significance of the gastroesophageal junction is unclear.</p> <ol> <li> <p>Niek Verweij, Yordi J van de Vegte, and Pim van der Harst. Genetic study links components of the autonomous nervous system to heart-rate profile during exercise. Nature communications, 9(1):898, 2018.\u00a0\u21a9</p> </li> <li> <p>GTEx Consortium. The gtex consortium atlas of genetic regulatory effects across human tissues. Science, 369(6509):1318\u20131330, 2020. URL: https://www.science.org/doi/full/10.1126/science.aaz1776.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Verweiji_et_al_2018%20%28HRR%29/MAGMA_HBA_HRR_Analysis/","title":"HBA MAGMA","text":""},{"location":"Analysis/Verweiji_et_al_2018%20%28HRR%29/MAGMA_HBA_HRR_Analysis/#hba-magma","title":"HBA MAGMA","text":"<p>I applied MAGMA to the heart rate recovery GWAS of Verweiji et al.<sup>1</sup> using scRNAseq data from the Human Brain Atlas as a reference.</p> <p>In the plot below, the x-axis corresponds to HBA cluster number<sup>2</sup>, while the y-axis corresponds to the \\(-\\log_{10}(p)\\) score produced by MAGMA.  Clusters are colored according to their HBA supercluster. The dotted line denotes the Bonferroni significance threshold.  I used a conditional analysis approach based on the one described in Wanatabe et al.<sup>3</sup> to identify independent clusters.   A single independent cluster was found, which is labeled in the plot, and listed in detail the table below.</p> <p></p> Retained_clusters P Supercluster Class auto-annotation Neurotransmitter auto-annotation Neuropeptide auto-annotation Subtype auto-annotation Transferred MTG Label Top three regions Top Enriched Genes Cluster398 1.5129e-07 Splatter NEUR VGLUT2 ADCYAP CART CBLN CCK CHGA CHGB GAL NAMPT NUCB NXPH SCG TAC UBL VGF proSAAS 0 Medulla: 86.6%, Pons: 12.8%, Midbrain: 0.2% PHOX2B-AS1, PHOX2B, LINC00682, HOXB3, SLC5A7, SLC6A2, GAL, TH, PHOX2A, HOTAIRM1 <p>This result is striking.  Notice that the cell type in the table above is found mostly in the medulla oblongata, a region of the brainstem. The brainstem is a center of autonomic nervous system control. Given that the autonomic nervous system is key to the control of heart rate, it makes physiologic sense that genes associated with heart rate recovery after exercise should be expressed in an autonomic control center.</p> <ol> <li> <p>Niek Verweij, Yordi J van de Vegte, and Pim van der Harst. Genetic study links components of the autonomous nervous system to heart-rate profile during exercise. Nature communications, 9(1):898, 2018.\u00a0\u21a9</p> </li> <li> <p>Kimberly Siletti, Rebecca Hodge, Alejandro Mossi Albiach, Ka Wai Lee, Song-Lin Ding, Lijuan Hu, Peter L\u00f6nnerberg, Trygve Bakken, Tamara Casper, Michael Clark, and others. Transcriptomic diversity of cell types across the adult human brain. Science, 382(6667):eadd7046, 2023. URL: https://www.science.org/doi/abs/10.1126/science.add7046.\u00a0\u21a9</p> </li> <li> <p>Kyoko Watanabe, Ma\u0161a Umi\u0107evi\u0107 Mirkov, Christiaan A de Leeuw, Martijn P van den Heuvel, and Danielle Posthuma. Genetic mapping of cell type specificity for complex traits. Nature communications, 10(1):3222, 2019. URL: https://www.nature.com/articles/s41467-019-11181-1.\u00a0\u21a9</p> </li> </ol>"},{"location":"Analysis/Verweiji_et_al_2018%20%28HRR%29/S_LDSC_HRR_Analysis/","title":"S-LDSC","text":""},{"location":"Analysis/Verweiji_et_al_2018%20%28HRR%29/S_LDSC_HRR_Analysis/#s-ldsc","title":"S-LDSC","text":"<p>I used Stratified Linkage Disequilibrium Score Regression (S-LDSC) to analyze summary statistics from a GWAS of heart rate recovery after exercise </p> <p>I used the standard reference data sources to associate chromatin regions with cell or tissue types. These reference data sources were:</p> <ul> <li>The GTEx Project</li> <li>The Franke lab dataset</li> <li>The Roadmap Epigenetic Project</li> <li>The Corces et al. ATAC-seq dataset of 13 blood cell types.</li> <li>The ImmGen Project</li> <li>The Cahoy Mouse Central Nervous System Dataset</li> </ul> <p>Surprisingly, there were no significant tissue or cell types in any of these datasets. This may indicate a poor match between the cell and tissue types present in these datasets and the physiology of heart rate recovery.</p>"},{"location":"Bioinformatics_Concepts/Cross_Trait_LDSC/","title":"CT-LDSC","text":""},{"location":"Bioinformatics_Concepts/Cross_Trait_LDSC/#ct-ldsc","title":"CT-LDSC","text":"<p>Cross Trait Linkage Disequilibrium Score Regression (CT-LDSC)<sup>1</sup> is an extension of Linkage Disequilibrium Score Regression (LDSC)<sup>2</sup> that estimates genetic correlation.</p>"},{"location":"Bioinformatics_Concepts/Cross_Trait_LDSC/#derivation","title":"Derivation","text":""},{"location":"Bioinformatics_Concepts/Cross_Trait_LDSC/#data-generating-model","title":"Data Generating Model","text":"<p>Recall that LDSC assumes a linear data-generating model. CT-LDSC assumes two linear data-generating models, one for each of two traits:</p> \\[ \\begin{align} y_1&amp;= Y\\beta + \\delta \\label{dg1}\\\\ y_2&amp;= Z\\gamma + \\epsilon \\label{dg2} \\end{align} \\] <p>where:</p> <ul> <li>There are \\(M  \\gg 0\\) genetic variants.  </li> <li>There are \\(N_1 \\gg 0\\) individuals in the GWAS of trait 1 and \\(N_2 \\gg 0\\) individuals in the GWAS of trait 2.</li> <li>There are \\(N_s\\) individuals included in both GWAS.  Without loss of generality, assume these \\(N_s\\) individuals are listed first in the lists of participants in both studies.</li> <li>\\(y_1\\in \\mathbb{R}^{N_1}\\) and \\(y_2 \\in \\mathbb{R}^{N_2}\\) are the vectors of phenotypes for the GWAS of trait 1 and the GWAS of trait 2, respectively.</li> <li>\\(Y\\in\\mathbb{R}^{N_1\\times M}\\) and \\(Z\\in\\mathbb{R}^{N_2\\times M}\\) are the genotype matrices from the two GWAS, normalized to have columns with sample mean 0 and variance 1.  \\(Y_j\\in\\mathbb{R}^{N_1}\\) and \\(Z_j \\in \\mathbb{R}^{N_2}\\) denote the \\(j\\)th columns of the two matrices.</li> <li>\\(\\beta,\\gamma\\in\\mathbb{R}^M\\) are the vectors of true per-variant genetic effect sizes for the two traits. </li> <li>\\(Y\\beta\\in\\mathbb{R}^{N_1}\\) and \\(Z\\gamma\\in\\mathbb{R}^{N_2}\\) are thus the vectors of genetic effects in the two GWAS.</li> <li>\\(\\epsilon\\in\\mathbb{R}^{N_1}\\) and \\(\\delta\\in\\mathbb{R}^{N_2}\\) are the vectors of non-genetic effects in the two GWAS.</li> </ul> <p>We model \\(Y,Z,\\beta,\\gamma, \\delta,\\epsilon\\) as random variables with the following properties:</p> \\[ \\begin{align} \\mathbb{Var(\\delta)} &amp;= (1-h_1^2)I &amp; \\text{ for some }h_1&gt;0\\\\ \\mathbb{Var(\\epsilon)} &amp;= (1-h_2^2)I&amp; \\text{ for some }h_2&gt;0\\\\ \\mathbb{Cov}(\\delta_j,\\epsilon_k) &amp;= \\begin{cases} \\rho_e &amp;\\text{ if } j=k \\le N_s \\\\ 0 &amp; \\text{ else } \\end{cases} &amp; \\text{ for some }\\rho_e&gt;0 \\label{cov_delta_epsilon}\\\\ \\mathbb{Var}(\\beta) &amp;= \\frac{1}{M} h_1^2 I \\label{var_beta} \\\\ \\mathbb{Var}(\\gamma) &amp;= \\frac{1}{M} h_2^2 I  \\label{var_gamma}  \\\\ \\mathbb{Cov}(\\beta, \\gamma)&amp;= \\frac{1}{M}\\rho_gI &amp; \\text{ for some }\\rho_g&gt;0 \\label{cov_beta_gamma}\\\\ \\mathbb{E}(\\delta)&amp;=0\\label{e_delta}\\\\ \\mathbb{E}(\\beta)&amp;=0  \\label{e_beta} \\\\ \\mathbb{E} Y &amp;=0 \\label{e_Y} \\\\  \\mathbb{E}(\\epsilon)&amp;=0   \\label{e_epsilon} \\\\ \\mathbb{E}(\\gamma)&amp;=0  \\label{e_gamma} \\\\ \\mathbb{E} (Z) &amp;=0  \\label{e_Z} \\\\  \\mathbb{E}(Y_i^2) &amp;=\\mathbb{E}(Z_i^2)=1 &amp;\\text{ for all }i \\label{y_z_var} \\end{align} \\] <ul> <li>Assumption (\\(\\ref{cov_delta_epsilon}\\)) specifies that error is uncorrelated between GWAS, except for individuals who are participants both studies.</li> <li>Assumptions (\\(\\ref{var_beta}\\)), (\\(\\ref{var_gamma}\\)), and (\\(\\ref{cov_beta_gamma}\\)) specify an isotropically polygenic architecture, analogous to the one used in LDSC.</li> <li>Assumptions (\\(\\ref{e_delta}\\)), (\\(\\ref{e_beta}\\)), (\\(\\ref{e_Y}\\)), (\\(\\ref{e_Z}\\)), and (\\(\\ref{y_z_var}\\)) specify that the data has been pre-normalized. Here (\\(\\ref{e_Y}\\)), (\\(\\ref{e_Z}\\)), and (\\(\\ref{y_z_var}\\)) elide the distinction between sample and population level normalization, which should only introduce minor error given the large sample size of a typical GWAS.</li> </ul> <p>Furthermore, we assume the following relationships between the random variables, which are faily standard in linear data-generating models:</p> <ul> <li>The rows of \\(Y\\) and \\(Z\\) are mutually independent, except in the case that a row of \\(Y\\) and \\(Z\\) refer to the same individual (one of the \\(N_s\\) individuals present in both GWAS).</li> <li>The rows of \\(Y\\) and \\(Z\\) are identically distributed. That is, the two GWAS samples are drawn independently from the sample population.</li> <li>\\(Y, \\beta, \\delta\\) are all mutually independent, as are \\(Z,\\gamma, \\epsilon\\).</li> <li>\\(\\beta\\) is independent of \\(\\epsilon\\) and \\(Z\\), and \\(\\gamma\\) is independent of \\(\\delta\\) and \\(Y\\).</li> </ul> <p>Note that this implies that the true genetic effects have mean zero:</p> \\[ \\begin{align} \\mathbb{E}( Y\\beta) &amp;= \\mathbb{E}(Y) \\mathbb{E}(\\beta) &amp;\\text{ by independence}\\\\ &amp;=0 \\end{align} \\] <p>and similarly, \\(\\mathbb{E}(Z\\gamma)=0\\).</p> <p>Define the following quantities related to Linkage Disequilibrium (LD):</p> <ul> <li> <p>The LD between SNP \\(j\\) and SNP \\(k\\) is denoted by \\(r_{jk}:=\\mathbb{E}(Y_{i,j}Y_{i,k})=\\mathbb{E}(Z_{q,j}Z_{qk})\\), (which does not depend on the individuals \\(i\\) and \\(q\\) by our assumption that the rows of \\(Y\\) and \\(Z\\) are iid).</p> </li> <li> <p>The LD score of a SNP \\(j\\) is defined to be \\(l_j:= \\sum_k r_{jk}^2\\). It quantifies the magnitude of the dependence between \\(j\\) and other SNPs.</p> </li> </ul>"},{"location":"Bioinformatics_Concepts/Cross_Trait_LDSC/#genetic-covariance","title":"Genetic Covariance","text":"<p>First, let us compute the genetic covariances between the two phenotypes.  Let \\(X\\in\\mathbb{R}^M\\) denote the genotype of an arbitrary individual.  By definition, genetic covariance is:</p> \\[ \\begin{align} &amp;\\mathbb{Cov}\\left( \\sum_j X_j \\beta_j, \\sum_k X_k \\gamma_k \\right)\\\\ &amp;= \\mathbb{E}\\left(  \\left(\\sum_j X_j \\beta_j\\right)\\left(\\sum_k X_k \\gamma_k \\right)  \\right)&amp; \\text{mean 0}\\\\ &amp;=\\sum_{j,k} \\mathbb{E} \\left( X_j X_k \\beta_j \\gamma_k \\right) &amp; \\text{linearity}\\\\ &amp;=\\sum_{j,k}\\mathbb{E} (X_jX_k) \\mathbb{E}(\\beta_j \\gamma_k) &amp; \\text{independence}\\\\ &amp;=\\sum_{j}\\mathbb{E} (X_j^2) \\mathbb{E}(\\beta_j \\gamma_j) &amp; \\text{by (\\ref{cov_beta_gamma})}\\\\ &amp;=\\sum_j \\mathbb{E} (\\beta_j \\gamma_j) &amp; \\text{ by (\\ref{y_z_var})}\\\\ &amp;=\\rho_g. &amp; \\text{by (\\ref{cov_beta_gamma})} \\end{align} \\]"},{"location":"Bioinformatics_Concepts/Cross_Trait_LDSC/#genetic-correlation","title":"Genetic Correlation","text":"<p>Note that the model (\\(\\ref{dg1},\\ref{dg2}\\)) is an extension of the model used in LDSC.  By the derivation of LDSC, we have \\(\\mathbb{Var}(\\sum_j X_j \\beta_j)=h_1^2\\) and \\(\\mathbb{Var}(\\sum_j X_j \\gamma_j)=h_2^2\\).</p> <p>The genetic correlation of the two traits can be computed as their genetic covariance divided by the square root of the product of their heritabilities:</p> \\[ \\frac{\\rho_g}{h_1h_2}. \\]"},{"location":"Bioinformatics_Concepts/Cross_Trait_LDSC/#regression-equation","title":"Regression equation","text":"<p>Using the same logic as in derivation of LDSC, we approximate the Wald \\(\\chi^2\\) statistics of a variant \\(j\\) in the two GWAS: </p> \\[ \\begin{align} \\chi_{j,1}^2 &amp;\\approx N \\hat{\\beta}_{j,1}^2=\\frac{(y_1^T Y_{j})^2}{N_1}\\\\ \\chi_{j,2}^2 &amp;\\approx N \\hat{\\beta}_{j21}^2=\\frac{(y_1^T Z_{j})^2}{N_2}. \\end{align} \\] <p>It follows that the corresponding z-statistics are: </p> \\[ \\begin{align} z_{j,1} &amp;\\approx \\frac{(y_1^T Y_{j})}{\\sqrt{N_1}} \\label{d1}\\\\ z_{j,2} &amp;\\approx \\frac{y_1^T Z_{j}}{\\sqrt{N_2}} \\label{d2}. \\end{align} \\] <p>Recall that in LDSC, the regression dependent variable was the Wald \\(\\chi^2\\) statistic.  In CT-LDSC, the regression dependent variable is the product of the \\(z\\)-statistics from the two GWAS.  To derive the regression equation, we must estimate \\(\\mathbb{E}(z_{j,1}z_{j,2})\\).  By the Tower Law of Expectation (see Grimmett and Stirzaker pg.336<sup>3</sup>), </p> \\[ \\begin{align} \\mathbb{E}(z_{j,1}z_{j,2})= \\mathbb{E}\\left( \\mathbb{E}(z_{j,1}z_{j,2}|Z,Y) \\right). \\\\ \\end{align} \\] <p>Evaluating the inner expectation,</p> \\[ \\begin{align} &amp;\\mathbb{E}(z_{j,1}z_{j,2}|Z,Y)\\\\ &amp;\\approx\\frac{1}{\\sqrt{N_1N_2}} \\mathbb{E}\\left(Y_j^T y_1 y_1^T Z_j|Z,Y \\right) &amp; \\text{ by (\\ref{d1}, \\ref{d2})}\\\\ &amp;=\\frac{1}{\\sqrt{N_1N_2}}Y^T_j \\mathbb{E}\\left( (Y\\beta+\\delta)(Z\\gamma+\\epsilon)^T  |Z,Y\\right)Z_j &amp; \\text{ by (\\ref{dg1},\\ref{dg2})}\\\\ &amp;=\\frac{1}{\\sqrt{N_1N_2}}Y^T_j \\left(Y \\mathbb{E}(\\beta \\gamma^T)Z^T +  \\mathbb{E}(\\delta \\gamma^T) Z^T + Y \\mathbb{E}(\\beta \\epsilon^T) + \\mathbb{E}(\\epsilon \\delta^T) \\right)Z_j &amp; \\text{linearity, independence}\\\\ &amp;=\\frac{1}{\\sqrt{N_1N_2}}Y^T_j\\left(\\frac{\\rho_g}{M}YZ^T + \\rho_e Q\\right)Z_j &amp; \\text{ by (\\ref{cov_beta_gamma},\\ref{cov_delta_epsilon})}\\\\ &amp;=\\frac{1}{\\sqrt{N_1N_2}}\\left(\\frac{\\rho_g}{M}Y_j^TYZ^TZ_j + \\rho_e Y_j^T QZ_j\\right) \\label{cond_exp} \\end{align} \\] <p>where \\(Q\\in\\mathbb{R}^{N_1\\times N_2}\\) and </p> \\[ \\begin{align} Q_{i,j}&amp;= \\begin{cases} 1 &amp; \\text{ if }i=j \\le N_s\\\\ 0 &amp; \\text{else} \\end{cases}. \\end{align} \\] <p>Our goal is to derive an expression for the unconditional expectation of \\(z_{j,1}z_{j,2}\\).  To achieve this, we take the expectation of both terms in \\((\\ref{cond_exp})\\).  First, we have</p> \\[ \\begin{align} &amp;\\mathbb{E}(Y_j^TYZ^TZ_j)\\\\ &amp;= Y_j^T \\left( \\sum_{k=1}^M Y_{i,k} Z_{q,k} \\right)_{(i,q)}  Z_j \\\\ &amp;=\\mathbb{E} \\sum_{i=1}^{N_1}\\sum_{q=1}^{N_2}\\sum_{k=1}^M\\left( Y_{i,j}Y_{i,k} Z_{q,j} Z_{q,k}  \\right) &amp; \\text{ def of matrix product} \\end{align} \\] <p>There are \\(N_1N_2\\) possible pairs of the indexes \\(i\\) and \\(q\\).  For each such pair, there are two cases:</p> <ul> <li>Case 1: \\(i\\) and \\(q\\) refer to the same individual.  There are \\(N_s\\) such index pairs. In this case we have</li> </ul> \\[ \\begin{align} &amp;\\sum_{k=1}^M \\mathbb{E}(Y_{i,j} Y_{i,k} Z_{q,j} Z_{q,k} )\\\\ &amp;=\\sum_{k=1}^M \\mathbb{E}(Y_{i,j}^2 Y_{i,k}^2)\\\\ &amp;\\approx  \\sum_{k=1}^M (1 + 2r_{j,k}^2)  \\label{isserlis_approx_line}\\\\ &amp;=M + 2\\sum_{k=1}^M r_{j,k}^2\\\\ &amp;= M + 2l_j  \\end{align} \\] <p>Where we have approximated the random variables as having a normal distribution, and used   Isserlis's Theorem.  Recall that we also used Isserlis's theorem at a similar point in the derivation of LDSC.</p> <ul> <li>Case 2: \\(i\\) and \\(q\\) refer to different individuals.  There are \\(N_1N_2-N_s\\) such pairs.</li> </ul> \\[ \\begin{align} &amp;\\sum_{k=1}^M \\mathbb{E}(Y_{i,j} Y_{i,k} Z_{q,j} Z_{q,k} )\\\\ &amp;=\\sum_{k=1}^M \\mathbb{E}(Y_{i,j} Y_{i,k}) \\mathbb{E}(Z_{q,j} Z_{q,k} ) &amp; &amp;\\text{ independence}  \\\\ &amp;=\\sum_{k=1}^M r_{jk}^2\\\\ &amp;= l_{j} \\end{align} \\] <p>Combining the two cases yields</p> \\[ \\begin{align} &amp;\\mathbb{E}(Y_j^TYZ^TZ_j)\\\\ &amp;=N_s(M+2l_j) + (N_1N_2-N_s)l_j\\\\ &amp;=MN_s + (N_1N_2+N_s)l_j\\\\ &amp;\\approx MN_s + N_1N_2 l_j. \\label{exp_prod_1} \\end{align} \\] <p>Returning to the second term in \\((\\ref{cond_exp})\\), we have that </p> \\[ \\begin{align} \\mathbb{E}(Y_j^TQZ_j)=N_s \\label{exp_prod_2} \\end{align} \\] <p>by the assumption of independence of the genotypes of distinct individuals.</p> <p>Substituting \\((\\ref{exp_prod_1})\\) and \\((\\ref{exp_prod_2})\\) into \\((\\ref{cond_exp})\\) yields:</p> \\[ \\begin{align} &amp;\\mathbb{E}(z_{j,1}z_{j,2})\\\\ &amp;\\approx \\frac{1}{\\sqrt{N_1N_2}}\\left( \\frac{\\rho_g}{M}  (MN_s + N_1N_2 l_j) +\\rho_e N_s \\right)\\\\ &amp;= \\frac{\\rho_g\\sqrt{N_1N_2}}{M}l_j + \\frac{N_s}{\\sqrt{N_1N_2}    } (\\rho_g + \\rho_e   ).\\label{ct_ldsc_eqn} \\end{align} \\] <p>\\((\\ref{ct_ldsc_eqn})\\) is the key regression equation in CT-LDSC.</p>"},{"location":"Bioinformatics_Concepts/Cross_Trait_LDSC/#note-on-derivation","title":"Note on derivation","text":"<p>The derivation in the supplementary material to the original paper<sup>1</sup> contains several typos and implicit approximations.  In the version above, I have corrected typos and make approximations explicit.</p> <ol> <li> <p>Brendan Bulik-Sullivan, Hilary K Finucane, Verneri Anttila, Alexander Gusev, Felix R Day, Po-Ru Loh, ReproGen Consortium, Psychiatric Genomics Consortium, Genetic Consortium for Anorexia Nervosa of the Wellcome Trust Case Control Consortium 3, Laramie Duncan, and others. An atlas of genetic correlations across human diseases and traits. Nature genetics, 47(11):1236\u20131241, 2015. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC4797329/.\u00a0\u21a9\u21a9</p> </li> <li> <p>Brendan K Bulik-Sullivan, Po-Ru Loh, Hilary K Finucane, Stephan Ripke, Jian Yang, Nick Patterson, Mark J Daly, Alkes L Price, and Benjamin M Neale. Ld score regression distinguishes confounding from polygenicity in genome-wide association studies. Nature genetics, 47(3):291\u2013295, 2015. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC4495769/.\u00a0\u21a9</p> </li> <li> <p>Geoffrey Grimmett and David Stirzaker. Probability and random processes: third edition. Oxford university press, 2001. URL: https://www.amazon.ca/Probability-Random-Processes-3th-third/dp/B006QYQVTS.\u00a0\u21a9</p> </li> </ol>"},{"location":"Bioinformatics_Concepts/Epigenetics/","title":"Epigenetics","text":""},{"location":"Bioinformatics_Concepts/Epigenetics/#epigenetics","title":"Epigenetics","text":""},{"location":"Bioinformatics_Concepts/Epigenetics/#introduction","title":"Introduction","text":"<p>Neglecting somatic mutations, all non-gamete cells in the body contain the same DNA.  Despite this, the cells of multicellular organisms are diverse: adipocytes differ from neurons, which differ from macrophages, which differ from B cells, which differ from cardiomyocytes.</p> <p>What explains this diversity? Chiefly, the answer is gene expression.  While all genes are present in the DNA of all cells, different genes are switched on or off in different cell types.</p> <p>Gene expression is partly controlled via structural and chemical modifications of DNA that do not change the nucleotides sequence, but do affect transcription.  These structural and chemical modifications are referred to collectively as \"Epigenetics\".</p>"},{"location":"Bioinformatics_Concepts/Epigenetics/#histone-marks","title":"Histone marks","text":"<p>One of the key epigenetic regulatory systems involves histone marks.</p> <p>Eukaryotic DNA is tightly wound around spool-like complexes of proteins called histones.  The resulting DNA-histone units are called nucleosomes.</p> <p></p> <p>Image Source: David O Morgan.</p> <p>Histones can covalently bond to a variety of molecules.  These bonds are called \"histone marks\".  Histone marks affect the three-dimensional structure of chromatin.  For example, certain histone marks cause DNA to be tightly wound, so that the genes it contains cannot be transcribed, while other histone marks cause DNA to open up, allowing genes to be readily transcribed (see Alberts et al. pg 220<sup>1</sup>).</p> <p>Here are some examples of histone marks with known effects:</p> Histone Mark Effect on Chromatin H3K4me1 Associated with enhanced transcription H4K4me3 Open, accessible chromatin<sup>1</sup> H3K9ac Open, accessible chromatin<sup>1</sup> H3K9me3 Closed, inaccessible chromatin<sup>1</sup> [H3K27ac] Associated with higher activation of transcription H3K27me3 Closed, inaccessible chromatin<sup>1</sup> <p>Assays that report histone marks are a key method for understanding epigenetic regulation.</p>"},{"location":"Bioinformatics_Concepts/Epigenetics/#atac-seq","title":"ATAC-seq","text":"<p>Besides assays that report histone marks, assays that directly measure chromatin accessibility are also informative about epigenetic regulation. ATAC-seq is an important example of such an accessibility assay.</p> <p>ATAC-seq  repurposes transposase, the enzyme responsible for the movement of transposons, or \"jumping genes\".  It works on the principle that transposase can interact with open chromatin, but not closed chromatin.  This explains the name: Assay for Transposase Accessible Chromatin (ATAC).</p> <ol> <li> <p>Bruce Alberts, Rebecca Heald, Alexander Johnson, David Morgan, Martin Raff, Keith Roberts, and Peter Walter. Molecular Biology of the Cell: Seventh Edition. WW Norton &amp; Company, 2022.\u00a0\u21a9\u21a9\u21a9\u21a9\u21a9</p> </li> </ol>"},{"location":"Bioinformatics_Concepts/Fine_Mapping/","title":"Fine Mapping","text":""},{"location":"Bioinformatics_Concepts/Fine_Mapping/#fine-mapping","title":"Fine Mapping","text":""},{"location":"Bioinformatics_Concepts/Fine_Mapping/#gwas-and-causal-variants","title":"GWAS and Causal Variants","text":"<p>In a GWAS, one runs a single univariate regression per genetic variant.  The results are visualized as a Manhattan plot, which shows the profile of p values across the genome.  For instance, see this plot generated from the DecodeME<sup>1</sup> summary statistics:</p> <p></p> <p>One of the primary purposes of a GWAS is to identify genetic variants that are causal for the phenotype of interest.  These causal variants can provide insights into the biological processes underlying the phenotype.</p> <p>It would be natural to take the most significant genetic variants  (i.e. the highest points on the Manhattan plot, which are sometimes called \"lead variants\") and conclude that they are causal.  This approach omits a key consideration: linkage disequilibrium.</p>"},{"location":"Bioinformatics_Concepts/Fine_Mapping/#linkage-disequilibrium","title":"Linkage Disequilibrium","text":"<p>\"Linkage disequilibrium\" (LD) refers to statistical dependence between genetic variants. LD is central to nearly every aspect of statistical genomics.</p> <p>Some facts about LD:</p> <ul> <li>LD decays as the distance between variants increases, because the odds of an intervening recombination event correspondingly increase. However, due to the complex structure of Eukaryotic DNA, the odds of recombination events are highly non-uniform across a chromosome. Thus, the rate of LD decay with genomic distance is not constant.</li> <li>Genetic variants that are relatively recent tend to have low frequency in the population, and thus low LD with all other variants, regardless of distance.</li> </ul> <p>As an illustrative example, here is a plot of the absolute value of the correlation between genetic variants in a region of chromosome 1.  This plot was generated from the UK Biobank LD matrices stored on AWS OpenData.</p> <p></p> <p>Consistent with the facts above, we observe irregularly-spaced blocks of high LD.  Moreover, the high LD blocks are not uniform, but contain low-correlation genetic variants, perhaps the result of recent mutations.</p>"},{"location":"Bioinformatics_Concepts/Fine_Mapping/#effect-of-ld-on-significance","title":"Effect of LD on Significance","text":"<p>LD patterns can obscure the true causal variant. To illustrate the point, Wang and Huang<sup>2</sup> provide the toy example illustrated below:</p> <p></p> <p>In the example, the left and right variants are causal, while the central variant is not.  The left and right variants are correlated with the central variant, but not one another.  As a result, the GWAS signal is misleading: if we were to select the candidate causal variants according to p value, we would select the central variant.</p> <p>Wang and Huang's example is not a purely theoretical construction.  It reflects a phenomenon seen in real GWAS.  For instance, in a large scale UK Biobank fine-mapping study of 49 traits, Weisbrod et al.<sup>3</sup> report that \"Only 39% of the 2,225 [likely-causal] SNPs were also lead GWAS SNPs\".</p>"},{"location":"Bioinformatics_Concepts/Fine_Mapping/#fine-mapping_1","title":"Fine Mapping","text":"<p>Wang and Huang<sup>2</sup> note that fine mapping can be thought of as \"an exercise to disentangle the effect of LD from the GWAS data\".  The goal is to identify the true variants by reversing the effect of LD.</p>"},{"location":"Bioinformatics_Concepts/Fine_Mapping/#fine-mapping-as-bayesian-regression","title":"Fine Mapping as Bayesian Regression","text":"<p>Fine mapping is often formulated as a Bayesian linear regression variable selection problem.  In the case of a continuous phenotype, we write</p> \\[ y= \\sum_{j\\in J} \\beta_j x_j + \\epsilon \\] <p>where </p> <ul> <li>\\(y\\) is the phenotype,</li> <li>\\(J\\) is the set of genetic variants at a locus of interest,</li> <li>\\(x_j\\) is an individual's allele for variant \\(j\\),</li> <li>\\(\\beta_j\\) is the effect of variant \\(j\\) on the phenotype,</li> <li>\\(\\epsilon\\) accounts for the part of the phenotype not attributable to genetic variants at the locus.</li> </ul> <p>We state a Bayesian prior over the vector \\(\\beta\\in\\mathbb{R}^J\\), and then estimate a posterior over \\(\\beta\\) conditional on GWAS data.</p> <p>Roughly speaking, fine mapping methods will conclude that a SNP is causal if there is a high posterior probability that \\(\\beta_i\\) is significantly different from zero.  That is:</p> \\[ P(\\lvert\\beta_i\\rvert\\gg 0 |D) \\approx 1. \\] <p>where \\(D\\) is the GWAS data. In fine mapping terminology, a causal SNP is one has a high posterior probability of contributing significantly to the phenotype.</p> <p>It is natural to ask why, when so many other bioinformatic techniques use frequentist statistics, Bayesian statistics has come to dominate fine-mapping.  There are two main reasons.</p> <ul> <li>First, Bayesian statistics allows a precise description of complex forms of uncertainty.  Suppose that we observe significant marginal effects from 10 SNPs.  Suppose the 10 SNPs are all in mutual tight LD (i.e. they are highly correlated).  Many frequentist statistical techniques would formulate one null hypothesis per SNP, and would be unable to reject any of them.  Effectively, the frequentist techniques would provide no information.  Bayesian methods, however, could conclude with confidence that at least one of the 10 SNPs is causal, but express uncertainty over which. </li> <li>Second, Bayesian statistical techniques allow the incorporation of external information in the form of a prior.  As a simple example, note that a SNP that changes an amino acid in a protein is much more likely to have a biological effect than a SNP that replaces one codon with a synonym.</li> </ul>"},{"location":"Bioinformatics_Concepts/Fine_Mapping/#model-miss-specification-error-in-fine-mapping","title":"Model miss-specification error in fine-mapping","text":"<p>todo</p>"},{"location":"Bioinformatics_Concepts/Fine_Mapping/#links","title":"Links","text":"<ul> <li> <p>Primer on Fine Mapping by Ran Cui</p> </li> <li> <p>Talk on SUSIE Fine Mapping Method by Matthew Stephens</p> </li> </ul> <ol> <li> <p>Genetics Delivery Team, Thibaud Boutin, Andrew D Bretherick, Joshua J Dibble, Esther Ewaoluwagbemiga, Emma Northwood, Gemma L Samms, Veronique Vitart, Project, Cohort Delivery Team, \u00d8yvind Almelid, and others. Initial findings from the decodeme genome-wide association study of myalgic encephalomyelitis/chronic fatigue syndrome. medRxiv, pages 2025\u201308, 2025. URL: https://www.medrxiv.org/content/10.1101/2025.08.06.25333109v1.\u00a0\u21a9</p> </li> <li> <p>Qingbo S Wang and Hailiang Huang. Methods for statistical fine-mapping and their applications to auto-immune diseases. In Seminars in immunopathology, volume 44, 101\u2013113. Springer, 2022. URL: https://link.springer.com/article/10.1007/s00281-021-00902-8.\u00a0\u21a9\u21a9</p> </li> <li> <p>Omer Weissbrod, Farhad Hormozdiari, Christian Benner, Ran Cui, Jacob Ulirsch, Steven Gazal, Armin P Schoech, Bryce Van De Geijn, Yakir Reshef, Carla M\u00e1rquez-Luna, and others. Functionally informed fine-mapping and polygenic localization of complex trait heritability. Nature genetics, 52(12):1355\u20131363, 2020. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC7710571/.\u00a0\u21a9</p> </li> </ol>"},{"location":"Bioinformatics_Concepts/Genetic_Correlation/","title":"Genetic Correlation","text":""},{"location":"Bioinformatics_Concepts/Genetic_Correlation/#genetic-correlation","title":"Genetic Correlation","text":""},{"location":"Bioinformatics_Concepts/Genetic_Correlation/#standard-definition","title":"Standard Definition","text":"<p>Like heritability, genetic correlation is typically defined in the context of an additive genetic model. Let \\(Y_A\\) and \\(Y_B\\) denote two phenotypes of interest.  Let \\(G_A,G_B\\), and \\(E_A, E_B\\) denote the respective genetic and environmental components of the phenotypes.</p> <p>The model is</p> \\[ \\begin{align} Y_A &amp;= E_A + G_A,\\\\ Y_B &amp;= E_B + G_B. \\end{align} \\] <p>In the context of this model, genetic correlation is defined as the Pearson correlation of the genetic components:</p> \\[ \\rho_g:= \\mathrm{Corr}(G_A, G_B). \\]"},{"location":"Bioinformatics_Concepts/Genetic_Correlation/#when-are-traits-genetically-correlated","title":"When Are Traits Genetically Correlated?","text":"<p>What does it mean biologically when two traits are genetically correlated? The most straightforward case is that of pleiotropy: an overlapping set of genetic variants drives the two phenotypes.  This corresponds to the causal graph \\(A  \\leftarrow g\\rightarrow B\\), where \\(g\\) denotes the shared variants.  Mediated pleiotropy is also possible, in which variants cause one trait, which causes the other: \\(g\\rightarrow A\\rightarrow B\\).</p> <p>Besides these straightforward cases, there are more exotic possible causes of genetic correlation, as discussed here.  Briefly,</p> <ul> <li>Two traits can be genetically correlated because genetics affects the behavior of a parent, which affects the phenotype of their child.</li> <li>Two traits can be genetically correlated because individuals with these traits tend to mate at a higher rate than would be expected under random mating.</li> </ul>"},{"location":"Bioinformatics_Concepts/Heritability/","title":"Heritability","text":""},{"location":"Bioinformatics_Concepts/Heritability/#heritability","title":"Heritability","text":""},{"location":"Bioinformatics_Concepts/Heritability/#standard-definition","title":"Standard Definition","text":"<p>Heritability is typically defined in the context of an additive genetic model.  Let \\(Y\\) denote the phenotype of interest.  Let \\(G\\) denote the genetic component of the phenotype and \\(E\\) the environmental component. Assume the components are additively separable, so that:</p> \\[ \\begin{align} Y=E+G. \\label{model} \\end{align} \\] <p>Assume also that the random variables \\(E\\) and \\(G\\) are uncorrelated.</p> <p>Under these assumptions, define heritability:</p> \\[ h^2:= \\frac{\\mathrm{Var}(G)}{\\mathrm{Var}(Y)}. \\] <p>Note that in the uncorrelated-additive model above, \\(h^2\\) is equal to the coefficient of determination in the linear regression of \\(Y\\) on \\(G\\). To see this, observe that if we run a simple linear regression of \\(Y\\) on \\(G\\), then the coefficient of determination is given by the formula:</p> \\[ \\begin{align} \\mathrm{cor}(G,Y)^2&amp;=\\frac{\\mathrm{Cov}(Y,G)^2}{\\mathrm{Var}(G) \\mathrm{Var(Y)}}\\\\ &amp;=\\frac{\\mathrm{Cov}(E+G,G)^2}{\\mathrm{Var}(G) \\mathrm{Var(Y)}}&amp; \\text{ by }(\\ref{model})\\\\ &amp;=\\frac{\\mathrm{Var}(G)^2}{\\mathrm{Var}(G) \\mathrm{Var(Y)}} &amp; \\text{$G$ and  $E$ uncorrelated}\\\\ &amp;=\\frac{\\mathrm{Var}(G)}{\\mathrm{Var}(Y)}\\\\ &amp;=:h^2 \\end{align} \\] <p>\\(h^2\\) thus expresses the proportion of phenotypic variation attributable to genetics.</p>"},{"location":"Bioinformatics_Concepts/Heritability/#note-on-assumption","title":"Note on assumption","text":"<p>The assumption that \\(G\\) and \\(E\\) are uncorrelated is unrealistic in some contexts.  This is problematic for two reasons:</p> <ol> <li>If \\(\\mathrm{Cov}(G,E)\\ne 0\\), then \\(h^2\\) loses much of its interpretive value.  It is no longer the coefficient of determination of a regression.</li> <li>According to Visscher et al.<sup>1</sup>, if \\(\\mathrm{cov}(G,E)\\ne 0\\), then statistical estimates of \\(h^2\\) will tend to be inflated.</li> </ol> <p>As I understand it, practitioners typically argue that any correlation between \\(G\\) and \\(E\\) is not strong, so that the above effects are not severe, and the heritability concept remains a useful.</p>"},{"location":"Bioinformatics_Concepts/Heritability/#heritability-depends-on-the-population-context","title":"Heritability Depends on the Population Context","text":"<p>The heritability of a trait depends on the studied population.</p> <p>For instance, suppose we study a trait in two genetically identical populations \\(A\\) and \\(B\\), but population \\(B\\) lives in a much more variable environment than population \\(A\\), and that this variability affects the trait under study.  Then \\(\\mathrm{Var}(Y_B)&gt;\\mathrm{Var}(Y_A)\\) .  Consequently, \\(h^2_A&gt; h^2_B\\), despite the genetics of the two populations being the same. </p> <p>As a more specific example, note that (a) many recent GWAS have shown that obesity is highly heritable, and that (b) there has been a large increase in obesity rates in recent history, indicating a strong environmental influence.  These two facts do not contradict one another.  The obesity GWAS have studied cross-sectional populations drawn from a single snapshot in time, and have shown that a large portion of the variability in obesity in such populations is attributable to genetics.  On the other hand, if the GWAS samples had included individuals from a range of historical periods, environmental influence would have been proportionately larger, and calculated heritability would have been smaller.</p> <p>For a popular science book that discusses subtle issues in the definition of heredity, see Harden 2021<sup>2</sup>.</p>"},{"location":"Bioinformatics_Concepts/Heritability/#alternative-definitions-of-heritability","title":"Alternative definitions of Heritability","text":"<p>The standard definition of heritability stated above has certain unsatisfactory aspects:</p> <ol> <li>The random variables \\(G\\) and \\(E\\) are not precisely defined.</li> <li>Even if we \\(G\\) and \\(E\\) were precisely defined, heritability also assumes the additive model \\(Y=G+E\\).  Given the incredible complexity of biology, this is implausible.  It might, however, be reasonable to argue that the additive model reflects a first order Taylor expansion of the true phenotype-determining function.</li> <li>Even if we accept an additive model, the lack of correlation between \\(G\\) and \\(E\\) is also problematic.  Different individuals with different genes inhabit different environments.</li> </ol> <p>The above unsatisfactory aspects make heritability a somewhat fuzzy concept, and motivate the development of alternative definitions.</p>"},{"location":"Bioinformatics_Concepts/Heritability/#definition-via-conditional-expectation","title":"Definition via conditional expectation","text":"<p>In the definition above, we first specified the relationship between \\(G\\), \\(E\\), and \\(Y\\) , and then defined heritability in the context of this relationship. It is possible to reverse this.  </p> <p>As before, let the random variable \\(Y\\) denote the phenotypic trait of interest. Let \\(g\\) denote genotype.  Define:</p> \\[ \\begin{align} G&amp;:=\\mathbb{E} (Y|g),\\\\ E&amp;:=Y-G,\\\\ h^2&amp;:= \\frac{\\mathbb{Var}(G) }{\\mathbb{Var}(Y)}. \\end{align} \\] <p>We have</p> \\[ \\begin{align} \\mathbb{Cov}(G,E)&amp;=\\mathbb{E}(  \\mathbb{E}(Y|g) -\\mathbb{E}Y   )(  Y- \\mathbb{E}(Y|g) )\\\\ &amp;=0, \\end{align} \\] <p>where the last line follows from the Projection Theorem (pg. 345 in Grimmet and Stirzaker<sup>3</sup>).  Where before we needed to assume \\(\\mathbb{Cov}(E,G)=0\\), here this property is automatic.</p> <ul> <li>This approach has the advantage of its mathematical clarity.  Whereas the standard definition of heritability requires some fairly restrictive assumptions, this alternative definition is applicable to any phenotype representable by a random variable in \\(L_2\\).  Mathematically, it is now crystal clear what we mean when we speak of \\(G\\) and \\(E\\).</li> <li>On the other hand, the conditional expectation definition of heritability has the disadvantage of reduced interpretability.  In particular, \\(G\\) now incorporates all aspects of the phenotype that can be predicted from the genotype, including artifacts of population stratification.</li> </ul>"},{"location":"Bioinformatics_Concepts/Heritability/#counterfactual-heritability","title":"Counterfactual heritability","text":"<p>Todo<sup>4</sup></p>"},{"location":"Bioinformatics_Concepts/Heritability/#links","title":"Links","text":"<p>Broad Institute Primer Talk on Heritability</p>"},{"location":"Bioinformatics_Concepts/Heritability/#references","title":"References","text":"<ul> <li> <p>Balding, David J., Ida Moltke, and John Marioni, eds. Handbook of statistical genomics. John Wiley &amp; Sons, 2019. (Chapter 15)</p> </li> <li> <p>Visscher, Peter M., William G. Hill, and Naomi R. Wray. \"Heritability in the genomics era\u2014concepts and misconceptions.\" Nature reviews genetics 9.4 (2008): 255-266.</p> </li> </ul> <ol> <li> <p>Peter M Visscher, William G Hill, and Naomi R Wray. Heritability in the genomics era\u2014concepts and misconceptions. Nature reviews genetics, 9(4):255\u2013266, 2008. URL: https://www.researchgate.net/profile/Naomi-Wray/publication/5532009_Visscher_PM_Hill_WG_Wray_NR_Heritability_in_the_genomics_era-concepts_and_misconceptions_Nat_Rev_Genet_9_255-266/links/54176be90cf203f155ad57c4/Visscher-PM-Hill-WG-Wray-NR-Heritability-in-the-genomics-era-concepts-and-misconceptions-Nat-Rev-Genet-9-255-266.pdf.\u00a0\u21a9</p> </li> <li> <p>Kathryn Paige Harden. The genetic lottery: Why DNA matters for social equality. Princeton University Press, 2021.\u00a0\u21a9</p> </li> <li> <p>Geoffrey Grimmett and David Stirzaker. Probability and random processes: third edition. Oxford university press, 2001. URL: https://www.amazon.ca/Probability-Random-Processes-3th-third/dp/B006QYQVTS.\u00a0\u21a9</p> </li> <li> <p>Haochen Leia, Jieru Shib, Hongyuan Caoa, and Qingyuan Zhaoc. Heritability: a counterfactual perspective. preprint, 2025. URL: https://www.statslab.cam.ac.uk/~qz280/publication/counterfactual-heritability/paper.pdf.\u00a0\u21a9</p> </li> </ol>"},{"location":"Bioinformatics_Concepts/LDSC/","title":"LDSC","text":""},{"location":"Bioinformatics_Concepts/LDSC/#ldsc","title":"LDSC","text":"<p>Linkage Disequilibrium Score Regression<sup>1</sup> (LDSC) is a technique for estimating  heritability from GWAS summary statistics.  LDSC is ubiquitous, but its usefulness depends on the validity certain modeling assumptions. This page includes both a high-level summary and a detailed derivation of LDSC.</p>"},{"location":"Bioinformatics_Concepts/LDSC/#intuition-and-high-level-summary","title":"Intuition and High-level summary","text":"<p>The core idea of LDSC is illustrated below:</p> <p></p> <p>For each SNP, we compute a quantity called Linkage-Disequilibrium Score, or LD score, which measures the strength of the correlation between this SNP and other SNPs.  Two key insights are central to LDSC:</p> <ul> <li>SNPs with higher LD scores will tend to be more strongly associated with the GWAS phenotype, and thus will have higher Wald test statistics.  This follows because if a SNP is not itself causal, it can be associated with the GWAS phenotype through correlation with a causal SNP.  A SNP with a higher LD score has a higher chance of being correlated with a causal SNP than a SNP with a lower LD score.</li> <li>The strength of the relationship between LD score and the Wald test statistic depends on heritability.  A more heritable trait (right panel) will exhibit a stronger relationship than a less heritable trait (left panel).  This follows because for a more heritable trait, SNPs have a greater influence over the phenotype, so that increasing the extent to which a SNP is in LD with other SNPs will on average increase its association with the phenotype by a larger amount.</li> </ul> <p>Using these two insights, we can estimate heritability from the slope of regression line of Wald test statistics on LD scores.</p>"},{"location":"Bioinformatics_Concepts/LDSC/#detailed-derivation-of-method","title":"Detailed Derivation of Method","text":""},{"location":"Bioinformatics_Concepts/LDSC/#data-generating-model","title":"Data-generating model","text":"<p>LDSC assumes the following data generating equation:</p> \\[ \\phi = X\\beta + \\epsilon \\] <p>where:</p> <ul> <li>There are \\(M  \\gg 0\\) genetic variants.  </li> <li>There are \\(N  \\gg 0\\) individuals.  </li> <li>\\(\\phi\\in\\mathbb{R}^N\\) is the vector of phenotypes.</li> <li>\\(X\\in\\mathbb{R}^{N\\times M}\\) is the genotype matrix, normalized to have columns with sample mean 0 and sample variance 1.</li> <li>\\(\\beta\\in\\mathbb{R}^M\\) is the vector of true SNP effect sizes.</li> <li>\\(X\\beta \\in\\mathbb{R}^N\\) is thus the vector of total genetic effects for each individual.</li> <li>\\(\\epsilon\\in\\mathbb{R}^N\\) is the vector of non-genetic effects for each individual.</li> </ul> <p>Furthermore, we model \\(X,\\beta,\\epsilon\\) as random variables with the following properties:</p> \\[ \\begin{align} \\mathbb{Var}(\\epsilon)&amp;= (1-h^2)I  &amp; \\text{For some $h&gt;0$} \\\\ \\mathbb{Var}(\\beta)&amp;=\\frac{h^2}{M}I \\label{betavar} \\\\ \\mathbb{E}(\\epsilon)&amp;=0\\\\ \\mathbb{E}(\\beta)&amp;=0 \\\\ \\mathbb{E} X &amp;=0 \\\\  \\end{align} \\] <ul> <li>The rows of \\(X\\) are independent and identically distributed.</li> <li>The distributions of columns of \\(X\\) are \"not too similar\".</li> <li>The SNP \\(X_{i,j}\\) may be highly correlated with a few other SNPs, but is uncorrelated with most SNPs.</li> <li>\\(\\beta,\\epsilon,X\\) are all mutually independent.</li> </ul> <p>Furthermore, define the following quantities related to Linkage Disequilibrium (LD).</p> <ul> <li>The LD between SNP \\(j\\) and SNP \\(k\\) is denoted by \\(r_{jk}:=\\mathbb{E}X_{i,j}X_{i,k}\\), (which does not depend on the individual \\(i\\) by our assumption that the rows of \\(X\\) are iid).</li> <li>The empirical LD between \\(j\\) and \\(k\\) is defined to be \\(\\tilde{r}_{jk}:=\\frac{1}{N}X_{:,j}^T X_{:,k}\\).</li> <li>The LD score for a SNP \\(j\\) is defined to be \\(l_j:= \\sum_k r_{jk}^2\\).</li> </ul>"},{"location":"Bioinformatics_Concepts/LDSC/#properties-of-hatbeta_j-and-chi2_j","title":"Properties of \\(\\hat{\\beta}_j\\) and \\(\\chi^2_j\\)","text":"<p>We begin by computing the variance matrix of the genetic effects \\(X\\beta\\):</p> \\[ \\begin{align} &amp;\\mathbb{Var}(X\\beta)\\\\ &amp;=\\mathbb{E} X \\beta \\beta^T X^T\\\\ &amp;= \\mathbb{E} (X \\mathbb{E} ( \\beta \\beta^T |X ) X^T)  &amp; \\text{Tower law of expectation} \\\\ &amp;=\\frac{h^2}{M} \\mathbb{E} X X^T &amp; \\text{by (\\ref{betavar})} \\\\ &amp;=h^2I &amp; \\text{By independence of rows, zero mean of $X_{i,j}$} \\end{align} \\] <p>We can also compute the variance matrix of the phenotypes:</p> \\[ \\begin{align} &amp;\\mathbb{Var}(\\phi)\\\\ &amp;= \\mathbb{Var}(X\\beta) + \\mathbb{Var}(\\epsilon) &amp; \\text{ By independence}\\\\ &amp;=h^2I + (1-h^2)I\\\\ &amp;= I. \\end{align} \\] <p>Note that the heritability of the phenotype for an arbitrary individual \\(i\\) is:</p> \\[ \\begin{align} \\frac{\\mathbb{Var}(X\\beta)_{i,i} }{\\mathbb{Var}(\\phi)_{i,i}}&amp;= h^2 \\end{align} \\] <p>justifying the use of the symbol \\(h^2\\).</p> <p>The expectation of the phenotype vector is:</p> \\[ \\begin{align} &amp;\\mathbb{E} (\\phi) \\\\ &amp;= \\mathbb{E}(X \\beta) + \\mathbb{E} (\\epsilon)\\\\ &amp;= 0 &amp; \\text{Since $\\mathbb{E}\\beta =\\mathbb{E} \\epsilon=0$ } \\end{align} \\] <p>In a GWAS, it is typical to run a separate single-variant regression for each variant. Denote by \\(\\hat{\\beta}_j\\) the single-variant regression coefficient for SNP \\(j\\).  This is given by:</p> \\[ \\begin{align} \\hat{\\beta}_j &amp;\\\\ &amp;= \\frac{\\frac{1}{N}(\\phi-\\overline{\\phi})^T(X_{:,j} -\\overline{X_{:,j}} )}{\\frac{1}{N}  (X_{:,j} -\\overline{X_{:,j}} )^T (X_{:,j} -\\overline{X_{:,j}} ) }    &amp; \\text{ By OLS formula}\\\\ &amp;= \\frac{\\frac{1}{N}(\\phi-\\overline{\\phi})^TX_{:,j}  }{  \\frac{1}{N}X_{:,j}^TX_{:,j}  } &amp; \\text{Since columns of $X$ are normalized}\\\\ &amp;\\approx \\frac{\\frac{1}{N}\\phi^TX_{:,j}  }{\\frac{1}{N}X_{:,j}^TX_{:,j}} &amp; \\text{Since $\\mathbb{E}\\phi=0$ and $N$ is large}\\\\ &amp;=\\frac{1}{N}\\phi^TX_{:,i}  &amp; \\text{Since columns of $X$ are normalized} \\end{align} \\] <p>The squared regression errors of the \\(j\\)th GWAS regression are given by</p> \\[ \\begin{align}  \\lVert\\phi- \\hat{\\beta}_jX_{:,j} \\rVert^2 = \\lVert\\phi- \\frac{1}{N}(\\phi^T X_{:,j}) X_{:,j} \\rVert^2. \\end{align} \\] <p>We have assumed that \\(M\\) is large, that columns of \\(X\\) are not too similar, and that the components of \\(\\beta\\) are iid. Thus, GWAS regression on SNP \\(j\\) will not explain any significant proportion of the variance of the phenotype.  So  </p> \\[ \\begin{align} &amp;\\lVert\\phi- \\frac{1}{N}\\phi^T X_{:,j} X_{:,j} \\rVert^2\\\\ &amp;\\approx \\lVert\\phi\\rVert^2    \\\\ &amp;\\approx \\mathrm{trace}\\left( \\mathbb{Var} (\\phi) \\right)\\\\ &amp;= N  \\label{residuals} \\end{align} \\] <p>The standard error of the \\(j\\)th GWAS regression coefficient is</p> \\[ \\begin{align} &amp;\\mathrm{SE}(\\hat{\\beta}_j) \\\\ &amp;\\approx \\sqrt{\\frac{\\frac{1}{N}\\lVert\\phi- \\frac{1}{N}\\phi^T X_{:,j} X_{:,j} \\rVert^2}{(X_{:,j} -\\overline{X_{:,j}} )^T (X_{:,j} -\\overline{X_{:,ij} )}}} &amp; \\text{Formula for OLS SE}\\\\ &amp;=\\sqrt{\\frac{1}{N}} &amp; (\\text{\\ref{residuals}) + Normalization of $X$} \\label{sebeta} \\end{align} \\] <p>By the definition of the Wald Test Statistic for the \\(j\\)th SNP, \\(\\chi^2_j\\), we have</p> \\[ \\begin{align} &amp;\\chi_j^2\\\\ &amp;= \\frac{\\hat{\\beta_j}^2}{\\mathrm{SE}(\\hat{\\beta_j})^2}\\\\ &amp;\\approx N \\hat{\\beta_j^2} &amp; \\text{by (\\ref{sebeta})} \\label{wald} \\end{align} \\]"},{"location":"Bioinformatics_Concepts/LDSC/#expectation-of-empirical-ld-scores","title":"Expectation of empirical LD scores","text":"<p>The expectation of the square of the empirical LD between SNPs \\(j\\) and \\(k\\) is:</p> \\[ \\begin{align} &amp;\\mathbb{E} \\tilde{r}_{jk}^2\\\\ &amp;=\\mathbb{E}\\frac{1}{N^2}\\sum_i \\sum_q X_{i,j}X_{i,k}X_{q,j}X_{q,k}\\\\ &amp;=\\frac{1}{N^2}\\mathbb{E}(\\sum_{i\\ne q} X_{i,j}X_{i,k}X_{q,j}X_{q,k} + \\sum_i X_{i,j}^2X_{i,k}^2)\\\\ &amp;=\\frac{1}{N^2}( \\sum_{i\\ne q} \\mathbb{E}(X_{i,j} X_{i,k })\\mathbb{E} (X_{q,j X_{q,k}}) + \\sum_i \\mathbb{E} X_{i,j}^2 X_{i,k}^2) &amp;\\text{Independence of rows of $X$}\\\\ &amp;= \\frac{N-1}{N}r_{jk}^2 + \\frac{1}{N}\\mathbb{E}X_{1j}^2X_{1k}^2 \\end{align} \\] <p>We write \\(\\mathbb{E}X_{1j}^2X_{1k}^2=1+2r_{jk}^2+\\nu\\) where we have used Isserlis's Theorem to compute the expectation of the product of the squares of two normal random variables, and then added error term \\(\\nu\\) to account for the non-normality of \\(X\\).</p> <p>Thus we have </p> \\[ \\begin{align} &amp;\\mathbb{E} \\tilde{r}_{jk}^2 \\\\ &amp;=r_{jk}^2 + \\frac{1}{N}(1+r_{jk^2}^2+\\nu)\\\\ &amp;=r_{jk}^2+ \\frac{1}{N}(2r_{jk}^2+\\nu)+ \\frac{1}{N}(1-r_{jk}^2) \\end{align} \\] <p>The expectation of the sum of the squares of the empirical LD scores with SNP j is given by</p> \\[ \\begin{align} &amp;\\mathbb{E} \\sum_k \\tilde{r}_{jk}^2\\\\ &amp;=\\sum_{k}r^2_{jk} + \\sum_{k}\\frac{1}{N}(2r_{jk}^2+\\nu) + \\sum_k  \\frac{1}{N}(1-r_{jk}^2)\\\\ &amp;=l_j + \\sum_{k}\\frac{1}{N}(2r_{jk}^2+\\nu) + \\sum_k  \\frac{1}{N}(1-r_{jk}^2) &amp; \\text{Definition of $l_j$}\\\\ \\end{align} \\] <p>At this stage we introduce another approximation.  We have assumed that SNP \\(j\\) has high correlation with only a small number of other SNPs.  Thus the first \\(O(1/N)\\) term can will be much smaller than the second.  We therefor neglect this term, yielding:</p> \\[ \\mathbb{E}\\sum_k \\tilde{r}_{jk}^2 \\approx l_j + \\frac{1}{N}(M-l_j) \\]"},{"location":"Bioinformatics_Concepts/LDSC/#the-ldsc-equation","title":"The LDSC Equation","text":"<p>With the preliminaries out of the way, now compute the expectation of the chi squared statistic of the \\(j\\)th SNP</p> \\[ \\begin{align} &amp;\\mathbb{E} (\\chi^2_j)\\\\ &amp;=N \\mathbb{Var}(\\hat{\\beta_j)} &amp; \\text{by (\\ref{wald})}\\\\ &amp;=N \\mathbb{E} \\mathbb{Var}(\\hat{\\beta}_j | X) + \\underbrace{\\mathbb{Var}\\mathbb{E}( \\hat{\\beta}_j | X  )}_{=0}   &amp; \\text{Law of Total Variance}\\\\ &amp;= N \\mathbb{E}(  \\mathbb{Var}(  \\frac{1}{N} \\phi^T X_{:,j} |X)    )  \\label{varphi}   \\\\ &amp;= N \\mathbb{E}(  \\mathbb{Var}(  \\frac{1}{N} (X\\beta + \\epsilon)^T X_{:,j} |X)    )    \\\\ &amp;= N \\mathbb{E}(  \\mathbb{Var}(  \\frac{1}{N}( (X\\beta)^TX_{:,j} + \\epsilon^T X_{:,j}) |X)    )    \\\\ &amp;= N \\mathbb{E}(  \\mathbb{Var}(  \\frac{1}{N}( X_{:,j}^T (X\\beta)+ X_{:,j}^T\\epsilon   ) |X)    )    \\\\ &amp;= N \\mathbb{E}(   \\frac{1}{N}( X_{:,j}^T X \\mathbb{E}(\\beta \\beta^T|X)  X^T X_{:,j}   + X_{:,j}^T \\mathbb{E}(\\epsilon\\epsilon^T)X_{:,j}   )     )    \\\\ &amp;= N \\mathbb{E} ( \\frac{h^2}{MN^2} X_{:,j}^T X X^T X_{:,j}+ \\frac{1}{N}  (1-h^2) )\\\\ &amp;= N \\mathbb{E} ( \\frac{h^2}{M}\\sum_k \\tilde{r}^2_{jk} + \\frac{1}{N}  (1-h^2) ) &amp;\\text{def of }\\tilde{r}^2_{jk} \\label{hstep}\\\\ &amp;= \\frac{h^2}{M}(Nl_j + M-l_j) + 1 - h^2\\\\ &amp;= \\frac{h^2}{M}l_j(N-1)+1\\\\ &amp;\\approx \\frac{h^2}{M}l_jN+1\\\\ \\end{align} \\] <p>This is the main Linkage Disequilibrium Score Regression equation.</p>"},{"location":"Bioinformatics_Concepts/LDSC/#intuition-about-derivation","title":"Intuition about derivation","text":"<p>The key steps in the LDSC derivation above are between equations (\\(\\ref{varphi}\\)) and (\\(\\ref{hstep}\\)).  These steps relate the GWAS regression coefficients to a measure of linkage disequilibrium between SNPs.  These steps are only possible because of our distributional assumptions on \\(\\beta\\) and \\(\\epsilon\\).</p>"},{"location":"Bioinformatics_Concepts/LDSC/#critique-of-assumption","title":"Critique of assumption","text":"<p>We saw above that the most important of LDSC's assumptions is that  \\(\\mathbb{Var}\\beta=h^2 I\\).  This can be understood as an isotropic polygenicity assumption, and it amounts to the assumption that the heritability of a trait is distributed evenly across the genome, without correlation between SNPs.</p> <p>How plausible is this assumption?</p>"},{"location":"Bioinformatics_Concepts/LDSC/#arguments-that-assumption-is-plausible","title":"Arguments that assumption is plausible","text":"<p>On the one hand, the discovery that many traits are highly polygenic has been one of the most important findings of the GWAS era.  </p> <p>The following figure from Shi et al.<sup>2</sup> is a striking illustration:</p> <p></p> <p>The authors applied HESS to Schizophrenia, a prototypically polygenic disease.  HESS estimates the proportion of heritability attributal to each chromosome.  They found that the schizophrenia heritability of a chromosome was approximately proportional to the chromosome's length.  This is consistent with uniform polygenicity.</p> <p>See also this talk by Jonathan Pritchard, which proposes that most traits are \"omnigenic\", in the sense that they are controlled by vast numbers of small contributions spread across the genome:</p> <p>So, in a rough sense, assuming that the heritability of a trait is distributed across the genome is not unreasonable.</p>"},{"location":"Bioinformatics_Concepts/LDSC/#arguments-that-assumption-is-implausible","title":"Arguments that assumption is implausible","text":"<p>On the other hand, the assumption of perfectly uniform polygenicity strains plausibility.  For most traits, heritability is concentrated in certain key regions.  In autoimmune diseases, for example, heritability is typically concentrated around immunological regions, like  the MHC/HLA region.</p>"},{"location":"Bioinformatics_Concepts/LDSC/#extensions-to-make-assumption-more-plausible","title":"Extensions to make assumption more plausible","text":"<p>The issue of the implausibility of isotropic polygenicity is partially resolved by Stratified Linkage Disequilibrium Score Segression<sup>3</sup> (S-LDSC), an extension proposed by the same authors who devised LDSC.  S-LDSC allows the use of a pre-specified functional partitioning of the genome. While heritability is still assumed to be evenly distributed within a given partition, S-LDSC allows it to differ across partitions.</p>"},{"location":"Bioinformatics_Concepts/LDSC/#usage","title":"Usage","text":"<p>LDSC in its original form has two main usages</p> <ol> <li>Estimation of the parameter \\(h^2\\), the heritability of phenotype of interest.  An estimate of this parameter can be directly read from the LDSC regression.</li> <li>Detection of population stratification.</li> </ol> <ol> <li> <p>Brendan K Bulik-Sullivan, Po-Ru Loh, Hilary K Finucane, Stephan Ripke, Jian Yang, Nick Patterson, Mark J Daly, Alkes L Price, and Benjamin M Neale. Ld score regression distinguishes confounding from polygenicity in genome-wide association studies. Nature genetics, 47(3):291\u2013295, 2015. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC4495769/.\u00a0\u21a9</p> </li> <li> <p>Huwenbo Shi, Gleb Kichaev, and Bogdan Pasaniuc. Contrasting the genetic architecture of 30 complex traits from summary association data. The American Journal of Human Genetics, 99(1):139\u2013153, 2016. URL: https://www.cell.com/ajhg/fulltext/S0002-9297(16)30148-3.\u00a0\u21a9</p> </li> <li> <p>Hilary K Finucane, Brendan Bulik-Sullivan, Alexander Gusev, Gosia Trynka, Yakir Reshef, Po-Ru Loh, Verneri Anttila, Han Xu, Chongzhi Zang, Kyle Farh, and others. Partitioning heritability by functional annotation using genome-wide association summary statistics. Nature genetics, 47(11):1228\u20131235, 2015. URL: https://www.nature.com/articles/ng.3404.\u00a0\u21a9</p> </li> </ol>"},{"location":"Bioinformatics_Concepts/MAGMA_Overview/","title":"MAGMA","text":""},{"location":"Bioinformatics_Concepts/MAGMA_Overview/#magma","title":"MAGMA","text":""},{"location":"Bioinformatics_Concepts/MAGMA_Overview/#magma-overview","title":"MAGMA Overview","text":"<p>MAGMA is a tool for the analysis of GWAS results. MAGMA can operate on GWAS summary statistics and does not require raw GWAS data.</p> <p>MAGMA performs two main steps:</p> <ol> <li>Gene analysis,</li> <li>Gene property analysis.</li> </ol>"},{"location":"Bioinformatics_Concepts/MAGMA_Overview/#gene-analysis","title":"Gene Analysis","text":""},{"location":"Bioinformatics_Concepts/MAGMA_Overview/#purpose","title":"Purpose","text":"<p>GWAS summary statistics consist of variant-level regression coefficients and standard errors. The purpose of the MAGMA gene-analysis step is to convert these variant-level statistics to gene-level statistics, so we can judge which genes are likely to affect the phenotype.</p>"},{"location":"Bioinformatics_Concepts/MAGMA_Overview/#requirements","title":"Requirements","text":"<p>Gene analysis requires:</p> <ol> <li>GWAS summary statistics,</li> <li>A rule associating variants with genes (often just proximity),</li> <li>Data describing the linkage disequilibrium structure of the variants studied by the GWAS.</li> </ol>"},{"location":"Bioinformatics_Concepts/MAGMA_Overview/#mathematical-overview","title":"Mathematical Overview","text":"<p>Let \\(Y\\) be the phenotype of interest in a GWAS.  Let \\(X_i\\) be the ith variant.</p> <p>In a GWAS, we estimate</p> \\[ Y= \\beta_i X_i +\\epsilon_i, \\] <p>for all \\(i\\), where \\(\\beta_i\\) is the regression coefficient of \\(Y\\) on \\(X_i\\), and \\(\\epsilon_i\\) is the regression error. </p> <p>Let \\(G\\) be the set of variants that regulate or modify the gene of interest.  We wish to measure the strength of the evidence that \\(\\beta_i\\ne 0\\) for some \\(i\\in G\\). That is, we wish to judge how likely it is that the gene affects the phenotype.</p> <p>To evaluate the evidence, MAGMA uses as its test statistic<sup>1</sup><sup>2</sup> \\(\\sum_{i\\in G}Z_i^2\\), where \\(Z_i\\) is the Z-statistic of variant \\(i\\)'s GWAS regression. </p> <p>This test statistic has a generalized chi-squared distribution under the null hypothesis.  The details of its distribution depend on the correlations between the individual \\(Z\\)-statistics, which in turn depends on the linkage disequilibrium structure of the variants under study.  This is why MAGMA gene analysis requires linkage disequilibrium reference data.</p> <p>MAGMA converts the test-statistic to a p value via a numerical-integration procedure. A small p value indicates strong evidence that the gene affects the phenotype.</p>"},{"location":"Bioinformatics_Concepts/MAGMA_Overview/#gene-property-analysis","title":"Gene Property Analysis","text":""},{"location":"Bioinformatics_Concepts/MAGMA_Overview/#purpose_1","title":"Purpose","text":"<p>While knowing which genes are associated with the phenotype is of independent interest, understanding a phenotype requires knowing the biological systems that underlie it. To facilitate this, MAGMA provides a gene property module, which aims to answer the question: \"are genes  associated with the phenotype over-represented in particular biological systems?\"</p>"},{"location":"Bioinformatics_Concepts/MAGMA_Overview/#requirements_1","title":"Requirements","text":"<p>The gene property analysis module requires:</p> <ol> <li>The output of the gene analysis step, assigning p values to genes.</li> <li>A dataset of gene properties.  This dataset measures the extent to which different genes participate in various biological systems.  For example, tissue-specific RNAseq data from GTEx could be used.  A high quantity of RNA transcripts of a gene in a given tissue shows that the gene plays a role in that tissue.</li> </ol>"},{"location":"Bioinformatics_Concepts/MAGMA_Overview/#mathematical-overview_1","title":"Mathematical Overview","text":"<ul> <li>Let \\(Z_i\\) be the \\(z\\)-score of the association of gene \\(i\\) with the phenotype.</li> <li>Let \\(E_{i,j}\\) be the measure of the participation of gene \\(i\\) in biological system \\(j\\).</li> <li>Let \\(m\\) be a vector of control covariates. </li> </ul> <p>For each biological system \\(j\\), MAGMA fits the regression</p> \\[ \\begin{align} Z_i = \\beta_0 + \\beta_{j} E_{i,j} + (\\beta^m_{j})^T m + \\epsilon_{i,j}, \\label{magma_gene_prop} \\end{align} \\] <p>where the \\(\\beta\\) are regression coefficients and \\(\\epsilon_{i,j}\\) is the regression error.</p> <p>The null hypothesis \\(\\beta_{j}= 0\\) is tested.</p> <p>Rejecting this null would indicate that the degree to which the gene \\(i\\) participates in the biological system \\(j\\) is predictive of the extent of association of the gene with the phenotype, \\(Z_i\\).  This would suggest that the biological system is related to the phenotype.</p>"},{"location":"Bioinformatics_Concepts/MAGMA_Overview/#limitations","title":"Limitations","text":"<p>While MAGMA is a very useful approach for detecting the key biological systems involved in a disease or trait, it has a number of limitations.  These include:</p> <ol> <li>It is fundamentally limited by the availability and accuracy of data associating genes with biological systems.  For instance, if tissue-specific RNA-seq data is used, but RNAseq has not been performed on the key tissue involved in the disease, MAGMA will not produce useful results.</li> <li>It is unknown how to translate raw reference data, derived from RNAseq or another method, into \\(E_{i,j}\\) values to optimize the resulting MAGMA signal.  This question is its own research topic<sup>3</sup>.</li> <li>Relatedly, MAGMA relies on the assumption that if a biological system is important to a phenotype, the degree of participation of a gene in that biological system should be linearly related to the association of the gene with the phenotype.  While this is intuitively reasonable, it does not necessarily hold: biology is inherently nonlinear.</li> <li>Since MAGMA in its original form mostly uses proximity to associate genes with variants, it cannot incorporate long-distance regulatory effects.  If such effects are important to a disease, MAGMA could give misleading results.</li> </ol>"},{"location":"Bioinformatics_Concepts/MAGMA_Overview/#references","title":"References","text":"<p>The above discussion is based on:</p> <p>FUMA Tutorial</p> <p>MAGMA Paper </p> <p>MAGMA Site</p> <p>Note on Magma SNP-wise model</p> <p>Paper Critiquing the original MAGMA SNP-wise model (MAGMA was updated in response to this critique.)</p> <ol> <li> <p>Note on magma snp-wise model. URL: https://vu.data.surfsara.nl/s/VeuWKUwd0rz6AZD?dir=/&amp;editing=false&amp;openfile=true.\u00a0\u21a9</p> </li> <li> <p>Christiaan A De Leeuw, Joris M Mooij, Tom Heskes, and Danielle Posthuma. Magma: generalized gene-set analysis of gwas data. PLoS computational biology, 11(4):e1004219, 2015. URL: https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1004219.\u00a0\u21a9</p> </li> <li> <p>Ang Li, Tian Lin, Alicia Walker, Xiao Tan, Ruolan Zhao, Shuyang Yao, Patrick F Sullivan, Jens Hjerling-Leffler, Naomi R Wray, and Jian Zeng. Benchmarking methods integrating gwas and single-cell transcriptomic data for mapping trait-cell type associations. medRxiv, pages 2025\u201305, 2025. URL: https://www.medrxiv.org/content/10.1101/2025.05.24.25328275v2.full-text.\u00a0\u21a9</p> </li> </ol>"},{"location":"Bioinformatics_Concepts/Mendelian_Randomization/","title":"Mendelian Randomization","text":""},{"location":"Bioinformatics_Concepts/Mendelian_Randomization/#mendelian-randomization","title":"Mendelian Randomization","text":""},{"location":"Bioinformatics_Concepts/Mendelian_Randomization/#categories-of-data-science","title":"Categories of Data Science","text":"<p>Hernan et al.<sup>1</sup> assert that the core activities of the data scientist are, in order of increasing complexity:</p> <ol> <li>Description: Computing summary statistics, to enable large datasets to be easily comprehended. An example would be producing a chart summarizing the characteristics of heart disease patients.</li> <li>Prediction: Estimating the distribution of one variable conditional on other variables.  An example would be calculation of a person's odds of heart disease, conditional on their demographics, genetics, and LDL level.</li> <li>Causal Inference:   Reasoning about counterfactuals.   An example would be evaluating the evidence in support of a statement like: \"If all patients with high LDL were put on statins, occurrence of heart disease would be reduced by \\(X\\) percent\".  </li> </ol> <p>Here, we focus on causal inference.</p>"},{"location":"Bioinformatics_Concepts/Mendelian_Randomization/#methods-of-causal-inference","title":"Methods of causal inference","text":"<p>The randomized controlled trial (RCT) is the gold standard causal inference method. RCTs have the advantage of requiring few assumptions, but the disadvantages of being costly and time-consuming.  This motivates alternative causal inference techniques, which require more assumptions, but are cheap and fast.  Mendelian Randomization (MR) is such a technique.</p>"},{"location":"Bioinformatics_Concepts/Mendelian_Randomization/#mendelian-randomization_1","title":"Mendelian Randomization","text":"<p>As an illustrative example, consider the question of how LDL affects heart disease. We might notice from epidemiological studies that people with heart disease tend to have higher LDL than people without it. We recall, however, that correlation is not causation. Thus we apply MR, in hopes of determining whether there is a true causal effect.</p>"},{"location":"Bioinformatics_Concepts/Mendelian_Randomization/#the-three-main-mr-assumptions","title":"The three main MR assumptions","text":"<p>The figure below from Hartley et al.<sup>2</sup> summarizes MR:</p> <p></p> <p>We apply MR to estimate the causal effect of an exposure (e.g. LDL) on an outcome (e.g. heart disease).  MR requires a genetic variant (\"Genetic Instrument\") associated with the exposure.  </p> <p>The validity of MR depends on three main assumptions:</p> <ul> <li>IV1: The instrument must be associated with the exposure.</li> <li>IV2: The instrument cannot share a cause with the exposure or the outcome.</li> <li>IV3: The instrument cannot be causally associated with the outcome, except via the exposure.</li> </ul> <p>In MR, natural variation in the genetic instrument plays a role analogous to the random treatment assignment in an RCT.  The analogy between MR and an RCT is illustrated in the diagram below, from Zuber et al.<sup>3</sup>:</p> <p></p>"},{"location":"Bioinformatics_Concepts/Mendelian_Randomization/#the-fourth-mr-assumption","title":"The Fourth MR Assumption","text":"<p>Many texts on MR emphasize IV1, IV2, and IV3. However, these conditions are not sufficient to uniquely determine the causal effect of the exposure on the outcome (See Hernan and Robins Chapter 16<sup>4</sup>).  Another assumption is required.  There are numerous possible variants forms of this fourth assumption, which can largely be grouped into </p> <ul> <li>Homogeneity assumptions: roughly, the causal effect of the exposure on the outcome is the same for all individuals.</li> <li>Monotonicity assumptions: roughly, the instrument moves the exposure in the same direction for all individuals.</li> </ul> <p>MR texts tend to ignore the need for a fourth assumption because most practical applications of MR assume that the outcome \\(Y\\) is a linear function of the exposure \\(X\\):</p> \\[ \\begin{align} Y &amp;= \\beta_{Y,X}X +\\alpha_1 + \\epsilon &amp;\\text{ where }\\epsilon \\sim N(0,\\sigma_1)  \\end{align} \\] <p>Under this linear model, homogeneity holds automatically.</p>"},{"location":"Bioinformatics_Concepts/Mendelian_Randomization/#pitfalls-in-mendelian-randomization","title":"Pitfalls in Mendelian Randomization","text":""},{"location":"Bioinformatics_Concepts/Mendelian_Randomization/#horizontal-pleiotropy","title":"Horizontal Pleiotropy","text":"<p>A common source of error in Mendelian Randomization occurs when the genetic instrument affects the outcome through a causal pathway that does not involve the exposure.  This scenario, which is known as \"horizontal pleiotropy\", results in a violation of IV3.  If the strength of the causal effect through the alternative pathway is large, the results of Mendelian Randomization can be misleading.</p> <p>The diagram below illustrates horizontal pleiotropy:</p> <pre><code>graph LR\nA[Genetic Instrument] --&gt; B[Protein 1];\nB --&gt; C[Exposure];\nC --&gt; D[Outcome];\nA --&gt; E[Protein 2];\nE ----&gt; D;</code></pre> <p>A genetic variant affects the levels of two proteins.  One protein affects the outcome through the exposure, while the other affects the outcome independently of the exposure. If we believe the Omnigenic Model, we should expect this kind of horizontal pleiotropy to be relatively common.</p> <p>The risk of horizontal pleiotropy is magnified when the connection between the genetic variant and the exposure is complex and indirect.  An example would be a study in which the genetic instrument affects neurodevelopment, and the exposure is tobacco use.  The risk is reduced when the connection is straightforward and direct.  An example would be an MR study in which the exposure is the plasma level of a a protein, and the genetic instrument is a cis-regulatory variant for that protein (a cis-pQTL).</p>"},{"location":"Bioinformatics_Concepts/Mendelian_Randomization/#methods-of-mendelian-randomization","title":"Methods of Mendelian Randomization","text":""},{"location":"Bioinformatics_Concepts/Mendelian_Randomization/#the-wald-ratio","title":"The Wald Ratio","text":"<p>todo</p>"},{"location":"Bioinformatics_Concepts/Mendelian_Randomization/#links","title":"Links","text":"<p>Talk on MR by Dr. Jean Morrison</p> <ol> <li> <p>Miguel A Hern\u00e1n, John Hsu, and Brian Healy. A second chance to get causal inference right: a classification of data science tasks. Chance, 32(1):42\u201349, 2019. URL: https://www.tandfonline.com/doi/abs/10.1080/09332480.2019.1579578%4010.1080/tfocoll.2022.0.issue-teaching-simpsons-paradox.\u00a0\u21a9</p> </li> <li> <p>April E Hartley, Grace M Power, Eleanor Sanderson, and George Davey Smith. A guide for understanding and designing mendelian randomization studies in the musculoskeletal field. Journal of Bone and Mineral Research Plus, 6(10):e10675, 2022. URL: https://academic.oup.com/jbmrplus/article/6/10/e10675/7479111?login=false.\u00a0\u21a9</p> </li> <li> <p>Verena Zuber, Nastasiya F Grinberg, Dipender Gill, Ichcha Manipur, Eric AW Slob, Ashish Patel, Chris Wallace, and Stephen Burgess. Combining evidence from mendelian randomization and colocalization: review and comparison of approaches. The American Journal of Human Genetics, 109(5):767\u2013782, 2022. URL: https://www.cell.com/ajhg/fulltext/S0002-9297(22)00149-5.\u00a0\u21a9</p> </li> <li> <p>Miguel A Hern\u00e1n and James M Robins. Causal inference. 2010. URL: https://miguelhernan.org/whatifbook.\u00a0\u21a9</p> </li> </ol>"},{"location":"Bioinformatics_Concepts/Omnigenic_Model/","title":"Omnigenic Model","text":""},{"location":"Bioinformatics_Concepts/Omnigenic_Model/#omnigenic-model","title":"Omnigenic Model","text":"<p>In a small-world network, the number of steps between two random nodes  grows at a rate proportional to the logarithm of the number of nodes.  Consequently, even in very large small-world networks, nodes are separated by a few steps.  The game Six Degrees of Kevin Bacon is a classic illustration.</p> <p>The Omnigenic Model<sup>1</sup>  proposes that gene regulatory pathways constitute a small-world network.  For a typical trait, even though only a small number of core genes directly control the trait, a large number of peripheral genes are within a few regulatory steps of the core genes.  Genetic variants that affect the peripheral genes produce cascading effects through the regulatory network that ultimately affect the core genes and therefore the trait.  </p> <p>A central observation of the modern GWAS era is that the typical complex trait is influenced by a surprisingly large number of variants.  The Omnigenic Model explains why: all variants that affect peripheral genes affect the trait.</p> <p>The following figure, from Boyle et al.<sup>1</sup>, illustrates the concept:</p> <p></p> <ol> <li> <p>Evan A Boyle, Yang I Li, and Jonathan K Pritchard. An expanded view of complex traits: from polygenic to omnigenic. Cell, 169(7):1177\u20131186, 2017. URL: https://www.cell.com/cell/fulltext/S0092-8674(17)30629-3.\u00a0\u21a9\u21a9</p> </li> </ol>"},{"location":"Bioinformatics_Concepts/S_LDSC_For_Cell_And_Tissue_ID/","title":"S-LDSC","text":""},{"location":"Bioinformatics_Concepts/S_LDSC_For_Cell_And_Tissue_ID/#s-ldsc","title":"S-LDSC","text":"<p>Stratified Linkage Disequilibrium Score Regression (S-LDSC)<sup>1</sup><sup>2</sup> is an extension of Linkage Disequilibrium Score Regression (LDSC)<sup>3</sup>. S-LDSC can be used to generate hypotheses about the key cells and tissues underlying a phenotype.</p>"},{"location":"Bioinformatics_Concepts/S_LDSC_For_Cell_And_Tissue_ID/#high-level-summary","title":"High-level summary","text":""},{"location":"Bioinformatics_Concepts/S_LDSC_For_Cell_And_Tissue_ID/#review-of-ldsc","title":"Review of LDSC","text":"<p>Recall that LDSC assumes isotropic polygenicity: heritability is evenly distributed across the genome. Mathematically this means that in LDSC  for all genetic variants \\(i\\) and \\(j\\):</p> \\[ \\begin{align} \\mathbb{Var}(\\beta_i)&amp;=Q\\\\ \\mathbb{Cov}(\\beta_i,\\beta_j) &amp;= 0 &amp; \\text{ when }i\\ne j \\end{align} \\] <p>where \\(\\beta_i\\) is the true effect of variant \\(i\\) on the phenotype and \\(Q\\in\\mathbb{R}\\) is a constant.</p>"},{"location":"Bioinformatics_Concepts/S_LDSC_For_Cell_And_Tissue_ID/#overview-of-s-ldsc","title":"Overview of S-LDSC","text":"<p>S-LSDC instead assumes that the genome is divided into regions, and isotropic polygenicity holds within each region. Mathematically, this means that S-LDSC for all genetic variants \\(i\\) and \\(j\\):</p> \\[ \\begin{align} \\mathbb{Var}(\\beta_i)&amp;=\\sum_{k} \\tau_k I_{i \\in C_k}\\\\ \\mathbb{Cov}(\\beta_i, \\beta_j) &amp;= 0 &amp; \\text{ when }i\\ne j \\end{align} \\] <p>Where:</p> <ul> <li>The \\(\\{C_k\\}\\) are sub of genetic variants.  The \\(C_k\\) can describe functional chromosomal regions, like promoters, enhancers, or other regulatory regions.  They can also reflect gene-tissue expression.  For instance, a \\(C_k\\) could mark SNPs that are near genes that have been observed to be over-expressed in the liver according to a GTEx RNAseq dataset. The \\(C_k\\) may overlap.</li> <li>The \\(\\{\\tau_k\\}\\) are heritability weights. \\(\\tau_k\\in\\mathbb{R}\\) measures the effect on the GWAS signal of a genetic variant belonging to category \\(C_k\\).</li> </ul>"},{"location":"Bioinformatics_Concepts/S_LDSC_For_Cell_And_Tissue_ID/#procedure","title":"Procedure","text":""},{"location":"Bioinformatics_Concepts/S_LDSC_For_Cell_And_Tissue_ID/#review-of-ldsc-procedure","title":"Review of LDSC Procedure","text":"<p>Recall that LDSC runs a univariate regression based on the approximate equation:</p> \\[  \\mathbb{E} (\\chi^2_i) \\approx N\\frac{h^2}{M}l_N+1, \\] <p>where</p> <ul> <li>\\(\\chi^2_i\\) is the \\(\\chi^2\\) statistic of the maginal GWAS regression for genetic variant \\(i\\).</li> <li>\\(M\\) is the number of genetic variants in the GWAS.</li> <li>\\(N\\) is the number of individuals in the GWAS.</li> <li>\\(l_i:=\\sum_k r_{ik}^2\\) is the linkage disequilibrium score of genetic variant \\(i\\), where \\(r_{ik}\\) denotes the correlation between variants \\(i\\) and \\(k\\).</li> </ul> <p>This regression provides an estimate of \\(h^2\\), the trait's heritability.</p>"},{"location":"Bioinformatics_Concepts/S_LDSC_For_Cell_And_Tissue_ID/#s-ldsc-procedure","title":"S-LDSC Procedure","text":"<p>Analogously, S-LDSC runs a multivariate regression based on the approximate equation:</p> \\[ \\mathbb{E} (\\chi^2_i) \\approx   N \\sum_k \\tau_k l_{i,k}+1, \\] <p>where the notation is the same as above, with the addition that</p> <ul> <li>\\(l_{i,k}:=\\sum_j r_{i,j}^2 I_{j\\in C_k}\\) is the linkage disequilibrium score of genetic variant \\(i\\) restricted to category \\(k\\).</li> </ul> <p>This regression provides estimates of the heritability weights \\(\\{\\tau_k\\}\\).</p>"},{"location":"Bioinformatics_Concepts/S_LDSC_For_Cell_And_Tissue_ID/#the-output-of-s-ldsc","title":"The output of S-LDSC","text":"<ul> <li>Using the \\(\\tau_k\\) weights, we can estimate the overall heritability as \\(h^2=\\sum_i\\sum_k \\tau_k I_{i\\in C_k}\\).</li> <li>We can evaluate the proportion of heritability due to category \\(k'\\) as \\(\\frac{\\sum_i \\tau_{k'} I_{i\\in C_{k'}}}{\\sum_i\\sum_k \\tau_k I_{i\\in C_k}}\\).  We can compare this to the proportion of genetic variants in category \\(k\\), which is \\(|C_k|/M\\).  This comparison gives us an estimate of the enrichment of heritability in the category.</li> <li>We can run statistical tests to evaluate the evidence that \\(\\tau_k\\ne 0\\).  If this evidence is strong, we can argue that category \\(k\\) reflects a meaningful grouping of genetic variants that differentially affect the phenotype.</li> </ul> <ol> <li> <p>Hilary K Finucane, Yakir A Reshef, Verneri Anttila, Kamil Slowikowski, Alexander Gusev, Andrea Byrnes, Steven Gazal, Po-Ru Loh, Caleb Lareau, Noam Shoresh, and others. Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types. Nature genetics, 50(4):621\u2013629, 2018. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC5896795/.\u00a0\u21a9</p> </li> <li> <p>Hilary K Finucane, Brendan Bulik-Sullivan, Alexander Gusev, Gosia Trynka, Yakir Reshef, Po-Ru Loh, Verneri Anttila, Han Xu, Chongzhi Zang, Kyle Farh, and others. Partitioning heritability by functional annotation using genome-wide association summary statistics. Nature genetics, 47(11):1228\u20131235, 2015. URL: https://www.nature.com/articles/ng.3404.\u00a0\u21a9</p> </li> <li> <p>Brendan K Bulik-Sullivan, Po-Ru Loh, Hilary K Finucane, Stephan Ripke, Jian Yang, Nick Patterson, Mark J Daly, Alkes L Price, and Benjamin M Neale. Ld score regression distinguishes confounding from polygenicity in genome-wide association studies. Nature genetics, 47(3):291\u2013295, 2015. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC4495769/.\u00a0\u21a9</p> </li> </ol>"},{"location":"Bioinformatics_Concepts/Sumstats_Standardization/","title":"Sumstats Standardization","text":""},{"location":"Bioinformatics_Concepts/Sumstats_Standardization/#sumstats-standardization","title":"Sumstats Standardization","text":"<p>Before analyzing GWAS summary statistics, it is desirable to bring them to a standard form.  This is a complex, multi-step process.</p>"},{"location":"Bioinformatics_Concepts/Sumstats_Standardization/#step-1-strand-standardization","title":"Step 1: Strand Standardization","text":"<p>In the DNA double helix, the two strands are complementary: adenine (A) always pairs with thymine (T), and cytosine (C) always pairs with guanine (G).  This means that the same variant can be represented equivalently by describing its base sequence on either strand.</p> <p>For instance, suppose that a GWAS summary statistics file contains the following data: </p> CHROM GENPOS ALLELE0 ALLELE1 A1FREQ BETA LOG10P 5 90000126 G A 0.0154907 0.0388003 0.346247 5 90002604 T TG 0.16074 -0.000160003 0.00323221 5 90002963 G C 0.0109188 -0.0368269 0.257525 5 90003830 G A 0.160737 -0.00019273 0.0038963 <p>This data can be represented equivalently on the other strand as </p> CHROM GENPOS ALLELE0 ALLELE1 A1FREQ BETA LOG10P 5 90000126 C T 0.0154907 0.0388003 0.346247 5 90002604 A CA 0.16074 -0.000160003 0.00323221 5 90002963 C G 0.0109188 -0.0368269 0.257525 5 90003830 C T 0.160737 -0.00019273 0.0038963 <p>(Note that at multi-base alleles like the indel T/TG, we flip the order of the bases.)</p> <p>While GENPOS always refers to genomic coordinates in the \\(5'\\to 3'\\) direction along the forward strand, summary statistics files have been known to report alleles on either the forward or the reverse strand<sup>1</sup>. This ambiguity is problematic when one seeks to jointly analyze two GWAS, or look up variants from a GWAS in a reference.</p> <p>In most cases, the ambiguity can be resolved by consulting a reference genome sequence FASTA file.  For each genetic variant, one compares the alleles to the reference sequence at the given genomic coordinate. If there is a match, we know the alleles are correctly represented on the forward strand.  If instead there is match with the complement of one the alleles, we know the alleles are represented on the reverse strand, and we can standardize the genetic variant by substituting the alleles for their complements.  If there is no match between the alleles and either the forward or reverse strand, this likely indicates an error.</p>"},{"location":"Bioinformatics_Concepts/Sumstats_Standardization/#palindromic-variants","title":"Palindromic variants","text":"<p>Consider the C/G variant in the table above.  At position 90002963, the reference genome (GRCh38) has the base G.  There are two possible interpretations:</p> <ul> <li>ALLELE 1 is the reference allele, while ALLELE 0 is the alternate allele, and the alleles refer to the forward strand.</li> <li>ALLELE 0 is the reference allele, while ALLELE 1 is the alternate allele, and the alleles refer to the reverse strand.</li> </ul> <p>It is impossible to distinguish these cases using only CHROM/GENPOS/ALLELE0/ALLELE1.</p> <p>If one has access to a reference database of standardized genetic variants with allele frequencies, one can sometime disambiguate using these frequencies. Suppose as above that we have a palindromic variant and ALLELE 1 matches the reference allele in the database. The procedure is:</p> <ul> <li>If the allele frequency of ALLELE1 is close to 0.5, we can't disambiguate. Otherwise:</li> <li>Compare the allele frequency of ALLELE1 to the frequency of the reference allele in the database.  If there is a close match, we can assume that the allele pair in the summary statistics is on the forward strand.</li> <li>Compare the allele frequency of ALLELE1 to one minus the frequency of the reference allele in the database.  If there is a close match, we can assume the allele pair in the summary statistics is on the reverse strand.</li> </ul>"},{"location":"Bioinformatics_Concepts/Sumstats_Standardization/#step-2-left-normalization","title":"Step 2: Left Normalization","text":"<p>Even if we restrict ourselves to the forward strand, the same genetic variant can still be represented in multiple ways.</p> <p>This principle is demonstrated by the following examples from the Center for Statistical Genetics at the University of Michigan:</p> <p></p> <p></p> <p>Clearly, what is needed is a unique canonical form to which all equivalent variants can be normalized.  Fortunately, there is a left-normalization algorithm that does just this. While many modern GWAS pre-left-normalize their alleles, it is often advisable to run left-normalization, just to be sure.</p>"},{"location":"Bioinformatics_Concepts/Sumstats_Standardization/#algorithm-details","title":"Algorithm details","text":"<p>todo</p>"},{"location":"Bioinformatics_Concepts/Sumstats_Standardization/#step-3-harmonization-between-gwas-or-between-a-gwas-and-an-ld-matrix","title":"Step 3: Harmonization between GWAS, or between a GWAS and an LD Matrix","text":"<p>todo</p> <ol> <li> <p>Fernando Pires Hartwig, Neil Martin Davies, Gibran Hemani, and George Davey Smith. Two-sample mendelian randomization: avoiding the downsides of a powerful, widely applicable but potentially fallible technique. 2016. URL: https://academic.oup.com/ije/article/45/6/1717/3072174.\u00a0\u21a9</p> </li> </ol>"},{"location":"Codebase_Concepts/Build_System/","title":"Build System","text":""},{"location":"Codebase_Concepts/Build_System/#build-system","title":"Build System","text":""},{"location":"Codebase_Concepts/Build_System/#motivation","title":"Motivation","text":"<p>In data science, analysis pipelines often consist of many steps.  When the dataset under study is large, these steps can be slow.  This creates two challenges:</p> <ul> <li>Iteration: It is rare to run a pipeline once, produce an analysis, and be done. Usually, one must repeatedly tweak the steps, re-run the pipeline, and reexamine the result.  To avoid wasting time, it is therefore desirable that after each change, only impacted steps should be rerun.</li> <li>Lineage:  Given the complexity of many data science workflows, there is considerable room for error.  It is therefore desirable to be able to interrogate the final product of a workflow to trace its \"lineage\": the precise sequence of steps that produced it.</li> </ul> <p>These challenges motivate the development of a data science build system.</p>"},{"location":"Codebase_Concepts/Build_System/#framework","title":"Framework","text":"<p>The build system used in this project is based on the framework described by Mokhov et al.<sup>1</sup><sup>2</sup>.  I outline this framework below.</p>"},{"location":"Codebase_Concepts/Build_System/#key-concepts","title":"Key Concepts","text":""},{"location":"Codebase_Concepts/Build_System/#asset","title":"Asset","text":"<p>An asset is any file or directory consumed or produced by the build.  In this project, examples of assets include:</p> <ul> <li>GWAS summary statistics.</li> <li>Reference RNAseq data from the GTEx project.</li> <li>Plots illustrating the results of applying MAGMA to GWAS summary statistics.</li> <li>Tables of category heritability weights \\(\\{\\tau_k\\}\\) and their associated p values produced by Stratified Linkage Disequilibrium Score Regression.</li> </ul>"},{"location":"Codebase_Concepts/Build_System/#task","title":"Task","text":"<p>A task is an operation that constructs a particular asset.</p> <p>Here is the source code for the <code>Task</code> base class:</p> Task Class Definition<pre><code>\"\"\"\nInstructions for materializing an asset.\n\"\"\"\n\nfrom abc import ABC, abstractmethod\nfrom pathlib import Path\n\nfrom mecfs_bio.build_system.asset.base_asset import Asset\nfrom mecfs_bio.build_system.meta.asset_id import AssetId\nfrom mecfs_bio.build_system.meta.meta import Meta\nfrom mecfs_bio.build_system.rebuilder.fetch.base_fetch import Fetch\nfrom mecfs_bio.build_system.wf.base_wf import WF\n\n\nclass GeneratingTask(ABC):\n    \"\"\"\n    Instructions for materializing an asset.\n    \"\"\"\n\n    @property\n    @abstractmethod\n    def meta(self) -&gt; Meta:\n        \"\"\"\n        Metadata describing the target asset.\n        \"\"\"\n        pass\n\n    @property\n    @abstractmethod\n    def deps(self) -&gt; list[\"Task\"]:\n        \"\"\"\n        List of tasks whose assets are needed to produce the target asset.\n        \"\"\"\n        pass\n\n    @property\n    def asset_id(self) -&gt; AssetId:\n        return self.meta.asset_id\n\n    @abstractmethod\n    def execute(\n        self,\n        scratch_dir: Path,\n        fetch: Fetch,\n        wf: WF,\n    ) -&gt; Asset:\n        \"\"\"\n        Materialize the target asset, using the 'fetch' callback to access asset dependencies.\n        \"\"\"\n        pass\n\n\nTask = GeneratingTask\n</code></pre> <ul> <li>The <code>meta</code> property returns a metadata object (see below) describing the asset created by the Task. This metadata object must include a string id uniquely identifying the asset.</li> <li>The <code>deps</code> property returns a list of pre-requisite Tasks that must be executed prior to the current Task.  The build system uses <code>deps</code> to construct the Task dependency graph.</li> <li>The key method is <code>execute</code>. Subclasses override this method to specify how to construct their assets.  The <code>fetch</code> parameter is a special callback passed to <code>execute</code> by the build system.  Instead of directly accessing its dependencies, <code>execute</code> should use <code>fetch</code> to access dependencies via the build system</li> </ul> <p>Concrete Task subclasses are defined here.</p>"},{"location":"Codebase_Concepts/Build_System/#rebuilder","title":"Rebuilder","text":"<p>Given a <code>Task</code> that generates an <code>Asset</code>, together with a data storage object called <code>Info</code>, the job of a Rebuilder is to decide whether the current version of the <code>Asset</code> is up-to-date.  If so, that <code>Asset</code> can be directly returned without executing the <code>Task</code>.  If not, the rebuilder uses the <code>Task</code> to materialize an up-to-date version of the asset.</p> <p>Here is source code for the <code>Rebuilder</code> base class:</p> <pre><code>\"\"\"\nAbstract base class for Rebuilders.  See Andrey Mokhov, Neil Mitchell, and Simon Peyton Jones. Build systems \u00e0 la carte.\n\"\"\"\n\nfrom abc import ABC, abstractmethod\nfrom pathlib import Path\n\nfrom mecfs_bio.build_system.asset.base_asset import Asset\nfrom mecfs_bio.build_system.rebuilder.fetch.base_fetch import Fetch\nfrom mecfs_bio.build_system.rebuilder.metadata_to_path.base_meta_to_path import (\n    MetaToPath,\n)\nfrom mecfs_bio.build_system.task.base_task import Task\nfrom mecfs_bio.build_system.wf.base_wf import WF\n\n\nclass Rebuilder[Info](ABC):\n    \"\"\"\n    Key Operations:\n    - Decide whether a given asset is up-to-date using information from Info.\n    - If the asset is up-to-date, return it together with Info.\n    - If the asset is not up-to-date, bring it up-to-date, update Info, and return the new values of both.\n    \"\"\"\n\n    @abstractmethod\n    def rebuild(\n        self,\n        task: Task,\n        asset: Asset | None,\n        fetch: Fetch,\n        wf: WF,\n        info: Info,\n        meta_to_path: MetaToPath,\n    ) -&gt; tuple[Asset, Info]:\n        pass\n\n    @classmethod\n    @abstractmethod\n    def save_info(cls, info: Info, path: Path):\n        pass\n</code></pre> <p>Currently, there is one concrete implementation of <code>Rebuilder</code>, called the VerifyingTraceRebuilder.  It uses file hashes to decide whether an <code>Asset</code> is up-to-date.</p>"},{"location":"Codebase_Concepts/Build_System/#scheduler","title":"Scheduler","text":"<p>Given one or more target assets requested by the user, it is the job of the scheduler to determine which tasks need to be run in what order to produce those assets.  The scheduler delegates the actual running of these tasks to the Rebuilder.</p> <p>Currently, there is one concrete scheduler: the topological scheduler.  The topological scheduler constructs a directed acyclic graph of the dependencies of the requested assets, then traverses this graph in topological order.</p> <ol> <li> <p>Andrey Mokhov, Neil Mitchell, and Simon Peyton Jones. Build systems \u00e0 la carte. Proceedings of the ACM on Programming Languages, 2(ICFP):1\u201329, 2018. URL: https://dl.acm.org/doi/abs/10.1145/3236774.\u00a0\u21a9</p> </li> <li> <p>Andrey Mokhov, Neil Mitchell, and Simon Peyton Jones. Build systems \u00e0 la carte: theory and practice. Journal of Functional Programming, 30:e11, 2020. URL: https://www.cambridge.org/core/journals/journal-of-functional-programming/article/build-systems-a-la-carte-theory-and-practice/097CE52C750E69BD16B78C318754C7A4.\u00a0\u21a9</p> </li> </ol>"},{"location":"Codebase_Concepts/Figure_System/","title":"Figure System","text":""},{"location":"Codebase_Concepts/Figure_System/#figure-system","title":"Figure System","text":"<p>Plots and tables are important to the presentation of data science results.  This section discusses how to add plots and tables (referred to as \"figures\") to documentation.  There are two main approaches:</p> <ul> <li>The link-based approach</li> <li>The programmatic approach</li> </ul>"},{"location":"Codebase_Concepts/Figure_System/#link-based-approach","title":"Link-based approach","text":"<p>This is the simplest approach.</p> <p>With this approach, if you wish to add a figure to a documentation page, simply save the figure as a <code>.png</code> file, upload it to a publicly accessible website (The repository wiki is convenient.  Ask a maintainer to be granted edit permission to the wiki), and then embed a reference in your documentation page:</p> <pre><code>![name_of_figure](https://&lt;url_of_figure&gt;.png)\n</code></pre>"},{"location":"Codebase_Concepts/Figure_System/#programmatic-approach","title":"Programmatic approach","text":"<p>This approach is more complex, but more robust.</p> <p>The components of the programmatic figure system are:</p> <ul> <li>The list <code>ALL_FIGURE_TASKS</code> in figure_tasks.py specifies the build-system Tasks that generate programmatic figures.</li> <li>The script generate_figures.py invokes the build system to generate the assets corresponding to <code>ALL_FIGURE_TASKS</code>, then copies these figure assets into <code>docs/_figs</code>.</li> <li>The script pull_figures.py downloads figures from Github and merges them with the contents of <code>docs/_figs</code>.</li> <li>The script push_figures.py uploads the figure assets in <code>docs/figs</code> to Github as a release. Running this script may require permission from a repository maintainer.</li> </ul>"},{"location":"Codebase_Concepts/Figure_System/#standard-workflow","title":"Standard Workflow","text":"<p>Suppose that you have analyzed a genomic dataset and generated figures.  You wish to publish these figures and an associated write-up to the project documentation page.  Follow these steps:</p> <ul> <li>Add the Tasks that generate your figures to <code>ALL_FIGURE_TASKS</code>.</li> <li>Either invoke the generate_figures.py script to generate all figures, or write your own script to call the generate_figures function on just your newly added Tasks. In either case, your figures will be copied into <code>docs/_figs</code></li> <li>Document your analysis by adding a markdown file to <code>docs/analysis</code>.  In your write-up, include your figures by referencing their location in <code>docs/_figs</code>.</li> <li>Upload your figures using push_figures.py.</li> <li>Create a pull request with your changes (see Standard Workflow).</li> </ul>"},{"location":"Codebase_Concepts/Figure_System/#advantages","title":"Advantages","text":"<p>This programmatic approach is undoubtedly more complex than the link-based approach. Nevertheless, this workflow, in which figures are represented as Tasks, has several advantages;</p> <ul> <li>Figure Lineage:  Since figures are represented as build-system Tasks, it is straightforward to determine exactly the datasets and analysis used to produce any given figure.  This supports that project principle of automated reproducibility and is consistent with data-science best practices.</li> <li>Figure Upgrades: Since figures are represented as build system Tasks, any improvement to that code that generates a particular class of figures can easily be propagated to all figures of that class.</li> </ul>"},{"location":"Data_Sources/Corces_et_al/","title":"Corces et al. Blood Cell Epigenetics","text":""},{"location":"Data_Sources/Corces_et_al/#corces-et-al-blood-cell-epigenetics","title":"Corces et al. Blood Cell Epigenetics","text":"<p>Diagram from Corces et al.<sup>1</sup> showing 5 important ATAC-seq regions for each of 13 blood cell types.</p> <p>In their 2016 paper, Corces et al.<sup>1</sup> used ATAC-seq to record epigenetic chromatin accessibility data from 13 blood-cell types.</p> <p>Using functional genomics techniques like MAGMA and S-LDSC, this cell-specific chromatin accessibility data can be combined with GWAS summary statistics to implicate specific blood cell types in specific phenotypes.</p> <ol> <li> <p>M Ryan Corces, Jason D Buenrostro, Beijing Wu, Peyton G Greenside, Steven M Chan, Julie L Koenig, Michael P Snyder, Jonathan K Pritchard, Anshul Kundaje, William J Greenleaf, and others. Lineage-specific and single-cell chromatin accessibility charts human hematopoiesis and leukemia evolution. Nature genetics, 48(10):1193\u20131203, 2016. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC5042844/.\u00a0\u21a9\u21a9</p> </li> </ol>"},{"location":"Data_Sources/DecodeME/","title":"DecodeME","text":""},{"location":"Data_Sources/DecodeME/#decodeme","title":"DecodeME","text":"<p>DecodeME is a genome-wide association study of people with ME/CFS.  It is the largest ME/CFS study ever performed.  It is lead by Professor Chris Ponting.</p>"},{"location":"Data_Sources/DecodeME/#external-links","title":"External Links","text":"<ul> <li>Link to study home page</li> <li>Link to preprint</li> <li>Interview of Chris Ponting by David Tuller</li> </ul>"},{"location":"Data_Sources/DecodeME/#tasks","title":"Tasks","text":"<p>See here for tasks pertaining to DecodeME.</p>"},{"location":"Data_Sources/GTEx_RNAseq_Data/","title":"GTEx Bulk RNA-seq","text":""},{"location":"Data_Sources/GTEx_RNAseq_Data/#gtex-bulk-rna-seq","title":"GTEx Bulk RNA-seq","text":"<p>The Genotype Tissue Expression (GTEx) project<sup>1</sup> generates useful datasets via the analysis of diverse tissues from post-mortem human donors.</p> <p>One important class of GTEx dataset records levels of RNA expression across a wide range of tissues.  These GTEx RNAseq datasets can help us discover the tissues in which a particular gene plays an important role.  For instance, if we find that across many donors, the RNA transcripts of a gene are over-expressed in the colon relative to other tissues, it is reasonable to assume that the gene plays its most important role in the colon.</p> <p>GTEx bulk tissue RNA-seq datasets are used by the gene set analysis step of MAGMA to construct hypotheses about which tissues are most involved in a trait or disease.  Continuing the above example, MAGMA works on the principle that if most of the genes strongly associated with a disease are over-expressed in the colon according to GTEx RNAseq data, it is likely that the colon is central to the disease process.</p>"},{"location":"Data_Sources/GTEx_RNAseq_Data/#artifacts-in-gtex-rnaseq-data","title":"Artifacts in GTEx RNAseq data","text":"<p>Finucane et al.<sup>2</sup> applied Gene Ontology Enrichment Analysis to the genes expressed in lung tissue in the GTEx bulk RNAseq dataset.  They found strong enrichment for immune-related genes.  They hypothesized that this enrichment of immune genes in the lung was not a real property of lung tissue, but was instead a consequence of the presence of blood in the lungs of the post-mortem donors from which GTEx samples were collected. Users of GTEx datasets need to be aware of the presence of this kind of data artifact.</p>"},{"location":"Data_Sources/GTEx_RNAseq_Data/#references","title":"References","text":"<p>FUMA Tutorial (Discusses use of GTEx data for post-GWAS analysis)</p> <p>GTEx Bulk Tissue Expression Data</p> <p>GTEx paper</p> <p>Alberts, Bruce, et al. Molecular biology of the cell: seventh edition. WW Norton &amp; Company, 2022. See Chapter 6.</p> <ol> <li> <p>GTEx Consortium. The gtex consortium atlas of genetic regulatory effects across human tissues. Science, 369(6509):1318\u20131330, 2020. URL: https://www.science.org/doi/full/10.1126/science.aaz1776.\u00a0\u21a9</p> </li> <li> <p>Hilary K Finucane, Yakir A Reshef, Verneri Anttila, Kamil Slowikowski, Alexander Gusev, Andrea Byrnes, Steven Gazal, Po-Ru Loh, Caleb Lareau, Noam Shoresh, and others. Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types. Nature genetics, 50(4):621\u2013629, 2018. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC5896795/.\u00a0\u21a9</p> </li> </ol>"},{"location":"Data_Sources/HBA_scRNAseq/","title":"HBA scRNAseq","text":""},{"location":"Data_Sources/HBA_scRNAseq/#hba-scrnaseq","title":"HBA scRNAseq","text":"<p>The Human Brain Atlas (HBA)<sup>1</sup> surveys cell types across the brain through single-cell RNA sequencing (scRNAseq).</p> <p>The HBA dataset was derived from 106 dissections of the brains of 3 post-mortem donors.  The result is gene expression profiles from over 3 million brain cells.</p>"},{"location":"Data_Sources/HBA_scRNAseq/#clustering","title":"Clustering","text":"<p>HBA analysts applied hierarchical clustering algorithms to the RNA expression levels of these ~3 million cells to create clusters at 3 scales:  subclusters, clusters, and superclusters.  Accordingly, brain cell types in the HBA dataset are defined in an unbiased, data-driven way.</p> <p>In the figure below from Silleti et al,<sup>1</sup>, the left panel illustrates the dissected regions of the brain, while the right panel shows a t-SNE plot of brain cells, with each cell colored according to its supercluster. </p>"},{"location":"Data_Sources/HBA_scRNAseq/#utility","title":"Utility","text":"<p>The HBA dataset can be combined with MAGMA to associate GWAS phenotypes with HBA-defined brain cell types.</p> <ol> <li> <p>Kimberly Siletti, Rebecca Hodge, Alejandro Mossi Albiach, Ka Wai Lee, Song-Lin Ding, Lijuan Hu, Peter L\u00f6nnerberg, Trygve Bakken, Tamara Casper, Michael Clark, and others. Transcriptomic diversity of cell types across the adult human brain. Science, 382(6667):eadd7046, 2023. URL: https://www.science.org/doi/abs/10.1126/science.add7046.\u00a0\u21a9\u21a9</p> </li> </ol>"},{"location":"Data_Sources/Immgen_Project/","title":"ImmGen","text":""},{"location":"Data_Sources/Immgen_Project/#immgen","title":"ImmGen","text":"<p>Image source: Aguilar et al.<sup>1</sup></p> <p>The ImmGen project<sup>1</sup> is a public resource describing gene expression and gene regulation in the mouse immune system.  For each cell type in a highly granular taxonomy of mouse immune cell types, the ImmGen project seeks to record:</p> <ul> <li>mRNA expression levels,</li> <li>Epigenetic information describing chromatin regulation,</li> <li>Information on the relationship between mRNA and protein levels.</li> </ul>"},{"location":"Data_Sources/Immgen_Project/#uses","title":"Uses","text":"<p>Because of its extreme granularity, and because of the similarity between the mouse and human immune systems, ImmGen reference data can be combined with GWAS summary statistics to suggest the key immune-system cells driving a phenotype.</p> <ol> <li> <p>Stephanie Vargas Aguilar, Oscar Aguilar, Rhys Allan, El Ad David Amir, Veronique Angeli, Maxim N Artyomov, Natasha Asinovski, Jilian Astarita, K Frank Austen, Geetika Bajpai, and others. Immgen at 15. Nature immunology, 21(7):700\u2013703, 2020. URL: https://escholarship.org/content/qt75r8v4bt/qt75r8v4bt.pdf.\u00a0\u21a9\u21a9</p> </li> </ol>"},{"location":"Data_Sources/Million_Veterans_Program/","title":"Million Veterans Program","text":""},{"location":"Data_Sources/Million_Veterans_Program/#million-veterans-program","title":"Million Veterans Program","text":"<p>The Million Veterans Program (MVP) is a longitudinal health cohort study organized by the US Department of Veterans Affairs, which enrolled its one-millionth participant in 2023<sup>1</sup>.</p> <p>MVP participants are significantly more ethnically diverse than participants in other studies of a similar scale.</p> <p>The MVP investigators have run a large number of GWAS using genetic and phenotypic data collected from participants, and have publicly released summary statistics from these studies.</p>"},{"location":"Data_Sources/Million_Veterans_Program/#relevant-links","title":"Relevant Links","text":"<p>Interview with Dr. Mike Gaziano, one of the Principal Investigators leading the Million Veterans Program</p> <ol> <li> <p>Anurag Verma, Jennifer E Huffman, Alex Rodriguez, Mitchell Conery, Molei Liu, Yuk-Lam Ho, Youngdae Kim, David A Heise, Lindsay Guare, Vidul Ayakulangara Panickan, and others. Diversity and scale: genetic architecture of 2068 traits in the va million veteran program. Science, 385(6706):eadj1182, 2024. URL: https://www.science.org/doi/10.1126/science.adj1182.\u00a0\u21a9</p> </li> </ol>"},{"location":"Data_Sources/Roadmap/","title":"Roadmap Epigenetics Project","text":""},{"location":"Data_Sources/Roadmap/#roadmap-epigenetics-project","title":"Roadmap Epigenetics Project","text":""},{"location":"Data_Sources/Roadmap/#overview","title":"Overview","text":"<p>The Roadmap Epigenetics Project<sup>1</sup> was an NIH-funded initiative whose aim was to gather epigenetic data such as:</p> <ul> <li>DNA methylation data</li> <li>Histone modification data</li> <li>Chromatin accessibility data (via the DNase 1 chromatin accessibility assay),</li> </ul> <p>from a wide variety of human tissue.</p> <p>A key feature of the Roadmap Project was its adherence to the principle of In Vivo Veritas.  Whereas previous epigenetics studies had studied immortalized cell lines that may not faithfully recapitulate normal biology, the Roadmap Project studied normal cells retrieved from donors.  </p>"},{"location":"Data_Sources/Roadmap/#utility","title":"Utility","text":"<p>Roadmap datasets tell us which regions of the genome are under what kind of epigenetic control in which tissues.  They can thus be combined with GWAS results via tools like S-LDSC and MAGMA. Essentially, if we find a GWAS hit in a particular region of the genome, we can use Roadmap to try to ask: \"In which tissues is that region of the genome epigenetically up-regulated?\"</p> <ol> <li> <p>Bradley E Bernstein, John A Stamatoyannopoulos, Joseph F Costello, Bing Ren, Aleksandar Milosavljevic, Alexander Meissner, Manolis Kellis, Marco A Marra, Arthur L Beaudet, Joseph R Ecker, and others. The nih roadmap epigenomics mapping consortium. Nature biotechnology, 28(10):1045\u20131048, 2010. URL: https://pmc.ncbi.nlm.nih.gov/articles/PMC3607281/.\u00a0\u21a9</p> </li> </ol>"},{"location":"Data_Sources/UKBB_PPP/","title":"UKBB PPP","text":""},{"location":"Data_Sources/UKBB_PPP/#ukbb-ppp","title":"UKBB PPP","text":"<p>The UK Biobank Pharma Proteomics Project (PPP)<sup>1</sup> is an effort to characterize the plasma proteomes of a sample of UK Biobank participants.  The PPP was funded and organized by a consortium consisting of the research arms of major pharmaceutical companies.  The aim was to produce datasets suitable for drug-discovery research.</p>"},{"location":"Data_Sources/UKBB_PPP/#motivation","title":"Motivation","text":"<p>Often, GWAS hits are mechanistically mysterious: it is unclear what biological pathway links a given genetic polymorphism with an associated phenotype.  At a high level the PPP is motivated by the observation that since proteins are the fundamental biological effector molecules, they can help explain GWAS hits.  If we observe that a GWAS hit for a phenotype is also associated with changed plasma levels of a protein, we may reason that the protein lies along the biological pathway leading to the GWAS hit.</p>"},{"location":"Data_Sources/UKBB_PPP/#public-data","title":"Public Data","text":"<p>While access to individual-level PPP data requires UKBB accreditation, there are a number of powerful summary PPP datasets that have been publicly released.</p>"},{"location":"Data_Sources/UKBB_PPP/#pqtls","title":"pQTLs","text":"<p>A plasma pQTL for a protein is a genetic variation that has likely-causal association with variations in plasma levels of that protein. One can find such pQTLs by running a GWAS with the plasma level of the target protein as the phenotype, then fine-mapping the results.   The original Sun et al. paper<sup>1</sup> provides pQTLs for 2525 different proteins (see Supplementary Tables 9 and 10).  These pQTLs are divided into cis-pQTLs (within 1Mb of the gene encoding the protein they affect), and trans-pQTLs.  </p> <p>pQTLs can be used in  Mendelian randomization (MR). In pQTL-based MR, the pQTLs for a protein are instruments, the level of the protein is the exposure, and a phenotype is the outcome.  The goal is causal inference about the effect of the protein on the phenotype.  In a pQTL MR study, one must decide whether to exclusively use cis-pQTLs, or to use both trans- and cis- pQTLs.  On the one hand, using only cis-pQTLs reduces the risk of violations of the MR assumptions due to pleiotropy, since the pathway from the genetic variant to the protein level is relatively straightforward.  On the other hand, for certain proteins, inclusion of trans-pQTL can increase statistical power.</p> <p>The figure below from Donoghue et al.<sup>2</sup> shows the proportion of variance in levels of asthma-relevant proteins explained by cis vs trans pQTL.  For certain proteins, it is necessary to use trans pQTLs to explain an adequate proportion of the variance.</p> <p></p>"},{"location":"Data_Sources/UKBB_PPP/#gwas-summary-statistics","title":"GWAS Summary Statistics","text":"<p>In addition to tables of pQTLs, the PPP has also released full GWAS summary statistics for each protein measured. There are available at Synapse. These summary statistics are useful for colocalization analysis.  For example, after one finds MR evidence suggesting that levels of a protein causally affect a phenotype, one can use colocalization to further support or refute a causal connection<sup>3</sup>.</p>"},{"location":"Data_Sources/UKBB_PPP/#links","title":"Links","text":"<p>Genetics Podcast Interview About PPP</p> <ol> <li> <p>Benjamin B Sun, Joshua Chiou, Matthew Traylor, Christian Benner, Yi-Hsiang Hsu, Tom G Richardson, Praveen Surendran, Anubha Mahajan, Chloe Robins, Steven G Vasquez-Grinnell, and others. Plasma proteomic associations with genetics and health in the uk biobank. Nature, 622(7982):329\u2013338, 2023. URL: https://www.nature.com/articles/s41586-023-06592-6.\u00a0\u21a9\u21a9</p> </li> <li> <p>Lauren J Donoghue, Christian Benner, Diana Chang, Flaviyan Jerome Irudayanathan, Rion K Pendergrass, Brian L Yaspan, Anubha Mahajan, and Mark I McCarthy. Integration of biobank-scale genetics and plasma proteomics reveals evidence for causal processes in asthma risk and heterogeneity. Cell Genomics, 2025. URL: https://www.cell.com/cell-genomics/fulltext/S2666-979X(25)00096-5.\u00a0\u21a9</p> </li> <li> <p>Verena Zuber, Nastasiya F Grinberg, Dipender Gill, Ichcha Manipur, Eric AW Slob, Ashish Patel, Chris Wallace, and Stephen Burgess. Combining evidence from mendelian randomization and colocalization: review and comparison of approaches. The American Journal of Human Genetics, 109(5):767\u2013782, 2022. URL: https://www.cell.com/ajhg/fulltext/S0002-9297(22)00149-5.\u00a0\u21a9</p> </li> </ol>"},{"location":"Getting_Started/a_setup/","title":"Initial Setup","text":""},{"location":"Getting_Started/a_setup/#initial-setup","title":"Initial Setup","text":"<p>Clone the repository:</p> <pre><code>git clone git@github.com:trafalmadorian97/mecfs_bioinformatics.git\n</code></pre> <p>We use Pixi as are our package manager.  Setup Pixi as described here, using the bash command:</p> <pre><code>curl -fsSL https://pixi.sh/install.sh | sh\n</code></pre> <p>After setup, source your <code>bashrc</code> to make sure <code>pixi</code> is on your path:</p> <pre><code>source ~/.bashrc\n</code></pre> <p>To verify everything is working correctly, try: </p> <pre><code>pixi r invoke init\n</code></pre> <p>This will install additional required packages, then run linters and tests.</p> <p>A natural next step is to run the basic analysis of the Decode ME data using the script here.</p> <p>You can use pixi to run this or another script via the command:</p> <pre><code>pixi r python [PATH_TO_SCRIPT]\n</code></pre>"},{"location":"Getting_Started/b_Standard_Workflow/","title":"Standard Workflow","text":""},{"location":"Getting_Started/b_Standard_Workflow/#standard-workflow","title":"Standard Workflow","text":"<p>This page describes the standard workflow for contributing to the <code>mecfs_bioinformatics</code> repository.</p>"},{"location":"Getting_Started/b_Standard_Workflow/#create-a-new-branch","title":"Create a new branch","text":"<p>Use checkout to create a new branch for your changes.  </p> <pre><code>git checkout -b &lt;branchname&gt;\n</code></pre>"},{"location":"Getting_Started/b_Standard_Workflow/#make-changes","title":"Make changes","text":"<p>Implement your changes.  Typically, this will involve:</p> <ul> <li>Defining a new <code>Task</code> object in the assets directory.  This can often be accomplished using an existing <code>Task</code> class, but if no <code>Task</code> class meets your needs, you can implement a new one in the task directory.</li> <li>Adding an analysis script to materialize the new asset you defined.</li> </ul> <p>If you added a new <code>Task</code> class, you will also want to add a unit test to the <code>test_mecfs_bio directory</code> to verify that it works as intended on some dummy data.  To read about the principles of unit testing, see Winters et al.<sup>1</sup> (The chapter on testing can be found here).  </p>"},{"location":"Getting_Started/b_Standard_Workflow/#update-documentation","title":"Update documentation","text":"<p>If any documentation changes are needed, edit the corresponding files in the <code>docs</code> directory, then view the results by running the following command and accessing http://localhost:8000 in your browser.</p> <pre><code>pixi r invoke sdocs\n</code></pre> <p><code>sdocs</code> will both download figures and serve docs. To only serve docs without downloading figures, use <code>pixi r invoke serve-docs</code>.</p>"},{"location":"Getting_Started/b_Standard_Workflow/#run-linters-formatters-and-tests","title":"Run linters, formatters, and tests","text":"<p>The <code>invoke green</code> command runs linters, formatters, and tests. Run it with </p> <pre><code>pixi r invoke green\n</code></pre> <p>It is advisable to run <code>invoke green</code> and fix any detected errors prior to submitting a PR.</p>"},{"location":"Getting_Started/b_Standard_Workflow/#commit-changes-create-a-pr","title":"Commit changes, create a PR","text":"<p>Commit your changes and push them </p><pre><code>git add mecfs_bio test_mecfs_bio; git commit -m '&lt;your message&gt;';git push --set-upstream origin &lt;branchname&gt;\n</code></pre> Finally, use the github interface to create a PR from your changes, and ask a reviewer for a review.<p></p> <ol> <li> <p>Titus Winters, Tom Manshreck, and Hyrum Wright. Software engineering at google: Lessons learned from programming over time. \" O'Reilly Media, Inc.\", 2020. URL: https://abseil.io/resources/swe-book/html/toc.html.\u00a0\u21a9</p> </li> </ol>"},{"location":"Getting_Started/c_Synapse/","title":"Synapse","text":""},{"location":"Getting_Started/c_Synapse/#synapse","title":"Synapse","text":"<p>Some datasets must be downloaded from Synapse. An example is the UK Biobank Pharma Proteomics Project Summary Statistics.  While the build system can automate these downloads, each user must provide their own Synapse Personal Access Token.</p>"},{"location":"Getting_Started/c_Synapse/#steps-to-set-up-synapse-access-token","title":"Steps to Set Up Synapse Access Token","text":"<ol> <li>Go to https://www.synapse.org/, and create an account.</li> <li>Click Account Settings \\(\\to\\) Personal Access Tokens \\(\\to\\) Manage Personal Access Tokens \\(\\to\\) Create New Token.</li> <li>Create a file <code>~/.synapseConfig</code> at the root of your user directory.  Edit it so it has the following contents:</li> </ol> <pre><code>[default]\nauthtoken = &lt;YOUR_AUTH_TOKEN&gt;\n</code></pre>"},{"location":"Getting_Started/d_adding_packages/","title":"Adding Packages","text":""},{"location":"Getting_Started/d_adding_packages/#adding-packages","title":"Adding Packages","text":"<p>You may find that the analysis you would like to perform requires access to a software package that is not currently part of the <code>mecfs_bioinformatics</code> environment.</p>"},{"location":"Getting_Started/d_adding_packages/#adding-pypi-packages","title":"Adding PyPi Packages","text":"<p>If your software package is available on PyPi, you can add it with </p> <pre><code>pixi add --pypi &lt;your_package_name&gt; --feature analysis\n</code></pre> <p>This will update <code>pyproject.toml</code> and <code>pixi.lock</code> by adding the package to the analysis dependency group (the main dependency group used by the project).  You can use <code>git add pyproject.toml pixi.lock; git commit -m '&lt;your_message&gt;'</code> to add the environment update to your branch. </p>"},{"location":"Getting_Started/d_adding_packages/#adding-bioconda-conda-forge-packages","title":"Adding bioconda/ conda-forge packages","text":"<p>If your package is instead present on bioconda or conda-forge, you can add it with</p> <pre><code>pixi add &lt;your_package_name&gt;  --feature analysis\n</code></pre> <p>Again, commit the resulting changes to <code>pyproject.toml</code> and <code>pixi.lock</code>.</p> <p>Note that numerous Python packages are available on both PyPi and bioconda/ conda-forge.  In such cases, it is preferable to install them from PyPi.  Having Python packages installed from both sources can cause problems for Pixi's dependency resolver.</p>"},{"location":"Getting_Started/e_experiments_directory/","title":"Experiments Directory","text":""},{"location":"Getting_Started/e_experiments_directory/#experiments-directory","title":"Experiments Directory","text":""},{"location":"Getting_Started/e_experiments_directory/#motivation","title":"Motivation","text":"<p>In research projects, it is often necessary to write rough, experimental code. Subjecting this experimental code to normal code review would be counterproductive, because doing so would slow down the pace of exploration, and because much of this code will be ultimately unused.</p> <p>Nevertheless, it is still valuable to commit this experimental code to Github, to create a record of past experiments.</p> <p>This motivates the <code>experiments</code> directory: a place to store rough experimental scripts.</p>"},{"location":"reference/mecfs_bio/","title":"mecfs_bio","text":""},{"location":"reference/mecfs_bio/#mecfs_bio","title":"mecfs_bio","text":"<p>Root directory for the ME/CFS biostatistics project.</p> <p>Modules:</p> <ul> <li> <code>analysis</code>           \u2013            <p>Scripts that invoke the build system to execute Tasks to analyze biostatistical data.</p> </li> <li> <code>asset_generator</code>           \u2013            <p>Convenience functions to generate multiple related Tasks.</p> </li> <li> <code>assets</code>           \u2013            <p>Definitions of the Task objects used to fetch biostatistical datasets, preprocess them, perform relevant analysis, and report results.</p> </li> <li> <code>build_system</code>           \u2013            <p>Incremental build system framework. See \"Build Systems a la Carte\" by Mokhov, Mitchell, and Peyton Jones for a conceptual discussion.</p> </li> <li> <code>constants</code>           \u2013            <p>Global constants.</p> </li> <li> <code>figures</code>           \u2013            <p>Functionality to generate plots and tables from build system assets, and upload them to Github.</p> </li> <li> <code>util</code>           \u2013            <p>Miscellaneous utilities related to plotting and the execution of shell subprocesses.</p> </li> </ul>"},{"location":"reference/mecfs_bio/analysis/","title":"analysis","text":""},{"location":"reference/mecfs_bio/analysis/#mecfs_bio.analysis","title":"mecfs_bio.analysis","text":"<p>Scripts that invoke the build system to execute Tasks to analyze biostatistical data.</p> <p>Modules:</p> <ul> <li> <code>alzheimers</code>           \u2013            <p>This file contains a basic driver script to analyze GWAS of the Alzheimer's phenotype.</p> </li> <li> <code>asthma</code>           \u2013            <p>Script to analyze asthma phenotype.</p> </li> <li> <code>ct_ldsc_analysis</code>           \u2013            <p>Script to generate a heatmap showing estimated genetic correlation between a diverse collection of traits.</p> </li> <li> <code>dbp_analysis</code>           \u2013            <p>Analyze diastolic blood pressure  GWAS</p> </li> <li> <code>decode_me_fine_mapping</code>           \u2013            <p>Script to run fine mapping analysis on DecodeME data.</p> </li> <li> <code>decode_me_initial_analysis</code>           \u2013            <p>Script to run initial analysis on DecodeME data.</p> </li> <li> <code>heart_rate_recovery</code>           \u2013            <p>Script to analyze heart rate recovery GWAS of Verweiji et al.</p> </li> <li> <code>ibd_analysis</code>           \u2013            <p>Script to analyze inflammatory bowel disease GWAS from Liu et al.</p> </li> <li> <code>johnston_multisite_pain_analysis</code>           \u2013            <p>This file contains a basic driver script to analyze the GWAS of the multisite pain phenotype.</p> </li> <li> <code>ldl_analysis</code>           \u2013            <p>Script to run basic analysis of LDL GWAS from the Million Veterans Program.</p> </li> <li> <code>lee_educational_attainment_analysis</code>           \u2013            <p>Script to run initial analysis on Lee et al. Educational Attainment GWAS</p> </li> <li> <code>psoriasis_analysis</code>           \u2013            <p>Script to analyze psoriasis data from the Million Veterans Program</p> </li> <li> <code>pullit_body_fat_analysis</code>           \u2013            <p>Script to analyze the body fat distribution GWAS from Pullit et al.</p> </li> <li> <code>red_blood_cell_volume</code>           \u2013            <p>Analyze red blood cell volume GWAS</p> </li> <li> <code>ref_data</code>           \u2013            <p>Script to download some reference data.  Mainly for testing.</p> </li> <li> <code>right_heart_analysis</code>           \u2013            <p>Script to analyze imaging-derived right-heart phenotypes</p> </li> <li> <code>runner</code>           \u2013            <p>Build system runners used to analyze GWAS data.</p> </li> <li> <code>schizophrenia_analysis</code>           \u2013            <p>Analyze Schizophrenia dataset from PGC 2022</p> </li> <li> <code>syncope</code>           \u2013            <p>Analyze the syncope GWAS of Aegisdottir et al.</p> </li> </ul>"},{"location":"reference/mecfs_bio/analysis/alzheimers/","title":"alzheimers","text":""},{"location":"reference/mecfs_bio/analysis/alzheimers/#mecfs_bio.analysis.alzheimers","title":"mecfs_bio.analysis.alzheimers","text":"<p>This file contains a basic driver script to analyze GWAS of the Alzheimer's phenotype.</p> <p>Functions:</p> <ul> <li> <code>run_initial_alzheimers_analysis</code>             \u2013              <p>Function to analyze GWAS of Alzheimer's phenotype.</p> </li> </ul>"},{"location":"reference/mecfs_bio/analysis/alzheimers/#mecfs_bio.analysis.alzheimers.run_initial_alzheimers_analysis","title":"run_initial_alzheimers_analysis","text":"<pre><code>run_initial_alzheimers_analysis()\n</code></pre> <p>Function to analyze GWAS of Alzheimer's phenotype. Includes: - S-LDSC analysis - MAGMA analysis (Using both GTEx and HBA reference data)</p> Source code in <code>mecfs_bio/analysis/alzheimers.py</code> <pre><code>def run_initial_alzheimers_analysis():\n    \"\"\"\n    Function to analyze GWAS of Alzheimer's phenotype.\n    Includes:\n    - S-LDSC analysis\n    - MAGMA analysis (Using both GTEx and HBA reference data)\n    \"\"\"\n    DEFAULT_RUNNER.run(\n        BELLENGUEZ_STANDARD_ANALYSIS.get_terminal_tasks()\n        + [BELLENGUEZ_STANDARD_ANALYSIS.hba_magma_tasks.magma_independent_cluster_plot],\n        incremental_save=True,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/analysis/asthma/","title":"asthma","text":""},{"location":"reference/mecfs_bio/analysis/asthma/#mecfs_bio.analysis.asthma","title":"mecfs_bio.analysis.asthma","text":"<p>Script to analyze asthma phenotype.</p> <p>Functions:</p> <ul> <li> <code>run_initial_asthma_analysis</code>             \u2013              <p>Function to analyze asthma phenotype</p> </li> </ul>"},{"location":"reference/mecfs_bio/analysis/asthma/#mecfs_bio.analysis.asthma.run_initial_asthma_analysis","title":"run_initial_asthma_analysis","text":"<pre><code>run_initial_asthma_analysis()\n</code></pre> <p>Function to analyze asthma phenotype Includes: - MAGMA and S-LDSC analysis</p> Source code in <code>mecfs_bio/analysis/asthma.py</code> <pre><code>def run_initial_asthma_analysis():\n    \"\"\"\n    Function to analyze asthma phenotype\n    Includes:\n    - MAGMA and S-LDSC analysis\n    \"\"\"\n    DEFAULT_RUNNER.run(\n        [\n            # ASTHMA_PP_CIS_MR_UNIPROT_LABELED,\n            # ASTHMA_HAN_PPP_CIS_MR_MARKDOWN\n            # HAN_CIS_PPP_MR_PLOT,\n        ],\n        # [HAN_2022_ASTHMA_TSMR],\n        # [HAN_ET_AL_ASTHMA_RAW] + HAN_ASTHMA_STANDARD_ANALYSIS.get_terminal_tasks(),\n        incremental_save=True,\n        must_rebuild_transitive=[\n            # HAN_CIS_PPP_MR_PLOT\n            # ASTHMA_HAN_PPP_CIS_MR_MARKDOWN\n            # ASTHMA_PP_CIS_MR_UNIPROT_LABELED\n            # HAN_ASTHMA_STANDARD_ANALYSIS.labeled_lead_variant_tasks.raw_sumstats_task\n            # HAN_2022_ASTHMA_TSMR\n        ],\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/analysis/ct_ldsc_analysis/","title":"ct_ldsc_analysis","text":""},{"location":"reference/mecfs_bio/analysis/ct_ldsc_analysis/#mecfs_bio.analysis.ct_ldsc_analysis","title":"mecfs_bio.analysis.ct_ldsc_analysis","text":"<p>Script to generate a heatmap showing estimated genetic correlation between a diverse collection of traits. Uses cross-trait linkage disequilibrium score regression to estimate correlation.</p> <p>See: Bulik-Sullivan, Brendan, et al. \"An atlas of genetic correlations across human diseases and traits.\" Nature genetics 47.11 (2015): 1236-1241.</p> <p>Functions:</p> <ul> <li> <code>initial_ct_ldsc_analysis</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/analysis/ct_ldsc_analysis/#mecfs_bio.analysis.ct_ldsc_analysis.initial_ct_ldsc_analysis","title":"initial_ct_ldsc_analysis","text":"<pre><code>initial_ct_ldsc_analysis()\n</code></pre> Source code in <code>mecfs_bio/analysis/ct_ldsc_analysis.py</code> <pre><code>def initial_ct_ldsc_analysis():\n    DEFAULT_RUNNER.run([CT_LDSC_INITIAL_PLOT], incremental_save=True)\n</code></pre>"},{"location":"reference/mecfs_bio/analysis/dbp_analysis/","title":"dbp_analysis","text":""},{"location":"reference/mecfs_bio/analysis/dbp_analysis/#mecfs_bio.analysis.dbp_analysis","title":"mecfs_bio.analysis.dbp_analysis","text":"<p>Analyze diastolic blood pressure  GWAS</p> <p>Functions:</p> <ul> <li> <code>run_dbp_analysis</code>             \u2013              <p>Analyze Keaton meta GWAS f diastolic blood pressure</p> </li> </ul>"},{"location":"reference/mecfs_bio/analysis/dbp_analysis/#mecfs_bio.analysis.dbp_analysis.run_dbp_analysis","title":"run_dbp_analysis","text":"<pre><code>run_dbp_analysis()\n</code></pre> <p>Analyze Keaton meta GWAS f diastolic blood pressure</p> Source code in <code>mecfs_bio/analysis/dbp_analysis.py</code> <pre><code>def run_dbp_analysis():\n    \"\"\"\n    Analyze Keaton meta GWAS f diastolic blood pressure\n\n    \"\"\"\n    DEFAULT_RUNNER.run(\n        [KEATON_ET_AL_DBP_RAW] + KEATON_DBP_STANDARD_ANALYSIS.get_terminal_tasks(),\n        incremental_save=True,\n        # must_rebuild_transitive=[KEATON_DBP_STANDARD_ANALYSIS.magma_tasks.inner.bar_plot_task]\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/analysis/decode_me_fine_mapping/","title":"decode_me_fine_mapping","text":""},{"location":"reference/mecfs_bio/analysis/decode_me_fine_mapping/#mecfs_bio.analysis.decode_me_fine_mapping","title":"mecfs_bio.analysis.decode_me_fine_mapping","text":"<p>Script to run fine mapping analysis on DecodeME data.</p> <p>Functions:</p> <ul> <li> <code>run_fine_mapping_decode_me_analysis</code>             \u2013              <p>Function to fine map the main DecodeME loci using SUSIE.</p> </li> </ul>"},{"location":"reference/mecfs_bio/analysis/decode_me_fine_mapping/#mecfs_bio.analysis.decode_me_fine_mapping.run_fine_mapping_decode_me_analysis","title":"run_fine_mapping_decode_me_analysis","text":"<pre><code>run_fine_mapping_decode_me_analysis()\n</code></pre> <p>Function to fine map the main DecodeME loci using SUSIE. As an LD reference, use a UK biobank LD reference matrix from the Broad institute.</p> Source code in <code>mecfs_bio/analysis/decode_me_fine_mapping.py</code> <pre><code>def run_fine_mapping_decode_me_analysis():\n    \"\"\"\n    Function to fine map the main DecodeME loci using SUSIE.\n    As an LD reference, use a UK biobank LD reference matrix from the Broad institute.\n    \"\"\"\n    DEFAULT_RUNNER.run(\n        (\n            DECODE_ME_GWAS_37_CHR1_174_128_548_FINEMAP_PALINDROMES.terminal_tasks()\n            + DECODE_ME_GWAS_37_CHR6_26_215_000_FINEMAP_PALINDROMES.terminal_tasks()\n            + DECODE_ME_GWAS_37_CHR6_97_505_620_FINEMAP_PALINDROMES.terminal_tasks()\n            + DECODE_ME_GWAS_37_CHR_15_54_925_638_FINEMAP_PALINDROMES.terminal_tasks()\n            + DECODE_ME_GWAS_37_CHR17_50_237_377_FINEMAP_PALINDROMES.terminal_tasks()\n            + DECODE_ME_GWAS_37_CHR20_47_653_000_FINEMAP_PALNDROMES.terminal_tasks()\n        ),\n        incremental_save=True,\n        must_rebuild_transitive=[],\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/analysis/decode_me_initial_analysis/","title":"decode_me_initial_analysis","text":""},{"location":"reference/mecfs_bio/analysis/decode_me_initial_analysis/#mecfs_bio.analysis.decode_me_initial_analysis","title":"mecfs_bio.analysis.decode_me_initial_analysis","text":"<p>Script to run initial analysis on DecodeME data.</p> <p>Functions:</p> <ul> <li> <code>run_initial_decode_me_analysis</code>             \u2013              <p>Function to run initial analysis on DecodeME data.</p> </li> </ul>"},{"location":"reference/mecfs_bio/analysis/decode_me_initial_analysis/#mecfs_bio.analysis.decode_me_initial_analysis.run_initial_decode_me_analysis","title":"run_initial_decode_me_analysis","text":"<pre><code>run_initial_decode_me_analysis()\n</code></pre> <p>Function to run initial analysis on DecodeME data.</p> <p>Includes:</p> <ul> <li>Generation of manhattan plot.</li> <li>Extraction of lead variants.</li> <li>Application of MAGMA to GTEx data to identify possible key tissues.</li> <li>Application of MAGMA to human brain atlas to identify key brain tissue</li> <li>Use of S-LDSC to investigate key cell and tissue types</li> <li>USe of Mendelian Randomization to look for causal blood proteins</li> </ul> <p>Comment out lines to remove tasks</p> Source code in <code>mecfs_bio/analysis/decode_me_initial_analysis.py</code> <pre><code>def run_initial_decode_me_analysis():\n    \"\"\"\n    Function to run initial analysis on DecodeME data.\n\n    Includes:\n\n    - Generation of manhattan plot.\n    - Extraction of lead variants.\n    - Application of MAGMA to GTEx data to identify possible key tissues.\n    - Application of MAGMA to human brain atlas to identify key brain tissue\n    - Use of S-LDSC to investigate key cell and tissue types\n    - USe of Mendelian Randomization to look for causal blood proteins\n\n\n    Comment out lines to remove tasks\n    \"\"\"\n    DEFAULT_RUNNER.run(\n        [\n            DECODE_ME_GWAS_1_MANHATTAN_AND_QQ_PLOT,\n            DECODE_ME_GWAS_1_MANHATTAN_PLOT,\n            DECODE_ME_GWAS_1_LEAD_VARIANTS,\n            MAGMA_DECODE_ME_SPECIFIC_TISSUE_ANALYSIS_BAR_PLOT,\n            DECODE_ME_MASTER_GENE_LIST_AS_MARKDOWN,\n        ]\n        + DECODE_ME_S_LDSC.get_terminal_tasks()\n        + DECODE_ME_HBA_MAGMA_TASKS.terminal_tasks(),\n        # + DECODE_ME_BASIC_CIS_PQTL_MR.terminal_tasks(),\n        incremental_save=True,\n        must_rebuild_transitive=[\n            DECODE_ME_GWAS_1_37_ANNOVAR_DBSNP150_RSID_ASSIGNED.harmonize_task\n        ],\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/analysis/heart_rate_recovery/","title":"heart_rate_recovery","text":""},{"location":"reference/mecfs_bio/analysis/heart_rate_recovery/#mecfs_bio.analysis.heart_rate_recovery","title":"mecfs_bio.analysis.heart_rate_recovery","text":"<p>Script to analyze heart rate recovery GWAS of Verweiji et al.</p> <p>Functions:</p> <ul> <li> <code>run_heart_rate_recovery_analysis</code>             \u2013              <p>Analyze GWAS of heart rate recovery ( Verweiji et al. (2018))</p> </li> </ul>"},{"location":"reference/mecfs_bio/analysis/heart_rate_recovery/#mecfs_bio.analysis.heart_rate_recovery.run_heart_rate_recovery_analysis","title":"run_heart_rate_recovery_analysis","text":"<pre><code>run_heart_rate_recovery_analysis()\n</code></pre> <p>Analyze GWAS of heart rate recovery ( Verweiji et al. (2018)) Analysis includes: - Application of MAGMA to GTEx data to identify possible key tissues. - Application of MAGMA to human brain atlas to identify key brain tissue - Use of S-LDSC to investigate key cell and tissue types</p> Source code in <code>mecfs_bio/analysis/heart_rate_recovery.py</code> <pre><code>def run_heart_rate_recovery_analysis():\n    \"\"\"\n    Analyze GWAS of heart rate recovery ( Verweiji et al. (2018))\n    Analysis includes:\n    - Application of MAGMA to GTEx data to identify possible key tissues.\n    - Application of MAGMA to human brain atlas to identify key brain tissue\n    - Use of S-LDSC to investigate key cell and tissue types\n\n    \"\"\"\n    DEFAULT_RUNNER.run(\n        VERWEIJI_ET_AL_HRR_STANDARD_ANALYSIS.get_terminal_tasks(),\n        incremental_save=True,\n        must_rebuild_transitive=[],\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/analysis/ibd_analysis/","title":"ibd_analysis","text":""},{"location":"reference/mecfs_bio/analysis/ibd_analysis/#mecfs_bio.analysis.ibd_analysis","title":"mecfs_bio.analysis.ibd_analysis","text":"<p>Script to analyze inflammatory bowel disease GWAS from Liu et al.</p> <p>Functions:</p> <ul> <li> <code>run_ibd_analysis</code>             \u2013              <p>This script runs a basic analysis of the IBD GWAS from Liu et al.</p> </li> </ul>"},{"location":"reference/mecfs_bio/analysis/ibd_analysis/#mecfs_bio.analysis.ibd_analysis.run_ibd_analysis","title":"run_ibd_analysis","text":"<pre><code>run_ibd_analysis()\n</code></pre> <p>This script runs a basic analysis of the IBD GWAS from Liu et al. It includes:</p> <ul> <li>Using MAGMA to combine the IBD GWAS summary statistics with tissue-specific expression data from GTEx to identify possible tissues involved in the IBD disease process.</li> <li>S-LDSC analysis using standard reference data</li> </ul> Source code in <code>mecfs_bio/analysis/ibd_analysis.py</code> <pre><code>def run_ibd_analysis():\n    \"\"\"\n    This script runs a basic analysis of the IBD GWAS from Liu et al.\n    It includes:\n\n\n    - Using MAGMA to combine the IBD GWAS summary statistics with tissue-specific expression data from GTEx to identify possible tissues involved in the IBD disease process.\n    - S-LDSC analysis using standard reference data\n    \"\"\"\n    DEFAULT_RUNNER.run(\n        [\n            LIU_ET_AL_IBD_EUR_37_SPECIFIC_TISSUE_ANALYSIS_BAR_PLOT,\n        ]\n        + IBD_HBA_MAGMA_TASKS.terminal_tasks(),\n        # + LIU_ET_AL_S_LSDC_FROM_SNP_150.get_terminal_tasks(),\n        incremental_save=True,\n        must_rebuild_transitive=[IBD_HBA_MAGMA_TASKS.magma_independent_cluster_plot],\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/analysis/johnston_multisite_pain_analysis/","title":"johnston_multisite_pain_analysis","text":""},{"location":"reference/mecfs_bio/analysis/johnston_multisite_pain_analysis/#mecfs_bio.analysis.johnston_multisite_pain_analysis","title":"mecfs_bio.analysis.johnston_multisite_pain_analysis","text":"<p>This file contains a basic driver script to analyze the GWAS of the multisite pain phenotype.</p> <p>Functions:</p> <ul> <li> <code>run_initial_multisite_pain_analysis</code>             \u2013              <p>Function to analyze GWAS of multisite pain phenotype.</p> </li> </ul>"},{"location":"reference/mecfs_bio/analysis/johnston_multisite_pain_analysis/#mecfs_bio.analysis.johnston_multisite_pain_analysis.run_initial_multisite_pain_analysis","title":"run_initial_multisite_pain_analysis","text":"<pre><code>run_initial_multisite_pain_analysis()\n</code></pre> <p>Function to analyze GWAS of multisite pain phenotype. Includes: - S-LDSC analysis - MAGMA analysis (Using both GTEx and HBA reference data)</p> Source code in <code>mecfs_bio/analysis/johnston_multisite_pain_analysis.py</code> <pre><code>def run_initial_multisite_pain_analysis():\n    \"\"\"\n    Function to analyze GWAS of multisite pain phenotype.\n    Includes:\n    - S-LDSC analysis\n    - MAGMA analysis (Using both GTEx and HBA reference data)\n    \"\"\"\n    DEFAULT_RUNNER.run(\n        JOHNSTON_ET_AL_PAIN_STANDARD_ANALYSIS.get_terminal_tasks(),\n        incremental_save=True,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/analysis/ldl_analysis/","title":"ldl_analysis","text":""},{"location":"reference/mecfs_bio/analysis/ldl_analysis/#mecfs_bio.analysis.ldl_analysis","title":"mecfs_bio.analysis.ldl_analysis","text":"<p>Script to run basic analysis of LDL GWAS from the Million Veterans Program.</p> <p>Functions:</p> <ul> <li> <code>run_ldl_analysis</code>             \u2013              <p>This script runs a basic analysis of the LDL GWAS from the Million Veterans Program</p> </li> </ul>"},{"location":"reference/mecfs_bio/analysis/ldl_analysis/#mecfs_bio.analysis.ldl_analysis.run_ldl_analysis","title":"run_ldl_analysis","text":"<pre><code>run_ldl_analysis()\n</code></pre> <p>This script runs a basic analysis of the LDL GWAS from the Million Veterans Program</p> <p>This includes:</p> <ul> <li>Using MAGMA to combine the LDL GWAS summary statistics with tissue-specific expression data from GTEx to identify key tissues involved in control of LDL levels.</li> <li>Using S-LDSC to identify key tissues and cell types via a heritability model</li> </ul> Source code in <code>mecfs_bio/analysis/ldl_analysis.py</code> <pre><code>def run_ldl_analysis():\n    \"\"\"\n    This script runs a basic analysis of the LDL GWAS from the Million Veterans Program\n\n    This includes:\n\n    - Using MAGMA to combine the LDL GWAS summary statistics with tissue-specific expression data from GTEx to identify key tissues involved in control of LDL levels.\n    - Using S-LDSC to identify key tissues and cell types via a heritability model\n    \"\"\"\n    DEFAULT_RUNNER.run(\n        [\n            MILLION_VETERANS_EUR_LDL_MAGMA_TASKS.inner.bar_plot_task,\n            MILLION_VETERANS_EUR_LDL_MAGMA_TASKS.inner.labeled_filtered_gene_analysis_task,\n        ]\n        + LDL_STANDARD_SLDSC_TASK_GROUP.get_terminal_tasks(),\n        incremental_save=True,\n        must_rebuild_transitive=[\n            LDL_STANDARD_SLDSC_TASK_GROUP.partitioned_tasks[\n                \"multi_tissue_gene_expression\"\n            ].add_categories_task\n        ],\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/analysis/lee_educational_attainment_analysis/","title":"lee_educational_attainment_analysis","text":""},{"location":"reference/mecfs_bio/analysis/lee_educational_attainment_analysis/#mecfs_bio.analysis.lee_educational_attainment_analysis","title":"mecfs_bio.analysis.lee_educational_attainment_analysis","text":"<p>Script to run initial analysis on Lee et al. Educational Attainment GWAS</p> <p>Functions:</p> <ul> <li> <code>run_edu_analysis</code>             \u2013              <p>Function to run initial analysis on the Lee et al. Educational Attainment GWAS</p> </li> </ul>"},{"location":"reference/mecfs_bio/analysis/lee_educational_attainment_analysis/#mecfs_bio.analysis.lee_educational_attainment_analysis.run_edu_analysis","title":"run_edu_analysis","text":"<pre><code>run_edu_analysis()\n</code></pre> <p>Function to run initial analysis on the Lee et al. Educational Attainment GWAS Includes:</p> <ul> <li>Calculating heritability by LDSC</li> <li>Plotting key tissues as determined by MAGMA Gene Level Analysis of key cells and tissues of SLDSC</li> <li>Use S-LSDC to look for key tissues and cells using standard reference datasets</li> </ul> Source code in <code>mecfs_bio/analysis/lee_educational_attainment_analysis.py</code> <pre><code>def run_edu_analysis():\n    \"\"\"\n    Function to run initial analysis on the Lee et al. Educational Attainment GWAS\n    Includes:\n\n    - Calculating heritability by LDSC\n    - Plotting key tissues as determined by MAGMA Gene Level Analysis of key cells and tissues of SLDSC\n    - Use S-LSDC to look for key tissues and cells using standard reference datasets\n\n    \"\"\"\n    DEFAULT_RUNNER.run(\n        [\n            LEE_ET_AL_2018_COMBINED_MAGMA_TASKS.inner.bar_plot_task,\n            # LEE_ET_AL_2018_H2_BY_LDSC,\n        ]\n        + LEE_ET_AL_2018_HBA_MAGMA_TASKS_EDU.terminal_tasks(),\n        +LEE_ET_AL_EDU_STANDARD_SLDSC_TASK_GROUP.get_terminal_tasks(),\n        incremental_save=True,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/analysis/psoriasis_analysis/","title":"psoriasis_analysis","text":""},{"location":"reference/mecfs_bio/analysis/psoriasis_analysis/#mecfs_bio.analysis.psoriasis_analysis","title":"mecfs_bio.analysis.psoriasis_analysis","text":"<p>Script to analyze psoriasis data from the Million Veterans Program</p> <p>Functions:</p> <ul> <li> <code>run_initial_psoriasis_analysis</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/analysis/psoriasis_analysis/#mecfs_bio.analysis.psoriasis_analysis.run_initial_psoriasis_analysis","title":"run_initial_psoriasis_analysis","text":"<pre><code>run_initial_psoriasis_analysis()\n</code></pre> Source code in <code>mecfs_bio/analysis/psoriasis_analysis.py</code> <pre><code>def run_initial_psoriasis_analysis():\n    DEFAULT_RUNNER.run(\n        [MILLION_VETERANS_EUR_PSORIASIS_COMBINED_MAGMA_TASKS.inner.bar_plot_task],\n        incremental_save=True,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/analysis/pullit_body_fat_analysis/","title":"pullit_body_fat_analysis","text":""},{"location":"reference/mecfs_bio/analysis/pullit_body_fat_analysis/#mecfs_bio.analysis.pullit_body_fat_analysis","title":"mecfs_bio.analysis.pullit_body_fat_analysis","text":"<p>Script to analyze the body fat distribution GWAS from Pullit et al.</p> <p>Full citation: Pulit, Sara L., et al. \"Meta-analysis of genome-wide association studies for body fat distribution in 694 649 individuals of European ancestry.\" Human molecular genetics 28.1 (2019): 166-174.</p> <p>Functions:</p> <ul> <li> <code>run_body_fat_distribution_analysis</code>             \u2013              <p>Analyze body fat distribution GWAS from pullit et al.</p> </li> </ul>"},{"location":"reference/mecfs_bio/analysis/pullit_body_fat_analysis/#mecfs_bio.analysis.pullit_body_fat_analysis.run_body_fat_distribution_analysis","title":"run_body_fat_distribution_analysis","text":"<pre><code>run_body_fat_distribution_analysis()\n</code></pre> <p>Analyze body fat distribution GWAS from pullit et al. Includes: - MAGMA analysis of key tissues using GTEx bulk RNAseq reference data</p> Source code in <code>mecfs_bio/analysis/pullit_body_fat_analysis.py</code> <pre><code>def run_body_fat_distribution_analysis():\n    \"\"\"\n    Analyze body fat distribution GWAS from pullit et al.\n    Includes:\n    - MAGMA analysis of key tissues using GTEx bulk RNAseq reference data\n\n    \"\"\"\n    DEFAULT_RUNNER.run(\n        [PULLIT_ET_AL_2018_COMBINED_MAGMA_TASKS.inner.bar_plot_task],\n        incremental_save=True,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/analysis/red_blood_cell_volume/","title":"red_blood_cell_volume","text":""},{"location":"reference/mecfs_bio/analysis/red_blood_cell_volume/#mecfs_bio.analysis.red_blood_cell_volume","title":"mecfs_bio.analysis.red_blood_cell_volume","text":"<p>Analyze red blood cell volume GWAS</p> <p>Functions:</p> <ul> <li> <code>run_red_blood_cell_volume_analysis</code>             \u2013              <p>Analyze GWAS of red blood cell volume from a million veterans</p> </li> </ul>"},{"location":"reference/mecfs_bio/analysis/red_blood_cell_volume/#mecfs_bio.analysis.red_blood_cell_volume.run_red_blood_cell_volume_analysis","title":"run_red_blood_cell_volume_analysis","text":"<pre><code>run_red_blood_cell_volume_analysis()\n</code></pre> <p>Analyze GWAS of red blood cell volume from a million veterans Includes: - Apply MAGMA to estimate significant genes - Combine Magma results with GTEx to estimate significant tissues - Apply S-LDSC using standard reference datasets to estimate key cells and tissues</p> Source code in <code>mecfs_bio/analysis/red_blood_cell_volume.py</code> <pre><code>def run_red_blood_cell_volume_analysis():\n    \"\"\"\n    Analyze GWAS of red blood cell volume from a million veterans\n    Includes:\n    - Apply MAGMA to estimate significant genes\n    - Combine Magma results with GTEx to estimate significant tissues\n    - Apply S-LDSC using standard reference datasets to estimate key cells and tissues\n\n\n    \"\"\"\n    DEFAULT_RUNNER.run(\n        [\n            MILLION_VETERANS_EUR_RBC_VOLUME_MAGMA_TASKS.inner.bar_plot_task,\n            MILLION_VETERANS_EUR_RBC_VOLUME_MAGMA_TASKS.inner.gene_analysis_task,\n            MILLION_VETERANS_EUR_RBC_VOLUME_MAGMA_TASKS.inner.labeled_filtered_gene_analysis_task,\n        ]\n        + MILLION_VETERANS_EUR_RBC_VOL_S_LDSC_TASKS.get_terminal_tasks(),\n        incremental_save=True,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/analysis/ref_data/","title":"ref_data","text":""},{"location":"reference/mecfs_bio/analysis/ref_data/#mecfs_bio.analysis.ref_data","title":"mecfs_bio.analysis.ref_data","text":"<p>Script to download some reference data.  Mainly for testing.</p> <p>Functions:</p> <ul> <li> <code>run_initial_analysis</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/analysis/ref_data/#mecfs_bio.analysis.ref_data.run_initial_analysis","title":"run_initial_analysis","text":"<pre><code>run_initial_analysis()\n</code></pre> Source code in <code>mecfs_bio/analysis/ref_data.py</code> <pre><code>def run_initial_analysis():\n    DEFAULT_RUNNER.run(\n        [\n            # UKBB_PPP_RABGAP1L,\n            # UKBB_PPP_RABGAP1L_UNTAR,\n            # STACK_UKBBPPP_RABGAP1L\n            # UKBBPPP_RABGAP1L_RABGAP1L_REGION_PLOT_37\n            # UKBBPPP_RABGAP1l_SUMSTATS_37_HARMONIZED\n            # UNIPROT_LOOKUP\n            # GENE_THESAURUS\n            # DUNCAN_ET_AL_2025_ST1_EXTRACTED\n        ]\n        + [BTN1A1_UKBB_PPP_GWAS_PROCESS.plot_task],\n        incremental_save=True,\n        # must_rebuild_transitive=[SUN_ET_AL_2023_COMBINED_PQTLS_EXTRACTED],\n        # must_rebuild_transitive=[PARQUET_DBSNP_37_UNNESTED],\n        # must_rebuild_transitive=[DB_SNP150_ANNOVAR_PROC]\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/analysis/right_heart_analysis/","title":"right_heart_analysis","text":""},{"location":"reference/mecfs_bio/analysis/right_heart_analysis/#mecfs_bio.analysis.right_heart_analysis","title":"mecfs_bio.analysis.right_heart_analysis","text":"<p>Script to analyze imaging-derived right-heart phenotypes</p> <p>Functions:</p> <ul> <li> <code>run_initial_right_heart_analysis</code>             \u2013              <p>Function to analyze imaging-derived right-heart phenotype.</p> </li> </ul>"},{"location":"reference/mecfs_bio/analysis/right_heart_analysis/#mecfs_bio.analysis.right_heart_analysis.run_initial_right_heart_analysis","title":"run_initial_right_heart_analysis","text":"<pre><code>run_initial_right_heart_analysis()\n</code></pre> <p>Function to analyze imaging-derived right-heart phenotype. Includes: - MAGMA and S-LDSC analysis of LVEF</p> Source code in <code>mecfs_bio/analysis/right_heart_analysis.py</code> <pre><code>def run_initial_right_heart_analysis():\n    \"\"\"\n    Function to analyze imaging-derived right-heart phenotype.\n    Includes:\n    - MAGMA and S-LDSC analysis of LVEF\n    \"\"\"\n    DEFAULT_RUNNER.run(\n        RVEF_STANDARD_ANALYSIS_ASSIGN_RSID.terminal_tasks(),\n        incremental_save=True,\n        must_rebuild_transitive=[\n            RVEF_STANDARD_ANALYSIS_ASSIGN_RSID.tasks.master_gene_list_tasks.markdown_task\n        ],\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/analysis/runner/","title":"runner","text":""},{"location":"reference/mecfs_bio/analysis/runner/#mecfs_bio.analysis.runner","title":"mecfs_bio.analysis.runner","text":"<p>Build system runners used to analyze GWAS data.</p> <p>Modules:</p> <ul> <li> <code>default_runner</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/analysis/runner/default_runner/","title":"default_runner","text":""},{"location":"reference/mecfs_bio/analysis/runner/default_runner/#mecfs_bio.analysis.runner.default_runner","title":"mecfs_bio.analysis.runner.default_runner","text":"<p>Attributes:</p> <ul> <li> <code>ASSET_ROOT</code>           \u2013            </li> <li> <code>DEFAULT_RUNNER</code>           \u2013            </li> <li> <code>IMO_128_INFO_STORE_PATH</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/analysis/runner/default_runner/#mecfs_bio.analysis.runner.default_runner.ASSET_ROOT","title":"ASSET_ROOT  <code>module-attribute</code>","text":"<pre><code>ASSET_ROOT = Path('assets') / 'base_asset_store'\n</code></pre>"},{"location":"reference/mecfs_bio/analysis/runner/default_runner/#mecfs_bio.analysis.runner.default_runner.DEFAULT_RUNNER","title":"DEFAULT_RUNNER  <code>module-attribute</code>","text":"<pre><code>DEFAULT_RUNNER = SimpleRunner(\n    tracer=_imo_hasher_128,\n    info_store=IMO_128_INFO_STORE_PATH,\n    asset_root=ASSET_ROOT,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/analysis/runner/default_runner/#mecfs_bio.analysis.runner.default_runner.IMO_128_INFO_STORE_PATH","title":"IMO_128_INFO_STORE_PATH  <code>module-attribute</code>","text":"<pre><code>IMO_128_INFO_STORE_PATH = (\n    Path(\"build_system\")\n    / \"verifying_trace_imo_xxh_128_info.yaml\"\n)\n</code></pre>"},{"location":"reference/mecfs_bio/analysis/schizophrenia_analysis/","title":"schizophrenia_analysis","text":""},{"location":"reference/mecfs_bio/analysis/schizophrenia_analysis/#mecfs_bio.analysis.schizophrenia_analysis","title":"mecfs_bio.analysis.schizophrenia_analysis","text":"<p>Analyze Schizophrenia dataset from PGC 2022</p> <p>Functions:</p> <ul> <li> <code>run_initial_schizophrenia_analysis</code>             \u2013              <p>Function to analyze GWAS of Schizophrenia phenotype.</p> </li> </ul>"},{"location":"reference/mecfs_bio/analysis/schizophrenia_analysis/#mecfs_bio.analysis.schizophrenia_analysis.run_initial_schizophrenia_analysis","title":"run_initial_schizophrenia_analysis","text":"<pre><code>run_initial_schizophrenia_analysis()\n</code></pre> <p>Function to analyze GWAS of Schizophrenia phenotype. Includes: - S-LDSC analysis - MAGMA analysis (Using both GTEx and HBA reference data)</p> Source code in <code>mecfs_bio/analysis/schizophrenia_analysis.py</code> <pre><code>def run_initial_schizophrenia_analysis():\n    \"\"\"\n    Function to analyze GWAS of Schizophrenia phenotype.\n    Includes:\n    - S-LDSC analysis\n    - MAGMA analysis (Using both GTEx and HBA reference data)\n    \"\"\"\n    DEFAULT_RUNNER.run(\n        [\n            # PGC_2022_SCH_RAW,\n            # PGC2022_SCH_MAGMA_ENTREZ_ANNOTATIONS,\n            # PGC2022_SCH_MAGMA_ENTREZ_GENE_ANALYSIS\n            # MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR\n            # PGC_2022_SCH_MAGMA_HUMAN_BRAIN_ATLAS_PLOT,\n            # MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_CONDITIONAL_ANALYSIS\n            # MAGMA_PGC2022_HBA_FORWARD_STEPWISE_CLUSTER_SELECT,\n            # PGC2022_HBA_MAGMA_STEPWISE_PLOT\n            SCH_PGC_2022_STANDARD_ANALYSIS.hba_magma_tasks.magma_independent_cluster_plot\n        ],\n        # ]+ SCH_PGC_2022_STANDARD_ANALYSIS.get_terminal_tasks(),\n        # must_rebuild_transitive=[PGC2022_SCH_MAGMA_ENTREZ_ANNOTATIONS]\n        # must_rebuild_transitive=[PGC2022_HBA_MAGMA_SPEC_MATRIX_FILTERED],\n        # must_rebuild_transitive=[\n        #     PGC2022_HBA_MAGMA_STEPWISE_PLOT,\n        #     MAGMA_PGC2022_HBA_FORWARD_STEPWISE_CLUSTER_SELECT,\n        # ],\n        must_rebuild_transitive=[\n            SCH_PGC_2022_STANDARD_ANALYSIS.hba_magma_tasks.magma_independent_cluster_plot\n        ],\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/analysis/syncope/","title":"syncope","text":""},{"location":"reference/mecfs_bio/analysis/syncope/#mecfs_bio.analysis.syncope","title":"mecfs_bio.analysis.syncope","text":"<p>Analyze the syncope GWAS of Aegisdottir et al.</p> <p>Functions:</p> <ul> <li> <code>run_syncope_analysis</code>             \u2013              <p>Analyze GWAS of syncope from Aegisdottir et al.</p> </li> </ul>"},{"location":"reference/mecfs_bio/analysis/syncope/#mecfs_bio.analysis.syncope.run_syncope_analysis","title":"run_syncope_analysis","text":"<pre><code>run_syncope_analysis()\n</code></pre> <p>Analyze GWAS of syncope from Aegisdottir et al. Includes: - MAGMA using GTEx bulk RNAseq reference data - MAGMA using human brain atlas single cell RNAseq reference data - S-LDSC using standard reference datasets.</p> Source code in <code>mecfs_bio/analysis/syncope.py</code> <pre><code>def run_syncope_analysis():\n    \"\"\"\n    Analyze GWAS of syncope from Aegisdottir et al.\n    Includes:\n    - MAGMA using GTEx bulk RNAseq reference data\n    - MAGMA using human brain atlas single cell RNAseq reference data\n    - S-LDSC using standard reference datasets.\n    \"\"\"\n    DEFAULT_RUNNER.run(\n        [\n            AEGISDOTTIR_ET_AL_RAW_SYNCOPE_DATA,\n        ]\n        + SYNCOPE_S_LDSC_TASKS.get_terminal_tasks()\n        + HBA_MAGMA_AEGISDOTTIR_SYCNOPE_GWAS.terminal_tasks()\n        + AEGISDOTTIR_COMBINED_MAGMA_TASKS.inner.terminal_tasks(),\n        incremental_save=True,\n        must_rebuild_transitive=[AEGISDOTTIR_COMBINED_MAGMA_TASKS.sumstats_task],\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/","title":"asset_generator","text":""},{"location":"reference/mecfs_bio/asset_generator/#mecfs_bio.asset_generator","title":"mecfs_bio.asset_generator","text":"<p>Convenience functions to generate multiple related Tasks.</p> <p>Modules:</p> <ul> <li> <code>annovar_37_basic_rsid_assignment</code>           \u2013            <p>Asset generator for assigning RSIDS to genome build-37 GWS datasets.</p> </li> <li> <code>concrete_magma_asset_generator</code>           \u2013            <p>Generates MAGMA tasks using standard reference data</p> </li> <li> <code>concrete_sldsc_generator</code>           \u2013            <p>Asset generator for applying S-LDSC using standard reference datasets.</p> </li> <li> <code>concrete_standard_analysis_task_generator</code>           \u2013            <p>Task generators that apply a collection of standard analysis techniques to GWAS summary statistics using standard reference data.</p> </li> <li> <code>fine_mapping_asset_generator</code>           \u2013            <p>Asset generator for fine mapping with SUSIE</p> </li> <li> <code>genetic_correlation_asset_generator</code>           \u2013            <p>Task generator that, given a list of tasks that generate gwaslab sumstats,</p> </li> <li> <code>hba_magma_asset_generator</code>           \u2013            <p>Asset generator for applying MAGMA gene property analysis using the Human Brain Atlas scRNAseq data as a reference.</p> </li> <li> <code>labeled_lead_variants_asset_generator</code>           \u2013            </li> <li> <code>mr_with_cis_pqtl_asset_generator</code>           \u2013            <p>Asset generator for applying Mendelian Randomization using cis-pQTLs from the UK Biobank</p> </li> <li> <code>ukbb_broad_ld_matrix_generator</code>           \u2013            <p>Asset generator to automatically determine the optimal UKBB LD matrix to use for fine-mapping</p> </li> <li> <code>ukbb_ppp_single_gwas_generator</code>           \u2013            <p>Asset generator for downloading and preprocessing data from the UK Biobank Pharma Proteomics Project.</p> </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/annovar_37_basic_rsid_assignment/","title":"annovar_37_basic_rsid_assignment","text":""},{"location":"reference/mecfs_bio/asset_generator/annovar_37_basic_rsid_assignment/#mecfs_bio.asset_generator.annovar_37_basic_rsid_assignment","title":"mecfs_bio.asset_generator.annovar_37_basic_rsid_assignment","text":"<p>Asset generator for assigning RSIDS to genome build-37 GWS datasets.</p> <p>Classes:</p> <ul> <li> <code>RSIDAssignmentTaskGroup</code>           \u2013            <p>Collection of tasks used to assign RSIDS by joining with an existing dataframe of SNPs</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>annovar_37_basic_rsid_assignment</code>             \u2013              <p>Asset generator that creates a chain of tasks to assign rsids to existing build 37 sumstats datasets using the annovar dbSNP reference data</p> </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/annovar_37_basic_rsid_assignment/#mecfs_bio.asset_generator.annovar_37_basic_rsid_assignment.RSIDAssignmentTaskGroup","title":"RSIDAssignmentTaskGroup","text":"<p>Collection of tasks used to assign RSIDS by joining with an existing dataframe of SNPs</p> <p>Attributes:</p> <ul> <li> <code>dump_parquet_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>harmonize_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>join_task</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/annovar_37_basic_rsid_assignment/#mecfs_bio.asset_generator.annovar_37_basic_rsid_assignment.RSIDAssignmentTaskGroup.dump_parquet_task","title":"dump_parquet_task  <code>instance-attribute</code>","text":"<pre><code>dump_parquet_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/annovar_37_basic_rsid_assignment/#mecfs_bio.asset_generator.annovar_37_basic_rsid_assignment.RSIDAssignmentTaskGroup.harmonize_task","title":"harmonize_task  <code>instance-attribute</code>","text":"<pre><code>harmonize_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/annovar_37_basic_rsid_assignment/#mecfs_bio.asset_generator.annovar_37_basic_rsid_assignment.RSIDAssignmentTaskGroup.join_task","title":"join_task  <code>instance-attribute</code>","text":"<pre><code>join_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/annovar_37_basic_rsid_assignment/#mecfs_bio.asset_generator.annovar_37_basic_rsid_assignment.annovar_37_basic_rsid_assignment","title":"annovar_37_basic_rsid_assignment","text":"<pre><code>annovar_37_basic_rsid_assignment(\n    sumstats_task: Task,\n    base_name: str,\n    use_gwaslab_rsids_convention: bool = False,\n    drop_palindromic_ambiguous: bool = True,\n) -&gt; RSIDAssignmentTaskGroup\n</code></pre> <p>Asset generator that creates a chain of tasks to assign rsids to existing build 37 sumstats datasets using the annovar dbSNP reference data</p> Source code in <code>mecfs_bio/asset_generator/annovar_37_basic_rsid_assignment.py</code> <pre><code>def annovar_37_basic_rsid_assignment(\n    sumstats_task: Task,\n    base_name: str,\n    use_gwaslab_rsids_convention: bool = False,\n    drop_palindromic_ambiguous: bool = True,\n) -&gt; RSIDAssignmentTaskGroup:\n    \"\"\"\n    Asset generator that creates a chain of tasks to assign rsids to existing build 37 sumstats datasets using the annovar dbSNP reference data\n    \"\"\"\n    harmonized_task = GWASLabTransformSumstatsTask.create_from_source_task(\n        sumstats_task,\n        asset_id=base_name + \"__harmonized\",\n        spec=GwasLabTransformSpec(\n            harmonize_options=HarmonizationOptions(\n                ref_infer=GWASLabVCFRef(name=\"1kg_eur_hg19\", ref_alt_freq=\"AF\"),\n                ref_seq=\"ucsc_genome_hg19\",\n                check_ref_files=True,\n                drop_missing_from_ref_seq=True,\n                drop_missing_from_ref_infer_or_ambiguous=drop_palindromic_ambiguous,\n                cores=4,\n            )\n        ),\n    )\n    dump_parquet_task = GwasLabSumstatsToTableTask.create_from_source_task(\n        source_tsk=harmonized_task,\n        asset_id=base_name + \"_harmonized_dump_to_parquet\",\n        sub_dir=\"processed\",\n    )\n    out_pipe: DataProcessingPipe\n    if use_gwaslab_rsids_convention:\n        out_pipe = RenameColPipe(old_name=\"rsid\", new_name=\"rsID\")\n    else:\n        out_pipe = IdentityPipe()\n    join_with_rsid_task = JoinDataFramesTask.create_from_result_df(\n        asset_id=base_name + \"_assign_rsids_via_dbsnp150\",\n        result_df_task=dump_parquet_task,\n        reference_df_task=PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_UNIQUE_DIRECT_DOWNLOAD,\n        left_on=[\"CHR\", \"POS\", \"EA\", \"NEA\"],\n        right_on=[\"int_chrom\", \"POS\", \"ALT\", \"REF\"],\n        out_format=ParquetOutFormat(),\n        how=\"inner\",\n        df_1_pipe=CompositePipe(\n            [\n                CastPipe(\n                    target_column=\"EA\",\n                    type=narwhals.dtypes.String(),\n                    new_col_name=\"EA\",\n                ),\n                CastPipe(\n                    target_column=\"NEA\",\n                    type=narwhals.dtypes.String(),\n                    new_col_name=\"NEA\",\n                ),\n            ]\n        ),\n        backend=\"ibis\",\n        out_pipe=out_pipe,\n    )\n    group = RSIDAssignmentTaskGroup(\n        harmonize_task=harmonized_task,\n        dump_parquet_task=dump_parquet_task,\n        join_task=join_with_rsid_task,\n    )\n    return group\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/concrete_magma_asset_generator/","title":"concrete_magma_asset_generator","text":""},{"location":"reference/mecfs_bio/asset_generator/concrete_magma_asset_generator/#mecfs_bio.asset_generator.concrete_magma_asset_generator","title":"mecfs_bio.asset_generator.concrete_magma_asset_generator","text":"<p>Generates MAGMA tasks using standard reference data</p> <p>Functions:</p> <ul> <li> <code>concrete_magma_assets_generate</code>             \u2013              <p>Function to generate tasks that apply MAGMA to a GWAS summary statistics dataset using standard reference data.</p> </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/concrete_magma_asset_generator/#mecfs_bio.asset_generator.concrete_magma_asset_generator.concrete_magma_assets_generate","title":"concrete_magma_assets_generate","text":"<pre><code>concrete_magma_assets_generate(\n    base_name: str,\n    raw_gwas_data_task: Task,\n    fmt: ValidGwaslabFormat,\n    sample_size: int,\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n    gget_settings: GGetSettings | None = GGetSettings(50),\n    number_of_bars: int = 20,\n) -&gt; MagmaTaskGeneratorFromRaw\n</code></pre> <p>Function to generate tasks that apply MAGMA to a GWAS summary statistics dataset using standard reference data.</p> Source code in <code>mecfs_bio/asset_generator/concrete_magma_asset_generator.py</code> <pre><code>def concrete_magma_assets_generate(\n    base_name: str,\n    raw_gwas_data_task: Task,\n    fmt: ValidGwaslabFormat,\n    sample_size: int,\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n    gget_settings: GGetSettings | None = GGetSettings(50),\n    number_of_bars: int = 20,\n) -&gt; MagmaTaskGeneratorFromRaw:\n    \"\"\"\n    Function to generate tasks that apply MAGMA to a GWAS summary statistics dataset using standard reference data.\n    \"\"\"\n    return MagmaTaskGeneratorFromRaw.create(\n        raw_gwas_data_task=raw_gwas_data_task,\n        base_name=base_name,\n        sample_size=sample_size,\n        magma_binary_task=MAGMA_1_1_BINARY_EXTRACTED,\n        gene_loc_file_task=MAGMA_ENSEMBL_GENE_LOCATION_REFERENCE_DATA_BUILD_37_RAW,\n        magma_ld_ref_task=MAGMA_EUR_BUILD_37_1K_GENOMES_EXTRACTED,\n        tissue_expression_gene_set_task=GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_PREP_FOR_MAGMA,\n        fmt=fmt,\n        pre_pipe=pre_pipe,\n        gene_thesaurus_task=GENE_THESAURUS,\n        gget_settings=gget_settings,\n        number_of_bars=number_of_bars,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/concrete_sldsc_generator/","title":"concrete_sldsc_generator","text":""},{"location":"reference/mecfs_bio/asset_generator/concrete_sldsc_generator/#mecfs_bio.asset_generator.concrete_sldsc_generator","title":"mecfs_bio.asset_generator.concrete_sldsc_generator","text":"<p>Asset generator for applying S-LDSC using standard reference datasets.</p> <p>Functions:</p> <ul> <li> <code>standard_sldsc_task_generator</code>             \u2013              <p>Standardized task generator for applying S-LSDC to GWAS summary statistics</p> </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/concrete_sldsc_generator/#mecfs_bio.asset_generator.concrete_sldsc_generator.standard_sldsc_task_generator","title":"standard_sldsc_task_generator","text":"<pre><code>standard_sldsc_task_generator(\n    sumstats_task: Task,\n    base_name: str,\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n) -&gt; SLDSCTaskGenerator\n</code></pre> <p>Standardized task generator for applying S-LSDC to GWAS summary statistics</p> <p>as described in \"Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types.\" Nature genetics 50.4 (2018): 621-629.</p> <p>using the standard partitioning datasets provided by the authors of that paper</p> Source code in <code>mecfs_bio/asset_generator/concrete_sldsc_generator.py</code> <pre><code>def standard_sldsc_task_generator(\n    sumstats_task: Task,\n    base_name: str,\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n) -&gt; SLDSCTaskGenerator:\n    \"\"\"\n    Standardized task generator for applying S-LSDC to GWAS summary statistics\n\n    as described in\n    \"Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types.\" Nature genetics 50.4 (2018): 621-629.\n\n    using the standard partitioning datasets provided by the authors of that paper\n\n    \"\"\"\n    result = SLDSCTaskGenerator.create(\n        base_name=base_name,\n        source_sumstats_task=sumstats_task,\n        ref_ld_chr_task=BASE_MODEL_PARTITIONED_LD_SCORES_EXTRACTED,\n        ref_ld_chr_inner_dirname=\"baseline_v1.2/baseline.@\",\n        w_ld_chr_task=PARTITIONED_MODEL_REGRESSION_WEIGHTS_EXTRACTED,\n        w_ld_chr_inner_dirname=\"1000G_Phase3_weights_hm3_no_MHC/weights.hm3_noMHC.@\",\n        partitioned_entries=[\n            PartitionedLDScoresRecord(\n                ref_ld_chr_cts_task=PARTITIONED_MODEL_CAHOY_LD_SCORES_EXTRACTED_RD,\n                ref_ld_chr_cts_filename=\"Cahoy.ldcts\",\n                cell_or_tissue_labels_task=None,\n                entry_name=\"cahoy_cns\",\n            ),\n            PartitionedLDScoresRecord(\n                ref_ld_chr_cts_task=PARTITIONED_MODEL_GTEX_BRAIN_LD_SCORES_EXTRACTED_RD,\n                ref_ld_chr_cts_filename=\"GTEx_brain.ldcts\",\n                cell_or_tissue_labels_task=None,\n                entry_name=\"gtex_brain\",\n            ),\n            PartitionedLDScoresRecord(\n                ref_ld_chr_cts_task=PARTITIONED_MODEL_IMMGEN_LD_SCORES_EXTRACTED_RD,\n                ref_ld_chr_cts_filename=\"ImmGen.ldcts\",\n                cell_or_tissue_labels_task=CellOrTissueLabelRecord(\n                    FICUANE_2018_IMMGEN_CATEGORIES,\n                    pipe_left=CompositePipe(\n                        [\n                            StrLowercasePipe(\n                                target_column=\"Name\",\n                                new_column_name=\"lower case name\",\n                            ),\n                        ],\n                    ),\n                    pipe_right=CompositePipe(\n                        [\n                            StrLowercasePipe(\n                                target_column=\"Cell Type\",\n                                new_column_name=\"lower case name\",\n                            )\n                        ]\n                    ),\n                    left_join_on=\"lower case name\",\n                    right_join_on=\"lower case name\",\n                ),\n                entry_name=\"immgen\",\n            ),\n            PartitionedLDScoresRecord(\n                ref_ld_chr_cts_task=PARTITIONED_MODEL_CORCES_ATAC_LD_SCORES_EXTRACTED_RD,\n                ref_ld_chr_cts_filename=\"Corces_ATAC.ldcts\",\n                cell_or_tissue_labels_task=None,\n                entry_name=\"corces_atac\",\n            ),\n            PartitionedLDScoresRecord(\n                ref_ld_chr_cts_task=PARTITIONED_MODEL_MULTI_TISSUE_CHROMATIN_LD_SCORES_EXTRACTED_RD,\n                ref_ld_chr_cts_filename=\"Multi_tissue_chromatin.ldcts\",\n                entry_name=\"multi_tissue_chromatin\",\n                cell_or_tissue_labels_task=CellOrTissueLabelRecord(\n                    ROADMAP_CELL_TYPE_CATEGORIES_FOR_LDSC,\n                    pipe_left=CompositePipe(\n                        [\n                            SplitExactColPipe(\n                                col_to_split=\"Name\",\n                                split_by=\"__\",\n                                new_col_names=(\"Cell\", \"Epigenetic_Assay\"),\n                            ),\n                            StrReplacePipe(\n                                target_column=\"Cell\",\n                                new_column_name=\"Cell\",\n                                replace_what=\"_ENTEX\",\n                                replace_with=\"\",\n                            ),\n                            StrLowercasePipe(\n                                target_column=\"Cell\",\n                                new_column_name=\"Cell\",\n                            ),\n                        ],\n                    ),\n                    pipe_right=CompositePipe(\n                        [\n                            StrLowercasePipe(\n                                target_column=\"Cell Type\", new_column_name=\"Cell type\"\n                            )\n                        ]\n                    ),\n                    left_join_on=\"Cell\",\n                    right_join_on=\"Cell type\",\n                ),\n            ),\n            PartitionedLDScoresRecord(\n                ref_ld_chr_cts_task=PARTITIONED_MODEL_MULTI_TISSUE_GENE_EXPR_LD_SCORES_EXTRACTED_RD,\n                ref_ld_chr_cts_filename=\"Multi_tissue_gene_expr.ldcts\",\n                cell_or_tissue_labels_task=CellOrTissueLabelRecord(\n                    FICUANE_2018_FRANKE_GTEX_CATEGORIES,\n                    pipe_left=CompositePipe(\n                        [\n                            StrLowercasePipe(\n                                target_column=\"Name\", new_column_name=\"Name\"\n                            ),\n                            StrReplacePipe(\n                                target_column=\"Name\",\n                                new_column_name=\"Name\",\n                                replace_what=\" \",\n                                replace_with=\"_\",\n                            ),\n                        ]\n                    ),\n                    pipe_right=CompositePipe(\n                        [\n                            StrLowercasePipe(\n                                target_column=\"Tissue_Or_Cell\",\n                                new_column_name=\"Tissue_Or_Cell\",\n                            ),\n                            StrReplacePipe(\n                                target_column=\"Tissue_Or_Cell\",\n                                new_column_name=\"Tissue_Or_Cell\",\n                                replace_what=\" \",\n                                replace_with=\"_\",\n                            ),\n                        ]\n                    ),\n                ),\n                entry_name=\"multi_tissue_gene_expression\",\n            ),\n        ],\n        multiple_testing_alpha=0.01,\n        multiple_testing_method=\"fdr_bh\",\n        pre_pipe=pre_pipe,\n    )\n    return result\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/concrete_standard_analysis_task_generator/","title":"concrete_standard_analysis_task_generator","text":""},{"location":"reference/mecfs_bio/asset_generator/concrete_standard_analysis_task_generator/#mecfs_bio.asset_generator.concrete_standard_analysis_task_generator","title":"mecfs_bio.asset_generator.concrete_standard_analysis_task_generator","text":"<p>Task generators that apply a collection of standard analysis techniques to GWAS summary statistics using standard reference data.</p> <p>Classes:</p> <ul> <li> <code>StandardAnalysisTaskGroup</code>           \u2013            <p>Collection of standard analysis tasks for GWAS summary statistics.</p> </li> <li> <code>StandardAnalysisTaskGroupAddRSIDS</code>           \u2013            <p>Collection to tasks to assign rsids to GWAS data, then apply standard analysis techniques.</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>concrete_standard_analysis_generator_assume_already_has_rsid</code>             \u2013              <p>Generate standard MAGMA and S-LDSC analysis tasks for given GWAS data,</p> </li> <li> <code>concrete_standard_analysis_generator_no_rsid</code>             \u2013              <p>Generate standard MAGMA and S-LDSC analysis tasks for given GWAS data,</p> </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/concrete_standard_analysis_task_generator/#mecfs_bio.asset_generator.concrete_standard_analysis_task_generator.StandardAnalysisTaskGroup","title":"StandardAnalysisTaskGroup","text":"<p>Collection of standard analysis tasks for GWAS summary statistics.</p> <p>Methods:</p> <ul> <li> <code>get_terminal_tasks</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>hba_magma_tasks</code>               (<code>HBAMagmaTasks | None</code>)           \u2013            </li> <li> <code>labeled_lead_variant_tasks</code>               (<code>LabelLeadVariantsTasks</code>)           \u2013            </li> <li> <code>magma_tasks</code>               (<code>MagmaTaskGeneratorFromRaw</code>)           \u2013            </li> <li> <code>master_gene_list_tasks</code>               (<code>MasterGeneListTasks | None</code>)           \u2013            </li> <li> <code>sldsc_tasks</code>               (<code>SLDSCTaskGenerator</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/concrete_standard_analysis_task_generator/#mecfs_bio.asset_generator.concrete_standard_analysis_task_generator.StandardAnalysisTaskGroup.hba_magma_tasks","title":"hba_magma_tasks  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>hba_magma_tasks: HBAMagmaTasks | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/concrete_standard_analysis_task_generator/#mecfs_bio.asset_generator.concrete_standard_analysis_task_generator.StandardAnalysisTaskGroup.labeled_lead_variant_tasks","title":"labeled_lead_variant_tasks  <code>instance-attribute</code>","text":"<pre><code>labeled_lead_variant_tasks: LabelLeadVariantsTasks\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/concrete_standard_analysis_task_generator/#mecfs_bio.asset_generator.concrete_standard_analysis_task_generator.StandardAnalysisTaskGroup.magma_tasks","title":"magma_tasks  <code>instance-attribute</code>","text":"<pre><code>magma_tasks: MagmaTaskGeneratorFromRaw\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/concrete_standard_analysis_task_generator/#mecfs_bio.asset_generator.concrete_standard_analysis_task_generator.StandardAnalysisTaskGroup.master_gene_list_tasks","title":"master_gene_list_tasks  <code>instance-attribute</code>","text":"<pre><code>master_gene_list_tasks: MasterGeneListTasks | None\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/concrete_standard_analysis_task_generator/#mecfs_bio.asset_generator.concrete_standard_analysis_task_generator.StandardAnalysisTaskGroup.sldsc_tasks","title":"sldsc_tasks  <code>instance-attribute</code>","text":"<pre><code>sldsc_tasks: SLDSCTaskGenerator\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/concrete_standard_analysis_task_generator/#mecfs_bio.asset_generator.concrete_standard_analysis_task_generator.StandardAnalysisTaskGroup.get_terminal_tasks","title":"get_terminal_tasks","text":"<pre><code>get_terminal_tasks() -&gt; list[Task]\n</code></pre> Source code in <code>mecfs_bio/asset_generator/concrete_standard_analysis_task_generator.py</code> <pre><code>def get_terminal_tasks(self) -&gt; list[Task]:\n    result = (\n        list(self.sldsc_tasks.get_terminal_tasks())\n        + self.magma_tasks.inner.terminal_tasks()\n        + self.labeled_lead_variant_tasks.terminal_tasks()\n    )\n    if self.master_gene_list_tasks is not None:\n        result = result + self.master_gene_list_tasks.terminal_tasks()\n    if self.hba_magma_tasks is not None:\n        result.extend(self.hba_magma_tasks.terminal_tasks())\n    return result\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/concrete_standard_analysis_task_generator/#mecfs_bio.asset_generator.concrete_standard_analysis_task_generator.StandardAnalysisTaskGroupAddRSIDS","title":"StandardAnalysisTaskGroupAddRSIDS","text":"<p>Collection to tasks to assign rsids to GWAS data, then apply standard analysis techniques.</p> <p>Methods:</p> <ul> <li> <code>terminal_tasks</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>assign_rsids_task_group</code>               (<code>RSIDAssignmentTaskGroup</code>)           \u2013            </li> <li> <code>initial_sumstats_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>tasks</code>               (<code>StandardAnalysisTaskGroup</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/concrete_standard_analysis_task_generator/#mecfs_bio.asset_generator.concrete_standard_analysis_task_generator.StandardAnalysisTaskGroupAddRSIDS.assign_rsids_task_group","title":"assign_rsids_task_group  <code>instance-attribute</code>","text":"<pre><code>assign_rsids_task_group: RSIDAssignmentTaskGroup\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/concrete_standard_analysis_task_generator/#mecfs_bio.asset_generator.concrete_standard_analysis_task_generator.StandardAnalysisTaskGroupAddRSIDS.initial_sumstats_task","title":"initial_sumstats_task  <code>instance-attribute</code>","text":"<pre><code>initial_sumstats_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/concrete_standard_analysis_task_generator/#mecfs_bio.asset_generator.concrete_standard_analysis_task_generator.StandardAnalysisTaskGroupAddRSIDS.tasks","title":"tasks  <code>instance-attribute</code>","text":"<pre><code>tasks: StandardAnalysisTaskGroup\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/concrete_standard_analysis_task_generator/#mecfs_bio.asset_generator.concrete_standard_analysis_task_generator.StandardAnalysisTaskGroupAddRSIDS.terminal_tasks","title":"terminal_tasks","text":"<pre><code>terminal_tasks() -&gt; list[Task]\n</code></pre> Source code in <code>mecfs_bio/asset_generator/concrete_standard_analysis_task_generator.py</code> <pre><code>def terminal_tasks(self) -&gt; list[Task]:\n    return list(self.tasks.get_terminal_tasks())\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/concrete_standard_analysis_task_generator/#mecfs_bio.asset_generator.concrete_standard_analysis_task_generator.concrete_standard_analysis_generator_assume_already_has_rsid","title":"concrete_standard_analysis_generator_assume_already_has_rsid","text":"<pre><code>concrete_standard_analysis_generator_assume_already_has_rsid(\n    base_name: str,\n    raw_gwas_data_task: Task,\n    fmt: ValidGwaslabFormat,\n    sample_size: int,\n    sample_size_for_sldsc: int | None = None,\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n    pre_sldsc_pipe: DataProcessingPipe = IdentityPipe(),\n    include_master_gene_lists: bool = True,\n    include_hba_magma_tasks: bool = False,\n    include_independent_cluster_plot_in_hba: bool = False,\n    hba_plot_settings: PlotSettings = PlotSettings(),\n    gtex_magma_number_of_bars: int = 20,\n    hba_indep_plot_options: HBAIndepPlotOptions = HBAIndepPlotOptions(),\n) -&gt; StandardAnalysisTaskGroup\n</code></pre> <p>Generate standard MAGMA and S-LDSC analysis tasks for given GWAS data, assuming that GWAS data already contains rsids</p> Source code in <code>mecfs_bio/asset_generator/concrete_standard_analysis_task_generator.py</code> <pre><code>def concrete_standard_analysis_generator_assume_already_has_rsid(\n    base_name: str,\n    raw_gwas_data_task: Task,\n    fmt: ValidGwaslabFormat,\n    sample_size: int,\n    sample_size_for_sldsc: int | None = None,\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n    pre_sldsc_pipe: DataProcessingPipe = IdentityPipe(),\n    include_master_gene_lists: bool = True,\n    include_hba_magma_tasks: bool = False,\n    include_independent_cluster_plot_in_hba: bool = False,\n    hba_plot_settings: PlotSettings = PlotSettings(),\n    gtex_magma_number_of_bars: int = 20,\n    hba_indep_plot_options: HBAIndepPlotOptions = HBAIndepPlotOptions(),\n) -&gt; StandardAnalysisTaskGroup:\n    \"\"\"\n    Generate standard MAGMA and S-LDSC analysis tasks for given GWAS data,\n    assuming that GWAS data already contains rsids\n    \"\"\"\n\n    labeled_lead_variant_task_group = generate_tasks_labeled_lead_variants(\n        base_name=base_name,\n        raw_gwas_data_task=raw_gwas_data_task,\n        fmt=fmt,\n        pre_pipe=pre_pipe,\n    )\n    magma_tasks = concrete_magma_assets_generate(\n        base_name=base_name,\n        raw_gwas_data_task=raw_gwas_data_task,\n        fmt=fmt,\n        sample_size=sample_size,\n        pre_pipe=pre_pipe,\n        number_of_bars=gtex_magma_number_of_bars,\n    )\n    sldsc_ss = (\n        sample_size_for_sldsc if sample_size_for_sldsc is not None else sample_size\n    )\n    pre_sldsc_pipe = CompositePipe(\n        [\n            SetColToConstantPipe(\n                col_name=GWASLAB_SAMPLE_SIZE_COLUMN, constant=sldsc_ss\n            ),\n            pre_sldsc_pipe,\n        ]\n    )\n\n    sldsc_tasks = standard_sldsc_task_generator(\n        sumstats_task=magma_tasks.sumstats_task,\n        base_name=base_name,\n        pre_pipe=pre_sldsc_pipe,\n    )\n    if include_master_gene_lists:\n        master_gene_list_tasks = generate_master_gene_list_tasks(\n            base_name=base_name,\n            gene_sources=[\n                SrcGeneList(\n                    task=magma_tasks.inner.filtered_gene_analysis_task,\n                    name=\"MAGMA\",\n                    ensemble_id_column=\"GENE\",\n                ),\n                SrcGeneList(\n                    task=labeled_lead_variant_task_group.labeled_lead_variants_task,\n                    name=\"GWASLAB\",\n                    ensemble_id_column=\"Gene stable ID\",\n                ),\n            ],\n        )\n    else:\n        master_gene_list_tasks = None\n    if include_hba_magma_tasks:\n        hba_magma = generate_human_brain_atlas_magma_tasks(\n            base_name=base_name,\n            gwas_parquet_with_rsids_task=magma_tasks.parquet_file_task,\n            sample_size=sample_size,\n            plot_settings=hba_plot_settings,\n            include_independent_cluster_plot=include_independent_cluster_plot_in_hba,\n            hba_indep_plot_options=hba_indep_plot_options,\n        )\n    else:\n        hba_magma = None\n\n    return StandardAnalysisTaskGroup(\n        sldsc_tasks=sldsc_tasks,\n        magma_tasks=magma_tasks,\n        labeled_lead_variant_tasks=labeled_lead_variant_task_group,\n        master_gene_list_tasks=master_gene_list_tasks,\n        hba_magma_tasks=hba_magma,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/concrete_standard_analysis_task_generator/#mecfs_bio.asset_generator.concrete_standard_analysis_task_generator.concrete_standard_analysis_generator_no_rsid","title":"concrete_standard_analysis_generator_no_rsid","text":"<pre><code>concrete_standard_analysis_generator_no_rsid(\n    base_name: str,\n    raw_gwas_data_task: Task,\n    fmt: ValidGwaslabFormat,\n    sample_size: int,\n    sample_size_for_sldsc: int | None = None,\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n    pre_sldsc_pipe: DataProcessingPipe = IdentityPipe(),\n    include_master_gene_lists: bool = True,\n) -&gt; StandardAnalysisTaskGroupAddRSIDS\n</code></pre> <p>Generate standard MAGMA and S-LDSC analysis tasks for given GWAS data, Assume that the GWAS data does not contain rsids,and so these need to be assigned.</p> Source code in <code>mecfs_bio/asset_generator/concrete_standard_analysis_task_generator.py</code> <pre><code>def concrete_standard_analysis_generator_no_rsid(\n    base_name: str,\n    raw_gwas_data_task: Task,\n    fmt: ValidGwaslabFormat,\n    sample_size: int,\n    sample_size_for_sldsc: int | None = None,\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n    pre_sldsc_pipe: DataProcessingPipe = IdentityPipe(),\n    include_master_gene_lists: bool = True,\n) -&gt; StandardAnalysisTaskGroupAddRSIDS:\n    \"\"\"\n\n    Generate standard MAGMA and S-LDSC analysis tasks for given GWAS data,\n    Assume that the GWAS data does not contain rsids,and so these need to be assigned.\n\n    \"\"\"\n    sumstats_37_task = GWASLabCreateSumstatsTask(\n        df_source_task=raw_gwas_data_task,\n        asset_id=AssetId(base_name + \"_initial_sumstats_37\"),\n        basic_check=True,\n        genome_build=\"infer\",\n        liftover_to=\"19\",\n        fmt=fmt,\n        pre_pipe=pre_pipe,\n    )\n    rsids_assigned_task_group = annovar_37_basic_rsid_assignment(\n        sumstats_task=sumstats_37_task,\n        base_name=base_name,\n        use_gwaslab_rsids_convention=True,\n    )\n    standard_tasks = concrete_standard_analysis_generator_assume_already_has_rsid(\n        base_name=base_name,\n        raw_gwas_data_task=rsids_assigned_task_group.join_task,\n        fmt=\"gwaslab\",\n        sample_size=sample_size,\n        pre_pipe=pre_pipe,\n        pre_sldsc_pipe=pre_sldsc_pipe,\n        sample_size_for_sldsc=sample_size_for_sldsc,\n        include_master_gene_lists=include_master_gene_lists,\n    )\n    return StandardAnalysisTaskGroupAddRSIDS(\n        tasks=standard_tasks,\n        initial_sumstats_task=sumstats_37_task,\n        assign_rsids_task_group=rsids_assigned_task_group,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/fine_mapping_asset_generator/","title":"fine_mapping_asset_generator","text":""},{"location":"reference/mecfs_bio/asset_generator/fine_mapping_asset_generator/#mecfs_bio.asset_generator.fine_mapping_asset_generator","title":"mecfs_bio.asset_generator.fine_mapping_asset_generator","text":"<p>Asset generator for fine mapping with SUSIE</p> <p>Classes:</p> <ul> <li> <code>BroadFineMapTaskGroup</code>           \u2013            </li> </ul> <p>Functions:</p> <ul> <li> <code>generate_assets_broad_ukbb_fine_map</code>             \u2013              <p>Asset generator for fine mapping using SUSIE.</p> </li> <li> <code>markdown_cs_table_task</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/fine_mapping_asset_generator/#mecfs_bio.asset_generator.fine_mapping_asset_generator.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/fine_mapping_asset_generator/#mecfs_bio.asset_generator.fine_mapping_asset_generator.BroadFineMapTaskGroup","title":"BroadFineMapTaskGroup","text":"<p>Methods:</p> <ul> <li> <code>terminal_tasks</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>harmonized_sumstats_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>ld_labels_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>ld_matrix_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>markdown_table_tasks</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>renamed_ld_labels_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>susie_finemap_1_credible_set_plot</code>               (<code>Task</code>)           \u2013            </li> <li> <code>susie_finemap_1_credible_set_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>susie_finemap_2_credible_set_plot</code>               (<code>Task</code>)           \u2013            </li> <li> <code>susie_finemap_2_credible_set_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>susie_finemap_strict_plot</code>               (<code>Task</code>)           \u2013            </li> <li> <code>susie_finemap_strict_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>susie_finemap_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>susie_stackplot_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>upset_plot_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>upset_plot_task_pip001</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/fine_mapping_asset_generator/#mecfs_bio.asset_generator.fine_mapping_asset_generator.BroadFineMapTaskGroup.harmonized_sumstats_task","title":"harmonized_sumstats_task  <code>instance-attribute</code>","text":"<pre><code>harmonized_sumstats_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/fine_mapping_asset_generator/#mecfs_bio.asset_generator.fine_mapping_asset_generator.BroadFineMapTaskGroup.ld_labels_task","title":"ld_labels_task  <code>instance-attribute</code>","text":"<pre><code>ld_labels_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/fine_mapping_asset_generator/#mecfs_bio.asset_generator.fine_mapping_asset_generator.BroadFineMapTaskGroup.ld_matrix_task","title":"ld_matrix_task  <code>instance-attribute</code>","text":"<pre><code>ld_matrix_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/fine_mapping_asset_generator/#mecfs_bio.asset_generator.fine_mapping_asset_generator.BroadFineMapTaskGroup.markdown_table_tasks","title":"markdown_table_tasks  <code>instance-attribute</code>","text":"<pre><code>markdown_table_tasks: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/fine_mapping_asset_generator/#mecfs_bio.asset_generator.fine_mapping_asset_generator.BroadFineMapTaskGroup.renamed_ld_labels_task","title":"renamed_ld_labels_task  <code>instance-attribute</code>","text":"<pre><code>renamed_ld_labels_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/fine_mapping_asset_generator/#mecfs_bio.asset_generator.fine_mapping_asset_generator.BroadFineMapTaskGroup.susie_finemap_1_credible_set_plot","title":"susie_finemap_1_credible_set_plot  <code>instance-attribute</code>","text":"<pre><code>susie_finemap_1_credible_set_plot: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/fine_mapping_asset_generator/#mecfs_bio.asset_generator.fine_mapping_asset_generator.BroadFineMapTaskGroup.susie_finemap_1_credible_set_task","title":"susie_finemap_1_credible_set_task  <code>instance-attribute</code>","text":"<pre><code>susie_finemap_1_credible_set_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/fine_mapping_asset_generator/#mecfs_bio.asset_generator.fine_mapping_asset_generator.BroadFineMapTaskGroup.susie_finemap_2_credible_set_plot","title":"susie_finemap_2_credible_set_plot  <code>instance-attribute</code>","text":"<pre><code>susie_finemap_2_credible_set_plot: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/fine_mapping_asset_generator/#mecfs_bio.asset_generator.fine_mapping_asset_generator.BroadFineMapTaskGroup.susie_finemap_2_credible_set_task","title":"susie_finemap_2_credible_set_task  <code>instance-attribute</code>","text":"<pre><code>susie_finemap_2_credible_set_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/fine_mapping_asset_generator/#mecfs_bio.asset_generator.fine_mapping_asset_generator.BroadFineMapTaskGroup.susie_finemap_strict_plot","title":"susie_finemap_strict_plot  <code>instance-attribute</code>","text":"<pre><code>susie_finemap_strict_plot: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/fine_mapping_asset_generator/#mecfs_bio.asset_generator.fine_mapping_asset_generator.BroadFineMapTaskGroup.susie_finemap_strict_task","title":"susie_finemap_strict_task  <code>instance-attribute</code>","text":"<pre><code>susie_finemap_strict_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/fine_mapping_asset_generator/#mecfs_bio.asset_generator.fine_mapping_asset_generator.BroadFineMapTaskGroup.susie_finemap_task","title":"susie_finemap_task  <code>instance-attribute</code>","text":"<pre><code>susie_finemap_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/fine_mapping_asset_generator/#mecfs_bio.asset_generator.fine_mapping_asset_generator.BroadFineMapTaskGroup.susie_stackplot_task","title":"susie_stackplot_task  <code>instance-attribute</code>","text":"<pre><code>susie_stackplot_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/fine_mapping_asset_generator/#mecfs_bio.asset_generator.fine_mapping_asset_generator.BroadFineMapTaskGroup.upset_plot_task","title":"upset_plot_task  <code>instance-attribute</code>","text":"<pre><code>upset_plot_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/fine_mapping_asset_generator/#mecfs_bio.asset_generator.fine_mapping_asset_generator.BroadFineMapTaskGroup.upset_plot_task_pip001","title":"upset_plot_task_pip001  <code>instance-attribute</code>","text":"<pre><code>upset_plot_task_pip001: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/fine_mapping_asset_generator/#mecfs_bio.asset_generator.fine_mapping_asset_generator.BroadFineMapTaskGroup.terminal_tasks","title":"terminal_tasks","text":"<pre><code>terminal_tasks() -&gt; list[Task]\n</code></pre> Source code in <code>mecfs_bio/asset_generator/fine_mapping_asset_generator.py</code> <pre><code>def terminal_tasks(self) -&gt; list[Task]:\n    return [\n        self.susie_finemap_task,\n        self.susie_stackplot_task,\n        self.susie_finemap_strict_task,\n        self.susie_finemap_strict_plot,\n        self.susie_finemap_1_credible_set_task,\n        self.susie_finemap_1_credible_set_plot,\n        self.susie_finemap_2_credible_set_task,\n        self.susie_finemap_2_credible_set_plot,\n        self.upset_plot_task,\n        self.upset_plot_task_pip001,\n    ] + self.markdown_table_tasks\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/fine_mapping_asset_generator/#mecfs_bio.asset_generator.fine_mapping_asset_generator.generate_assets_broad_ukbb_fine_map","title":"generate_assets_broad_ukbb_fine_map","text":"<pre><code>generate_assets_broad_ukbb_fine_map(\n    chrom: int,\n    pos: int,\n    build_37_sumstats_task: Task,\n    base_name: str,\n    sumstats_pipe: DataProcessingPipe,\n    sample_size_or_effect_sample_size: int,\n    chrom_range: ChromRange | None = None,\n    palindrome_strategy: PalindromeStrategy = \"drop\",\n) -&gt; BroadFineMapTaskGroup\n</code></pre> <p>Asset generator for fine mapping using SUSIE. by default, calls SUSIE with a number of different parameter settings to check how the results are affected</p> Source code in <code>mecfs_bio/asset_generator/fine_mapping_asset_generator.py</code> <pre><code>def generate_assets_broad_ukbb_fine_map(\n    chrom: int,\n    pos: int,\n    build_37_sumstats_task: Task,\n    base_name: str,\n    sumstats_pipe: DataProcessingPipe,\n    sample_size_or_effect_sample_size: int,\n    chrom_range: ChromRange | None = None,\n    palindrome_strategy: PalindromeStrategy = \"drop\",\n) -&gt; BroadFineMapTaskGroup:\n    \"\"\"\n    Asset generator for fine mapping using SUSIE.\n    by default, calls SUSIE with a number of different parameter settings to check how the results are affected\n    \"\"\"\n\n    interval = get_optimal_ukbb_ld_interval(\n        chrom=chrom,\n        pos=pos,\n    )\n    if chrom_range is not None:\n        assert chrom == chrom_range.chrom\n        assert pos &gt;= chrom_range.start\n        assert pos &lt;= chrom_range.end\n        assert interval.start &lt;= chrom_range.start\n        assert chrom_range.end &lt;= interval.end\n        base_name = (\n            base_name + f\"chr{chrom_range.chrom}_{chrom_range.start}_{chrom_range.end}\"\n        )\n    else:\n        stem = get_genomic_interval_stem_name(interval)\n        base_name = base_name + \"_\" + stem\n    if palindrome_strategy != \"drop\":\n        base_name = base_name + \"_palindromes_\" + palindrome_strategy\n\n    logger.debug(\n        f\"To finemap position {pos} on chromosome {chrom}, interval {interval} was selected.\"\n    )\n    ld_labels_task, ld_matrix_task = (\n        get_ld_labels_and_matrix_task_for_genomic_interval_build_37(\n            interval=interval,\n        )\n    )\n\n    ld_labels_task_renamed = PipeDataFrameTask.create(\n        source_task=ld_labels_task,\n        asset_id=ld_labels_task.asset_id + \"_renamed\",\n        out_format=ParquetOutFormat(),\n        pipes=[\n            RenameColPipe(old_name=\"rsid\", new_name=GWASLAB_RSID_COL),\n            RenameColPipe(old_name=\"chromosome\", new_name=GWASLAB_CHROM_COL),\n            RenameColPipe(old_name=\"position\", new_name=GWASLAB_POS_COL),\n            RenameColPipe(\n                old_name=\"allele1\",\n                new_name=GWASLAB_NON_EFFECT_ALLELE_COL,\n                # See: https://github.com/omerwe/polyfun/issues/208#issuecomment-2563832487\n            ),\n            RenameColPipe(old_name=\"allele2\", new_name=GWASLAB_EFFECT_ALLELE_COL),\n        ],\n        backend=\"polars\",\n    )\n\n    harmonized_sumstats_task = HarmonizeGWASWithReferenceViaAlleles.create(\n        asset_id=base_name + \"_gwas_harmonized_with_ref\",\n        gwas_data_task=build_37_sumstats_task,\n        reference_task=ld_labels_task_renamed,\n        palindrome_strategy=palindrome_strategy,\n        gwas_pipe=CompositePipe(\n            [\n                sumstats_pipe,\n                UniquePipe(\n                    by=[\n                        GWASLAB_CHROM_COL,\n                        GWASLAB_POS_COL,\n                        GWASLAB_EFFECT_ALLELE_COL,\n                        GWASLAB_NON_EFFECT_ALLELE_COL,\n                    ],\n                    keep=\"none\",\n                    order_by=[\n                        GWASLAB_CHROM_COL,\n                        GWASLAB_POS_COL,\n                        GWASLAB_EFFECT_ALLELE_COL,\n                        GWASLAB_NON_EFFECT_ALLELE_COL,\n                    ],\n                ),\n            ]\n        ),\n        chrom_range_filter=chrom_range,\n    )\n    markdown_table_tasks = []\n    susie_finemap_task = SusieRFinemapTask.create(\n        asset_id=base_name + \"_susie_finemap\",\n        gwas_data_task=harmonized_sumstats_task,\n        ld_labels_task=ld_labels_task_renamed,\n        ld_matrix_source=BroadInstituteFormatLDMatrix(ld_matrix_task),\n        effective_sample_size=sample_size_or_effect_sample_size,\n    )\n    susie_stack_plot_task = SusieStackPlotTask.create(\n        asset_id=base_name + \"_susie_stackplot\",\n        susie_task=susie_finemap_task,\n        gene_info_task=MAGMA_ENSEMBL_GENE_LOCATION_REFERENCE_DATA_BUILD_37_RAW,\n        gene_info_pipe=IdentityPipe(),\n        region_mode=RegionSelectDefault(),\n        heatmap_options=HeatmapOptions(\n            heatmap_bin_options=None, mode=\"ld2\", cmap=\"plasma\"\n        ),\n    )\n    markdown_table_tasks.append(\n        markdown_cs_table_task(\n            susie_finemap_task=susie_finemap_task, base_name=base_name + \"_susie_base\"\n        )\n    )\n\n    susie_finemap_task_strict = SusieRFinemapTask.create(\n        asset_id=base_name + \"_susie_finemap_strict_threshold\",\n        gwas_data_task=harmonized_sumstats_task,\n        ld_labels_task=ld_labels_task_renamed,\n        ld_matrix_source=BroadInstituteFormatLDMatrix(ld_matrix_task),\n        effective_sample_size=sample_size_or_effect_sample_size,\n        z_score_filtering_threshold=1.0,\n    )\n    strict_plot = SusieStackPlotTask.create(\n        asset_id=base_name + \"_susie_stackplot_strict\",\n        susie_task=susie_finemap_task_strict,\n        gene_info_task=MAGMA_ENSEMBL_GENE_LOCATION_REFERENCE_DATA_BUILD_37_RAW,\n        gene_info_pipe=IdentityPipe(),\n        region_mode=RegionSelectDefault(),\n        heatmap_options=HeatmapOptions(\n            heatmap_bin_options=None, mode=\"ld2\", cmap=\"plasma\"\n        ),\n    )\n\n    markdown_table_tasks.append(\n        markdown_cs_table_task(\n            susie_finemap_task=susie_finemap_task_strict,\n            base_name=base_name + \"_susie_strict\",\n        )\n    )\n\n    susie_finemap_task_1_credible_set = SusieRFinemapTask.create(\n        asset_id=base_name + \"_susie_finemap_1_credible_set\",\n        gwas_data_task=harmonized_sumstats_task,\n        ld_labels_task=ld_labels_task_renamed,\n        ld_matrix_source=BroadInstituteFormatLDMatrix(ld_matrix_task),\n        effective_sample_size=sample_size_or_effect_sample_size,\n        max_credible_sets=1,\n    )\n    susie_plot_1_credible_set = SusieStackPlotTask.create(\n        asset_id=base_name + \"_susie_stackplot_1_credible_set\",\n        susie_task=susie_finemap_task_1_credible_set,\n        gene_info_task=MAGMA_ENSEMBL_GENE_LOCATION_REFERENCE_DATA_BUILD_37_RAW,\n        gene_info_pipe=IdentityPipe(),\n        region_mode=RegionSelectDefault(),\n        heatmap_options=HeatmapOptions(\n            heatmap_bin_options=None, mode=\"ld2\", cmap=\"plasma\"\n        ),\n    )\n\n    markdown_table_tasks.append(\n        markdown_cs_table_task(\n            susie_finemap_task=susie_finemap_task_1_credible_set,\n            base_name=base_name + \"_susie_1\",\n        )\n    )\n\n    susie_finemap_task_2_credible_set = SusieRFinemapTask.create(\n        asset_id=base_name + \"_susie_finemap_2_credible_set\",\n        gwas_data_task=harmonized_sumstats_task,\n        ld_labels_task=ld_labels_task_renamed,\n        ld_matrix_source=BroadInstituteFormatLDMatrix(ld_matrix_task),\n        effective_sample_size=sample_size_or_effect_sample_size,\n        max_credible_sets=1,\n    )\n    susie_plot_2_credible_set = SusieStackPlotTask.create(\n        asset_id=base_name + \"_susie_stackplot_2_credible_set\",\n        susie_task=susie_finemap_task_2_credible_set,\n        gene_info_task=MAGMA_ENSEMBL_GENE_LOCATION_REFERENCE_DATA_BUILD_37_RAW,\n        gene_info_pipe=IdentityPipe(),\n        region_mode=RegionSelectDefault(),\n        heatmap_options=HeatmapOptions(\n            heatmap_bin_options=None, mode=\"ld2\", cmap=\"plasma\"\n        ),\n    )\n\n    markdown_table_tasks.append(\n        markdown_cs_table_task(\n            susie_finemap_task=susie_finemap_task_2_credible_set,\n            base_name=base_name + \"_susie_2\",\n        )\n    )\n    variant_id = \"__variant_id\"\n    id_variant_pipe = ConcatStrPipe(\n        target_cols=[\n            GWASLAB_CHROM_COL,\n            GWASLAB_POS_COL,\n            GWASLAB_EFFECT_ALLELE_COL,\n            GWASLAB_NON_EFFECT_ALLELE_COL,\n        ],\n        sep=\"__\",\n        new_col_name=variant_id,\n    )\n\n    filtered_id_variant_pipe_005 = CompositePipe(\n        [id_variant_pipe, FilterRowsByMinInCol(min_value=0.05, col=PIP_COLUMN)]\n    )\n\n    filtered_id_variant_pipe_0025 = CompositePipe(\n        [id_variant_pipe, FilterRowsByMinInCol(min_value=0.025, col=PIP_COLUMN)]\n    )\n\n    filtered_id_variant_pipe_001 = CompositePipe(\n        [id_variant_pipe, FilterRowsByMinInCol(min_value=0.01, col=PIP_COLUMN)]\n    )\n\n    upset_plot = UpSetPlotTask.create(\n        asset_id=base_name + \"_upset_plot\",\n        set_sources=[\n            DirSetSource(\n                name=\"L=10\",\n                task=susie_finemap_task,\n                file_in_dir=PurePath(COMBINED_CS_FILENAME),\n                read_spec=DataFrameReadSpec(DataFrameParquetFormat()),\n                pipe=id_variant_pipe,\n                col_name=variant_id,\n            ),\n            DirSetSource(\n                name=\"L=10, Strict\",\n                task=susie_finemap_task_strict,\n                file_in_dir=PurePath(COMBINED_CS_FILENAME),\n                read_spec=DataFrameReadSpec(DataFrameParquetFormat()),\n                pipe=id_variant_pipe,\n                col_name=variant_id,\n            ),\n            DirSetSource(\n                name=\"L=2\",\n                task=susie_finemap_task_2_credible_set,\n                file_in_dir=PurePath(COMBINED_CS_FILENAME),\n                read_spec=DataFrameReadSpec(DataFrameParquetFormat()),\n                pipe=id_variant_pipe,\n                col_name=variant_id,\n            ),\n            DirSetSource(\n                name=\"L=1\",\n                task=susie_finemap_task_1_credible_set,\n                file_in_dir=PurePath(COMBINED_CS_FILENAME),\n                read_spec=DataFrameReadSpec(DataFrameParquetFormat()),\n                pipe=id_variant_pipe,\n                col_name=variant_id,\n            ),\n        ],\n    )\n\n    upset_plot_pip001 = UpSetPlotTask.create(\n        asset_id=base_name + \"_upset_plot_pip001\",\n        set_sources=[\n            DirSetSource(\n                name=\"L=10\",\n                task=susie_finemap_task,\n                file_in_dir=PurePath(COMBINED_CS_FILENAME),\n                read_spec=DataFrameReadSpec(DataFrameParquetFormat()),\n                pipe=filtered_id_variant_pipe_001,\n                col_name=variant_id,\n            ),\n            DirSetSource(\n                name=\"L=10, Strict\",\n                task=susie_finemap_task_strict,\n                file_in_dir=PurePath(COMBINED_CS_FILENAME),\n                read_spec=DataFrameReadSpec(DataFrameParquetFormat()),\n                pipe=filtered_id_variant_pipe_001,\n                col_name=variant_id,\n            ),\n            DirSetSource(\n                name=\"L=2\",\n                task=susie_finemap_task_2_credible_set,\n                file_in_dir=PurePath(COMBINED_CS_FILENAME),\n                read_spec=DataFrameReadSpec(DataFrameParquetFormat()),\n                pipe=filtered_id_variant_pipe_001,\n                col_name=variant_id,\n            ),\n            DirSetSource(\n                name=\"L=1\",\n                task=susie_finemap_task_1_credible_set,\n                file_in_dir=PurePath(COMBINED_CS_FILENAME),\n                read_spec=DataFrameReadSpec(DataFrameParquetFormat()),\n                pipe=filtered_id_variant_pipe_001,\n                col_name=variant_id,\n            ),\n        ],\n    )\n\n    return BroadFineMapTaskGroup(\n        ld_labels_task=ld_labels_task,\n        ld_matrix_task=ld_matrix_task,\n        renamed_ld_labels_task=ld_labels_task_renamed,\n        harmonized_sumstats_task=harmonized_sumstats_task,\n        susie_finemap_task=susie_finemap_task,\n        susie_stackplot_task=susie_stack_plot_task,\n        susie_finemap_strict_task=susie_finemap_task_strict,\n        susie_finemap_strict_plot=strict_plot,\n        susie_finemap_1_credible_set_task=susie_finemap_task_1_credible_set,\n        susie_finemap_1_credible_set_plot=susie_plot_1_credible_set,\n        markdown_table_tasks=markdown_table_tasks,\n        susie_finemap_2_credible_set_task=susie_finemap_task_2_credible_set,\n        susie_finemap_2_credible_set_plot=susie_plot_2_credible_set,\n        upset_plot_task=upset_plot,\n        upset_plot_task_pip001=upset_plot_pip001,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/fine_mapping_asset_generator/#mecfs_bio.asset_generator.fine_mapping_asset_generator.markdown_cs_table_task","title":"markdown_cs_table_task","text":"<pre><code>markdown_cs_table_task(\n    susie_finemap_task: SusieRFinemapTask, base_name: str\n) -&gt; Task\n</code></pre> Source code in <code>mecfs_bio/asset_generator/fine_mapping_asset_generator.py</code> <pre><code>def markdown_cs_table_task(\n    susie_finemap_task: SusieRFinemapTask, base_name: str\n) -&gt; Task:\n    copy_cs = CopyFileFromDirectoryTask.create_result_table(\n        asset_id=base_name + \"_copy_cs_from_directory\",\n        source_directory_task=susie_finemap_task,\n        path_inside_directory=Path(COMBINED_CS_FILENAME),\n        extension=\".parquet\",\n        read_spec=DataFrameReadSpec(DataFrameParquetFormat()),\n    )\n\n    cs_markdown = ConvertDataFrameToMarkdownTask.create_from_result_table_task(\n        asset_id=base_name + \"_convert_cs_to_markdown\",\n        source_task=copy_cs,\n    )\n    return cs_markdown\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/genetic_correlation_asset_generator/","title":"genetic_correlation_asset_generator","text":""},{"location":"reference/mecfs_bio/asset_generator/genetic_correlation_asset_generator/#mecfs_bio.asset_generator.genetic_correlation_asset_generator","title":"mecfs_bio.asset_generator.genetic_correlation_asset_generator","text":"<p>Task generator that, given a list of tasks that generate gwaslab sumstats, creates one task for each pair of sumstats to compute their genetic correlation. The advantage of this approach is that each correlation is cached separately.</p> <p>Classes:</p> <ul> <li> <code>GeneticCorrTasks</code>           \u2013            </li> </ul> <p>Functions:</p> <ul> <li> <code>genetic_corr_by_ct_ldsc_asset_generator</code>             \u2013              <p>Task generator that, given a list of tasks that generate gwaslab sumstats,</p> </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/genetic_correlation_asset_generator/#mecfs_bio.asset_generator.genetic_correlation_asset_generator.GeneticCorrTasks","title":"GeneticCorrTasks","text":"<p>Attributes:</p> <ul> <li> <code>aggregation_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>corr_tasks</code>               (<code>Mapping[str, Task]</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/genetic_correlation_asset_generator/#mecfs_bio.asset_generator.genetic_correlation_asset_generator.GeneticCorrTasks.aggregation_task","title":"aggregation_task  <code>instance-attribute</code>","text":"<pre><code>aggregation_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/genetic_correlation_asset_generator/#mecfs_bio.asset_generator.genetic_correlation_asset_generator.GeneticCorrTasks.corr_tasks","title":"corr_tasks  <code>instance-attribute</code>","text":"<pre><code>corr_tasks: Mapping[str, Task]\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/genetic_correlation_asset_generator/#mecfs_bio.asset_generator.genetic_correlation_asset_generator.genetic_corr_by_ct_ldsc_asset_generator","title":"genetic_corr_by_ct_ldsc_asset_generator","text":"<pre><code>genetic_corr_by_ct_ldsc_asset_generator(\n    base_name: str,\n    sources: Sequence[SumstatsSource],\n    ld_ref_task: Task = THOUSAND_GENOME_EUR_LD_REFERENCE_DATA_V1_EXTRACTED,\n    ld_file_filename_pattern: str = \"/LDscore.@\",\n    build: GenomeBuild = \"19\",\n) -&gt; GeneticCorrTasks\n</code></pre> <p>Task generator that, given a list of tasks that generate gwaslab sumstats, creates one task for each pair of sumstats to compute their genetic correlation. The advantage of this approach is that each correlation is cached separately.</p> Source code in <code>mecfs_bio/asset_generator/genetic_correlation_asset_generator.py</code> <pre><code>def genetic_corr_by_ct_ldsc_asset_generator(\n    base_name: str,\n    sources: Sequence[SumstatsSource],\n    ld_ref_task: Task = THOUSAND_GENOME_EUR_LD_REFERENCE_DATA_V1_EXTRACTED,\n    ld_file_filename_pattern: str = \"/LDscore.@\",\n    build: GenomeBuild = \"19\",\n) -&gt; GeneticCorrTasks:\n    \"\"\"\n    Task generator that, given a list of tasks that generate gwaslab sumstats,\n    creates one task for each pair of sumstats to compute their genetic correlation.\n    The advantage of this approach is that each correlation is cached separately.\n    \"\"\"\n    tasks = {}\n    for source_1, source_2 in itertools.combinations(sources, 2):\n        sorted_sources = sorted([source_1, source_2], key=lambda x: x.alias.lower())\n        task_name = (\n            base_name\n            + \"_ct_ldsc_corr_\"\n            + sorted_sources[0].alias\n            + \"__\"\n            + sorted_sources[1].alias\n        ).lower()\n        task = GeneticCorrelationByCTLDSCTask.create(\n            asset_id=task_name,\n            sources=sorted_sources,\n            ld_ref_task=ld_ref_task,\n            build=build,\n            ld_file_filename_pattern=ld_file_filename_pattern,\n        )\n        tasks[task_name] = task\n    aggregation = ConcatFramesTask.create(\n        asset_id=base_name + \"_ct_ldsc_corr_aggregation\",\n        frames_tasks=list(tasks.values()),\n        out_format=CSVOutFormat(\",\"),\n    )\n\n    return GeneticCorrTasks(\n        corr_tasks=frozendict(tasks),\n        aggregation_task=aggregation,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/hba_magma_asset_generator/","title":"hba_magma_asset_generator","text":""},{"location":"reference/mecfs_bio/asset_generator/hba_magma_asset_generator/#mecfs_bio.asset_generator.hba_magma_asset_generator","title":"mecfs_bio.asset_generator.hba_magma_asset_generator","text":"<p>Asset generator for applying MAGMA gene property analysis using the Human Brain Atlas scRNAseq data as a reference.</p> <p>Classes:</p> <ul> <li> <code>HBAMagmaTasks</code>           \u2013            </li> </ul> <p>Functions:</p> <ul> <li> <code>generate_human_brain_atlas_magma_tasks</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/hba_magma_asset_generator/#mecfs_bio.asset_generator.hba_magma_asset_generator.HBAMagmaTasks","title":"HBAMagmaTasks","text":"<p>Methods:</p> <ul> <li> <code>terminal_tasks</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>extracted_plot_task</code>               (<code>CopyFileFromDirectoryTask</code>)           \u2013            </li> <li> <code>independent_clusters_markdown_task</code>               (<code>ConvertDataFrameToMarkdownTask | None</code>)           \u2013            </li> <li> <code>magma_annotation_task</code>               (<code>MagmaAnnotateTask</code>)           \u2013            </li> <li> <code>magma_gene_analysis_task</code>               (<code>MagmaGeneAnalysisTask</code>)           \u2013            </li> <li> <code>magma_hba_conditional_analysis</code>               (<code>MagmaGeneSetAnalysisTask | None</code>)           \u2013            </li> <li> <code>magma_hba_filtered_spec_matrix</code>               (<code>MagmaSubsetSpecificityMatrixWithTopLabels | None</code>)           \u2013            </li> <li> <code>magma_hba_forward_select</code>               (<code>MagmaForwardStepwiseSelectTask | None</code>)           \u2013            </li> <li> <code>magma_hba_gene_set_result_extract_task</code>               (<code>CopyFileFromDirectoryTask</code>)           \u2013            </li> <li> <code>magma_hba_gene_set_task</code>               (<code>MagmaGeneSetAnalysisTask</code>)           \u2013            </li> <li> <code>magma_hba_multiple_testing_task</code>               (<code>MultipleTestingTableTask</code>)           \u2013            </li> <li> <code>magma_hba_result_annotated_task</code>               (<code>JoinDataFramesTask</code>)           \u2013            </li> <li> <code>magma_hba_result_plot_task</code>               (<code>PlotMagmaBrainAtlasResultTask</code>)           \u2013            </li> <li> <code>magma_independent_cluster_plot</code>               (<code>MAGMAPlotBrainAtlasResultWithStepwiseLabels | None</code>)           \u2013            </li> <li> <code>magma_independent_clusters_csv</code>               (<code>JoinDataFramesTask | None</code>)           \u2013            </li> <li> <code>snp_loc_task</code>               (<code>MagmaSNPFileTask</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/hba_magma_asset_generator/#mecfs_bio.asset_generator.hba_magma_asset_generator.HBAMagmaTasks.extracted_plot_task","title":"extracted_plot_task  <code>instance-attribute</code>","text":"<pre><code>extracted_plot_task: CopyFileFromDirectoryTask\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/hba_magma_asset_generator/#mecfs_bio.asset_generator.hba_magma_asset_generator.HBAMagmaTasks.independent_clusters_markdown_task","title":"independent_clusters_markdown_task  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>independent_clusters_markdown_task: (\n    ConvertDataFrameToMarkdownTask | None\n) = None\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/hba_magma_asset_generator/#mecfs_bio.asset_generator.hba_magma_asset_generator.HBAMagmaTasks.magma_annotation_task","title":"magma_annotation_task  <code>instance-attribute</code>","text":"<pre><code>magma_annotation_task: MagmaAnnotateTask\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/hba_magma_asset_generator/#mecfs_bio.asset_generator.hba_magma_asset_generator.HBAMagmaTasks.magma_gene_analysis_task","title":"magma_gene_analysis_task  <code>instance-attribute</code>","text":"<pre><code>magma_gene_analysis_task: MagmaGeneAnalysisTask\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/hba_magma_asset_generator/#mecfs_bio.asset_generator.hba_magma_asset_generator.HBAMagmaTasks.magma_hba_conditional_analysis","title":"magma_hba_conditional_analysis  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>magma_hba_conditional_analysis: (\n    MagmaGeneSetAnalysisTask | None\n) = None\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/hba_magma_asset_generator/#mecfs_bio.asset_generator.hba_magma_asset_generator.HBAMagmaTasks.magma_hba_filtered_spec_matrix","title":"magma_hba_filtered_spec_matrix  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>magma_hba_filtered_spec_matrix: (\n    MagmaSubsetSpecificityMatrixWithTopLabels | None\n) = None\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/hba_magma_asset_generator/#mecfs_bio.asset_generator.hba_magma_asset_generator.HBAMagmaTasks.magma_hba_forward_select","title":"magma_hba_forward_select  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>magma_hba_forward_select: (\n    MagmaForwardStepwiseSelectTask | None\n) = None\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/hba_magma_asset_generator/#mecfs_bio.asset_generator.hba_magma_asset_generator.HBAMagmaTasks.magma_hba_gene_set_result_extract_task","title":"magma_hba_gene_set_result_extract_task  <code>instance-attribute</code>","text":"<pre><code>magma_hba_gene_set_result_extract_task: (\n    CopyFileFromDirectoryTask\n)\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/hba_magma_asset_generator/#mecfs_bio.asset_generator.hba_magma_asset_generator.HBAMagmaTasks.magma_hba_gene_set_task","title":"magma_hba_gene_set_task  <code>instance-attribute</code>","text":"<pre><code>magma_hba_gene_set_task: MagmaGeneSetAnalysisTask\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/hba_magma_asset_generator/#mecfs_bio.asset_generator.hba_magma_asset_generator.HBAMagmaTasks.magma_hba_multiple_testing_task","title":"magma_hba_multiple_testing_task  <code>instance-attribute</code>","text":"<pre><code>magma_hba_multiple_testing_task: MultipleTestingTableTask\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/hba_magma_asset_generator/#mecfs_bio.asset_generator.hba_magma_asset_generator.HBAMagmaTasks.magma_hba_result_annotated_task","title":"magma_hba_result_annotated_task  <code>instance-attribute</code>","text":"<pre><code>magma_hba_result_annotated_task: JoinDataFramesTask\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/hba_magma_asset_generator/#mecfs_bio.asset_generator.hba_magma_asset_generator.HBAMagmaTasks.magma_hba_result_plot_task","title":"magma_hba_result_plot_task  <code>instance-attribute</code>","text":"<pre><code>magma_hba_result_plot_task: PlotMagmaBrainAtlasResultTask\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/hba_magma_asset_generator/#mecfs_bio.asset_generator.hba_magma_asset_generator.HBAMagmaTasks.magma_independent_cluster_plot","title":"magma_independent_cluster_plot  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>magma_independent_cluster_plot: (\n    MAGMAPlotBrainAtlasResultWithStepwiseLabels | None\n) = None\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/hba_magma_asset_generator/#mecfs_bio.asset_generator.hba_magma_asset_generator.HBAMagmaTasks.magma_independent_clusters_csv","title":"magma_independent_clusters_csv  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>magma_independent_clusters_csv: (\n    JoinDataFramesTask | None\n) = None\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/hba_magma_asset_generator/#mecfs_bio.asset_generator.hba_magma_asset_generator.HBAMagmaTasks.snp_loc_task","title":"snp_loc_task  <code>instance-attribute</code>","text":"<pre><code>snp_loc_task: MagmaSNPFileTask\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/hba_magma_asset_generator/#mecfs_bio.asset_generator.hba_magma_asset_generator.HBAMagmaTasks.terminal_tasks","title":"terminal_tasks","text":"<pre><code>terminal_tasks() -&gt; list[Task]\n</code></pre> Source code in <code>mecfs_bio/asset_generator/hba_magma_asset_generator.py</code> <pre><code>def terminal_tasks(self) -&gt; list[Task]:\n    result: list = [self.extracted_plot_task]\n    if self.magma_independent_cluster_plot is not None:\n        result += [self.magma_independent_cluster_plot]\n    if self.independent_clusters_markdown_task is not None:\n        result += [self.independent_clusters_markdown_task]\n    return result\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/hba_magma_asset_generator/#mecfs_bio.asset_generator.hba_magma_asset_generator.generate_human_brain_atlas_magma_tasks","title":"generate_human_brain_atlas_magma_tasks","text":"<pre><code>generate_human_brain_atlas_magma_tasks(\n    base_name: str,\n    gwas_parquet_with_rsids_task: Task,\n    sample_size: int,\n    plot_settings: PlotSettings,\n    include_independent_cluster_plot: bool = False,\n    pipes: list[DataProcessingPipe] | None = None,\n    hba_indep_plot_options: HBAIndepPlotOptions = HBAIndepPlotOptions(),\n) -&gt; HBAMagmaTasks\n</code></pre> Source code in <code>mecfs_bio/asset_generator/hba_magma_asset_generator.py</code> <pre><code>def generate_human_brain_atlas_magma_tasks(\n    base_name: str,\n    gwas_parquet_with_rsids_task: Task,\n    sample_size: int,\n    plot_settings: PlotSettings,\n    include_independent_cluster_plot: bool = False,\n    pipes: list[DataProcessingPipe] | None = None,\n    hba_indep_plot_options: HBAIndepPlotOptions = HBAIndepPlotOptions(),\n) -&gt; HBAMagmaTasks:\n    magma_binary_task = MAGMA_1_1_BINARY_EXTRACTED\n    gene_loc_file_task = MAGMA_ENTREZ_GENE_LOCATION_REFERENCE_DATA_BUILD_37_EXTRACTED\n\n    p_value_task = MagmaSNPFileTask.create_for_magma_snp_p_value_file_compute_if_needed(\n        gwas_parquet_with_rsids_task=gwas_parquet_with_rsids_task,\n        asset_id=base_name + \"_hba_magma_snp_p_values\",\n        pipes=pipes,\n    )\n    snp_loc_task = MagmaSNPFileTask.create_for_magma_snp_pos_file(\n        gwas_parquet_with_rsids_task=gwas_parquet_with_rsids_task,\n        asset_id=base_name + \"_hba_magma_snp_locs\",\n        pipes=pipes,\n    )\n    annotations_task = MagmaAnnotateTask.create(\n        asset_id=base_name + \"_hba_magma_annotations\",\n        magma_binary_task=magma_binary_task,\n        snp_loc_file_task=snp_loc_task,\n        gene_loc_file_task=gene_loc_file_task,\n        window=(35, 10),  # This choice comes from the Duncan paper\n    )\n    gene_analysis_task = MagmaGeneAnalysisTask.create(\n        asset_id=base_name + \"_hba_magma_gene_analysis\",\n        magma_annotation_task=annotations_task,\n        magma_p_value_task=p_value_task,\n        magma_binary_task=magma_binary_task,\n        magma_ld_ref_task=MAGMA_EUR_BUILD_37_1K_GENOMES_EXTRACTED,\n        ld_ref_file_stem=\"g1000_eur\",\n        sample_size=sample_size,\n    )\n\n    cell_analysis_task = MagmaGeneSetAnalysisTask.create(\n        asset_id=base_name + \"_hba_gene_covar\",\n        magma_gene_analysis_task=gene_analysis_task,\n        magma_binary_task=MAGMA_1_1_BINARY_EXTRACTED,\n        gene_set_task=MAGMA_ENTREZ_SPECIFICITY_MATRIX_HBCA_RNA_DUNCAN,\n        set_or_covar=\"covar\",\n        model_params=ModelParams(direction_covar=\"greater\", condition_hide=[]),\n    )\n\n    result_extract_task = CopyFileFromDirectoryTask.create_result_table(\n        base_name + \"_hba_gene_covar_results_extracted\",\n        source_directory_task=cell_analysis_task,\n        path_inside_directory=PurePath(\n            str(GENE_SET_ANALYSIS_OUTPUT_STEM_NAME + \".gsa.out\")\n        ),\n        extension=\".txt\",\n        read_spec=DataFrameReadSpec(DataFrameWhiteSpaceSepTextFormat(comment_code=\"#\")),\n    )\n    result_annotated_task = JoinDataFramesTask.create_from_result_df(\n        asset_id=base_name + \"_hba_gene_covar_results_labeled\",\n        result_df_task=result_extract_task,\n        reference_df_task=DUNCAN_ET_AL_2025_ST1_LABEL_COLS,\n        how=\"left\",\n        left_on=[\"VARIABLE\"],\n        right_on=[\"VARIABLE\"],\n    )\n    multiple_testing_task = MultipleTestingTableTask.create_from_result_table_task(\n        alpha=0.01,\n        source_task=result_annotated_task,\n        method=\"bonferroni\",\n        asset_id=base_name + \"_hba_gene_covar_results_multiple_testing\",\n        p_value_column=\"P\",\n        apply_filter=False,\n    )\n    plot_task = PlotMagmaBrainAtlasResultTask.create(\n        result_table_task=multiple_testing_task,\n        cluster_annotation_task=CLUSTER_ANNOTATION_TERM_METADATA,\n        asset_id=base_name + \"_hba_atlas_magma_plot\",\n        plot_settings=plot_settings,\n    )\n    extracted_plot_task = CopyFileFromDirectoryTask.create_result_table(\n        asset_id=base_name + \"_hba_magma_plot_extracted\",\n        source_directory_task=plot_task,\n        path_inside_directory=PurePath(BRAIN_ATLAS_PLOT_NAME + \".html\"),\n        extension=\".html\",\n        read_spec=None,\n    )\n    if include_independent_cluster_plot:\n        magma_hba_filtered_spec_matrix = (\n            MagmaSubsetSpecificityMatrixWithTopLabels.create(\n                asset_id=base_name + \"_hba_magma_filtered_spec_matrix\",\n                specificity_matrix_task=MAGMA_ENTREZ_SPECIFICITY_MATRIX_HBCA_RNA_DUNCAN,\n                magma_gene_covar_analysis_task=cell_analysis_task,\n                nominal_sig_level=0.01,\n            )\n        )\n        magma_hba_conditional_analysis = MagmaGeneSetAnalysisTask.create(\n            asset_id=base_name + \"_hba_magma_conditional_analysis\",\n            magma_gene_analysis_task=gene_analysis_task,\n            magma_binary_task=MAGMA_1_1_BINARY_EXTRACTED,\n            gene_set_task=magma_hba_filtered_spec_matrix,\n            set_or_covar=\"covar\",\n            model_params=ModelParams(\n                direction_covar=\"greater\", condition_hide=[], joint_pairs=True\n            ),\n        )\n        magma_hba_forward_select = MagmaForwardStepwiseSelectTask.create(\n            asset_id=base_name + \"_hba_magma_forward_stepwise\",\n            magma_marginal_output_task=cell_analysis_task,\n            magma_conditional_output_task=magma_hba_conditional_analysis,\n            significance_threshold=0.01,\n        )\n        magma_independent_clusters_labeled_labeled = (\n            JoinDataFramesTask.create_from_result_df(\n                asset_id=base_name + \"_hba_magma_independent_clusters_labeled\",\n                result_df_task=magma_hba_forward_select,\n                reference_df_task=result_annotated_task,\n                how=\"left\",\n                right_on=[\"VARIABLE\"],\n                left_on=[RETAINED_CLUSTERS_COLUMN],\n                out_pipe=SelectColPipe(\n                    [RETAINED_CLUSTERS_COLUMN, MAGMA_P_COLUMN]\n                    + KEY_HBA_ANNOTATION_COLUMNS\n                ),\n            )\n        )\n        independent_clusters_markdown = (\n            ConvertDataFrameToMarkdownTask.create_from_result_table_task(\n                asset_id=base_name + \"_hba_magma_independent_clusters_markdown\",\n                source_task=magma_independent_clusters_labeled_labeled,\n            )\n        )\n\n        magma_independent_cluster_plot = (\n            MAGMAPlotBrainAtlasResultWithStepwiseLabels.create(\n                result_table_task=multiple_testing_task,\n                asset_id=base_name + \"_hba_magma_independent_cluster_plot\",\n                stepwise_cluster_list_task=magma_hba_forward_select,\n                plot_options=hba_indep_plot_options,\n            )\n        )\n    else:\n        magma_hba_filtered_spec_matrix = None\n        magma_hba_conditional_analysis = None\n        magma_hba_forward_select = None\n        magma_independent_cluster_plot = None\n        independent_clusters_markdown = None\n        magma_independent_clusters_labeled_labeled = None\n\n    return HBAMagmaTasks(\n        snp_loc_task=snp_loc_task,\n        magma_annotation_task=annotations_task,\n        magma_gene_analysis_task=gene_analysis_task,\n        magma_hba_gene_set_task=cell_analysis_task,\n        magma_hba_gene_set_result_extract_task=result_extract_task,\n        magma_hba_result_annotated_task=result_annotated_task,\n        magma_hba_multiple_testing_task=multiple_testing_task,\n        magma_hba_result_plot_task=plot_task,\n        magma_hba_filtered_spec_matrix=magma_hba_filtered_spec_matrix,\n        magma_hba_conditional_analysis=magma_hba_conditional_analysis,\n        magma_hba_forward_select=magma_hba_forward_select,\n        magma_independent_cluster_plot=magma_independent_cluster_plot,\n        independent_clusters_markdown_task=independent_clusters_markdown,\n        magma_independent_clusters_csv=magma_independent_clusters_labeled_labeled,\n        extracted_plot_task=extracted_plot_task,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/labeled_lead_variants_asset_generator/","title":"labeled_lead_variants_asset_generator","text":""},{"location":"reference/mecfs_bio/asset_generator/labeled_lead_variants_asset_generator/#mecfs_bio.asset_generator.labeled_lead_variants_asset_generator","title":"mecfs_bio.asset_generator.labeled_lead_variants_asset_generator","text":"<p>Classes:</p> <ul> <li> <code>LabelLeadVariantsTasks</code>           \u2013            </li> </ul> <p>Functions:</p> <ul> <li> <code>generate_tasks_labeled_lead_variants</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/labeled_lead_variants_asset_generator/#mecfs_bio.asset_generator.labeled_lead_variants_asset_generator.LabelLeadVariantsTasks","title":"LabelLeadVariantsTasks","text":"<p>Methods:</p> <ul> <li> <code>terminal_tasks</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>labeled_lead_variants_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>lead_variants_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>raw_sumstats_task</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/labeled_lead_variants_asset_generator/#mecfs_bio.asset_generator.labeled_lead_variants_asset_generator.LabelLeadVariantsTasks.labeled_lead_variants_task","title":"labeled_lead_variants_task  <code>instance-attribute</code>","text":"<pre><code>labeled_lead_variants_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/labeled_lead_variants_asset_generator/#mecfs_bio.asset_generator.labeled_lead_variants_asset_generator.LabelLeadVariantsTasks.lead_variants_task","title":"lead_variants_task  <code>instance-attribute</code>","text":"<pre><code>lead_variants_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/labeled_lead_variants_asset_generator/#mecfs_bio.asset_generator.labeled_lead_variants_asset_generator.LabelLeadVariantsTasks.raw_sumstats_task","title":"raw_sumstats_task  <code>instance-attribute</code>","text":"<pre><code>raw_sumstats_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/labeled_lead_variants_asset_generator/#mecfs_bio.asset_generator.labeled_lead_variants_asset_generator.LabelLeadVariantsTasks.terminal_tasks","title":"terminal_tasks","text":"<pre><code>terminal_tasks() -&gt; list[Task]\n</code></pre> Source code in <code>mecfs_bio/asset_generator/labeled_lead_variants_asset_generator.py</code> <pre><code>def terminal_tasks(self) -&gt; list[Task]:\n    return [self.labeled_lead_variants_task]\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/labeled_lead_variants_asset_generator/#mecfs_bio.asset_generator.labeled_lead_variants_asset_generator.generate_tasks_labeled_lead_variants","title":"generate_tasks_labeled_lead_variants","text":"<pre><code>generate_tasks_labeled_lead_variants(\n    base_name: str,\n    raw_gwas_data_task: Task,\n    fmt: ValidGwaslabFormat,\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n) -&gt; LabelLeadVariantsTasks\n</code></pre> Source code in <code>mecfs_bio/asset_generator/labeled_lead_variants_asset_generator.py</code> <pre><code>def generate_tasks_labeled_lead_variants(\n    base_name: str,\n    raw_gwas_data_task: Task,\n    fmt: ValidGwaslabFormat,\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n) -&gt; LabelLeadVariantsTasks:\n    raw_sumstats_task = GWASLabCreateSumstatsTask(\n        df_source_task=raw_gwas_data_task,\n        fmt=fmt,\n        basic_check=True,\n        genome_build=\"infer\",\n        pre_pipe=pre_pipe,\n        asset_id=AssetId(base_name + \"_raw_sumstats_task_no_liftover\"),\n    )\n    lead_variants_task = GwasLabLeadVariantsTask(\n        sumstats_task=raw_sumstats_task, short_id=base_name + \"_gwaslab_lead_variants\"\n    )\n    labeled_lead_variants_task = JoinDataFramesTask.create_from_result_df(\n        asset_id=base_name + \"_labeled_lead_variants\",\n        result_df_task=lead_variants_task,\n        reference_df_task=GENE_THESAURUS,\n        how=\"left\",\n        left_on=[\"GENE\"],\n        right_on=[\"Gene name\"],\n        df_1_pipe=SelectColPipe([\"GENE\"]),\n        df_2_pipe=SelectColPipe(\n            [\"Gene name\", \"NCBI gene (formerly Entrezgene) ID\", \"Gene stable ID\"]\n        ),\n    )\n    return LabelLeadVariantsTasks(\n        raw_sumstats_task=raw_sumstats_task,\n        lead_variants_task=lead_variants_task,\n        labeled_lead_variants_task=labeled_lead_variants_task,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/mr_with_cis_pqtl_asset_generator/","title":"mr_with_cis_pqtl_asset_generator","text":""},{"location":"reference/mecfs_bio/asset_generator/mr_with_cis_pqtl_asset_generator/#mecfs_bio.asset_generator.mr_with_cis_pqtl_asset_generator","title":"mecfs_bio.asset_generator.mr_with_cis_pqtl_asset_generator","text":"<p>Asset generator for applying Mendelian Randomization using cis-pQTLs from the UK Biobank Pharma Proteomics project</p> <p>Classes:</p> <ul> <li> <code>BinaryOutcomeConfig</code>           \u2013            </li> <li> <code>CisMRTasks</code>           \u2013            </li> <li> <code>QuantOutcomeConfig</code>           \u2013            </li> </ul> <p>Functions:</p> <ul> <li> <code>mr_cis_pqtl_asset_generator</code>             \u2013              <p>Asset generator for applying Mendelian Randomization using cis-pQTLs from the UK Biobank</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>PROTEIN_EXPOSURE_COL</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/mr_with_cis_pqtl_asset_generator/#mecfs_bio.asset_generator.mr_with_cis_pqtl_asset_generator.PROTEIN_EXPOSURE_COL","title":"PROTEIN_EXPOSURE_COL  <code>module-attribute</code>","text":"<pre><code>PROTEIN_EXPOSURE_COL = 'protein_exposure_id'\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/mr_with_cis_pqtl_asset_generator/#mecfs_bio.asset_generator.mr_with_cis_pqtl_asset_generator.BinaryOutcomeConfig","title":"BinaryOutcomeConfig","text":"<p>Attributes:</p> <ul> <li> <code>n_case</code>               (<code>int</code>)           \u2013            </li> <li> <code>n_control</code>               (<code>int</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/mr_with_cis_pqtl_asset_generator/#mecfs_bio.asset_generator.mr_with_cis_pqtl_asset_generator.BinaryOutcomeConfig.n_case","title":"n_case  <code>instance-attribute</code>","text":"<pre><code>n_case: int\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/mr_with_cis_pqtl_asset_generator/#mecfs_bio.asset_generator.mr_with_cis_pqtl_asset_generator.BinaryOutcomeConfig.n_control","title":"n_control  <code>instance-attribute</code>","text":"<pre><code>n_control: int\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/mr_with_cis_pqtl_asset_generator/#mecfs_bio.asset_generator.mr_with_cis_pqtl_asset_generator.CisMRTasks","title":"CisMRTasks","text":"<p>Methods:</p> <ul> <li> <code>terminal_tasks</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>extract_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>label_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>md_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>mr_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>multiple_testing_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>plot_task</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/mr_with_cis_pqtl_asset_generator/#mecfs_bio.asset_generator.mr_with_cis_pqtl_asset_generator.CisMRTasks.extract_task","title":"extract_task  <code>instance-attribute</code>","text":"<pre><code>extract_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/mr_with_cis_pqtl_asset_generator/#mecfs_bio.asset_generator.mr_with_cis_pqtl_asset_generator.CisMRTasks.label_task","title":"label_task  <code>instance-attribute</code>","text":"<pre><code>label_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/mr_with_cis_pqtl_asset_generator/#mecfs_bio.asset_generator.mr_with_cis_pqtl_asset_generator.CisMRTasks.md_task","title":"md_task  <code>instance-attribute</code>","text":"<pre><code>md_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/mr_with_cis_pqtl_asset_generator/#mecfs_bio.asset_generator.mr_with_cis_pqtl_asset_generator.CisMRTasks.mr_task","title":"mr_task  <code>instance-attribute</code>","text":"<pre><code>mr_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/mr_with_cis_pqtl_asset_generator/#mecfs_bio.asset_generator.mr_with_cis_pqtl_asset_generator.CisMRTasks.multiple_testing_task","title":"multiple_testing_task  <code>instance-attribute</code>","text":"<pre><code>multiple_testing_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/mr_with_cis_pqtl_asset_generator/#mecfs_bio.asset_generator.mr_with_cis_pqtl_asset_generator.CisMRTasks.plot_task","title":"plot_task  <code>instance-attribute</code>","text":"<pre><code>plot_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/mr_with_cis_pqtl_asset_generator/#mecfs_bio.asset_generator.mr_with_cis_pqtl_asset_generator.CisMRTasks.terminal_tasks","title":"terminal_tasks","text":"<pre><code>terminal_tasks() -&gt; list[Task]\n</code></pre> Source code in <code>mecfs_bio/asset_generator/mr_with_cis_pqtl_asset_generator.py</code> <pre><code>def terminal_tasks(self) -&gt; list[Task]:\n    return [self.plot_task, self.md_task]\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/mr_with_cis_pqtl_asset_generator/#mecfs_bio.asset_generator.mr_with_cis_pqtl_asset_generator.QuantOutcomeConfig","title":"QuantOutcomeConfig","text":"<p>Attributes:</p> <ul> <li> <code>sample_size</code>               (<code>int</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/mr_with_cis_pqtl_asset_generator/#mecfs_bio.asset_generator.mr_with_cis_pqtl_asset_generator.QuantOutcomeConfig.sample_size","title":"sample_size  <code>instance-attribute</code>","text":"<pre><code>sample_size: int\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/mr_with_cis_pqtl_asset_generator/#mecfs_bio.asset_generator.mr_with_cis_pqtl_asset_generator.mr_cis_pqtl_asset_generator","title":"mr_cis_pqtl_asset_generator","text":"<pre><code>mr_cis_pqtl_asset_generator(\n    gwas_dataframe_with_rsids: Task,\n    base_name: str,\n    outcome_config: BinaryOutcomeConfig\n    | QuantOutcomeConfig,\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n    steiger_config: None\n    | SteigerFilteringOptions = SteigerFilteringOptions(\n        True, 0.01\n    ),\n    significant_alpha: float = 0.01,\n)\n</code></pre> <p>Asset generator for applying Mendelian Randomization using cis-pQTLs from the UK Biobank Pharma Proteomics project</p> Source code in <code>mecfs_bio/asset_generator/mr_with_cis_pqtl_asset_generator.py</code> <pre><code>def mr_cis_pqtl_asset_generator(\n    gwas_dataframe_with_rsids: Task,\n    base_name: str,\n    outcome_config: BinaryOutcomeConfig | QuantOutcomeConfig,\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n    steiger_config: None | SteigerFilteringOptions = SteigerFilteringOptions(\n        True, 0.01\n    ),\n    significant_alpha: float = 0.01,\n):\n    \"\"\"\n    Asset generator for applying Mendelian Randomization using cis-pQTLs from the UK Biobank\n    Pharma Proteomics project\n    \"\"\"\n    outcome_pipes: list[DataProcessingPipe] = [\n        pre_pipe,\n        ComputeBetaIfNeededPipe(),\n        ComputeSEIfNeededPipe(),\n        ComputePIfNeededPipe(),\n    ]\n    if isinstance(outcome_config, BinaryOutcomeConfig):\n        outcome_pipes.extend(\n            [\n                SetColToConstantPipe(\n                    col_name=GWASLAB_N_CASE_COL, constant=outcome_config.n_case\n                ),\n                SetColToConstantPipe(\n                    col_name=GWASLAB_N_CONTROL_COL, constant=outcome_config.n_control\n                ),\n                SetColToConstantPipe(TSM_UNITS_COL, constant=\"log odds\"),\n            ]\n        )\n    elif isinstance(outcome_config, QuantOutcomeConfig):\n        outcome_pipes.append(\n            SetColToConstantPipe(\n                GWASLAB_SAMPLE_SIZE_COLUMN, constant=outcome_config.sample_size\n            )\n        )\n\n    two_sample_task = TwoSampleMRTask.create(\n        asset_id=base_name + \"_two_sample_mr_cis_pqtl\",\n        outcome_data_task=gwas_dataframe_with_rsids,\n        exposure_data_task=SUN_ET_AL_2023_COMBINED_PQTLS_EXTRACTED,\n        config=TwoSampleMRConfig(\n            clump_exposure_data=None,\n            pre_filter_outcome_variants=True,\n            steiger_filter=steiger_config,\n        ),\n        exposure_pipe=CompositePipe(\n            [\n                ConcatStrPipe(\n                    [SUN_ASSAY_TARGET, SUN_TARGET_UNIPROT],\n                    sep=\"__\",\n                    new_col_name=PROTEIN_EXPOSURE_COL,\n                ),\n                # FilterRowsByValue(\n                #     target_column=\"protein_exposure_id\", valid_values=[\"IL1R1_P14778\"]\n                # ),\n                #\n                # FilterRowsByValue(\n                #     target_column=PROTEIN_EXPOSURE_COL,\n                #     valid_values=[\"TLR1_Q15399\", \"IL1R1_P14778\"],\n                # ),\n                FilterRowsByValue(\n                    target_column=SUN_CIS_TRANS_COL, valid_values=[SUN_CIS]\n                ),\n                RenameColPipe(SUN_MLOG10_P_COL, GWASLAB_MLOG10P_COL),\n                ComputePIfNeededPipe(),\n                SetColToConstantPipe(\n                    GWASLAB_SAMPLE_SIZE_COLUMN, constant=54_219\n                ),  # This is the UKBB PPP sample size. source: sun et al. abstract\n            ]\n        ),\n        exposure_col_spec=attrs.evolve(\n            SUN_ET_AL_MR_INPUT_COL_SPEC_hg37, sample_size_col=GWASLAB_SAMPLE_SIZE_COLUMN\n        ),\n        outcome_col_spec=GWASLAB_MR_INPUT_COL_SPEC,\n        outcome_pipe=CompositePipe(outcome_pipes),\n    )\n    extract_mr_result_task = CopyFileFromDirectoryTask.create_result_table(\n        asset_id=base_name + \"_two_sample_mr_cis_pqtl_extract_result\",\n        source_directory_task=two_sample_task,\n        path_inside_directory=PurePath(MAIN_RESULT_DF_PATH),\n        extension=\".csv\",\n        read_spec=DataFrameReadSpec(DataFrameTextFormat(separator=\",\")),\n    )\n    multiple_testing_task = MultipleTestingTableTask.create_from_result_table_task(\n        alpha=significant_alpha,\n        method=\"bonferroni\",\n        asset_id=base_name + \"_two_sample_mr_cis_pqtl_multiple_testing\",\n        p_value_column=TSM_OUTPUT_P_COL,\n        source_task=extract_mr_result_task,\n        apply_filter=True,\n    )\n\n    plot_mr_result_task = PlotMREffectMeasure.create(\n        asset_id=base_name + \"_cis_pqtl_mr_effect_measure_plot\",\n        source_df_task=multiple_testing_task,\n        config=EffectMeasurePlotConfig(\n            y_label_col=SUN_ASSAY_TARGET,\n            y_label=\"Protein\",\n            effect_size_col=TSM_OUTPUT_B_COL,\n            effect_size_label=\"b\",\n            se_col=TSM_OUTPUT_SE_COL,\n            ref_line_center=0,\n            figsize=(14 * 1.3, 6 * 1.3),\n            t_adjust=0.02,\n        ),\n        pre_pipe=SplitExactColPipe(\n            TSM_OUTPUT_EXPOSURE_COL,\n            split_by=\"__\",\n            new_col_names=(SUN_ASSAY_TARGET, SUN_TARGET_UNIPROT),\n        ),\n    )\n    label_task = JoinDataFramesTask.create_from_result_df(\n        asset_id=base_name + \"_ppp_cis_mr_labeled_with_uniprot\",\n        result_df_task=multiple_testing_task,\n        reference_df_task=UNIPROT_LOOKUP,\n        how=\"left\",\n        df_1_pipe=SplitExactColPipe(\n            TSM_OUTPUT_EXPOSURE_COL,\n            split_by=\"__\",\n            new_col_names=(SUN_ASSAY_TARGET, SUN_TARGET_UNIPROT),\n        ),\n        left_on=[SUN_TARGET_UNIPROT],\n        right_on=[UNIPROT_DAT_ID_COL],\n        out_format=ParquetOutFormat(),\n    )\n\n    md_task = ConvertDataFrameToMarkdownTask.create_from_result_table_task(\n        source_task=label_task,\n        asset_id=base_name + \"_cis_mr_markdown\",\n        pipe=CompositePipe(\n            [\n                SelectColPipe(\n                    [\n                        SUN_ASSAY_TARGET,\n                        TSM_OUTPUT_B_COL,\n                        # TSM_OUTPUT_SE_COL,\n                        TSM_OUTPUT_P_COL,\n                        UNIPROT_DAT_FUNCTION_COL,\n                    ],\n                ),\n                SortPipe(by=[TSM_OUTPUT_B_COL]),\n            ]\n        ),\n    )\n\n    return CisMRTasks(\n        mr_task=two_sample_task,\n        extract_task=extract_mr_result_task,\n        multiple_testing_task=multiple_testing_task,\n        plot_task=plot_mr_result_task,\n        label_task=label_task,\n        md_task=md_task,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator/","title":"ukbb_broad_ld_matrix_generator","text":""},{"location":"reference/mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator/#mecfs_bio.asset_generator.ukbb_broad_ld_matrix_generator","title":"mecfs_bio.asset_generator.ukbb_broad_ld_matrix_generator","text":"<p>Asset generator to automatically determine the optimal UKBB LD matrix to use for fine-mapping</p> <p>Classes:</p> <ul> <li> <code>GenomicInterval</code>           \u2013            </li> </ul> <p>Functions:</p> <ul> <li> <code>get_broad_ukbb_ld_matrix_file_info</code>             \u2013              </li> <li> <code>get_genomic_interval_ld_labels_task</code>             \u2013              </li> <li> <code>get_genomic_interval_ld_labels_url</code>             \u2013              </li> <li> <code>get_genomic_interval_ld_matrix_task</code>             \u2013              </li> <li> <code>get_genomic_interval_ld_matrix_url</code>             \u2013              </li> <li> <code>get_genomic_interval_stem_name</code>             \u2013              </li> <li> <code>get_ld_labels_and_matrix_task_for_chrom_pos_build_37</code>             \u2013              </li> <li> <code>get_ld_labels_and_matrix_task_for_genomic_interval_build_37</code>             \u2013              </li> <li> <code>get_optimal_ukbb_ld_interval</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>BROAD_UKBB_FILE_LIST</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator/#mecfs_bio.asset_generator.ukbb_broad_ld_matrix_generator.BROAD_UKBB_FILE_LIST","title":"BROAD_UKBB_FILE_LIST  <code>module-attribute</code>","text":"<pre><code>BROAD_UKBB_FILE_LIST = Path(\n    \"mecfs_bio/vend_files/broad_ukbb_ld_matrix_file_list.txt\"\n)\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator/#mecfs_bio.asset_generator.ukbb_broad_ld_matrix_generator.GenomicInterval","title":"GenomicInterval","text":"<p>Attributes:</p> <ul> <li> <code>chrom</code>               (<code>int</code>)           \u2013            </li> <li> <code>end</code>               (<code>int</code>)           \u2013            </li> <li> <code>start</code>               (<code>int</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator/#mecfs_bio.asset_generator.ukbb_broad_ld_matrix_generator.GenomicInterval.chrom","title":"chrom  <code>instance-attribute</code>","text":"<pre><code>chrom: int\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator/#mecfs_bio.asset_generator.ukbb_broad_ld_matrix_generator.GenomicInterval.end","title":"end  <code>instance-attribute</code>","text":"<pre><code>end: int\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator/#mecfs_bio.asset_generator.ukbb_broad_ld_matrix_generator.GenomicInterval.start","title":"start  <code>instance-attribute</code>","text":"<pre><code>start: int\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator/#mecfs_bio.asset_generator.ukbb_broad_ld_matrix_generator.get_broad_ukbb_ld_matrix_file_info","title":"get_broad_ukbb_ld_matrix_file_info","text":"<pre><code>get_broad_ukbb_ld_matrix_file_info() -&gt; pd.DataFrame\n</code></pre> Source code in <code>mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator.py</code> <pre><code>def get_broad_ukbb_ld_matrix_file_info() -&gt; pd.DataFrame:\n    df = pd.read_csv(\n        BROAD_UKBB_FILE_LIST, sep=r\"\\s+\", names=[f\"col_{i}\" for i in range(6)]\n    )\n    split = df[\"col_3\"].str.split(\".\", expand=True)\n    split = split.iloc[2:-1]\n    intervals = split[0].str.split(\"_\", expand=True)\n    intervals.columns = [\"chrom\", \"start\", \"end\"]\n    intervals[\"chrom\"] = intervals[\"chrom\"].str.removeprefix(\"chr\").astype(int)\n    intervals[\"start\"] = intervals[\"start\"].astype(int)\n    intervals[\"end\"] = intervals[\"end\"].astype(int)\n    return intervals\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator/#mecfs_bio.asset_generator.ukbb_broad_ld_matrix_generator.get_genomic_interval_ld_labels_task","title":"get_genomic_interval_ld_labels_task","text":"<pre><code>get_genomic_interval_ld_labels_task(\n    interval: GenomicInterval,\n) -&gt; Task\n</code></pre> Source code in <code>mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator.py</code> <pre><code>def get_genomic_interval_ld_labels_task(interval: GenomicInterval) -&gt; Task:\n    stem = get_genomic_interval_stem_name(interval)\n    url = get_genomic_interval_ld_labels_url(interval)\n    return DownloadFileTask(\n        meta=ReferenceFileMeta(\n            group=\"ukbb_reference_ld\",\n            sub_group=stem,\n            sub_folder=PurePath(\"raw\"),\n            id=AssetId(f\"ukbb_broad_ld_{stem}_labels\"),\n            filename=stem,\n            extension=\".gz\",\n            read_spec=DataFrameReadSpec(DataFrameTextFormat(separator=\"\\t\")),\n        ),\n        url=url,\n        md5_hash=None,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator/#mecfs_bio.asset_generator.ukbb_broad_ld_matrix_generator.get_genomic_interval_ld_labels_url","title":"get_genomic_interval_ld_labels_url","text":"<pre><code>get_genomic_interval_ld_labels_url(\n    interval: GenomicInterval,\n) -&gt; str\n</code></pre> Source code in <code>mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator.py</code> <pre><code>def get_genomic_interval_ld_labels_url(interval: GenomicInterval) -&gt; str:\n    return (\n        \"https://broad-alkesgroup-ukbb-ld.s3.amazonaws.com/UKBB_LD/\"\n        + get_genomic_interval_stem_name(interval)\n        + \".gz\"\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator/#mecfs_bio.asset_generator.ukbb_broad_ld_matrix_generator.get_genomic_interval_ld_matrix_task","title":"get_genomic_interval_ld_matrix_task","text":"<pre><code>get_genomic_interval_ld_matrix_task(\n    interval: GenomicInterval,\n) -&gt; Task\n</code></pre> Source code in <code>mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator.py</code> <pre><code>def get_genomic_interval_ld_matrix_task(interval: GenomicInterval) -&gt; Task:\n    stem = get_genomic_interval_stem_name(interval)\n    url = get_genomic_interval_ld_matrix_url(interval)\n    return DownloadFileTask(\n        meta=ReferenceFileMeta(\n            group=\"ukbb_reference_ld\",\n            sub_group=stem,\n            sub_folder=PurePath(\"raw\"),\n            id=AssetId(f\"ukbb_broad_ld_{stem}_matrix\"),\n            filename=stem,\n            extension=\".npz\",\n        ),\n        url=url,\n        md5_hash=None,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator/#mecfs_bio.asset_generator.ukbb_broad_ld_matrix_generator.get_genomic_interval_ld_matrix_url","title":"get_genomic_interval_ld_matrix_url","text":"<pre><code>get_genomic_interval_ld_matrix_url(\n    interval: GenomicInterval,\n) -&gt; str\n</code></pre> Source code in <code>mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator.py</code> <pre><code>def get_genomic_interval_ld_matrix_url(interval: GenomicInterval) -&gt; str:\n    return (\n        \"https://broad-alkesgroup-ukbb-ld.s3.amazonaws.com/UKBB_LD/\"\n        + get_genomic_interval_stem_name(interval)\n        + \".npz\"\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator/#mecfs_bio.asset_generator.ukbb_broad_ld_matrix_generator.get_genomic_interval_stem_name","title":"get_genomic_interval_stem_name","text":"<pre><code>get_genomic_interval_stem_name(\n    interval: GenomicInterval,\n) -&gt; str\n</code></pre> Source code in <code>mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator.py</code> <pre><code>def get_genomic_interval_stem_name(\n    interval: GenomicInterval,\n) -&gt; str:\n    return f\"chr{interval.chrom}_{interval.start}_{interval.end}\"\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator/#mecfs_bio.asset_generator.ukbb_broad_ld_matrix_generator.get_ld_labels_and_matrix_task_for_chrom_pos_build_37","title":"get_ld_labels_and_matrix_task_for_chrom_pos_build_37","text":"<pre><code>get_ld_labels_and_matrix_task_for_chrom_pos_build_37(\n    chrom: int, pos: int\n) -&gt; tuple[Task, Task]\n</code></pre> Source code in <code>mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator.py</code> <pre><code>def get_ld_labels_and_matrix_task_for_chrom_pos_build_37(\n    chrom: int, pos: int\n) -&gt; tuple[Task, Task]:\n    interval = get_optimal_ukbb_ld_interval(chrom=chrom, pos=pos)\n    return get_ld_labels_and_matrix_task_for_genomic_interval_build_37(\n        interval=interval\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator/#mecfs_bio.asset_generator.ukbb_broad_ld_matrix_generator.get_ld_labels_and_matrix_task_for_genomic_interval_build_37","title":"get_ld_labels_and_matrix_task_for_genomic_interval_build_37","text":"<pre><code>get_ld_labels_and_matrix_task_for_genomic_interval_build_37(\n    interval: GenomicInterval,\n)\n</code></pre> Source code in <code>mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator.py</code> <pre><code>def get_ld_labels_and_matrix_task_for_genomic_interval_build_37(\n    interval: GenomicInterval,\n):\n    return (\n        get_genomic_interval_ld_labels_task(interval=interval),\n        get_genomic_interval_ld_matrix_task(interval=interval),\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator/#mecfs_bio.asset_generator.ukbb_broad_ld_matrix_generator.get_optimal_ukbb_ld_interval","title":"get_optimal_ukbb_ld_interval","text":"<pre><code>get_optimal_ukbb_ld_interval(\n    chrom: int, pos: int\n) -&gt; GenomicInterval\n</code></pre> Source code in <code>mecfs_bio/asset_generator/ukbb_broad_ld_matrix_generator.py</code> <pre><code>def get_optimal_ukbb_ld_interval(chrom: int, pos: int) -&gt; GenomicInterval:\n    broad_ld_df = get_broad_ukbb_ld_matrix_file_info()\n\n    valid_intervals_df = broad_ld_df.loc[\n        (broad_ld_df[\"chrom\"] == chrom)\n        &amp; (broad_ld_df[\"start\"] &lt;= pos)\n        &amp; (broad_ld_df[\"end\"] &gt;= pos)\n    ]\n    if len(valid_intervals_df) == 0:\n        raise ValueError(\n            f\"Could not find a broad UKKBB LD matrix for chromosome {chrom}, position {pos}\"\n        )\n\n    valid_intervals_df[\"start_dist\"] = pos - valid_intervals_df[\"start\"]\n    valid_intervals_df[\"end_dist\"] = valid_intervals_df[\"end\"] - pos\n    valid_intervals_df[\"centrality\"] = (\n        valid_intervals_df.loc[:, [\"start_dist\", \"end_dist\"]]\n    ).min(axis=1)\n    valid_intervals_df = valid_intervals_df.sort_values(\n        by=\"centrality\", ascending=False\n    )\n    optimal_interval = valid_intervals_df.iloc[0]\n    return GenomicInterval(\n        optimal_interval[\"chrom\"].item(),\n        optimal_interval[\"start\"].item(),\n        optimal_interval[\"end\"].item(),\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/ukbb_ppp_single_gwas_generator/","title":"ukbb_ppp_single_gwas_generator","text":""},{"location":"reference/mecfs_bio/asset_generator/ukbb_ppp_single_gwas_generator/#mecfs_bio.asset_generator.ukbb_ppp_single_gwas_generator","title":"mecfs_bio.asset_generator.ukbb_ppp_single_gwas_generator","text":"<p>Asset generator for downloading and preprocessing data from the UK Biobank Pharma Proteomics Project.</p> <p>Classes:</p> <ul> <li> <code>UKBBPPPGWASPrep</code>           \u2013            <p>Grouping of tasks for downloading and preprocessing data from a UK Biobank Pharma Proteomics Project GWAS.</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>ubbb_ppp_gwas_prep</code>             \u2013              <p>Asset generator to generate tasks to download and preprocess data from one of the UK Biobank Pharma Proteomics Project GWAS</p> </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/ukbb_ppp_single_gwas_generator/#mecfs_bio.asset_generator.ukbb_ppp_single_gwas_generator.UKBBPPPGWASPrep","title":"UKBBPPPGWASPrep","text":"<p>Grouping of tasks for downloading and preprocessing data from a UK Biobank Pharma Proteomics Project GWAS.</p> <p>Attributes:</p> <ul> <li> <code>fetch_task</code>               (<code>GetFileFromSynapseTask</code>)           \u2013            </li> <li> <code>plot_task</code>               (<code>GwasLabRegionPlotTargetLocusTask</code>)           \u2013            </li> <li> <code>stack_task</code>               (<code>ConcatFramesInDirTask</code>)           \u2013            </li> <li> <code>sumstats_37_task</code>               (<code>GWASLabCreateSumstatsTask</code>)           \u2013            </li> <li> <code>untar_task</code>               (<code>ExtractTarGzipTask</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/asset_generator/ukbb_ppp_single_gwas_generator/#mecfs_bio.asset_generator.ukbb_ppp_single_gwas_generator.UKBBPPPGWASPrep.fetch_task","title":"fetch_task  <code>instance-attribute</code>","text":"<pre><code>fetch_task: GetFileFromSynapseTask\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/ukbb_ppp_single_gwas_generator/#mecfs_bio.asset_generator.ukbb_ppp_single_gwas_generator.UKBBPPPGWASPrep.plot_task","title":"plot_task  <code>instance-attribute</code>","text":"<pre><code>plot_task: GwasLabRegionPlotTargetLocusTask\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/ukbb_ppp_single_gwas_generator/#mecfs_bio.asset_generator.ukbb_ppp_single_gwas_generator.UKBBPPPGWASPrep.stack_task","title":"stack_task  <code>instance-attribute</code>","text":"<pre><code>stack_task: ConcatFramesInDirTask\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/ukbb_ppp_single_gwas_generator/#mecfs_bio.asset_generator.ukbb_ppp_single_gwas_generator.UKBBPPPGWASPrep.sumstats_37_task","title":"sumstats_37_task  <code>instance-attribute</code>","text":"<pre><code>sumstats_37_task: GWASLabCreateSumstatsTask\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/ukbb_ppp_single_gwas_generator/#mecfs_bio.asset_generator.ukbb_ppp_single_gwas_generator.UKBBPPPGWASPrep.untar_task","title":"untar_task  <code>instance-attribute</code>","text":"<pre><code>untar_task: ExtractTarGzipTask\n</code></pre>"},{"location":"reference/mecfs_bio/asset_generator/ukbb_ppp_single_gwas_generator/#mecfs_bio.asset_generator.ukbb_ppp_single_gwas_generator.ubbb_ppp_gwas_prep","title":"ubbb_ppp_gwas_prep","text":"<pre><code>ubbb_ppp_gwas_prep(\n    gene_name: str,\n    syn_id: str,\n    expected_filename: str,\n    region_to_plot_chrom: int,\n    region_to_plot_37_pos: int,\n)\n</code></pre> <p>Asset generator to generate tasks to download and preprocess data from one of the UK Biobank Pharma Proteomics Project GWAS</p> <p>Also plots a region of the downloaded GWAS.</p> Source code in <code>mecfs_bio/asset_generator/ukbb_ppp_single_gwas_generator.py</code> <pre><code>def ubbb_ppp_gwas_prep(\n    gene_name: str,\n    syn_id: str,\n    expected_filename: str,\n    region_to_plot_chrom: int,\n    region_to_plot_37_pos: int,\n):\n    \"\"\"\n    Asset generator to generate tasks to download and preprocess data from one of the UK Biobank Pharma Proteomics Project GWAS\n\n    Also plots a region of the downloaded GWAS.\n    \"\"\"\n    base_name = gene_name + \"_ukbb_ppp\"\n    trait = \"ukbb_ppp\"\n    fetch_task = GetFileFromSynapseTask(\n        meta=GWASSummaryDataFileMeta(\n            id=AssetId(base_name + \"_downloaded_raw_data\"),\n            trait=trait,\n            project=gene_name,\n            sub_dir=\"raw\",\n            project_path=PurePath(expected_filename),\n        ),\n        synid=syn_id,\n        expected_filename=expected_filename,\n    )\n    untar_task = ExtractTarGzipTask.create(\n        asset_id=base_name + \"_untar\", source_task=fetch_task, read_mode=\"r\"\n    )\n\n    stack_task = ConcatFramesInDirTask.create(\n        asset_id=base_name + \"_stacked\",\n        source_dir_task=untar_task,\n        path_glob=\"*.gz\",\n        read_spec_for_frames=DataFrameReadSpec(DataFrameTextFormat(separator=\" \")),\n    )\n    sumstats_37_task = GWASLabCreateSumstatsTask(\n        df_source_task=stack_task,\n        asset_id=AssetId(base_name + \"_37_sumstats\"),\n        basic_check=True,\n        genome_build=\"infer\",\n        liftover_to=\"19\",\n        fmt=\"regenie\",\n        harmonize_options=None,\n    )\n    plot_task = GwasLabRegionPlotTargetLocusTask.create(\n        asset_id=base_name + \"_region_plot\",\n        sumstats_task=sumstats_37_task,\n        vcf_name_for_ld=\"1kg_eur_hg19\",\n        chrom=region_to_plot_chrom,\n        pos=region_to_plot_37_pos,\n    )\n    return UKBBPPPGWASPrep(\n        fetch_task=fetch_task,\n        untar_task=untar_task,\n        stack_task=stack_task,\n        sumstats_37_task=sumstats_37_task,\n        plot_task=plot_task,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/assets/","title":"assets","text":""},{"location":"reference/mecfs_bio/assets/#mecfs_bio.assets","title":"mecfs_bio.assets","text":"<p>Definitions of the Task objects used to fetch biostatistical datasets, preprocess them, perform relevant analysis, and report results.</p> <p>Modules:</p> <ul> <li> <code>executable</code>           \u2013            <p>Tasks to download and prepare executables.</p> </li> <li> <code>gwas</code>           \u2013            <p>This module contains Tasks for retrieving, preparing, and analyzing GWAS data.</p> </li> <li> <code>multi_gwas</code>           \u2013            </li> <li> <code>reference_data</code>           \u2013            <p>Tasks to download and prepare reference data.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/executable/","title":"executable","text":""},{"location":"reference/mecfs_bio/assets/executable/#mecfs_bio.assets.executable","title":"mecfs_bio.assets.executable","text":"<p>Tasks to download and prepare executables.</p> <p>Modules:</p> <ul> <li> <code>extracted</code>           \u2013            </li> <li> <code>raw</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/executable/extracted/","title":"extracted","text":""},{"location":"reference/mecfs_bio/assets/executable/extracted/#mecfs_bio.assets.executable.extracted","title":"mecfs_bio.assets.executable.extracted","text":"<p>Modules:</p> <ul> <li> <code>magma_binary_extracted</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/executable/extracted/magma_binary_extracted/","title":"magma_binary_extracted","text":""},{"location":"reference/mecfs_bio/assets/executable/extracted/magma_binary_extracted/#mecfs_bio.assets.executable.extracted.magma_binary_extracted","title":"mecfs_bio.assets.executable.extracted.magma_binary_extracted","text":"<p>Attributes:</p> <ul> <li> <code>MAGMA_1_1_BINARY_EXTRACTED</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/executable/extracted/magma_binary_extracted/#mecfs_bio.assets.executable.extracted.magma_binary_extracted.MAGMA_1_1_BINARY_EXTRACTED","title":"MAGMA_1_1_BINARY_EXTRACTED  <code>module-attribute</code>","text":"<pre><code>MAGMA_1_1_BINARY_EXTRACTED = create_from_zipped_executable(\n    source_task=MAGMA_1_1_BINARY_ZIPPED,\n    asset_id=\"magma_1_1_binary_extracted\",\n    file_to_extract=\"magma\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/executable/raw/","title":"raw","text":""},{"location":"reference/mecfs_bio/assets/executable/raw/#mecfs_bio.assets.executable.raw","title":"mecfs_bio.assets.executable.raw","text":"<p>Modules:</p> <ul> <li> <code>magma_binary_zip</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/executable/raw/magma_binary_zip/","title":"magma_binary_zip","text":""},{"location":"reference/mecfs_bio/assets/executable/raw/magma_binary_zip/#mecfs_bio.assets.executable.raw.magma_binary_zip","title":"mecfs_bio.assets.executable.raw.magma_binary_zip","text":"<p>Attributes:</p> <ul> <li> <code>MAGMA_1_1_BINARY_ZIPPED</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/executable/raw/magma_binary_zip/#mecfs_bio.assets.executable.raw.magma_binary_zip.MAGMA_1_1_BINARY_ZIPPED","title":"MAGMA_1_1_BINARY_ZIPPED  <code>module-attribute</code>","text":"<pre><code>MAGMA_1_1_BINARY_ZIPPED = DownloadFileTask(\n    meta=create(\n        group=\"gene_set_analysis\",\n        sub_folder=PurePath(\"raw\"),\n        asset_id=\"magma_1_1_binary_zip\",\n        extension=\".zip\",\n        filename=\"magma_v1.10\",\n    ),\n    url=\"https://vu.data.surf.nl/public.php/dav/files/zkKbNeNOZAhFXZB/?accept=zip\",\n    md5_hash=\"139171d8b859527b6c9231103c4d695f\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/","title":"gwas","text":""},{"location":"reference/mecfs_bio/assets/gwas/#mecfs_bio.assets.gwas","title":"mecfs_bio.assets.gwas","text":"<p>This module contains Tasks for retrieving, preparing, and analyzing GWAS data.</p> <p>Modules:</p> <ul> <li> <code>alzheimers</code>           \u2013            </li> <li> <code>asthma</code>           \u2013            </li> <li> <code>blood_pressure</code>           \u2013            </li> <li> <code>body_fat_distribution</code>           \u2013            </li> <li> <code>educational_attainment</code>           \u2013            </li> <li> <code>heart_rate_recovery</code>           \u2013            </li> <li> <code>imaging_derived_heart_phenotypes</code>           \u2013            </li> <li> <code>inflammatory_bowel_disease</code>           \u2013            </li> <li> <code>ldl</code>           \u2013            </li> <li> <code>me_cfs</code>           \u2013            <p>Tasks pertaining to ME/CFS  GWAS.</p> </li> <li> <code>multisite_pain</code>           \u2013            </li> <li> <code>psoriasis</code>           \u2013            </li> <li> <code>red_blood_cell_volume</code>           \u2013            </li> <li> <code>schizophrenia</code>           \u2013            </li> <li> <code>syncope</code>           \u2013            </li> <li> <code>systemic_lupus_erythematosus</code>           \u2013            </li> <li> <code>ukbb_ppp</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/alzheimers/","title":"alzheimers","text":""},{"location":"reference/mecfs_bio/assets/gwas/alzheimers/#mecfs_bio.assets.gwas.alzheimers","title":"mecfs_bio.assets.gwas.alzheimers","text":"<p>Modules:</p> <ul> <li> <code>bellenguez_et_al</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/alzheimers/bellenguez_et_al/","title":"bellenguez_et_al","text":""},{"location":"reference/mecfs_bio/assets/gwas/alzheimers/bellenguez_et_al/#mecfs_bio.assets.gwas.alzheimers.bellenguez_et_al","title":"mecfs_bio.assets.gwas.alzheimers.bellenguez_et_al","text":"<p>Modules:</p> <ul> <li> <code>analysis</code>           \u2013            </li> <li> <code>processed</code>           \u2013            </li> <li> <code>raw</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/alzheimers/bellenguez_et_al/analysis/","title":"analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/alzheimers/bellenguez_et_al/analysis/#mecfs_bio.assets.gwas.alzheimers.bellenguez_et_al.analysis","title":"mecfs_bio.assets.gwas.alzheimers.bellenguez_et_al.analysis","text":"<p>Modules:</p> <ul> <li> <code>bellenguez_standard_analysis</code>           \u2013            <p>Apply standard MAGMA and S-LDSC analysis to Bellenguez et al.'s meta-GWAS of Alzheimer's</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/alzheimers/bellenguez_et_al/analysis/bellenguez_standard_analysis/","title":"bellenguez_standard_analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/alzheimers/bellenguez_et_al/analysis/bellenguez_standard_analysis/#mecfs_bio.assets.gwas.alzheimers.bellenguez_et_al.analysis.bellenguez_standard_analysis","title":"mecfs_bio.assets.gwas.alzheimers.bellenguez_et_al.analysis.bellenguez_standard_analysis","text":"<p>Apply standard MAGMA and S-LDSC analysis to Bellenguez et al.'s meta-GWAS of Alzheimer's</p> <p>Attributes:</p> <ul> <li> <code>BELLENGUEZ_STANDARD_ANALYSIS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/alzheimers/bellenguez_et_al/analysis/bellenguez_standard_analysis/#mecfs_bio.assets.gwas.alzheimers.bellenguez_et_al.analysis.bellenguez_standard_analysis.BELLENGUEZ_STANDARD_ANALYSIS","title":"BELLENGUEZ_STANDARD_ANALYSIS  <code>module-attribute</code>","text":"<pre><code>BELLENGUEZ_STANDARD_ANALYSIS = concrete_standard_analysis_generator_assume_already_has_rsid(\n    base_name=\"bellenguez_et_al_alz\",\n    raw_gwas_data_task=BELLINGUEZ_ET_AL_ALZHEIMERS_EXTRACTED,\n    sample_size=487511,\n    include_hba_magma_tasks=True,\n    fmt=GWASLabColumnSpecifiers(\n        rsid=\"hm_rsid\",\n        snpid=\"hm_variant_id\",\n        chrom=\"hm_chrom\",\n        pos=\"hm_pos\",\n        ea=\"hm_effect_allele\",\n        nea=\"hm_other_allele\",\n        OR=\"hm_odds_ratio\",\n        se=\"standard_error\",\n        p=\"p_value\",\n        eaf=\"hm_effect_allele_frequency\",\n        beta=\"hm_beta\",\n        ncase=\"n_cas\",\n        ncontrol=\"n_con\",\n    ),\n    pre_pipe=DropNullsPipe(),\n    hba_plot_settings=PlotSettings(\"plotly_white\"),\n    include_independent_cluster_plot_in_hba=True,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/alzheimers/bellenguez_et_al/processed/","title":"processed","text":""},{"location":"reference/mecfs_bio/assets/gwas/alzheimers/bellenguez_et_al/processed/#mecfs_bio.assets.gwas.alzheimers.bellenguez_et_al.processed","title":"mecfs_bio.assets.gwas.alzheimers.bellenguez_et_al.processed","text":"<p>Modules:</p> <ul> <li> <code>extracted_bellinguez_data</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/alzheimers/bellenguez_et_al/processed/extracted_bellinguez_data/","title":"extracted_bellinguez_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/alzheimers/bellenguez_et_al/processed/extracted_bellinguez_data/#mecfs_bio.assets.gwas.alzheimers.bellenguez_et_al.processed.extracted_bellinguez_data","title":"mecfs_bio.assets.gwas.alzheimers.bellenguez_et_al.processed.extracted_bellinguez_data","text":"<p>Attributes:</p> <ul> <li> <code>BELLINGUEZ_ET_AL_ALZHEIMERS_EXTRACTED</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/alzheimers/bellenguez_et_al/processed/extracted_bellinguez_data/#mecfs_bio.assets.gwas.alzheimers.bellenguez_et_al.processed.extracted_bellinguez_data.BELLINGUEZ_ET_AL_ALZHEIMERS_EXTRACTED","title":"BELLINGUEZ_ET_AL_ALZHEIMERS_EXTRACTED  <code>module-attribute</code>","text":"<pre><code>BELLINGUEZ_ET_AL_ALZHEIMERS_EXTRACTED = (\n    create_for_gwas_file(\n        source_file_task=BELLENGUEZ_ET_AL_ALZHEIMERS_RAW,\n        asset_id=\"bellinguez_alz_extracted\",\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/alzheimers/bellenguez_et_al/raw/","title":"raw","text":""},{"location":"reference/mecfs_bio/assets/gwas/alzheimers/bellenguez_et_al/raw/#mecfs_bio.assets.gwas.alzheimers.bellenguez_et_al.raw","title":"mecfs_bio.assets.gwas.alzheimers.bellenguez_et_al.raw","text":"<p>Modules:</p> <ul> <li> <code>raw_bellenguez_data</code>           \u2013            <p>Task to download GWAS summary statistics from Bellenguez et al's Alzheimers GWAS</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/alzheimers/bellenguez_et_al/raw/raw_bellenguez_data/","title":"raw_bellenguez_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/alzheimers/bellenguez_et_al/raw/raw_bellenguez_data/#mecfs_bio.assets.gwas.alzheimers.bellenguez_et_al.raw.raw_bellenguez_data","title":"mecfs_bio.assets.gwas.alzheimers.bellenguez_et_al.raw.raw_bellenguez_data","text":"<p>Task to download GWAS summary statistics from Bellenguez et al's Alzheimers GWAS</p> <p>see: https://www.ebi.ac.uk/gwas/studies/GCST90027158</p> <p>Citation: Bellenguez, C\u00e9line, et al. \"New insights into the genetic etiology of Alzheimer\u2019s disease and related dementias.Nature genetics (2022): 412-436.</p> <p>Attributes:</p> <ul> <li> <code>BELLENGUEZ_ET_AL_ALZHEIMERS_RAW</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/alzheimers/bellenguez_et_al/raw/raw_bellenguez_data/#mecfs_bio.assets.gwas.alzheimers.bellenguez_et_al.raw.raw_bellenguez_data.BELLENGUEZ_ET_AL_ALZHEIMERS_RAW","title":"BELLENGUEZ_ET_AL_ALZHEIMERS_RAW  <code>module-attribute</code>","text":"<pre><code>BELLENGUEZ_ET_AL_ALZHEIMERS_RAW = DownloadFileTask(\n    meta=GWASSummaryDataFileMeta(\n        id=AssetId(\"bellenguez_et_al_alzheimers_raw\"),\n        trait=\"alzheimers\",\n        project=\"bellenguez_et_al\",\n        sub_dir=\"raw\",\n        project_path=PurePath(\n            \"35379992-GCST90027158-MONDO_0004975.h.tsv.gz\"\n        ),\n        read_spec=DataFrameReadSpec(\n            format=DataFrameTextFormat(\n                separator=\"\\t\", null_values=[\"NaN\", \"NA\"]\n            )\n        ),\n    ),\n    url=\"http://ftp.ebi.ac.uk/pub/databases/gwas/summary_statistics/GCST90027001-GCST90028000/GCST90027158/harmonised/35379992-GCST90027158-MONDO_0004975.h.tsv.gz\",\n    md5_hash=\"e2c8be73b5aa7698c5e8878ae607fe85\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/asthma/","title":"asthma","text":""},{"location":"reference/mecfs_bio/assets/gwas/asthma/#mecfs_bio.assets.gwas.asthma","title":"mecfs_bio.assets.gwas.asthma","text":"<p>Modules:</p> <ul> <li> <code>han_et_al_2022</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/","title":"han_et_al_2022","text":""},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/#mecfs_bio.assets.gwas.asthma.han_et_al_2022","title":"mecfs_bio.assets.gwas.asthma.han_et_al_2022","text":"<p>Modules:</p> <ul> <li> <code>analysis</code>           \u2013            </li> <li> <code>raw</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/","title":"analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/#mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis","title":"mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis","text":"<p>Modules:</p> <ul> <li> <code>asthma_ppp_two_sample_mr_cis</code>           \u2013            <p>Task to use pQTLs derived from the Pharma Proteomics Project as exposures in a Mendelian randomization analysis of the Han et al. asthma GWAS.</p> </li> <li> <code>asthma_standard_analysis</code>           \u2013            <p>Task generator to perform standard analysis (S-LDSC and MAGMA using standard reference datasets)</p> </li> <li> <code>mr</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/asthma_ppp_two_sample_mr_cis/","title":"asthma_ppp_two_sample_mr_cis","text":""},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/asthma_ppp_two_sample_mr_cis/#mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.asthma_ppp_two_sample_mr_cis","title":"mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.asthma_ppp_two_sample_mr_cis","text":"<p>Task to use pQTLs derived from the Pharma Proteomics Project as exposures in a Mendelian randomization analysis of the Han et al. asthma GWAS.</p> <p>Attributes:</p> <ul> <li> <code>HAN_2022_ASTHMA_TSMR</code>           \u2013            </li> <li> <code>PROTEIN_EXPOSURE_COL</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/asthma_ppp_two_sample_mr_cis/#mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.asthma_ppp_two_sample_mr_cis.HAN_2022_ASTHMA_TSMR","title":"HAN_2022_ASTHMA_TSMR  <code>module-attribute</code>","text":"<pre><code>HAN_2022_ASTHMA_TSMR = create(\n    asset_id=\"two_sample_mr_asthma_han\",\n    outcome_data_task=parquet_file_task,\n    exposure_data_task=SUN_ET_AL_2023_COMBINED_PQTLS_EXTRACTED,\n    config=TwoSampleMRConfig(\n        clump_exposure_data=None,\n        pre_filter_outcome_variants=True,\n        steiger_filter=SteigerFilteringOptions(True),\n    ),\n    exposure_pipe=CompositePipe(\n        [\n            ConcatStrPipe(\n                [SUN_ASSAY_TARGET, SUN_TARGET_UNIPROT],\n                sep=\"_\",\n                new_col_name=PROTEIN_EXPOSURE_COL,\n            ),\n            FilterRowsByValue(\n                target_column=SUN_CIS_TRANS_COL,\n                valid_values=[SUN_CIS],\n            ),\n            RenameColPipe(\n                SUN_MLOG10_P_COL, GWASLAB_MLOG10P_COL\n            ),\n            ComputePPipe(),\n            SetColToConstantPipe(\n                GWASLAB_SAMPLE_SIZE_COLUMN, constant=54219\n            ),\n        ]\n    ),\n    exposure_col_spec=evolve(\n        SUN_ET_AL_MR_INPUT_COL_SPEC_hg37,\n        sample_size_col=GWASLAB_SAMPLE_SIZE_COLUMN,\n    ),\n    outcome_col_spec=GWASLAB_MR_INPUT_COL_SPEC,\n    outcome_pipe=CompositePipe(\n        [\n            ComputeBetaPipe(),\n            ComputeSEPipe(),\n            SetColToConstantPipe(\n                col_name=GWASLAB_N_CASE_COL, constant=64538\n            ),\n            SetColToConstantPipe(\n                col_name=GWASLAB_N_CONTROL_COL,\n                constant=329321,\n            ),\n            ComputePIfNeededPipe(),\n            SetColToConstantPipe(\n                TSM_UNITS_COL, constant=\"log odds\"\n            ),\n        ]\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/asthma_ppp_two_sample_mr_cis/#mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.asthma_ppp_two_sample_mr_cis.PROTEIN_EXPOSURE_COL","title":"PROTEIN_EXPOSURE_COL  <code>module-attribute</code>","text":"<pre><code>PROTEIN_EXPOSURE_COL = 'protein_exposure_id'\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/asthma_standard_analysis/","title":"asthma_standard_analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/asthma_standard_analysis/#mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.asthma_standard_analysis","title":"mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.asthma_standard_analysis","text":"<p>Task generator to perform standard analysis (S-LDSC and MAGMA using standard reference datasets) on asthma GWAS from Han et al.</p> <p>Attributes:</p> <ul> <li> <code>HAN_ASTHMA_STANDARD_ANALYSIS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/asthma_standard_analysis/#mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.asthma_standard_analysis.HAN_ASTHMA_STANDARD_ANALYSIS","title":"HAN_ASTHMA_STANDARD_ANALYSIS  <code>module-attribute</code>","text":"<pre><code>HAN_ASTHMA_STANDARD_ANALYSIS = concrete_standard_analysis_generator_assume_already_has_rsid(\n    base_name=\"han_asthma\",\n    raw_gwas_data_task=HAN_ET_AL_ASTHMA_RAW,\n    fmt=GWASLabColumnSpecifiers(\n        rsid=\"SNP\",\n        chrom=\"CHR\",\n        pos=\"BP\",\n        ea=\"EA\",\n        nea=\"NEA\",\n        eaf=\"EAF\",\n        info=\"INFO\",\n        OR=\"OR\",\n        or_95l=\"OR_95L\",\n        or_95u=\"OR_95U\",\n        p=\"P\",\n        snpid=None,\n        se=None,\n    ),\n    sample_size=393859,\n    include_master_gene_lists=False,\n    pre_sldsc_pipe=CompositePipe(\n        [ComputeBetaPipe(), ComputeSEPipe()]\n    ),\n    include_hba_magma_tasks=True,\n    include_independent_cluster_plot_in_hba=True,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/mr/","title":"mr","text":""},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/mr/#mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.mr","title":"mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.mr","text":"<p>Modules:</p> <ul> <li> <code>asthma_ppp_cis_mr_effect_measure_plot</code>           \u2013            <p>Create a effect measure plot illustrating the results of Mendelian randomization with cis-pQTLs applied to the Asthma GWAS</p> </li> <li> <code>asthma_ppp_cis_mr_label_with_uniprot</code>           \u2013            <p>Label significant proteins from MR analysis for Asthma GWAS using descriptions from UniProt</p> </li> <li> <code>asthma_ppp_cis_mr_markdown</code>           \u2013            <p>Produce a markdown table of significant proteins from MR analysis of Asthma GWAS</p> </li> <li> <code>asthma_ppp_cis_mr_multiple_testing</code>           \u2013            </li> <li> <code>asthma_ppp_cis_two_sample_mr_extract</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/mr/asthma_ppp_cis_mr_effect_measure_plot/","title":"asthma_ppp_cis_mr_effect_measure_plot","text":""},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/mr/asthma_ppp_cis_mr_effect_measure_plot/#mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.mr.asthma_ppp_cis_mr_effect_measure_plot","title":"mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.mr.asthma_ppp_cis_mr_effect_measure_plot","text":"<p>Create a effect measure plot illustrating the results of Mendelian randomization with cis-pQTLs applied to the Asthma GWAS</p> <p>Attributes:</p> <ul> <li> <code>HAN_CIS_PPP_MR_PLOT</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/mr/asthma_ppp_cis_mr_effect_measure_plot/#mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.mr.asthma_ppp_cis_mr_effect_measure_plot.HAN_CIS_PPP_MR_PLOT","title":"HAN_CIS_PPP_MR_PLOT  <code>module-attribute</code>","text":"<pre><code>HAN_CIS_PPP_MR_PLOT = create(\n    asset_id=\"cis_ppp_mr_effect_measure_plot\",\n    source_df_task=HAN_2022_ASTHMA_CIS_PPP_TSMR_MULTIPLE_TESTING,\n    config=EffectMeasurePlotConfig(\n        y_label_col=SUN_ASSAY_TARGET,\n        y_label=\"Protein\",\n        effect_size_col=TSM_OUTPUT_B_COL,\n        effect_size_label=\"b\",\n        se_col=TSM_OUTPUT_SE_COL,\n        ref_line_center=0,\n        figsize=(14 * 1.3, 6 * 1.3),\n        t_adjust=0.02,\n    ),\n    pre_pipe=SplitExactColPipe(\n        TSM_OUTPUT_EXPOSURE_COL,\n        split_by=\"_\",\n        new_col_names=(\n            SUN_ASSAY_TARGET,\n            SUN_TARGET_UNIPROT,\n        ),\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/mr/asthma_ppp_cis_mr_label_with_uniprot/","title":"asthma_ppp_cis_mr_label_with_uniprot","text":""},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/mr/asthma_ppp_cis_mr_label_with_uniprot/#mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.mr.asthma_ppp_cis_mr_label_with_uniprot","title":"mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.mr.asthma_ppp_cis_mr_label_with_uniprot","text":"<p>Label significant proteins from MR analysis for Asthma GWAS using descriptions from UniProt</p> <p>Attributes:</p> <ul> <li> <code>ASTHMA_PP_CIS_MR_UNIPROT_LABELED</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/mr/asthma_ppp_cis_mr_label_with_uniprot/#mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.mr.asthma_ppp_cis_mr_label_with_uniprot.ASTHMA_PP_CIS_MR_UNIPROT_LABELED","title":"ASTHMA_PP_CIS_MR_UNIPROT_LABELED  <code>module-attribute</code>","text":"<pre><code>ASTHMA_PP_CIS_MR_UNIPROT_LABELED = create_from_result_df(\n    asset_id=\"asthma_ppp_cis_mr_labeled_with_uniprot\",\n    result_df_task=HAN_2022_ASTHMA_CIS_PPP_TSMR_MULTIPLE_TESTING,\n    reference_df_task=UNIPROT_LOOKUP,\n    how=\"left\",\n    df_1_pipe=SplitExactColPipe(\n        TSM_OUTPUT_EXPOSURE_COL,\n        split_by=\"_\",\n        new_col_names=(\n            SUN_ASSAY_TARGET,\n            SUN_TARGET_UNIPROT,\n        ),\n    ),\n    left_on=[SUN_TARGET_UNIPROT],\n    right_on=[UNIPROT_DAT_ID_COL],\n    out_format=ParquetOutFormat(),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/mr/asthma_ppp_cis_mr_markdown/","title":"asthma_ppp_cis_mr_markdown","text":""},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/mr/asthma_ppp_cis_mr_markdown/#mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.mr.asthma_ppp_cis_mr_markdown","title":"mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.mr.asthma_ppp_cis_mr_markdown","text":"<p>Produce a markdown table of significant proteins from MR analysis of Asthma GWAS</p> <p>Attributes:</p> <ul> <li> <code>ASTHMA_HAN_PPP_CIS_MR_MARKDOWN</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/mr/asthma_ppp_cis_mr_markdown/#mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.mr.asthma_ppp_cis_mr_markdown.ASTHMA_HAN_PPP_CIS_MR_MARKDOWN","title":"ASTHMA_HAN_PPP_CIS_MR_MARKDOWN  <code>module-attribute</code>","text":"<pre><code>ASTHMA_HAN_PPP_CIS_MR_MARKDOWN = (\n    create_from_result_table_task(\n        ASTHMA_PP_CIS_MR_UNIPROT_LABELED,\n        asset_id=\"asthma_han_cis_mr_markdown\",\n        pipe=CompositePipe(\n            [\n                SelectColPipe(\n                    [\n                        SUN_TARGET_UNIPROT,\n                        SUN_ASSAY_TARGET,\n                        TSM_OUTPUT_B_COL,\n                        TSM_OUTPUT_SE_COL,\n                        TSM_OUTPUT_P_COL,\n                        UNIPROT_DAT_FUNCTION_COL,\n                    ]\n                ),\n                SortPipe(by=[TSM_OUTPUT_P_COL]),\n            ]\n        ),\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/mr/asthma_ppp_cis_mr_multiple_testing/","title":"asthma_ppp_cis_mr_multiple_testing","text":""},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/mr/asthma_ppp_cis_mr_multiple_testing/#mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.mr.asthma_ppp_cis_mr_multiple_testing","title":"mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.mr.asthma_ppp_cis_mr_multiple_testing","text":"<p>Attributes:</p> <ul> <li> <code>HAN_2022_ASTHMA_CIS_PPP_TSMR_MULTIPLE_TESTING</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/mr/asthma_ppp_cis_mr_multiple_testing/#mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.mr.asthma_ppp_cis_mr_multiple_testing.HAN_2022_ASTHMA_CIS_PPP_TSMR_MULTIPLE_TESTING","title":"HAN_2022_ASTHMA_CIS_PPP_TSMR_MULTIPLE_TESTING  <code>module-attribute</code>","text":"<pre><code>HAN_2022_ASTHMA_CIS_PPP_TSMR_MULTIPLE_TESTING = create_from_result_table_task(\n    alpha=0.01,\n    method=\"bonferroni\",\n    asset_id=\"asthma_two_sample_mr_cis_ppp_multiple_testing\",\n    p_value_column=TSM_OUTPUT_P_COL,\n    source_task=HAN_2022_ASTHMA_CIS_PPP_TSMR_EXTRACT,\n    apply_filter=True,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/mr/asthma_ppp_cis_two_sample_mr_extract/","title":"asthma_ppp_cis_two_sample_mr_extract","text":""},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/mr/asthma_ppp_cis_two_sample_mr_extract/#mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.mr.asthma_ppp_cis_two_sample_mr_extract","title":"mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.mr.asthma_ppp_cis_two_sample_mr_extract","text":"<p>Attributes:</p> <ul> <li> <code>HAN_2022_ASTHMA_CIS_PPP_TSMR_EXTRACT</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/analysis/mr/asthma_ppp_cis_two_sample_mr_extract/#mecfs_bio.assets.gwas.asthma.han_et_al_2022.analysis.mr.asthma_ppp_cis_two_sample_mr_extract.HAN_2022_ASTHMA_CIS_PPP_TSMR_EXTRACT","title":"HAN_2022_ASTHMA_CIS_PPP_TSMR_EXTRACT  <code>module-attribute</code>","text":"<pre><code>HAN_2022_ASTHMA_CIS_PPP_TSMR_EXTRACT = create_result_table(\n    asset_id=\"two_sample_mr_ppp_cis_asthma_han_extract_results\",\n    source_directory_task=HAN_2022_ASTHMA_TSMR,\n    path_inside_directory=PurePath(MAIN_RESULT_DF_PATH),\n    extension=\".csv\",\n    read_spec=DataFrameReadSpec(\n        DataFrameTextFormat(separator=\",\")\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/raw/","title":"raw","text":""},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/raw/#mecfs_bio.assets.gwas.asthma.han_et_al_2022.raw","title":"mecfs_bio.assets.gwas.asthma.han_et_al_2022.raw","text":"<p>Modules:</p> <ul> <li> <code>raw_asthma_data</code>           \u2013            <p>Task to download raw summary statistics of Han et al's asthma GWAS as hosted on the GWAS catalog</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/raw/raw_asthma_data/","title":"raw_asthma_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/raw/raw_asthma_data/#mecfs_bio.assets.gwas.asthma.han_et_al_2022.raw.raw_asthma_data","title":"mecfs_bio.assets.gwas.asthma.han_et_al_2022.raw.raw_asthma_data","text":"<p>Task to download raw summary statistics of Han et al's asthma GWAS as hosted on the GWAS catalog</p> <p>Paper: Han, Yi, et al. \"Genome-wide analysis highlights contribution of immune system pathways to the genetic architecture of asthma.\" Nature communications 11.1 (2020): 1776.</p> <p>Attributes:</p> <ul> <li> <code>HAN_ET_AL_ASTHMA_RAW</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/asthma/han_et_al_2022/raw/raw_asthma_data/#mecfs_bio.assets.gwas.asthma.han_et_al_2022.raw.raw_asthma_data.HAN_ET_AL_ASTHMA_RAW","title":"HAN_ET_AL_ASTHMA_RAW  <code>module-attribute</code>","text":"<pre><code>HAN_ET_AL_ASTHMA_RAW = DownloadFileTask(\n    meta=GWASSummaryDataFileMeta(\n        id=AssetId(\"han_et_al_asthma_raw\"),\n        trait=\"asthma\",\n        project=\"han_et_al\",\n        sub_dir=\"raw\",\n        project_path=PurePath(\n            \"HanY_prePMID_asthma_UKBB.txt.gz\"\n        ),\n        read_spec=DataFrameReadSpec(\n            format=DataFrameTextFormat(separator=\"\\t\")\n        ),\n    ),\n    url=\"https://ftp.ebi.ac.uk/pub/databases/gwas/summary_statistics/GCST010001-GCST011000/GCST010042/HanY_prePMID_asthma_UKBB.txt.gz\",\n    md5_hash=\"0d34c6cb3581e5d8af73797bfa256f68\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/blood_pressure/","title":"blood_pressure","text":""},{"location":"reference/mecfs_bio/assets/gwas/blood_pressure/#mecfs_bio.assets.gwas.blood_pressure","title":"mecfs_bio.assets.gwas.blood_pressure","text":"<p>Modules:</p> <ul> <li> <code>keaton_et_al_diastolic</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/blood_pressure/keaton_et_al_diastolic/","title":"keaton_et_al_diastolic","text":""},{"location":"reference/mecfs_bio/assets/gwas/blood_pressure/keaton_et_al_diastolic/#mecfs_bio.assets.gwas.blood_pressure.keaton_et_al_diastolic","title":"mecfs_bio.assets.gwas.blood_pressure.keaton_et_al_diastolic","text":"<p>Modules:</p> <ul> <li> <code>analysis</code>           \u2013            </li> <li> <code>raw</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/blood_pressure/keaton_et_al_diastolic/analysis/","title":"analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/blood_pressure/keaton_et_al_diastolic/analysis/#mecfs_bio.assets.gwas.blood_pressure.keaton_et_al_diastolic.analysis","title":"mecfs_bio.assets.gwas.blood_pressure.keaton_et_al_diastolic.analysis","text":"<p>Modules:</p> <ul> <li> <code>keaton_dbp_standard_analysis</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/blood_pressure/keaton_et_al_diastolic/analysis/keaton_dbp_standard_analysis/","title":"keaton_dbp_standard_analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/blood_pressure/keaton_et_al_diastolic/analysis/keaton_dbp_standard_analysis/#mecfs_bio.assets.gwas.blood_pressure.keaton_et_al_diastolic.analysis.keaton_dbp_standard_analysis","title":"mecfs_bio.assets.gwas.blood_pressure.keaton_et_al_diastolic.analysis.keaton_dbp_standard_analysis","text":"<p>Attributes:</p> <ul> <li> <code>KEATON_DBP_STANDARD_ANALYSIS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/blood_pressure/keaton_et_al_diastolic/analysis/keaton_dbp_standard_analysis/#mecfs_bio.assets.gwas.blood_pressure.keaton_et_al_diastolic.analysis.keaton_dbp_standard_analysis.KEATON_DBP_STANDARD_ANALYSIS","title":"KEATON_DBP_STANDARD_ANALYSIS  <code>module-attribute</code>","text":"<pre><code>KEATON_DBP_STANDARD_ANALYSIS = concrete_standard_analysis_generator_assume_already_has_rsid(\n    base_name=\"keaton_dbp\",\n    raw_gwas_data_task=KEATON_ET_AL_DBP_RAW,\n    fmt=GWASLabColumnSpecifiers(\n        rsid=\"rsid\",\n        chrom=\"chromosome\",\n        pos=\"base_pair_location\",\n        ea=\"effect_allele\",\n        nea=\"other_allele\",\n        beta=\"beta\",\n        eaf=\"effect_allele_frequency\",\n        p=\"p_value\",\n        se=\"standard_error\",\n        n=\"n\",\n        snpid=\"variant_id\",\n        OR=None,\n        info=None,\n    ),\n    sample_size=729882,\n    include_master_gene_lists=False,\n    gtex_magma_number_of_bars=40,\n    include_hba_magma_tasks=True,\n    hba_plot_settings=PlotSettings(\"plotly_white\"),\n    include_independent_cluster_plot_in_hba=True,\n    hba_indep_plot_options=HBAIndepPlotOptions(\n        annotation_text_size=16\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/blood_pressure/keaton_et_al_diastolic/raw/","title":"raw","text":""},{"location":"reference/mecfs_bio/assets/gwas/blood_pressure/keaton_et_al_diastolic/raw/#mecfs_bio.assets.gwas.blood_pressure.keaton_et_al_diastolic.raw","title":"mecfs_bio.assets.gwas.blood_pressure.keaton_et_al_diastolic.raw","text":"<p>Modules:</p> <ul> <li> <code>raw_dbp_data</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/blood_pressure/keaton_et_al_diastolic/raw/raw_dbp_data/","title":"raw_dbp_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/blood_pressure/keaton_et_al_diastolic/raw/raw_dbp_data/#mecfs_bio.assets.gwas.blood_pressure.keaton_et_al_diastolic.raw.raw_dbp_data","title":"mecfs_bio.assets.gwas.blood_pressure.keaton_et_al_diastolic.raw.raw_dbp_data","text":"<p>Attributes:</p> <ul> <li> <code>KEATON_ET_AL_DBP_RAW</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/blood_pressure/keaton_et_al_diastolic/raw/raw_dbp_data/#mecfs_bio.assets.gwas.blood_pressure.keaton_et_al_diastolic.raw.raw_dbp_data.KEATON_ET_AL_DBP_RAW","title":"KEATON_ET_AL_DBP_RAW  <code>module-attribute</code>","text":"<pre><code>KEATON_ET_AL_DBP_RAW = DownloadFileTask(\n    meta=GWASSummaryDataFileMeta(\n        id=AssetId(\"keaton_et_al_dbp_raw\"),\n        trait=\"diastolic_blood_pressure\",\n        project=\"keaton_et_al_dbp\",\n        sub_dir=\"raw\",\n        project_path=PurePath(\"GCST90310295.h.tsv.gz\"),\n        read_spec=DataFrameReadSpec(\n            format=DataFrameTextFormat(separator=\"\\t\")\n        ),\n    ),\n    url=\"http://ftp.ebi.ac.uk/pub/databases/gwas/summary_statistics/GCST90310001-GCST90311000/GCST90310295/harmonised/GCST90310295.h.tsv.gz\",\n    md5_hash=\"392e09b40dcd4716efb14446745dbb2c\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/body_fat_distribution/","title":"body_fat_distribution","text":""},{"location":"reference/mecfs_bio/assets/gwas/body_fat_distribution/#mecfs_bio.assets.gwas.body_fat_distribution","title":"mecfs_bio.assets.gwas.body_fat_distribution","text":"<p>Modules:</p> <ul> <li> <code>pullit_et_al_2018</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/body_fat_distribution/pullit_et_al_2018/","title":"pullit_et_al_2018","text":""},{"location":"reference/mecfs_bio/assets/gwas/body_fat_distribution/pullit_et_al_2018/#mecfs_bio.assets.gwas.body_fat_distribution.pullit_et_al_2018","title":"mecfs_bio.assets.gwas.body_fat_distribution.pullit_et_al_2018","text":"<p>Modules:</p> <ul> <li> <code>processed_gwas_data</code>           \u2013            </li> <li> <code>raw_gwas_data</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/body_fat_distribution/pullit_et_al_2018/processed_gwas_data/","title":"processed_gwas_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/body_fat_distribution/pullit_et_al_2018/processed_gwas_data/#mecfs_bio.assets.gwas.body_fat_distribution.pullit_et_al_2018.processed_gwas_data","title":"mecfs_bio.assets.gwas.body_fat_distribution.pullit_et_al_2018.processed_gwas_data","text":"<p>Modules:</p> <ul> <li> <code>pullit_et_al_magma_task_generator</code>           \u2013            <p>Task generator to apply the main steps of MAGMA analysis is Pullit et al's</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/body_fat_distribution/pullit_et_al_2018/processed_gwas_data/pullit_et_al_magma_task_generator/","title":"pullit_et_al_magma_task_generator","text":""},{"location":"reference/mecfs_bio/assets/gwas/body_fat_distribution/pullit_et_al_2018/processed_gwas_data/pullit_et_al_magma_task_generator/#mecfs_bio.assets.gwas.body_fat_distribution.pullit_et_al_2018.processed_gwas_data.pullit_et_al_magma_task_generator","title":"mecfs_bio.assets.gwas.body_fat_distribution.pullit_et_al_2018.processed_gwas_data.pullit_et_al_magma_task_generator","text":"<p>Task generator to apply the main steps of MAGMA analysis is Pullit et al's Body fat distribution GWAS</p> <p>Attributes:</p> <ul> <li> <code>PULLIT_ET_AL_2018_COMBINED_MAGMA_TASKS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/body_fat_distribution/pullit_et_al_2018/processed_gwas_data/pullit_et_al_magma_task_generator/#mecfs_bio.assets.gwas.body_fat_distribution.pullit_et_al_2018.processed_gwas_data.pullit_et_al_magma_task_generator.PULLIT_ET_AL_2018_COMBINED_MAGMA_TASKS","title":"PULLIT_ET_AL_2018_COMBINED_MAGMA_TASKS  <code>module-attribute</code>","text":"<pre><code>PULLIT_ET_AL_2018_COMBINED_MAGMA_TASKS = create(\n    raw_gwas_data_task=PULLIT_ET_AL_2018_RAW,\n    magma_binary_task=MAGMA_1_1_BINARY_EXTRACTED,\n    gene_loc_file_task=MAGMA_ENSEMBL_GENE_LOCATION_REFERENCE_DATA_BUILD_37_RAW,\n    magma_ld_ref_task=MAGMA_EUR_BUILD_37_1K_GENOMES_EXTRACTED,\n    tissue_expression_gene_set_task=GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_PREP_FOR_MAGMA,\n    base_name=\"pullit_et_al_2018\",\n    sample_size=484564,\n    fmt=GWASLabColumnSpecifiers(\n        chrom=\"CHR\",\n        pos=\"POS\",\n        ea=\"Tested_Allele\",\n        nea=\"Other_Allele\",\n        eaf=\"Freq_Tested_Allele\",\n        beta=\"BETA\",\n        p=\"P\",\n        snpid=\"SNP\",\n        OR=None,\n        se=\"SE\",\n        info=\"INFO\",\n        rsid=\"RSID\",\n    ),\n    pre_pipe=CompositePipe(\n        [\n            DropNullsPipe(subset=[\"CHR\", \"POS\"]),\n            SplitExactColPipe(\n                col_to_split=\"SNP\",\n                split_by=\":\",\n                new_col_names=(\"RSID\", \"al1\", \"al2\"),\n            ),\n        ]\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/body_fat_distribution/pullit_et_al_2018/raw_gwas_data/","title":"raw_gwas_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/body_fat_distribution/pullit_et_al_2018/raw_gwas_data/#mecfs_bio.assets.gwas.body_fat_distribution.pullit_et_al_2018.raw_gwas_data","title":"mecfs_bio.assets.gwas.body_fat_distribution.pullit_et_al_2018.raw_gwas_data","text":"<p>Modules:</p> <ul> <li> <code>pullit_et_al_raw_gwas_data</code>           \u2013            <p>Pull raw gwas summary data from:</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/body_fat_distribution/pullit_et_al_2018/raw_gwas_data/pullit_et_al_raw_gwas_data/","title":"pullit_et_al_raw_gwas_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/body_fat_distribution/pullit_et_al_2018/raw_gwas_data/pullit_et_al_raw_gwas_data/#mecfs_bio.assets.gwas.body_fat_distribution.pullit_et_al_2018.raw_gwas_data.pullit_et_al_raw_gwas_data","title":"mecfs_bio.assets.gwas.body_fat_distribution.pullit_et_al_2018.raw_gwas_data.pullit_et_al_raw_gwas_data","text":"<p>Pull raw gwas summary data from: \"Meta-analysis of genome-wide association studies for body fat distribution in 694,649 individuals of European ancestry.\" Pulit, SL et al. bioRxiv, 2018. https://www.biorxiv.org/content/early/2018/04/18/304030 Files are hosted at: https://zenodo.org/records/1251813</p> <p>Attributes:</p> <ul> <li> <code>PULLIT_ET_AL_2018_RAW</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/body_fat_distribution/pullit_et_al_2018/raw_gwas_data/pullit_et_al_raw_gwas_data/#mecfs_bio.assets.gwas.body_fat_distribution.pullit_et_al_2018.raw_gwas_data.pullit_et_al_raw_gwas_data.PULLIT_ET_AL_2018_RAW","title":"PULLIT_ET_AL_2018_RAW  <code>module-attribute</code>","text":"<pre><code>PULLIT_ET_AL_2018_RAW = DownloadFileTask(\n    meta=GWASSummaryDataFileMeta(\n        id=AssetId(\"pullit_et_al_2018_gwas_summary\"),\n        trait=\"body_fat_distribution\",\n        project=\"pullt_et_al_2018\",\n        sub_dir=\"raw\",\n        read_spec=DataFrameReadSpec(\n            format=DataFrameTextFormat(\n                separator=\" \",\n                null_values=[\"NA\"],\n                schema_overrides={\"N\": Float64()},\n            )\n        ),\n        project_path=PurePath(\n            \"whradjbmi.giant-ukbb.meta-analysis.combined.23May2018.txt.gz\"\n        ),\n    ),\n    url=\"https://zenodo.org/records/1251813/files/whradjbmi.giant-ukbb.meta-analysis.combined.23May2018.txt.gz?download=1\",\n    md5_hash=\"500ee10b8406dc80394ad8cc968a4eb1\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/","title":"educational_attainment","text":""},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/#mecfs_bio.assets.gwas.educational_attainment","title":"mecfs_bio.assets.gwas.educational_attainment","text":"<p>Modules:</p> <ul> <li> <code>lee_et_al_2018</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/","title":"lee_et_al_2018","text":""},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/#mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018","title":"mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018","text":"<p>Modules:</p> <ul> <li> <code>analysis</code>           \u2013            </li> <li> <code>processed_gwas_data</code>           \u2013            </li> <li> <code>raw_gwas_data</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/analysis/","title":"analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/analysis/#mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.analysis","title":"mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.analysis","text":"<p>Modules:</p> <ul> <li> <code>hba_magma_analysis</code>           \u2013            <p>Task generator to use the Human Brain Atlas reference dataset to analyze the educational attainment GWAS via MAGMA.</p> </li> <li> <code>lee_et_al_edu_cis_pqtl_mr</code>           \u2013            <p>Apply MR using cis-pQTL to the EDU GWAS</p> </li> <li> <code>lee_et_al_h2_by_ldsc</code>           \u2013            </li> <li> <code>lee_et_al_standard_s_ldsc</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/analysis/hba_magma_analysis/","title":"hba_magma_analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/analysis/hba_magma_analysis/#mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.analysis.hba_magma_analysis","title":"mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.analysis.hba_magma_analysis","text":"<p>Task generator to use the Human Brain Atlas reference dataset to analyze the educational attainment GWAS via MAGMA.</p> <p>Attributes:</p> <ul> <li> <code>LEE_ET_AL_2018_HBA_MAGMA_TASKS_EDU</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/analysis/hba_magma_analysis/#mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.analysis.hba_magma_analysis.LEE_ET_AL_2018_HBA_MAGMA_TASKS_EDU","title":"LEE_ET_AL_2018_HBA_MAGMA_TASKS_EDU  <code>module-attribute</code>","text":"<pre><code>LEE_ET_AL_2018_HBA_MAGMA_TASKS_EDU = (\n    generate_human_brain_atlas_magma_tasks(\n        base_name=\"lee_et_al_2018_edu\",\n        gwas_parquet_with_rsids_task=parquet_file_task,\n        sample_size=257841,\n        plot_settings=PlotSettings(\"plotly_white\"),\n        include_independent_cluster_plot=True,\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/analysis/lee_et_al_edu_cis_pqtl_mr/","title":"lee_et_al_edu_cis_pqtl_mr","text":""},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/analysis/lee_et_al_edu_cis_pqtl_mr/#mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.analysis.lee_et_al_edu_cis_pqtl_mr","title":"mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.analysis.lee_et_al_edu_cis_pqtl_mr","text":"<p>Apply MR using cis-pQTL to the EDU GWAS</p> <p>Attributes:</p> <ul> <li> <code>LEE_ET_AL_EDU_CIS_PQTL_MR</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/analysis/lee_et_al_edu_cis_pqtl_mr/#mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.analysis.lee_et_al_edu_cis_pqtl_mr.LEE_ET_AL_EDU_CIS_PQTL_MR","title":"LEE_ET_AL_EDU_CIS_PQTL_MR  <code>module-attribute</code>","text":"<pre><code>LEE_ET_AL_EDU_CIS_PQTL_MR = mr_cis_pqtl_asset_generator(\n    gwas_dataframe_with_rsids=parquet_file_task,\n    base_name=\"lee_et_al_Edu\",\n    outcome_config=QuantOutcomeConfig(sample_size=257841),\n    steiger_config=None,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/analysis/lee_et_al_h2_by_ldsc/","title":"lee_et_al_h2_by_ldsc","text":""},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/analysis/lee_et_al_h2_by_ldsc/#mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.analysis.lee_et_al_h2_by_ldsc","title":"mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.analysis.lee_et_al_h2_by_ldsc","text":"<p>Attributes:</p> <ul> <li> <code>LEE_ET_AL_2018_H2_BY_LDSC</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/analysis/lee_et_al_h2_by_ldsc/#mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.analysis.lee_et_al_h2_by_ldsc.LEE_ET_AL_2018_H2_BY_LDSC","title":"LEE_ET_AL_2018_H2_BY_LDSC  <code>module-attribute</code>","text":"<pre><code>LEE_ET_AL_2018_H2_BY_LDSC = create(\n    asset_id=\"lee_et_al_2018_r2_by_ldsc\",\n    source_sumstats_task=sumstats_task,\n    ld_ref_task=THOUSAND_GENOME_EUR_LD_REFERENCE_DATA_V1_EXTRACTED,\n    set_sample_size=257841,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/analysis/lee_et_al_standard_s_ldsc/","title":"lee_et_al_standard_s_ldsc","text":""},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/analysis/lee_et_al_standard_s_ldsc/#mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.analysis.lee_et_al_standard_s_ldsc","title":"mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.analysis.lee_et_al_standard_s_ldsc","text":"<p>Attributes:</p> <ul> <li> <code>LEE_ET_AL_EDU_STANDARD_SLDSC_TASK_GROUP</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/analysis/lee_et_al_standard_s_ldsc/#mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.analysis.lee_et_al_standard_s_ldsc.LEE_ET_AL_EDU_STANDARD_SLDSC_TASK_GROUP","title":"LEE_ET_AL_EDU_STANDARD_SLDSC_TASK_GROUP  <code>module-attribute</code>","text":"<pre><code>LEE_ET_AL_EDU_STANDARD_SLDSC_TASK_GROUP = (\n    standard_sldsc_task_generator(\n        sumstats_task=sumstats_task,\n        base_name=\"lee_et_al_2018\",\n        pre_pipe=SetColToConstantPipe(\n            col_name=GWASLAB_SAMPLE_SIZE_COLUMN,\n            constant=257841,\n        ),\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/processed_gwas_data/","title":"processed_gwas_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/processed_gwas_data/#mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.processed_gwas_data","title":"mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.processed_gwas_data","text":"<p>Modules:</p> <ul> <li> <code>lee_et_al_magma_task_generator</code>           \u2013            <p>Task generator to apply the main steps of MAGMA analysis is LEE et al's</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/processed_gwas_data/lee_et_al_magma_task_generator/","title":"lee_et_al_magma_task_generator","text":""},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/processed_gwas_data/lee_et_al_magma_task_generator/#mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.processed_gwas_data.lee_et_al_magma_task_generator","title":"mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.processed_gwas_data.lee_et_al_magma_task_generator","text":"<p>Task generator to apply the main steps of MAGMA analysis is LEE et al's educational attainment GWAS.</p> <p>Attributes:</p> <ul> <li> <code>LEE_ET_AL_2018_COMBINED_MAGMA_TASKS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/processed_gwas_data/lee_et_al_magma_task_generator/#mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.processed_gwas_data.lee_et_al_magma_task_generator.LEE_ET_AL_2018_COMBINED_MAGMA_TASKS","title":"LEE_ET_AL_2018_COMBINED_MAGMA_TASKS  <code>module-attribute</code>","text":"<pre><code>LEE_ET_AL_2018_COMBINED_MAGMA_TASKS = create(\n    raw_gwas_data_task=LEE_ET_AL_2018_CATALOG_HARMONIZED_RAW,\n    magma_binary_task=MAGMA_1_1_BINARY_EXTRACTED,\n    gene_loc_file_task=MAGMA_ENSEMBL_GENE_LOCATION_REFERENCE_DATA_BUILD_37_RAW,\n    magma_ld_ref_task=MAGMA_EUR_BUILD_37_1K_GENOMES_EXTRACTED,\n    tissue_expression_gene_set_task=GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_PREP_FOR_MAGMA,\n    base_name=\"lee_et_al_2018\",\n    sample_size=257841,\n    fmt=GWASLabColumnSpecifiers(\n        rsid=\"variant_id\",\n        chrom=\"chromosome\",\n        pos=\"base_pair_location\",\n        ea=\"effect_allele\",\n        nea=\"other_allele\",\n        eaf=\"effect_allele_frequency\",\n        beta=\"beta\",\n        p=\"p_value\",\n        snpid=None,\n        OR=None,\n        se=\"standard_error\",\n        info=None,\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/raw_gwas_data/","title":"raw_gwas_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/raw_gwas_data/#mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.raw_gwas_data","title":"mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.raw_gwas_data","text":"<p>Modules:</p> <ul> <li> <code>lee_et_al_catalog_harmonized</code>           \u2013            <p>GWAS summary statistics from the paper: Lee, James J., et al. \"Gene discovery and polygenic prediction from a genome-wide association study of educational attainment in 1.1 million individuals.\"\u00a0Nature genetics\u00a050.8 (2018): 1112-1121.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/raw_gwas_data/lee_et_al_catalog_harmonized/","title":"lee_et_al_catalog_harmonized","text":""},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/raw_gwas_data/lee_et_al_catalog_harmonized/#mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.raw_gwas_data.lee_et_al_catalog_harmonized","title":"mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.raw_gwas_data.lee_et_al_catalog_harmonized","text":"<p>GWAS summary statistics from the paper: Lee, James J., et al. \"Gene discovery and polygenic prediction from a genome-wide association study of educational attainment in 1.1 million individuals.\"\u00a0Nature genetics\u00a050.8 (2018): 1112-1121.</p> <p>Harmonized to fit the GWAS catalog format.</p> <p>GWAS catalog page is here: https://www.ebi.ac.uk/gwas/publications/30038396.</p> <p>Attributes:</p> <ul> <li> <code>LEE_ET_AL_2018_CATALOG_HARMONIZED_RAW</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/educational_attainment/lee_et_al_2018/raw_gwas_data/lee_et_al_catalog_harmonized/#mecfs_bio.assets.gwas.educational_attainment.lee_et_al_2018.raw_gwas_data.lee_et_al_catalog_harmonized.LEE_ET_AL_2018_CATALOG_HARMONIZED_RAW","title":"LEE_ET_AL_2018_CATALOG_HARMONIZED_RAW  <code>module-attribute</code>","text":"<pre><code>LEE_ET_AL_2018_CATALOG_HARMONIZED_RAW = DownloadFileTask(\n    meta=GWASSummaryDataFileMeta(\n        id=AssetId(\"lee_at_al_2018_catalog_harmonized\"),\n        trait=\"educational_attainment\",\n        project=\"lee_el_al_2018\",\n        sub_dir=\"raw\",\n        project_path=PurePath(\n            \"harmonized/30038396-GCST006572-EFO_0008354-build37.f.tsv.gz\"\n        ),\n        read_spec=DataFrameReadSpec(\n            format=DataFrameTextFormat(separator=\"\\t\")\n        ),\n    ),\n    url=\"https://ftp.ebi.ac.uk/pub/databases/gwas/summary_statistics/GCST006001-GCST007000/GCST006572/harmonised/30038396-GCST006572-EFO_0008354-build37.f.tsv.gz\",\n    md5_hash=None,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/heart_rate_recovery/","title":"heart_rate_recovery","text":""},{"location":"reference/mecfs_bio/assets/gwas/heart_rate_recovery/#mecfs_bio.assets.gwas.heart_rate_recovery","title":"mecfs_bio.assets.gwas.heart_rate_recovery","text":"<p>Modules:</p> <ul> <li> <code>verweij_et_al_2018</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/heart_rate_recovery/verweij_et_al_2018/","title":"verweij_et_al_2018","text":""},{"location":"reference/mecfs_bio/assets/gwas/heart_rate_recovery/verweij_et_al_2018/#mecfs_bio.assets.gwas.heart_rate_recovery.verweij_et_al_2018","title":"mecfs_bio.assets.gwas.heart_rate_recovery.verweij_et_al_2018","text":"<p>Modules:</p> <ul> <li> <code>analysis</code>           \u2013            </li> <li> <code>processed</code>           \u2013            </li> <li> <code>raw</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/heart_rate_recovery/verweij_et_al_2018/analysis/","title":"analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/heart_rate_recovery/verweij_et_al_2018/analysis/#mecfs_bio.assets.gwas.heart_rate_recovery.verweij_et_al_2018.analysis","title":"mecfs_bio.assets.gwas.heart_rate_recovery.verweij_et_al_2018.analysis","text":"<p>Modules:</p> <ul> <li> <code>verweiji_standard_analysis</code>           \u2013            <p>Task to perform standard analysis on heart rate recovery GWAS of Verweiji et al.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/heart_rate_recovery/verweij_et_al_2018/analysis/verweiji_standard_analysis/","title":"verweiji_standard_analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/heart_rate_recovery/verweij_et_al_2018/analysis/verweiji_standard_analysis/#mecfs_bio.assets.gwas.heart_rate_recovery.verweij_et_al_2018.analysis.verweiji_standard_analysis","title":"mecfs_bio.assets.gwas.heart_rate_recovery.verweij_et_al_2018.analysis.verweiji_standard_analysis","text":"<p>Task to perform standard analysis on heart rate recovery GWAS of Verweiji et al.</p> <p>Attributes:</p> <ul> <li> <code>VERWEIJI_ET_AL_HRR_STANDARD_ANALYSIS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/heart_rate_recovery/verweij_et_al_2018/analysis/verweiji_standard_analysis/#mecfs_bio.assets.gwas.heart_rate_recovery.verweij_et_al_2018.analysis.verweiji_standard_analysis.VERWEIJI_ET_AL_HRR_STANDARD_ANALYSIS","title":"VERWEIJI_ET_AL_HRR_STANDARD_ANALYSIS  <code>module-attribute</code>","text":"<pre><code>VERWEIJI_ET_AL_HRR_STANDARD_ANALYSIS = concrete_standard_analysis_generator_assume_already_has_rsid(\n    base_name=\"verweiji_et_al_hrr\",\n    raw_gwas_data_task=VERWEIJI_ET_AL_RAW_HARMONIZED_BUILD_37,\n    sample_size=58818,\n    fmt=GWASLabColumnSpecifiers(\n        rsid=\"variant_id\",\n        chrom=\"chromosome\",\n        pos=\"base_pair_location\",\n        ea=\"effect_allele\",\n        nea=\"other_allele\",\n        beta=\"beta\",\n        p=\"p_value\",\n        snpid=\"uniqid\",\n        OR=None,\n        se=\"standard_error\",\n        info=\"info\",\n    ),\n    include_hba_magma_tasks=True,\n    hba_plot_settings=PlotSettings(\"plotly_white\"),\n    include_independent_cluster_plot_in_hba=True,\n    hba_indep_plot_options=HBAIndepPlotOptions(\n        annotation_text_size=11\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/heart_rate_recovery/verweij_et_al_2018/processed/","title":"processed","text":""},{"location":"reference/mecfs_bio/assets/gwas/heart_rate_recovery/verweij_et_al_2018/processed/#mecfs_bio.assets.gwas.heart_rate_recovery.verweij_et_al_2018.processed","title":"mecfs_bio.assets.gwas.heart_rate_recovery.verweij_et_al_2018.processed","text":""},{"location":"reference/mecfs_bio/assets/gwas/heart_rate_recovery/verweij_et_al_2018/raw/","title":"raw","text":""},{"location":"reference/mecfs_bio/assets/gwas/heart_rate_recovery/verweij_et_al_2018/raw/#mecfs_bio.assets.gwas.heart_rate_recovery.verweij_et_al_2018.raw","title":"mecfs_bio.assets.gwas.heart_rate_recovery.verweij_et_al_2018.raw","text":"<p>Modules:</p> <ul> <li> <code>verweij_raw_summary</code>           \u2013            <p>GWAS summary statistics from Verweij, Niek, Yordi J. van de Vegte, and Pim van der Harst. \"Genetic study links components of the autonomous nervous system to heart-rate profile during exercise.\"\u00a0Nature communications\u00a09.1 (2018): 898.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/heart_rate_recovery/verweij_et_al_2018/raw/verweij_raw_summary/","title":"verweij_raw_summary","text":""},{"location":"reference/mecfs_bio/assets/gwas/heart_rate_recovery/verweij_et_al_2018/raw/verweij_raw_summary/#mecfs_bio.assets.gwas.heart_rate_recovery.verweij_et_al_2018.raw.verweij_raw_summary","title":"mecfs_bio.assets.gwas.heart_rate_recovery.verweij_et_al_2018.raw.verweij_raw_summary","text":"<p>GWAS summary statistics from Verweij, Niek, Yordi J. van de Vegte, and Pim van der Harst. \"Genetic study links components of the autonomous nervous system to heart-rate profile during exercise.\"\u00a0Nature communications\u00a09.1 (2018): 898.</p> <p>Download from GWAS Catalog ftp site.</p> <p>See also: https://www.ebi.ac.uk/gwas/studies/GCST005850</p> <p>Attributes:</p> <ul> <li> <code>VERWEIJI_ET_AL_RAW_HARMONIZED_BUILD_37</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/heart_rate_recovery/verweij_et_al_2018/raw/verweij_raw_summary/#mecfs_bio.assets.gwas.heart_rate_recovery.verweij_et_al_2018.raw.verweij_raw_summary.VERWEIJI_ET_AL_RAW_HARMONIZED_BUILD_37","title":"VERWEIJI_ET_AL_RAW_HARMONIZED_BUILD_37  <code>module-attribute</code>","text":"<pre><code>VERWEIJI_ET_AL_RAW_HARMONIZED_BUILD_37 = DownloadFileTask(\n    meta=GWASSummaryDataFileMeta(\n        id=AssetId(\"verweij_et_al_2018_raw_harmonized\"),\n        trait=\"heart_rate_recovery\",\n        project=\"verweij_et_al_2018\",\n        sub_dir=\"raw\",\n        project_path=PurePath(\n            \"29497042-GCST005850-EFO_0009185-build37.f.tsv.gz\"\n        ),\n        read_spec=DataFrameReadSpec(\n            DataFrameTextFormat(separator=\"\\t\")\n        ),\n    ),\n    url=\"http://ftp.ebi.ac.uk/pub/databases/gwas/summary_statistics/GCST005001-GCST006000/GCST005850/harmonised/29497042-GCST005850-EFO_0009185-build37.f.tsv.gz\",\n    md5_hash=\"076ec2bf05476ce518fb628ad0bec8f2\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/imaging_derived_heart_phenotypes/","title":"imaging_derived_heart_phenotypes","text":""},{"location":"reference/mecfs_bio/assets/gwas/imaging_derived_heart_phenotypes/#mecfs_bio.assets.gwas.imaging_derived_heart_phenotypes","title":"mecfs_bio.assets.gwas.imaging_derived_heart_phenotypes","text":"<p>Modules:</p> <ul> <li> <code>pirruccello_et_al_2022</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/imaging_derived_heart_phenotypes/pirruccello_et_al_2022/","title":"pirruccello_et_al_2022","text":""},{"location":"reference/mecfs_bio/assets/gwas/imaging_derived_heart_phenotypes/pirruccello_et_al_2022/#mecfs_bio.assets.gwas.imaging_derived_heart_phenotypes.pirruccello_et_al_2022","title":"mecfs_bio.assets.gwas.imaging_derived_heart_phenotypes.pirruccello_et_al_2022","text":"<p>Modules:</p> <ul> <li> <code>analysis</code>           \u2013            </li> <li> <code>processed</code>           \u2013            </li> <li> <code>raw</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/imaging_derived_heart_phenotypes/pirruccello_et_al_2022/analysis/","title":"analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/imaging_derived_heart_phenotypes/pirruccello_et_al_2022/analysis/#mecfs_bio.assets.gwas.imaging_derived_heart_phenotypes.pirruccello_et_al_2022.analysis","title":"mecfs_bio.assets.gwas.imaging_derived_heart_phenotypes.pirruccello_et_al_2022.analysis","text":"<p>Modules:</p> <ul> <li> <code>rvef_standard_analysis</code>           \u2013            <p>Perform standard analysis on Right Ventricular Ejection Fraction data from Pirruccello et al. paper.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/imaging_derived_heart_phenotypes/pirruccello_et_al_2022/analysis/rvef_standard_analysis/","title":"rvef_standard_analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/imaging_derived_heart_phenotypes/pirruccello_et_al_2022/analysis/rvef_standard_analysis/#mecfs_bio.assets.gwas.imaging_derived_heart_phenotypes.pirruccello_et_al_2022.analysis.rvef_standard_analysis","title":"mecfs_bio.assets.gwas.imaging_derived_heart_phenotypes.pirruccello_et_al_2022.analysis.rvef_standard_analysis","text":"<p>Perform standard analysis on Right Ventricular Ejection Fraction data from Pirruccello et al. paper.</p> <p>Meaning of columns comes from https://kp4cd.org/sites/default/files/READMEs/Pirruccello_2021_README.txt, the readme for summary statistics from a different paper by the same authors. I am assuming that they use the same conventions in this paper</p> <p>Attributes:</p> <ul> <li> <code>RVEF_STANDARD_ANALYSIS_ASSIGN_RSID</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/imaging_derived_heart_phenotypes/pirruccello_et_al_2022/analysis/rvef_standard_analysis/#mecfs_bio.assets.gwas.imaging_derived_heart_phenotypes.pirruccello_et_al_2022.analysis.rvef_standard_analysis.RVEF_STANDARD_ANALYSIS_ASSIGN_RSID","title":"RVEF_STANDARD_ANALYSIS_ASSIGN_RSID  <code>module-attribute</code>","text":"<pre><code>RVEF_STANDARD_ANALYSIS_ASSIGN_RSID = (\n    concrete_standard_analysis_generator_no_rsid(\n        base_name=\"pirruccello_et_al_2022_rvef\",\n        raw_gwas_data_task=PIRRUCCELLO_EXTRACTED_RVEF_DATA,\n        fmt=GWASLabColumnSpecifiers(\n            snpid=\"SNP\",\n            chrom=\"CHR\",\n            pos=\"BP\",\n            ea=\"ALLELE1\",\n            nea=\"ALLELE0\",\n            eaf=\"A1FREQ\",\n            p=\"P_BOLT_LMM_INF\",\n            beta=\"BETA\",\n            se=\"SE\",\n            OR=None,\n            rsid=None,\n            info=\"INFO\",\n        ),\n        sample_size=41135,\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/imaging_derived_heart_phenotypes/pirruccello_et_al_2022/processed/","title":"processed","text":""},{"location":"reference/mecfs_bio/assets/gwas/imaging_derived_heart_phenotypes/pirruccello_et_al_2022/processed/#mecfs_bio.assets.gwas.imaging_derived_heart_phenotypes.pirruccello_et_al_2022.processed","title":"mecfs_bio.assets.gwas.imaging_derived_heart_phenotypes.pirruccello_et_al_2022.processed","text":"<p>Modules:</p> <ul> <li> <code>extracted_rvef_data</code>           \u2013            <p>Extract the Right Ventricular Ejection Fraction GWAS summary statistics from the zip file of Pirrucuello et al.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/imaging_derived_heart_phenotypes/pirruccello_et_al_2022/processed/extracted_rvef_data/","title":"extracted_rvef_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/imaging_derived_heart_phenotypes/pirruccello_et_al_2022/processed/extracted_rvef_data/#mecfs_bio.assets.gwas.imaging_derived_heart_phenotypes.pirruccello_et_al_2022.processed.extracted_rvef_data","title":"mecfs_bio.assets.gwas.imaging_derived_heart_phenotypes.pirruccello_et_al_2022.processed.extracted_rvef_data","text":"<p>Extract the Right Ventricular Ejection Fraction GWAS summary statistics from the zip file of Pirrucuello et al.</p> <p>Attributes:</p> <ul> <li> <code>PIRRUCCELLO_EXTRACTED_RVEF_DATA</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/imaging_derived_heart_phenotypes/pirruccello_et_al_2022/processed/extracted_rvef_data/#mecfs_bio.assets.gwas.imaging_derived_heart_phenotypes.pirruccello_et_al_2022.processed.extracted_rvef_data.PIRRUCCELLO_EXTRACTED_RVEF_DATA","title":"PIRRUCCELLO_EXTRACTED_RVEF_DATA  <code>module-attribute</code>","text":"<pre><code>PIRRUCCELLO_EXTRACTED_RVEF_DATA = create_from_zipped_gwas_data(\n    PIRRUCCELLO_RAW_RIGHT_HEART_DATA,\n    asset_id=\"pirruccello_et_al_2022_extracted_rvef_data\",\n    file_to_extract=\"invnorm_RVEF.tsv.gz\",\n    sub_dir=\"extracted\",\n    read_spec=DataFrameReadSpec(\n        DataFrameTextFormat(\n            \"\\t\", schema_overrides={\"GENPOS\": String()}\n        )\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/imaging_derived_heart_phenotypes/pirruccello_et_al_2022/raw/","title":"raw","text":""},{"location":"reference/mecfs_bio/assets/gwas/imaging_derived_heart_phenotypes/pirruccello_et_al_2022/raw/#mecfs_bio.assets.gwas.imaging_derived_heart_phenotypes.pirruccello_et_al_2022.raw","title":"mecfs_bio.assets.gwas.imaging_derived_heart_phenotypes.pirruccello_et_al_2022.raw","text":"<p>Modules:</p> <ul> <li> <code>raw_right_heart_data</code>           \u2013            <p>Download the zip file of raw summary statistics from the paper:</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/imaging_derived_heart_phenotypes/pirruccello_et_al_2022/raw/raw_right_heart_data/","title":"raw_right_heart_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/imaging_derived_heart_phenotypes/pirruccello_et_al_2022/raw/raw_right_heart_data/#mecfs_bio.assets.gwas.imaging_derived_heart_phenotypes.pirruccello_et_al_2022.raw.raw_right_heart_data","title":"mecfs_bio.assets.gwas.imaging_derived_heart_phenotypes.pirruccello_et_al_2022.raw.raw_right_heart_data","text":"<p>Download the zip file of raw summary statistics from the paper:</p> <p>Pirruccello, James P., et al. \"Genetic analysis of right heart structure and function in 40,000 people.\" Nature genetics 54.6 (2022): 792-803.</p> <p>Attributes:</p> <ul> <li> <code>PIRRUCCELLO_RAW_RIGHT_HEART_DATA</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/imaging_derived_heart_phenotypes/pirruccello_et_al_2022/raw/raw_right_heart_data/#mecfs_bio.assets.gwas.imaging_derived_heart_phenotypes.pirruccello_et_al_2022.raw.raw_right_heart_data.PIRRUCCELLO_RAW_RIGHT_HEART_DATA","title":"PIRRUCCELLO_RAW_RIGHT_HEART_DATA  <code>module-attribute</code>","text":"<pre><code>PIRRUCCELLO_RAW_RIGHT_HEART_DATA = DownloadFileTask(\n    meta=GWASSummaryDataFileMeta(\n        id=AssetId(\n            \"pirruccello_et_al_2022_raw_right_heart_data\"\n        ),\n        trait=\"imaging_derived_heart_phenotypes\",\n        project=\"pirruccello_et_al\",\n        sub_dir=\"raw\",\n        project_path=PurePath(\n            \"Pirruccello_2022_UKBB_HeartStructures.zip\"\n        ),\n    ),\n    url=\"https://personal.broadinstitute.org/ryank/Pirruccello_2022_UKBB_HeartStructures.zip\",\n    md5_hash=\"22d7e350975fcafd742781f24cda914f\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/","title":"inflammatory_bowel_disease","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/#mecfs_bio.assets.gwas.inflammatory_bowel_disease","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease","text":"<p>Modules:</p> <ul> <li> <code>liu_et_al_2023</code>           \u2013            <p>Tasks to download, prepare, and analyze GWAS summary statistics from Liu et al.'s meta-analysis of IBD.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/","title":"liu_et_al_2023","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023","text":"<p>Tasks to download, prepare, and analyze GWAS summary statistics from Liu et al.'s meta-analysis of IBD.</p> <p>Modules:</p> <ul> <li> <code>analysis</code>           \u2013            </li> <li> <code>processed_gwas_data</code>           \u2013            </li> <li> <code>raw_gwas_data</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/analysis/","title":"analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/analysis/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.analysis","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.analysis","text":"<p>Modules:</p> <ul> <li> <code>cis_pqtl_mr</code>           \u2013            <p>Apply MR using cis-pQTL to the IBD GWAS</p> </li> <li> <code>liu_et_al_lead_variants</code>           \u2013            </li> <li> <code>liu_et_al_s_lsdc</code>           \u2013            <p>Task generator to apply S-LDSC to the European results from the Inflammatory Bowel Disease study of Liu et al, using</p> </li> <li> <code>magma</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/analysis/cis_pqtl_mr/","title":"cis_pqtl_mr","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/analysis/cis_pqtl_mr/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.analysis.cis_pqtl_mr","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.analysis.cis_pqtl_mr","text":"<p>Apply MR using cis-pQTL to the IBD GWAS</p> <p>Attributes:</p> <ul> <li> <code>LIU_ET_AL_CIS_PQTL_MR</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/analysis/cis_pqtl_mr/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.analysis.cis_pqtl_mr.LIU_ET_AL_CIS_PQTL_MR","title":"LIU_ET_AL_CIS_PQTL_MR  <code>module-attribute</code>","text":"<pre><code>LIU_ET_AL_CIS_PQTL_MR = mr_cis_pqtl_asset_generator(\n    gwas_dataframe_with_rsids=LIU_ET_AL_2023_ASSIGN_RSID_VIA_SNP150_ANNOVAR,\n    base_name=\"liu_et_al_2023_ibd\",\n    outcome_config=BinaryOutcomeConfig(\n        n_case=24560, n_control=34915\n    ),\n    pre_pipe=RenameColPipe(\n        old_name=\"rsid\", new_name=GWASLAB_RSID_COL\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/analysis/liu_et_al_lead_variants/","title":"liu_et_al_lead_variants","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/analysis/liu_et_al_lead_variants/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.analysis.liu_et_al_lead_variants","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.analysis.liu_et_al_lead_variants","text":"<p>Attributes:</p> <ul> <li> <code>LIU_ET_AL_LEAD_VARIANTS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/analysis/liu_et_al_lead_variants/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.analysis.liu_et_al_lead_variants.LIU_ET_AL_LEAD_VARIANTS","title":"LIU_ET_AL_LEAD_VARIANTS  <code>module-attribute</code>","text":"<pre><code>LIU_ET_AL_LEAD_VARIANTS = GwasLabLeadVariantsTask(\n    short_id=AssetId(\"liu_et_al_2023_ibd_lead_variants\"),\n    sumstats_task=LIU_ET_AL_SUMSTATS_WITH_RSID_FROM_SNP150,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/analysis/liu_et_al_s_lsdc/","title":"liu_et_al_s_lsdc","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/analysis/liu_et_al_s_lsdc/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.analysis.liu_et_al_s_lsdc","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.analysis.liu_et_al_s_lsdc","text":"<p>Task generator to apply S-LDSC to the European results from the Inflammatory Bowel Disease study of Liu et al, using rsids assigned via SNP150</p> <p>Attributes:</p> <ul> <li> <code>LIU_ET_AL_S_LSDC_FROM_SNP_150</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/analysis/liu_et_al_s_lsdc/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.analysis.liu_et_al_s_lsdc.LIU_ET_AL_S_LSDC_FROM_SNP_150","title":"LIU_ET_AL_S_LSDC_FROM_SNP_150  <code>module-attribute</code>","text":"<pre><code>LIU_ET_AL_S_LSDC_FROM_SNP_150 = standard_sldsc_task_generator(\n    sumstats_task=LIU_ET_AL_SUMSTATS_WITH_RSID_FROM_SNP150,\n    base_name=\"liu_et_al_ibd_from_snp150\",\n    pre_pipe=SetColToConstantPipe(\n        col_name=GWASLAB_SAMPLE_SIZE_COLUMN, constant=59957\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/analysis/magma/","title":"magma","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/analysis/magma/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.analysis.magma","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.analysis.magma","text":"<p>Modules:</p> <ul> <li> <code>liu_et_al_2023_eur_37_hba_magma_analysis</code>           \u2013            </li> <li> <code>liu_et_al_2023_eur_37_magma_ensembl_specific_tisssue_gene_sets</code>           \u2013            </li> <li> <code>liu_et_al_2023_eur_37_specific_tissue_bar_plot</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/analysis/magma/liu_et_al_2023_eur_37_hba_magma_analysis/","title":"liu_et_al_2023_eur_37_hba_magma_analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/analysis/magma/liu_et_al_2023_eur_37_hba_magma_analysis/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.analysis.magma.liu_et_al_2023_eur_37_hba_magma_analysis","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.analysis.magma.liu_et_al_2023_eur_37_hba_magma_analysis","text":"<p>Attributes:</p> <ul> <li> <code>IBD_HBA_MAGMA_TASKS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/analysis/magma/liu_et_al_2023_eur_37_hba_magma_analysis/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.analysis.magma.liu_et_al_2023_eur_37_hba_magma_analysis.IBD_HBA_MAGMA_TASKS","title":"IBD_HBA_MAGMA_TASKS  <code>module-attribute</code>","text":"<pre><code>IBD_HBA_MAGMA_TASKS = generate_human_brain_atlas_magma_tasks(\n    base_name=\"liu_et_al_ibd\",\n    gwas_parquet_with_rsids_task=LIU_ET_AL_2023_ASSIGN_RSID_VIA_SNP150_ANNOVAR,\n    sample_size=59957,\n    plot_settings=PlotSettings(\"plotly_white\"),\n    pipes=[\n        RenameColPipe(\n            old_name=\"rsid\", new_name=GWASLAB_RSID_COL\n        )\n    ],\n    include_independent_cluster_plot=True,\n    hba_indep_plot_options=HBAIndepPlotOptions(\n        annotation_text_size=16\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/analysis/magma/liu_et_al_2023_eur_37_magma_ensembl_specific_tisssue_gene_sets/","title":"liu_et_al_2023_eur_37_magma_ensembl_specific_tisssue_gene_sets","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/analysis/magma/liu_et_al_2023_eur_37_magma_ensembl_specific_tisssue_gene_sets/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.analysis.magma.liu_et_al_2023_eur_37_magma_ensembl_specific_tisssue_gene_sets","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.analysis.magma.liu_et_al_2023_eur_37_magma_ensembl_specific_tisssue_gene_sets","text":"<p>Attributes:</p> <ul> <li> <code>LIU_ET_AL_IBD_EUR_37_SPECIFIC_TISSUE_GENE_SET_ANALYSIS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/analysis/magma/liu_et_al_2023_eur_37_magma_ensembl_specific_tisssue_gene_sets/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.analysis.magma.liu_et_al_2023_eur_37_magma_ensembl_specific_tisssue_gene_sets.LIU_ET_AL_IBD_EUR_37_SPECIFIC_TISSUE_GENE_SET_ANALYSIS","title":"LIU_ET_AL_IBD_EUR_37_SPECIFIC_TISSUE_GENE_SET_ANALYSIS  <code>module-attribute</code>","text":"<pre><code>LIU_ET_AL_IBD_EUR_37_SPECIFIC_TISSUE_GENE_SET_ANALYSIS = create(\n    asset_id=\"liu_et_al_ibd_37_eur_build_37_magma_ensemble_specific_tissue_gene_covar_analysis\",\n    magma_gene_analysis_task=LIU_ET_AL_IBD_2023_EUR_37_MAGMA_ENSEMBL_GENE_ANALYSIS,\n    magma_binary_task=MAGMA_1_1_BINARY_EXTRACTED,\n    gene_set_task=GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_PREP_FOR_MAGMA,\n    set_or_covar=\"covar\",\n    model_params=ModelParams(\n        direction_covar=\"greater\",\n        condition_hide=[\"Average\"],\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/analysis/magma/liu_et_al_2023_eur_37_specific_tissue_bar_plot/","title":"liu_et_al_2023_eur_37_specific_tissue_bar_plot","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/analysis/magma/liu_et_al_2023_eur_37_specific_tissue_bar_plot/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.analysis.magma.liu_et_al_2023_eur_37_specific_tissue_bar_plot","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.analysis.magma.liu_et_al_2023_eur_37_specific_tissue_bar_plot","text":"<p>Attributes:</p> <ul> <li> <code>LIU_ET_AL_IBD_EUR_37_SPECIFIC_TISSUE_ANALYSIS_BAR_PLOT</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/analysis/magma/liu_et_al_2023_eur_37_specific_tissue_bar_plot/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.analysis.magma.liu_et_al_2023_eur_37_specific_tissue_bar_plot.LIU_ET_AL_IBD_EUR_37_SPECIFIC_TISSUE_ANALYSIS_BAR_PLOT","title":"LIU_ET_AL_IBD_EUR_37_SPECIFIC_TISSUE_ANALYSIS_BAR_PLOT  <code>module-attribute</code>","text":"<pre><code>LIU_ET_AL_IBD_EUR_37_SPECIFIC_TISSUE_ANALYSIS_BAR_PLOT = create(\n    gene_set_analysis_task=LIU_ET_AL_IBD_EUR_37_SPECIFIC_TISSUE_GENE_SET_ANALYSIS,\n    asset_id=\"liu_et_Al_ibd_eur_build_37_magma_ensemble_specific_tissue_gene_covar_analysis_bar_plot\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/","title":"processed_gwas_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data","text":"<p>Modules:</p> <ul> <li> <code>liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_annovar</code>           \u2013            <p>Task to use the version of dbSNP 150 downloaded from annovar to assign rsids to variants from the Liu et al. study.</p> </li> <li> <code>liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_annovar_with_dups</code>           \u2013            <p>Task to use the version of DBSNP 150 downloaded from Annovar to assign rsids to variants from the Liu et al study.</p> </li> <li> <code>liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_sumstats</code>           \u2013            </li> <li> <code>liu_et_al_2023_eur_37_harmonized_dump_to_parquet</code>           \u2013            <p>Task to dump harmonized liu et al sumstats to parquet</p> </li> <li> <code>liu_et_al_2023_eur_37_harmonized_with_rsid_sumstats</code>           \u2013            <p>Task to create a Gwaslab Sumstats objects from the Liu et al inflammatory bowel disease GWAS data with rsids assigned via the annovar version of dbSNP150</p> </li> <li> <code>liu_et_al_2023_eur_liftover_to_37_parquet</code>           \u2013            </li> <li> <code>liu_et_al_2023_eur_liftover_to_37_sumstats</code>           \u2013            </li> <li> <code>liu_et_al_2023_eur_liftover_to_37_sumstats_harmonized</code>           \u2013            <p>Harmonize the  Liu et Al IBD Sumstats against the 1k genome and usc genome references</p> </li> <li> <code>liu_et_al_2023_eur_liftover_to_37_with_rsid</code>           \u2013            </li> <li> <code>liu_et_al_2023_eur_only</code>           \u2013            <p>Filter out columns referring to non-Finish Europeans</p> </li> <li> <code>magma</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_annovar/","title":"liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_annovar","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_annovar/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_annovar","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_annovar","text":"<p>Task to use the version of dbSNP 150 downloaded from annovar to assign rsids to variants from the Liu et al. study.</p> <p>Because the Annovar version of dbSNP is left normalized, it is more likely to contain matches for the genetic variants in the Liu et al. study</p> <p>Attributes:</p> <ul> <li> <code>LIU_ET_AL_2023_ASSIGN_RSID_VIA_SNP150_ANNOVAR</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_annovar/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_annovar.LIU_ET_AL_2023_ASSIGN_RSID_VIA_SNP150_ANNOVAR","title":"LIU_ET_AL_2023_ASSIGN_RSID_VIA_SNP150_ANNOVAR  <code>module-attribute</code>","text":"<pre><code>LIU_ET_AL_2023_ASSIGN_RSID_VIA_SNP150_ANNOVAR = create_from_result_df(\n    asset_id=\"liu_et_al_2023_ibd_eur_harmonize_assign_rsids_via_snp150_annovar\",\n    result_df_task=LIU_ET_AL_2023_IBD_EUR_HARMONIZE_PARQUET,\n    reference_df_task=PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_UNIQUE_NON_RD,\n    left_on=[\"CHR\", \"POS\", \"EA\", \"NEA\"],\n    right_on=[\"int_chrom\", \"POS\", \"ALT\", \"REF\"],\n    out_format=ParquetOutFormat(),\n    how=\"inner\",\n    df_1_pipe=CompositePipe(\n        [\n            CastPipe(\n                target_column=\"EA\",\n                type=String(),\n                new_col_name=\"EA\",\n            ),\n            CastPipe(\n                target_column=\"NEA\",\n                type=String(),\n                new_col_name=\"NEA\",\n            ),\n        ]\n    ),\n    backend=\"ibis\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_annovar_with_dups/","title":"liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_annovar_with_dups","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_annovar_with_dups/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_annovar_with_dups","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_annovar_with_dups","text":"<p>Task to use the version of DBSNP 150 downloaded from Annovar to assign rsids to variants from the Liu et al study. Because the Annovar version of dbsnp is left normalized, it is more likely to match the variants present in GWAS data than the raw dbsnp file</p> <p>Note that dbnsp contains multiple rsids referring to the same variant.  The asset generated by this file does not deduplicate these rsids.</p> <p>Attributes:</p> <ul> <li> <code>LIU_ET_AL_2023_ASSIGN_RSID_VIA_SNP150_ANNOVAR_WITH_DUPS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_annovar_with_dups/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_annovar_with_dups.LIU_ET_AL_2023_ASSIGN_RSID_VIA_SNP150_ANNOVAR_WITH_DUPS","title":"LIU_ET_AL_2023_ASSIGN_RSID_VIA_SNP150_ANNOVAR_WITH_DUPS  <code>module-attribute</code>","text":"<pre><code>LIU_ET_AL_2023_ASSIGN_RSID_VIA_SNP150_ANNOVAR_WITH_DUPS = create_from_result_df(\n    asset_id=\"liu_et_al_2023_ibd_eur_harmonize_assign_rsids_via_snp150_annovar_with_dups\",\n    result_df_task=LIU_ET_AL_2023_IBD_EUR_HARMONIZE_PARQUET,\n    reference_df_task=PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME,\n    left_on=[\"CHR\", \"POS\", \"EA\", \"NEA\"],\n    right_on=[\"int_chrom\", \"POS\", \"ALT\", \"REF\"],\n    out_format=ParquetOutFormat(),\n    how=\"inner\",\n    df_1_pipe=CompositePipe(\n        [\n            CastPipe(\n                target_column=\"EA\",\n                type=String(),\n                new_col_name=\"EA\",\n            ),\n            CastPipe(\n                target_column=\"NEA\",\n                type=String(),\n                new_col_name=\"NEA\",\n            ),\n        ]\n    ),\n    backend=\"ibis\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_sumstats/","title":"liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_sumstats","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_sumstats/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_sumstats","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_sumstats","text":"<p>Attributes:</p> <ul> <li> <code>LIU_ET_AL_2023_RSIDS_FROM_ANNOVAR_SUMSATS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_sumstats/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_37_harmonized_assign_rsid_via_snp150_sumstats.LIU_ET_AL_2023_RSIDS_FROM_ANNOVAR_SUMSATS","title":"LIU_ET_AL_2023_RSIDS_FROM_ANNOVAR_SUMSATS  <code>module-attribute</code>","text":"<pre><code>LIU_ET_AL_2023_RSIDS_FROM_ANNOVAR_SUMSATS = GWASLabCreateSumstatsTask(\n    df_source_task=LIU_ET_AL_2023_ASSIGN_RSID_VIA_SNP150_ANNOVAR,\n    asset_id=AssetId(\n        \"liu_et_al_2023_rsids_from_annovar_sumstats\"\n    ),\n    basic_check=True,\n    genome_build=\"19\",\n    fmt=\"gwaslab\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_37_harmonized_dump_to_parquet/","title":"liu_et_al_2023_eur_37_harmonized_dump_to_parquet","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_37_harmonized_dump_to_parquet/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_37_harmonized_dump_to_parquet","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_37_harmonized_dump_to_parquet","text":"<p>Task to dump harmonized liu et al sumstats to parquet</p> <p>Attributes:</p> <ul> <li> <code>LIU_ET_AL_2023_IBD_EUR_HARMONIZE_PARQUET</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_37_harmonized_dump_to_parquet/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_37_harmonized_dump_to_parquet.LIU_ET_AL_2023_IBD_EUR_HARMONIZE_PARQUET","title":"LIU_ET_AL_2023_IBD_EUR_HARMONIZE_PARQUET  <code>module-attribute</code>","text":"<pre><code>LIU_ET_AL_2023_IBD_EUR_HARMONIZE_PARQUET = create_from_source_task(\n    source_tsk=LIU_ET_AL_2023_IBD_EUR_HARMONIZE,\n    asset_id=\"liu_et_al_2023_ibd_eur_harmonize_dump_to_parquet\",\n    sub_dir=\"processed\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_37_harmonized_with_rsid_sumstats/","title":"liu_et_al_2023_eur_37_harmonized_with_rsid_sumstats","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_37_harmonized_with_rsid_sumstats/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_37_harmonized_with_rsid_sumstats","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_37_harmonized_with_rsid_sumstats","text":"<p>Task to create a Gwaslab Sumstats objects from the Liu et al inflammatory bowel disease GWAS data with rsids assigned via the annovar version of dbSNP150</p> <p>Attributes:</p> <ul> <li> <code>LIU_ET_AL_SUMSTATS_WITH_RSID_FROM_SNP150</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_37_harmonized_with_rsid_sumstats/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_37_harmonized_with_rsid_sumstats.LIU_ET_AL_SUMSTATS_WITH_RSID_FROM_SNP150","title":"LIU_ET_AL_SUMSTATS_WITH_RSID_FROM_SNP150  <code>module-attribute</code>","text":"<pre><code>LIU_ET_AL_SUMSTATS_WITH_RSID_FROM_SNP150 = GWASLabCreateSumstatsTask(\n    df_source_task=LIU_ET_AL_2023_ASSIGN_RSID_VIA_SNP150_ANNOVAR,\n    asset_id=AssetId(\n        \"liu_et_al_2023_ibd_sumstats_with_rsids_via_snp150\"\n    ),\n    basic_check=True,\n    genome_build=\"infer\",\n    liftover_to=\"19\",\n    fmt=GWASLabColumnSpecifiers(\n        nea=GWASLAB_NON_EFFECT_ALLELE_COL,\n        ea=GWASLAB_EFFECT_ALLELE_COL,\n        chrom=GWASLAB_CHROM_COL,\n        pos=GWASLAB_POS_COL,\n        eaf=GWASLAB_EFFECT_ALLELE_FREQ_COL,\n        beta=GWASLAB_BETA_COL,\n        se=GWASLAB_SE_COL,\n        p=GWASLAB_P_COL,\n        rsid=\"rsid\",\n        OR=None,\n        info=None,\n        snpid=GWASLAB_SNPID_COL,\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_liftover_to_37_parquet/","title":"liu_et_al_2023_eur_liftover_to_37_parquet","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_liftover_to_37_parquet/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_liftover_to_37_parquet","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_liftover_to_37_parquet","text":"<p>Attributes:</p> <ul> <li> <code>LIU_ET_AL_2023_IBD_LIFTOVER_TO_37_PARQUET</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_liftover_to_37_parquet/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_liftover_to_37_parquet.LIU_ET_AL_2023_IBD_LIFTOVER_TO_37_PARQUET","title":"LIU_ET_AL_2023_IBD_LIFTOVER_TO_37_PARQUET  <code>module-attribute</code>","text":"<pre><code>LIU_ET_AL_2023_IBD_LIFTOVER_TO_37_PARQUET = create_from_source_task(\n    source_tsk=LIU_ET_AL_2023_IBD_EUR_LIFTOVER_37_SUMSTATS,\n    asset_id=\"liu_et_al_2023_ibd_eur_liftover_to_37_parquet\",\n    sub_dir=\"processed\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_liftover_to_37_sumstats/","title":"liu_et_al_2023_eur_liftover_to_37_sumstats","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_liftover_to_37_sumstats/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_liftover_to_37_sumstats","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_liftover_to_37_sumstats","text":"<p>Attributes:</p> <ul> <li> <code>LIU_ET_AL_2023_IBD_EUR_LIFTOVER_37_SUMSTATS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_liftover_to_37_sumstats/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_liftover_to_37_sumstats.LIU_ET_AL_2023_IBD_EUR_LIFTOVER_37_SUMSTATS","title":"LIU_ET_AL_2023_IBD_EUR_LIFTOVER_37_SUMSTATS  <code>module-attribute</code>","text":"<pre><code>LIU_ET_AL_2023_IBD_EUR_LIFTOVER_37_SUMSTATS = (\n    GWASLabCreateSumstatsTask(\n        df_source_task=LIU_ET_AL_2023_IBD_META_EUR_ONLY,\n        asset_id=AssetId(\n            \"liu_et_al_2023_ibd_sumstats_liftover_to_37\"\n        ),\n        basic_check=True,\n        genome_build=\"infer\",\n        liftover_to=\"19\",\n        fmt=GWASLabColumnSpecifiers(\n            snpid=\"MarkerName\",\n            nea=\"Allele1\",\n            ea=\"Allele2\",\n            chrom=\"CHR\",\n            pos=\"BP\",\n            eaf=\"AF_NFE\",\n            beta=\"BETA_NFE\",\n            se=\"SE_NFE\",\n            p=\"P_NFE\",\n            rsid=None,\n            OR=None,\n            info=None,\n        ),\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_liftover_to_37_sumstats_harmonized/","title":"liu_et_al_2023_eur_liftover_to_37_sumstats_harmonized","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_liftover_to_37_sumstats_harmonized/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_liftover_to_37_sumstats_harmonized","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_liftover_to_37_sumstats_harmonized","text":"<p>Harmonize the  Liu et Al IBD Sumstats against the 1k genome and usc genome references Key steps: - Flip variants so they reflect the \"canonical strand\" according to the reference - For ambiguous variants, resolve using allele frequency data</p> <p>Attributes:</p> <ul> <li> <code>LIU_ET_AL_2023_IBD_EUR_HARMONIZE</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_liftover_to_37_sumstats_harmonized/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_liftover_to_37_sumstats_harmonized.LIU_ET_AL_2023_IBD_EUR_HARMONIZE","title":"LIU_ET_AL_2023_IBD_EUR_HARMONIZE  <code>module-attribute</code>","text":"<pre><code>LIU_ET_AL_2023_IBD_EUR_HARMONIZE = create_from_source_task(\n    LIU_ET_AL_2023_IBD_EUR_LIFTOVER_37_SUMSTATS,\n    asset_id=\"liu_et_al_2023_ibd_37_harmonized\",\n    spec=GwasLabTransformSpec(\n        harmonize_options=HarmonizationOptions(\n            ref_infer=GWASLabVCFRef(\n                name=\"1kg_eur_hg19\", ref_alt_freq=\"AF\"\n            ),\n            ref_seq=\"ucsc_genome_hg19\",\n            check_ref_files=True,\n            drop_missing_from_ref_seq=True,\n            cores=4,\n        )\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_liftover_to_37_with_rsid/","title":"liu_et_al_2023_eur_liftover_to_37_with_rsid","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_liftover_to_37_with_rsid/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_liftover_to_37_with_rsid","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_liftover_to_37_with_rsid","text":"<p>Attributes:</p> <ul> <li> <code>LIU_ET_AL_2023_IBD_LIFTOVER_TO_37_WITH_RSID</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_liftover_to_37_with_rsid/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_liftover_to_37_with_rsid.LIU_ET_AL_2023_IBD_LIFTOVER_TO_37_WITH_RSID","title":"LIU_ET_AL_2023_IBD_LIFTOVER_TO_37_WITH_RSID  <code>module-attribute</code>","text":"<pre><code>LIU_ET_AL_2023_IBD_LIFTOVER_TO_37_WITH_RSID = create(\n    snp151_database_file_task=GENOME_ANNOTATION_DATABASE_BUILD_37_PARQUET,\n    raw_snp_data_task=LIU_ET_AL_2023_IBD_LIFTOVER_TO_37_PARQUET,\n    asset_id=\"liu_et_al_2023_ibd_eur_liftover_to_37_parquet_with_rsid\",\n    valid_chroms=HG19_SNP151_VALID_CHROMS,\n    chrom_replace_rules=CHROM_RENAME_RULES,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_only/","title":"liu_et_al_2023_eur_only","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_only/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_only","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_only","text":"<p>Filter out columns referring to non-Finish Europeans</p> <p>In the raw GWAS data, the NFE columns refer to non-Finish Europeans. We extract these columns to get summary statistics for Non-Finish Europeans, and drop any variants with null values in these columns, indicating they were not measured in the NFE population</p> <p>Attributes:</p> <ul> <li> <code>LIU_ET_AL_2023_IBD_META_EUR_ONLY</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/liu_et_al_2023_eur_only/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.liu_et_al_2023_eur_only.LIU_ET_AL_2023_IBD_META_EUR_ONLY","title":"LIU_ET_AL_2023_IBD_META_EUR_ONLY  <code>module-attribute</code>","text":"<pre><code>LIU_ET_AL_2023_IBD_META_EUR_ONLY = create(\n    source_task=LIU_ET_AL_2023_IBD_META,\n    asset_id=\"liu_et_al_2023_ibd_meta_eur_only\",\n    out_format=ParquetOutFormat(),\n    pipes=[\n        SelectColPipe(\n            [\n                \"MarkerName\",\n                \"Allele1\",\n                \"Allele2\",\n                \"CHR\",\n                \"BP\",\n                \"AF_NFE\",\n                \"BETA_NFE\",\n                \"SE_NFE\",\n                \"P_NFE\",\n            ]\n        ),\n        DropNullsPipe(),\n    ],\n    backend=\"polars\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/magma/","title":"magma","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/magma/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.magma","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.magma","text":"<p>Modules:</p> <ul> <li> <code>liu_et_al_2023_eur_37_magma_ensembl_annotations</code>           \u2013            </li> <li> <code>liu_et_al_2023_eur_37_magma_ensembl_gene_analysis</code>           \u2013            </li> <li> <code>liu_et_al_2023_eur_37_magma_snp_locs</code>           \u2013            </li> <li> <code>liu_et_al_2023_eur_ibd_37_p_values</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/magma/liu_et_al_2023_eur_37_magma_ensembl_annotations/","title":"liu_et_al_2023_eur_37_magma_ensembl_annotations","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/magma/liu_et_al_2023_eur_37_magma_ensembl_annotations/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.magma.liu_et_al_2023_eur_37_magma_ensembl_annotations","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.magma.liu_et_al_2023_eur_37_magma_ensembl_annotations","text":"<p>Attributes:</p> <ul> <li> <code>LIU_ET_AL_2023_EUR_IBD_37_ENSEMBL_ANNOTATIONS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/magma/liu_et_al_2023_eur_37_magma_ensembl_annotations/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.magma.liu_et_al_2023_eur_37_magma_ensembl_annotations.LIU_ET_AL_2023_EUR_IBD_37_ENSEMBL_ANNOTATIONS","title":"LIU_ET_AL_2023_EUR_IBD_37_ENSEMBL_ANNOTATIONS  <code>module-attribute</code>","text":"<pre><code>LIU_ET_AL_2023_EUR_IBD_37_ENSEMBL_ANNOTATIONS = create(\n    asset_id=\"liu_et_al_2023_eur_37_magma_ensemble_annotations\",\n    magma_binary_task=MAGMA_1_1_BINARY_EXTRACTED,\n    snp_loc_file_task=LIU_ET_AL_IBD_EUR_BUILD_37_MAGMA_SNP_LOCS,\n    gene_loc_file_task=MAGMA_ENSEMBL_GENE_LOCATION_REFERENCE_DATA_BUILD_37_RAW,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/magma/liu_et_al_2023_eur_37_magma_ensembl_gene_analysis/","title":"liu_et_al_2023_eur_37_magma_ensembl_gene_analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/magma/liu_et_al_2023_eur_37_magma_ensembl_gene_analysis/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.magma.liu_et_al_2023_eur_37_magma_ensembl_gene_analysis","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.magma.liu_et_al_2023_eur_37_magma_ensembl_gene_analysis","text":"<p>Attributes:</p> <ul> <li> <code>LIU_ET_AL_IBD_2023_EUR_37_MAGMA_ENSEMBL_GENE_ANALYSIS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/magma/liu_et_al_2023_eur_37_magma_ensembl_gene_analysis/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.magma.liu_et_al_2023_eur_37_magma_ensembl_gene_analysis.LIU_ET_AL_IBD_2023_EUR_37_MAGMA_ENSEMBL_GENE_ANALYSIS","title":"LIU_ET_AL_IBD_2023_EUR_37_MAGMA_ENSEMBL_GENE_ANALYSIS  <code>module-attribute</code>","text":"<pre><code>LIU_ET_AL_IBD_2023_EUR_37_MAGMA_ENSEMBL_GENE_ANALYSIS = create(\n    asset_id=\"liu_et_al_ibd_2023_eur_37_magma_ensemble_gene_analysis\",\n    magma_annotation_task=LIU_ET_AL_2023_EUR_IBD_37_ENSEMBL_ANNOTATIONS,\n    magma_p_value_task=LIU_ET_AL_2023_IBD_37_MAGMA_SNP_P_VALUES,\n    magma_binary_task=MAGMA_1_1_BINARY_EXTRACTED,\n    magma_ld_ref_task=MAGMA_EUR_BUILD_37_1K_GENOMES_EXTRACTED,\n    ld_ref_file_stem=\"g1000_eur\",\n    sample_size=59957,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/magma/liu_et_al_2023_eur_37_magma_snp_locs/","title":"liu_et_al_2023_eur_37_magma_snp_locs","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/magma/liu_et_al_2023_eur_37_magma_snp_locs/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.magma.liu_et_al_2023_eur_37_magma_snp_locs","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.magma.liu_et_al_2023_eur_37_magma_snp_locs","text":"<p>Attributes:</p> <ul> <li> <code>LIU_ET_AL_IBD_EUR_BUILD_37_MAGMA_SNP_LOCS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/magma/liu_et_al_2023_eur_37_magma_snp_locs/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.magma.liu_et_al_2023_eur_37_magma_snp_locs.LIU_ET_AL_IBD_EUR_BUILD_37_MAGMA_SNP_LOCS","title":"LIU_ET_AL_IBD_EUR_BUILD_37_MAGMA_SNP_LOCS  <code>module-attribute</code>","text":"<pre><code>LIU_ET_AL_IBD_EUR_BUILD_37_MAGMA_SNP_LOCS = create_for_magma_snp_pos_file(\n    gwas_parquet_with_rsids_task=LIU_ET_AL_2023_IBD_LIFTOVER_TO_37_WITH_RSID,\n    asset_id=\"liu_et_al_2023_ibd_eur_build_37_magma_snp_locs\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/magma/liu_et_al_2023_eur_ibd_37_p_values/","title":"liu_et_al_2023_eur_ibd_37_p_values","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/magma/liu_et_al_2023_eur_ibd_37_p_values/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.magma.liu_et_al_2023_eur_ibd_37_p_values","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.magma.liu_et_al_2023_eur_ibd_37_p_values","text":"<p>Attributes:</p> <ul> <li> <code>LIU_ET_AL_2023_IBD_37_MAGMA_SNP_P_VALUES</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/processed_gwas_data/magma/liu_et_al_2023_eur_ibd_37_p_values/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.processed_gwas_data.magma.liu_et_al_2023_eur_ibd_37_p_values.LIU_ET_AL_2023_IBD_37_MAGMA_SNP_P_VALUES","title":"LIU_ET_AL_2023_IBD_37_MAGMA_SNP_P_VALUES  <code>module-attribute</code>","text":"<pre><code>LIU_ET_AL_2023_IBD_37_MAGMA_SNP_P_VALUES = create_for_magma_snp_p_value_file_precomputed_p(\n    gwas_parquet_with_rsids_task=LIU_ET_AL_2023_IBD_LIFTOVER_TO_37_WITH_RSID,\n    asset_id=\"liu_et_al_2023_ibd_eur_build_37_magma_snp_p_values\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/raw_gwas_data/","title":"raw_gwas_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/raw_gwas_data/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.raw_gwas_data","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.raw_gwas_data","text":"<p>Modules:</p> <ul> <li> <code>liu_et_al_2023_meta</code>           \u2013            <p>GWAS summary statistics from the 2023 meta-analysis of Liu et al.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/raw_gwas_data/liu_et_al_2023_meta/","title":"liu_et_al_2023_meta","text":""},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/raw_gwas_data/liu_et_al_2023_meta/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.raw_gwas_data.liu_et_al_2023_meta","title":"mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.raw_gwas_data.liu_et_al_2023_meta","text":"<p>GWAS summary statistics from the 2023 meta-analysis of Liu et al. See: https://www.nature.com/articles/s41588-023-01384-0 Google Drive link to downloads: https://drive.google.com/drive/folders/1MbjKuYp77SQEb1Q06nQG2Asq7gt6kGLO</p> <p>Attributes:</p> <ul> <li> <code>LIU_ET_AL_2023_IBD_META</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/inflammatory_bowel_disease/liu_et_al_2023/raw_gwas_data/liu_et_al_2023_meta/#mecfs_bio.assets.gwas.inflammatory_bowel_disease.liu_et_al_2023.raw_gwas_data.liu_et_al_2023_meta.LIU_ET_AL_2023_IBD_META","title":"LIU_ET_AL_2023_IBD_META  <code>module-attribute</code>","text":"<pre><code>LIU_ET_AL_2023_IBD_META = DownloadFromGoogleDriveTask(\n    meta=GWASSummaryDataFileMeta(\n        id=AssetId(\"liu_et_all_2023_ibd_meta_raw\"),\n        trait=\"inflammatory_bowl_disease\",\n        project=\"liu_et_al_2023_ibd_meta\",\n        sub_dir=\"raw\",\n        project_path=PurePath(\n            \"sumstats/ibd_EAS_EUR_SiKJEF_meta_IBD.TBL.txt.gz\"\n        ),\n        read_spec=DataFrameReadSpec(\n            DataFrameTextFormat(\n                separator=\"\\t\",\n                schema_overrides={\"CHR\": String()},\n            )\n        ),\n    ),\n    file_id=\"1KeYZd7WIqdQjdbRfUp084JDetN1S_01e\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/ldl/","title":"ldl","text":""},{"location":"reference/mecfs_bio/assets/gwas/ldl/#mecfs_bio.assets.gwas.ldl","title":"mecfs_bio.assets.gwas.ldl","text":"<p>Modules:</p> <ul> <li> <code>million_veterans</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/ldl/million_veterans/","title":"million_veterans","text":""},{"location":"reference/mecfs_bio/assets/gwas/ldl/million_veterans/#mecfs_bio.assets.gwas.ldl.million_veterans","title":"mecfs_bio.assets.gwas.ldl.million_veterans","text":"<p>Modules:</p> <ul> <li> <code>analysis</code>           \u2013            <p>Tasks for analysis of the Million Veterans Program LDL GWAS.</p> </li> <li> <code>processed_gwas_data</code>           \u2013            </li> <li> <code>raw_gwas_data</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/ldl/million_veterans/analysis/","title":"analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/ldl/million_veterans/analysis/#mecfs_bio.assets.gwas.ldl.million_veterans.analysis","title":"mecfs_bio.assets.gwas.ldl.million_veterans.analysis","text":"<p>Tasks for analysis of the Million Veterans Program LDL GWAS.</p> <p>Modules:</p> <ul> <li> <code>ldl_standard_sldsc</code>           \u2013            </li> <li> <code>million_veterans_ldl_eur_magma_task_generator</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/ldl/million_veterans/analysis/ldl_standard_sldsc/","title":"ldl_standard_sldsc","text":""},{"location":"reference/mecfs_bio/assets/gwas/ldl/million_veterans/analysis/ldl_standard_sldsc/#mecfs_bio.assets.gwas.ldl.million_veterans.analysis.ldl_standard_sldsc","title":"mecfs_bio.assets.gwas.ldl.million_veterans.analysis.ldl_standard_sldsc","text":"<p>Attributes:</p> <ul> <li> <code>LDL_STANDARD_SLDSC_TASK_GROUP</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/ldl/million_veterans/analysis/ldl_standard_sldsc/#mecfs_bio.assets.gwas.ldl.million_veterans.analysis.ldl_standard_sldsc.LDL_STANDARD_SLDSC_TASK_GROUP","title":"LDL_STANDARD_SLDSC_TASK_GROUP  <code>module-attribute</code>","text":"<pre><code>LDL_STANDARD_SLDSC_TASK_GROUP = (\n    standard_sldsc_task_generator(\n        sumstats_task=sumstats_task,\n        base_name=\"million_veterans_eur_ldl\",\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/ldl/million_veterans/analysis/million_veterans_ldl_eur_magma_task_generator/","title":"million_veterans_ldl_eur_magma_task_generator","text":""},{"location":"reference/mecfs_bio/assets/gwas/ldl/million_veterans/analysis/million_veterans_ldl_eur_magma_task_generator/#mecfs_bio.assets.gwas.ldl.million_veterans.analysis.million_veterans_ldl_eur_magma_task_generator","title":"mecfs_bio.assets.gwas.ldl.million_veterans.analysis.million_veterans_ldl_eur_magma_task_generator","text":"<p>Attributes:</p> <ul> <li> <code>MILLION_VETERANS_EUR_LDL_MAGMA_TASKS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/ldl/million_veterans/analysis/million_veterans_ldl_eur_magma_task_generator/#mecfs_bio.assets.gwas.ldl.million_veterans.analysis.million_veterans_ldl_eur_magma_task_generator.MILLION_VETERANS_EUR_LDL_MAGMA_TASKS","title":"MILLION_VETERANS_EUR_LDL_MAGMA_TASKS  <code>module-attribute</code>","text":"<pre><code>MILLION_VETERANS_EUR_LDL_MAGMA_TASKS = create(\n    raw_gwas_data_task=MILLION_VETERAN_LDL_EUR_DATA_RAW,\n    magma_binary_task=MAGMA_1_1_BINARY_EXTRACTED,\n    gene_loc_file_task=MAGMA_ENSEMBL_GENE_LOCATION_REFERENCE_DATA_BUILD_37_RAW,\n    magma_ld_ref_task=MAGMA_EUR_BUILD_37_1K_GENOMES_EXTRACTED,\n    tissue_expression_gene_set_task=GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_PREP_FOR_MAGMA,\n    base_name=\"million_veterans_eur_ldl\",\n    sample_size=404741,\n    fmt=GWASLabColumnSpecifiers(\n        rsid=\"rsid\",\n        OR=None,\n        se=\"standard_error\",\n        chrom=\"chromosome\",\n        pos=\"base_pair_location\",\n        ea=\"effect_allele\",\n        nea=\"other_allele\",\n        eaf=\"effect_allele_frequency\",\n        beta=\"beta\",\n        p=\"p_value\",\n        n=\"n\",\n        info=\"r2\",\n        snpid=None,\n    ),\n    pre_pipe=FilterRowsByInfoScorePipe(\n        min_score=0.8, info_col=\"r2\"\n    ),\n    gene_thesaurus_task=GENE_THESAURUS,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/ldl/million_veterans/processed_gwas_data/","title":"processed_gwas_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/ldl/million_veterans/processed_gwas_data/#mecfs_bio.assets.gwas.ldl.million_veterans.processed_gwas_data","title":"mecfs_bio.assets.gwas.ldl.million_veterans.processed_gwas_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/ldl/million_veterans/raw_gwas_data/","title":"raw_gwas_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/ldl/million_veterans/raw_gwas_data/#mecfs_bio.assets.gwas.ldl.million_veterans.raw_gwas_data","title":"mecfs_bio.assets.gwas.ldl.million_veterans.raw_gwas_data","text":"<p>Modules:</p> <ul> <li> <code>raw_ldl_data</code>           \u2013            <p>Raw Summary Statistics from the Million Veterans Program GWAS of LDL cholesterol.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/ldl/million_veterans/raw_gwas_data/raw_ldl_data/","title":"raw_ldl_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/ldl/million_veterans/raw_gwas_data/raw_ldl_data/#mecfs_bio.assets.gwas.ldl.million_veterans.raw_gwas_data.raw_ldl_data","title":"mecfs_bio.assets.gwas.ldl.million_veterans.raw_gwas_data.raw_ldl_data","text":"<p>Raw Summary Statistics from the Million Veterans Program GWAS of LDL cholesterol.</p> <p>See here for the ftp download page:https://ftp.ebi.ac.uk/pub/databases/gwas/summary_statistics/GCST90475001-GCST90476000/GCST90475416/</p> <p>See the GWAS catalog page here: https://www.ebi.ac.uk/gwas/studies/GCST90475416</p> <p>Attributes:</p> <ul> <li> <code>MILLION_VETERAN_LDL_EUR_DATA_RAW</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/ldl/million_veterans/raw_gwas_data/raw_ldl_data/#mecfs_bio.assets.gwas.ldl.million_veterans.raw_gwas_data.raw_ldl_data.MILLION_VETERAN_LDL_EUR_DATA_RAW","title":"MILLION_VETERAN_LDL_EUR_DATA_RAW  <code>module-attribute</code>","text":"<pre><code>MILLION_VETERAN_LDL_EUR_DATA_RAW = DownloadFileTask(\n    meta=GWASSummaryDataFileMeta(\n        id=AssetId(\"million_veterans_ldl_eur_raw\"),\n        trait=\"ldl\",\n        project=\"million_veterans\",\n        sub_dir=\"raw\",\n        project_path=PurePath(\"GCST90475416.tsv.gz\"),\n        read_spec=DataFrameReadSpec(\n            format=DataFrameTextFormat(separator=\"\\t\")\n        ),\n    ),\n    url=\"https://ftp.ebi.ac.uk/pub/databases/gwas/summary_statistics/GCST90475001-GCST90476000/GCST90475416/GCST90475416.tsv.gz\",\n    md5_hash=\"ecc667e9619db80b1752299bd81eaac5\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/","title":"me_cfs","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/#mecfs_bio.assets.gwas.me_cfs","title":"mecfs_bio.assets.gwas.me_cfs","text":"<p>Tasks pertaining to ME/CFS  GWAS.</p> <p>Modules:</p> <ul> <li> <code>decode_me</code>           \u2013            <p>Tasks pertaining to the DecodeME GWAS.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/","title":"decode_me","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/#mecfs_bio.assets.gwas.me_cfs.decode_me","title":"mecfs_bio.assets.gwas.me_cfs.decode_me","text":"<p>Tasks pertaining to the DecodeME GWAS.</p> <p>Modules:</p> <ul> <li> <code>analysis</code>           \u2013            <p>Tasks analyzing DecodeME data</p> </li> <li> <code>processed_gwas_data</code>           \u2013            <p>Tasks for organizing and preprocessing DecodeME data.</p> </li> <li> <code>raw_gwas_data</code>           \u2013            <p>Tasks retrieving raw GWAS data from the DecodeME OSF repository.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/","title":"analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis","text":"<p>Tasks analyzing DecodeME data</p> <p>Modules:</p> <ul> <li> <code>decode_me_gwas_1_cis_pqtl_mr</code>           \u2013            </li> <li> <code>decode_me_gwas_1_combined_gene_list_markdown</code>           \u2013            <p>Task to take combined list of candidate genes generated from MAGMA and GWASLAB and write out to a markdown file</p> </li> <li> <code>decode_me_gwas_1_combined_gene_list_with_gget</code>           \u2013            <p>Task to use gget to annotate master genes list with annotations from genetics databases.</p> </li> <li> <code>decode_me_gwas_1_combined_gene_lists</code>           \u2013            <p>Task to combine lists of candidate genes generated from MAGMA and GWASLAB</p> </li> <li> <code>decode_me_gwas_1_lead_variant_region_plots</code>           \u2013            </li> <li> <code>decode_me_gwas_1_lead_variants</code>           \u2013            </li> <li> <code>decode_me_gwas_1_lead_variants_gene_labeled</code>           \u2013            </li> <li> <code>decode_me_gwas_1_manhattan</code>           \u2013            </li> <li> <code>decode_me_gwas_1_manhattan_and_qq</code>           \u2013            </li> <li> <code>decode_me_region_plot_BTN1A1_locus_37</code>           \u2013            </li> <li> <code>decode_me_region_plot_rabgap1l_locus_37</code>           \u2013            </li> <li> <code>decode_me_sldsc</code>           \u2013            <p>Generate a chain of tasks to apply S-LDSC to DecodeME GWAS 1</p> </li> <li> <code>fine_mapping</code>           \u2013            </li> <li> <code>magma</code>           \u2013            <p>Tasks analyzing DecodeME data using MAGMA</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_cis_pqtl_mr/","title":"decode_me_gwas_1_cis_pqtl_mr","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_cis_pqtl_mr/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_cis_pqtl_mr","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_cis_pqtl_mr","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_BASIC_CIS_PQTL_MR</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_cis_pqtl_mr/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_cis_pqtl_mr.DECODE_ME_BASIC_CIS_PQTL_MR","title":"DECODE_ME_BASIC_CIS_PQTL_MR  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_BASIC_CIS_PQTL_MR = mr_cis_pqtl_asset_generator(\n    gwas_dataframe_with_rsids=join_task,\n    base_name=\"decode_me_gwas_1_mr\",\n    outcome_config=BinaryOutcomeConfig(\n        n_case=15579, n_control=259909\n    ),\n    pre_pipe=RenameColPipe(\n        old_name=\"rsid\", new_name=GWASLAB_RSID_COL\n    ),\n    significant_alpha=0.05,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_combined_gene_list_markdown/","title":"decode_me_gwas_1_combined_gene_list_markdown","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_combined_gene_list_markdown/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_combined_gene_list_markdown","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_combined_gene_list_markdown","text":"<p>Task to take combined list of candidate genes generated from MAGMA and GWASLAB and write out to a markdown file</p> <p>Attributes:</p> <ul> <li> <code>DECODE_ME_MASTER_GENE_LIST_AS_MARKDOWN</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_combined_gene_list_markdown/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_combined_gene_list_markdown.DECODE_ME_MASTER_GENE_LIST_AS_MARKDOWN","title":"DECODE_ME_MASTER_GENE_LIST_AS_MARKDOWN  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_MASTER_GENE_LIST_AS_MARKDOWN = (\n    create_from_result_table_task(\n        DECODE_ME_MASTER_GENE_LIST_WITH_GGET,\n        \"decode_me_gwas_1_combined_gene_list_markdown\",\n        pipe=SelectColPipe(\n            [\n                \"Ensembl ID\",\n                \"sources\",\n                \"uniprot_id\",\n                \"primary_gene_name\",\n                \"subcellular_localisation\",\n                \"ensembl_description\",\n                \"uniprot_description\",\n                \"ncbi_description\",\n            ]\n        ),\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_combined_gene_list_with_gget/","title":"decode_me_gwas_1_combined_gene_list_with_gget","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_combined_gene_list_with_gget/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_combined_gene_list_with_gget","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_combined_gene_list_with_gget","text":"<p>Task to use gget to annotate master genes list with annotations from genetics databases.</p> <p>Attributes:</p> <ul> <li> <code>DECODE_ME_MASTER_GENE_LIST_WITH_GGET</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_combined_gene_list_with_gget/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_combined_gene_list_with_gget.DECODE_ME_MASTER_GENE_LIST_WITH_GGET","title":"DECODE_ME_MASTER_GENE_LIST_WITH_GGET  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_MASTER_GENE_LIST_WITH_GGET = create(\n    asset_id=\"decode_me_gwas_1_master_gene_list_with_gget\",\n    source_df_task=DECODE_ME_GWAS_1_COMBINED_GENE_LISTS,\n    ensembl_id_col=ENSEMBL_ID_LABEL,\n    post_pipe=SortPipe([ENSEMBL_ID_LABEL]),\n    out_format=ParquetOutFormat(),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_combined_gene_lists/","title":"decode_me_gwas_1_combined_gene_lists","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_combined_gene_lists/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_combined_gene_lists","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_combined_gene_lists","text":"<p>Task to combine lists of candidate genes generated from MAGMA and GWASLAB</p> <p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_COMBINED_GENE_LISTS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_combined_gene_lists/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_combined_gene_lists.DECODE_ME_GWAS_1_COMBINED_GENE_LISTS","title":"DECODE_ME_GWAS_1_COMBINED_GENE_LISTS  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_COMBINED_GENE_LISTS = create(\n    asset_id=\"decode_me_gwas_1_combined_gene_list\",\n    src_gene_lists=[\n        SrcGeneList(\n            task=DECODE_ME_GWAS_1_GWASLAB_FILTERED_GENE_LIST_WITH_GENE_METADATA,\n            name=\"GWASLAB\",\n            ensemble_id_column=\"Gene stable ID\",\n        ),\n        SrcGeneList(\n            DECODE_ME_GWAS_1_MAGMA_FILTERED_GENE_LIST,\n            name=\"MAGMA\",\n            ensemble_id_column=\"GENE\",\n        ),\n    ],\n    out_format=ParquetOutFormat(),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_lead_variant_region_plots/","title":"decode_me_gwas_1_lead_variant_region_plots","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_lead_variant_region_plots/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_lead_variant_region_plots","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_lead_variant_region_plots","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_REGION_PLOTS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_lead_variant_region_plots/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_lead_variant_region_plots.DECODE_ME_GWAS_1_REGION_PLOTS","title":"DECODE_ME_GWAS_1_REGION_PLOTS  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_REGION_PLOTS = GwasLabRegionPlotsFromLeadVariantsTask(\n    lead_variants_task=DECODE_ME_GWAS_1_LEAD_VARIANTS,\n    sumstats_task=DECODE_ME_GWAS_1_SUMSTATS_MINIMAL_FILTERING,\n    vcf_name_for_ld=None,\n    short_id=\"decode_me_gwas_1_lead_variant_region_plots\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_lead_variants/","title":"decode_me_gwas_1_lead_variants","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_lead_variants/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_lead_variants","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_lead_variants","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_LEAD_VARIANTS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_lead_variants/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_lead_variants.DECODE_ME_GWAS_1_LEAD_VARIANTS","title":"DECODE_ME_GWAS_1_LEAD_VARIANTS  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_LEAD_VARIANTS = GwasLabLeadVariantsTask(\n    sumstats_task=DECODE_ME_GWAS_1_SUMSTATS_MINIMAL_FILTERING,\n    short_id=\"decode_me_gwas_1_lead_variants\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_lead_variants_gene_labeled/","title":"decode_me_gwas_1_lead_variants_gene_labeled","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_lead_variants_gene_labeled/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_lead_variants_gene_labeled","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_lead_variants_gene_labeled","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_GWASLAB_FILTERED_GENE_LIST_WITH_GENE_METADATA</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_lead_variants_gene_labeled/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_lead_variants_gene_labeled.DECODE_ME_GWAS_1_GWASLAB_FILTERED_GENE_LIST_WITH_GENE_METADATA","title":"DECODE_ME_GWAS_1_GWASLAB_FILTERED_GENE_LIST_WITH_GENE_METADATA  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_GWASLAB_FILTERED_GENE_LIST_WITH_GENE_METADATA = create_from_result_df(\n    asset_id=\"decode_me_gwas_1_gwaslab_filtered_gene_list_with_metadata\",\n    result_df_task=DECODE_ME_GWAS_1_LEAD_VARIANTS,\n    reference_df_task=GENE_THESAURUS,\n    how=\"left\",\n    left_on=[\"GENE\"],\n    right_on=[\"Gene name\"],\n    df_1_pipe=SelectColPipe([\"GENE\"]),\n    df_2_pipe=SelectColPipe(\n        [\n            \"Gene name\",\n            \"NCBI gene (formerly Entrezgene) ID\",\n            \"Gene stable ID\",\n        ]\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_manhattan/","title":"decode_me_gwas_1_manhattan","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_manhattan/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_manhattan","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_manhattan","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_MANHATTAN_PLOT</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_manhattan/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_manhattan.DECODE_ME_GWAS_1_MANHATTAN_PLOT","title":"DECODE_ME_GWAS_1_MANHATTAN_PLOT  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_MANHATTAN_PLOT = create(\n    sumstats_task=DECODE_ME_GWAS_1_SUMSTATS_MINIMAL_FILTERING,\n    asset_id=\"decode_me_gwas_1_manhattan_plot\",\n    plot_setting=\"m\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_manhattan_and_qq/","title":"decode_me_gwas_1_manhattan_and_qq","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_manhattan_and_qq/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_manhattan_and_qq","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_manhattan_and_qq","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_MANHATTAN_AND_QQ_PLOT</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_gwas_1_manhattan_and_qq/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_gwas_1_manhattan_and_qq.DECODE_ME_GWAS_1_MANHATTAN_AND_QQ_PLOT","title":"DECODE_ME_GWAS_1_MANHATTAN_AND_QQ_PLOT  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_MANHATTAN_AND_QQ_PLOT = create(\n    sumstats_task=DECODE_ME_GWAS_1_SUMSTATS_MINIMAL_FILTERING,\n    asset_id=\"decode_me_gwas_1_manhattan_and_qq_plot\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_region_plot_BTN1A1_locus_37/","title":"decode_me_region_plot_BTN1A1_locus_37","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_region_plot_BTN1A1_locus_37/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_region_plot_BTN1A1_locus_37","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_region_plot_BTN1A1_locus_37","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_BTN1A1_REGION_PLOT_37</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_region_plot_BTN1A1_locus_37/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_region_plot_BTN1A1_locus_37.DECODE_ME_BTN1A1_REGION_PLOT_37","title":"DECODE_ME_BTN1A1_REGION_PLOT_37  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_BTN1A1_REGION_PLOT_37 = create(\n    asset_id=\"decode_me_region_plot_btn1a1_locus\",\n    sumstats_task=DECODE_ME_GWAS_1_37_ANNOVAR_RSIDS_SUMSTATS,\n    vcf_name_for_ld=\"1kg_eur_hg19\",\n    chrom=6,\n    pos=26465384,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_region_plot_rabgap1l_locus_37/","title":"decode_me_region_plot_rabgap1l_locus_37","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_region_plot_rabgap1l_locus_37/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_region_plot_rabgap1l_locus_37","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_region_plot_rabgap1l_locus_37","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_RABGAP1L_REGION_PLOT_37</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_region_plot_rabgap1l_locus_37/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_region_plot_rabgap1l_locus_37.DECODE_ME_RABGAP1L_REGION_PLOT_37","title":"DECODE_ME_RABGAP1L_REGION_PLOT_37  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_RABGAP1L_REGION_PLOT_37 = create(\n    asset_id=\"decode_me_region_plot_rabgap1l_locus\",\n    sumstats_task=DECODE_ME_GWAS_1_37_ANNOVAR_RSIDS_SUMSTATS,\n    vcf_name_for_ld=\"1kg_eur_hg19\",\n    chrom=1,\n    pos=174104743,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_sldsc/","title":"decode_me_sldsc","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_sldsc/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_sldsc","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_sldsc","text":"<p>Generate a chain of tasks to apply S-LDSC to DecodeME GWAS 1</p> <p>Attributes:</p> <ul> <li> <code>DECODE_ME_S_LDSC</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/decode_me_sldsc/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.decode_me_sldsc.DECODE_ME_S_LDSC","title":"DECODE_ME_S_LDSC  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_S_LDSC = standard_sldsc_task_generator(\n    sumstats_task=DECODE_ME_GWAS_1_37_ANNOVAR_RSIDS_SUMSTATS,\n    base_name=\"decode_me_gwas_1\",\n    pre_pipe=ComputePIfNeededPipe(),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/","title":"fine_mapping","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping","text":"<p>Modules:</p> <ul> <li> <code>with_palindromes</code>           \u2013            </li> <li> <code>without_palindromes</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/with_palindromes/","title":"with_palindromes","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/with_palindromes/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.with_palindromes","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.with_palindromes","text":"<p>Modules:</p> <ul> <li> <code>susie_finemap_decode_me_37_chr15_54_925_638_locus_plalindindromes</code>           \u2013            </li> <li> <code>susie_finemap_decode_me_37_chr17_50_237_377_locus_palindromes</code>           \u2013            </li> <li> <code>susie_finemap_decode_me_37_chr1_174_128_548_locus_palindromes</code>           \u2013            </li> <li> <code>susie_finemap_decode_me_37_chr20_47_653_230_locus_palindromes</code>           \u2013            </li> <li> <code>susie_finemap_decode_me_37_chr6_26_215_000_locus_palindromes</code>           \u2013            </li> <li> <code>susie_finemap_decode_me_37_chr6_97_505_620_locus_palindromes</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/with_palindromes/susie_finemap_decode_me_37_chr15_54_925_638_locus_plalindindromes/","title":"susie_finemap_decode_me_37_chr15_54_925_638_locus_plalindindromes","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/with_palindromes/susie_finemap_decode_me_37_chr15_54_925_638_locus_plalindindromes/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.with_palindromes.susie_finemap_decode_me_37_chr15_54_925_638_locus_plalindindromes","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.with_palindromes.susie_finemap_decode_me_37_chr15_54_925_638_locus_plalindindromes","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_37_CHR_15_54_925_638_FINEMAP_PALINDROMES</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/with_palindromes/susie_finemap_decode_me_37_chr15_54_925_638_locus_plalindindromes/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.with_palindromes.susie_finemap_decode_me_37_chr15_54_925_638_locus_plalindindromes.DECODE_ME_GWAS_37_CHR_15_54_925_638_FINEMAP_PALINDROMES","title":"DECODE_ME_GWAS_37_CHR_15_54_925_638_FINEMAP_PALINDROMES  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_37_CHR_15_54_925_638_FINEMAP_PALINDROMES = (\n    generate_assets_broad_ukbb_fine_map(\n        chrom=15,\n        pos=54925638,\n        build_37_sumstats_task=join_task,\n        base_name=\"decode_me\",\n        sumstats_pipe=IdentityPipe(),\n        sample_size_or_effect_sample_size=int(\n            4 / (1 / 15579 + 1 / 259909)\n        ),\n        palindrome_strategy=\"keep\",\n        chrom_range=ChromRange(15, 54500000, 55500000),\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/with_palindromes/susie_finemap_decode_me_37_chr17_50_237_377_locus_palindromes/","title":"susie_finemap_decode_me_37_chr17_50_237_377_locus_palindromes","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/with_palindromes/susie_finemap_decode_me_37_chr17_50_237_377_locus_palindromes/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.with_palindromes.susie_finemap_decode_me_37_chr17_50_237_377_locus_palindromes","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.with_palindromes.susie_finemap_decode_me_37_chr17_50_237_377_locus_palindromes","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_37_CHR17_50_237_377_FINEMAP_PALINDROMES</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/with_palindromes/susie_finemap_decode_me_37_chr17_50_237_377_locus_palindromes/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.with_palindromes.susie_finemap_decode_me_37_chr17_50_237_377_locus_palindromes.DECODE_ME_GWAS_37_CHR17_50_237_377_FINEMAP_PALINDROMES","title":"DECODE_ME_GWAS_37_CHR17_50_237_377_FINEMAP_PALINDROMES  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_37_CHR17_50_237_377_FINEMAP_PALINDROMES = (\n    generate_assets_broad_ukbb_fine_map(\n        chrom=17,\n        pos=50237377,\n        build_37_sumstats_task=join_task,\n        base_name=\"decode_me\",\n        sumstats_pipe=IdentityPipe(),\n        sample_size_or_effect_sample_size=int(\n            4 / (1 / 15579 + 1 / 259909)\n        ),\n        palindrome_strategy=\"keep\",\n        chrom_range=ChromRange(17, 50000000, 51000000),\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/with_palindromes/susie_finemap_decode_me_37_chr1_174_128_548_locus_palindromes/","title":"susie_finemap_decode_me_37_chr1_174_128_548_locus_palindromes","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/with_palindromes/susie_finemap_decode_me_37_chr1_174_128_548_locus_palindromes/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.with_palindromes.susie_finemap_decode_me_37_chr1_174_128_548_locus_palindromes","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.with_palindromes.susie_finemap_decode_me_37_chr1_174_128_548_locus_palindromes","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_37_CHR1_174_128_548_FINEMAP_PALINDROMES</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/with_palindromes/susie_finemap_decode_me_37_chr1_174_128_548_locus_palindromes/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.with_palindromes.susie_finemap_decode_me_37_chr1_174_128_548_locus_palindromes.DECODE_ME_GWAS_37_CHR1_174_128_548_FINEMAP_PALINDROMES","title":"DECODE_ME_GWAS_37_CHR1_174_128_548_FINEMAP_PALINDROMES  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_37_CHR1_174_128_548_FINEMAP_PALINDROMES = (\n    generate_assets_broad_ukbb_fine_map(\n        chrom=1,\n        pos=174128548,\n        build_37_sumstats_task=join_task,\n        base_name=\"decode_me\",\n        sumstats_pipe=IdentityPipe(),\n        sample_size_or_effect_sample_size=int(\n            4 / (1 / 15579 + 1 / 259909)\n        ),\n        palindrome_strategy=\"keep\",\n        chrom_range=ChromRange(1, 173500000, 174500000),\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/with_palindromes/susie_finemap_decode_me_37_chr20_47_653_230_locus_palindromes/","title":"susie_finemap_decode_me_37_chr20_47_653_230_locus_palindromes","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/with_palindromes/susie_finemap_decode_me_37_chr20_47_653_230_locus_palindromes/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.with_palindromes.susie_finemap_decode_me_37_chr20_47_653_230_locus_palindromes","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.with_palindromes.susie_finemap_decode_me_37_chr20_47_653_230_locus_palindromes","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_37_CHR20_47_653_000_FINEMAP_PALNDROMES</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/with_palindromes/susie_finemap_decode_me_37_chr20_47_653_230_locus_palindromes/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.with_palindromes.susie_finemap_decode_me_37_chr20_47_653_230_locus_palindromes.DECODE_ME_GWAS_37_CHR20_47_653_000_FINEMAP_PALNDROMES","title":"DECODE_ME_GWAS_37_CHR20_47_653_000_FINEMAP_PALNDROMES  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_37_CHR20_47_653_000_FINEMAP_PALNDROMES = (\n    generate_assets_broad_ukbb_fine_map(\n        chrom=20,\n        pos=47653230,\n        build_37_sumstats_task=join_task,\n        base_name=\"decode_me\",\n        sumstats_pipe=IdentityPipe(),\n        sample_size_or_effect_sample_size=int(\n            4 / (1 / 15579 + 1 / 259909)\n        ),\n        palindrome_strategy=\"keep\",\n        chrom_range=ChromRange(\n            chrom=20, start=47000000, end=48200000\n        ),\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/with_palindromes/susie_finemap_decode_me_37_chr6_26_215_000_locus_palindromes/","title":"susie_finemap_decode_me_37_chr6_26_215_000_locus_palindromes","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/with_palindromes/susie_finemap_decode_me_37_chr6_26_215_000_locus_palindromes/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.with_palindromes.susie_finemap_decode_me_37_chr6_26_215_000_locus_palindromes","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.with_palindromes.susie_finemap_decode_me_37_chr6_26_215_000_locus_palindromes","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_37_CHR6_26_215_000_FINEMAP_PALINDROMES</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/with_palindromes/susie_finemap_decode_me_37_chr6_26_215_000_locus_palindromes/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.with_palindromes.susie_finemap_decode_me_37_chr6_26_215_000_locus_palindromes.DECODE_ME_GWAS_37_CHR6_26_215_000_FINEMAP_PALINDROMES","title":"DECODE_ME_GWAS_37_CHR6_26_215_000_FINEMAP_PALINDROMES  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_37_CHR6_26_215_000_FINEMAP_PALINDROMES = (\n    generate_assets_broad_ukbb_fine_map(\n        chrom=6,\n        pos=26215000,\n        build_37_sumstats_task=join_task,\n        base_name=\"decode_me\",\n        sumstats_pipe=IdentityPipe(),\n        sample_size_or_effect_sample_size=int(\n            4 / (1 / 15579 + 1 / 259909)\n        ),\n        palindrome_strategy=\"keep\",\n        chrom_range=ChromRange(6, 26000000, 27000000),\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/with_palindromes/susie_finemap_decode_me_37_chr6_97_505_620_locus_palindromes/","title":"susie_finemap_decode_me_37_chr6_97_505_620_locus_palindromes","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/with_palindromes/susie_finemap_decode_me_37_chr6_97_505_620_locus_palindromes/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.with_palindromes.susie_finemap_decode_me_37_chr6_97_505_620_locus_palindromes","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.with_palindromes.susie_finemap_decode_me_37_chr6_97_505_620_locus_palindromes","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_37_CHR6_97_505_620_FINEMAP_PALINDROMES</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/with_palindromes/susie_finemap_decode_me_37_chr6_97_505_620_locus_palindromes/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.with_palindromes.susie_finemap_decode_me_37_chr6_97_505_620_locus_palindromes.DECODE_ME_GWAS_37_CHR6_97_505_620_FINEMAP_PALINDROMES","title":"DECODE_ME_GWAS_37_CHR6_97_505_620_FINEMAP_PALINDROMES  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_37_CHR6_97_505_620_FINEMAP_PALINDROMES = (\n    generate_assets_broad_ukbb_fine_map(\n        chrom=6,\n        pos=97505620,\n        build_37_sumstats_task=join_task,\n        base_name=\"decode_me\",\n        sumstats_pipe=IdentityPipe(),\n        sample_size_or_effect_sample_size=int(\n            4 / (1 / 15579 + 1 / 259909)\n        ),\n        palindrome_strategy=\"keep\",\n        chrom_range=ChromRange(6, 97500000, 99000000),\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/without_palindromes/","title":"without_palindromes","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/without_palindromes/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.without_palindromes","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.without_palindromes","text":"<p>Modules:</p> <ul> <li> <code>susie_finemap_decode_me_37_chr15_54_925_638_locus</code>           \u2013            </li> <li> <code>susie_finemap_decode_me_37_chr17_50_237_377_locus</code>           \u2013            </li> <li> <code>susie_finemap_decode_me_37_chr1_173_locus</code>           \u2013            <p>Apply SUSIE to finemap the main DecodeME GWAS hit on chromosome 1.</p> </li> <li> <code>susie_finemap_decode_me_37_chr1_173_locus_stackplot</code>           \u2013            <p>Task to create a stacked plot illustrating the fine-mapping of the DecodeME Chromosome 1 locus</p> </li> <li> <code>susie_finemap_decode_me_37_chr20_47_653_230_locus</code>           \u2013            </li> <li> <code>susie_finemap_decode_me_37_chr6_26_215_000_locus</code>           \u2013            </li> <li> <code>susie_finemap_decode_me_37_chr6_97_505_620_locus</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/without_palindromes/susie_finemap_decode_me_37_chr15_54_925_638_locus/","title":"susie_finemap_decode_me_37_chr15_54_925_638_locus","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/without_palindromes/susie_finemap_decode_me_37_chr15_54_925_638_locus/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.without_palindromes.susie_finemap_decode_me_37_chr15_54_925_638_locus","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.without_palindromes.susie_finemap_decode_me_37_chr15_54_925_638_locus","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_37_CHR_15_54_925_638_FINEMAP</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/without_palindromes/susie_finemap_decode_me_37_chr15_54_925_638_locus/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.without_palindromes.susie_finemap_decode_me_37_chr15_54_925_638_locus.DECODE_ME_GWAS_37_CHR_15_54_925_638_FINEMAP","title":"DECODE_ME_GWAS_37_CHR_15_54_925_638_FINEMAP  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_37_CHR_15_54_925_638_FINEMAP = (\n    generate_assets_broad_ukbb_fine_map(\n        chrom=15,\n        pos=54925638,\n        build_37_sumstats_task=join_task,\n        base_name=\"decode_me\",\n        sumstats_pipe=IdentityPipe(),\n        sample_size_or_effect_sample_size=int(\n            4 / (1 / 15579 + 1 / 259909)\n        ),\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/without_palindromes/susie_finemap_decode_me_37_chr17_50_237_377_locus/","title":"susie_finemap_decode_me_37_chr17_50_237_377_locus","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/without_palindromes/susie_finemap_decode_me_37_chr17_50_237_377_locus/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.without_palindromes.susie_finemap_decode_me_37_chr17_50_237_377_locus","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.without_palindromes.susie_finemap_decode_me_37_chr17_50_237_377_locus","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_37_CHR17_50_237_377_FINEMAP</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/without_palindromes/susie_finemap_decode_me_37_chr17_50_237_377_locus/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.without_palindromes.susie_finemap_decode_me_37_chr17_50_237_377_locus.DECODE_ME_GWAS_37_CHR17_50_237_377_FINEMAP","title":"DECODE_ME_GWAS_37_CHR17_50_237_377_FINEMAP  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_37_CHR17_50_237_377_FINEMAP = (\n    generate_assets_broad_ukbb_fine_map(\n        chrom=17,\n        pos=50237377,\n        build_37_sumstats_task=join_task,\n        base_name=\"decode_me\",\n        sumstats_pipe=IdentityPipe(),\n        sample_size_or_effect_sample_size=int(\n            4 / (1 / 15579 + 1 / 259909)\n        ),\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/without_palindromes/susie_finemap_decode_me_37_chr1_173_locus/","title":"susie_finemap_decode_me_37_chr1_173_locus","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/without_palindromes/susie_finemap_decode_me_37_chr1_173_locus/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.without_palindromes.susie_finemap_decode_me_37_chr1_173_locus","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.without_palindromes.susie_finemap_decode_me_37_chr1_173_locus","text":"<p>Apply SUSIE to finemap the main DecodeME GWAS hit on chromosome 1. As a reference, use the UK Biobank LD matrix from the Broad Institute.</p> <p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_SUSIE_FINEMAP_CHR1_173_000_001_LOCUS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/without_palindromes/susie_finemap_decode_me_37_chr1_173_locus/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.without_palindromes.susie_finemap_decode_me_37_chr1_173_locus.DECODE_ME_GWAS_1_SUSIE_FINEMAP_CHR1_173_000_001_LOCUS","title":"DECODE_ME_GWAS_1_SUSIE_FINEMAP_CHR1_173_000_001_LOCUS  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_SUSIE_FINEMAP_CHR1_173_000_001_LOCUS = create(\n    asset_id=\"decode_me_gwas_1_37_susie_finemap_chr1_173000001_locus\",\n    gwas_data_task=DECODE_ME_HARMONIZE_WITH_CHR1_173_000_001_LD_VIA_ALLELES,\n    ld_labels_task=CHR1_173000001_17600000_UKBB_LD_LABELS_DOWNLOAD,\n    ld_matrix_source=BroadInstituteFormatLDMatrix(\n        CHR1_173000001_17600000_UKBB_LD_MATRIX_DOWNLOAD\n    ),\n    effective_sample_size=4 / (1 / 15579 + 1 / 259909),\n    ld_labels_pipe=CompositePipe(\n        [\n            RenameColPipe(\n                old_name=\"rsid\", new_name=GWASLAB_RSID_COL\n            ),\n            RenameColPipe(\n                old_name=\"chromosome\",\n                new_name=GWASLAB_CHROM_COL,\n            ),\n            RenameColPipe(\n                old_name=\"position\",\n                new_name=GWASLAB_POS_COL,\n            ),\n            RenameColPipe(\n                old_name=\"allele1\",\n                new_name=GWASLAB_NON_EFFECT_ALLELE_COL,\n            ),\n            RenameColPipe(\n                old_name=\"allele2\",\n                new_name=GWASLAB_EFFECT_ALLELE_COL,\n            ),\n        ]\n    ),\n    subsample=None,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/without_palindromes/susie_finemap_decode_me_37_chr1_173_locus_stackplot/","title":"susie_finemap_decode_me_37_chr1_173_locus_stackplot","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/without_palindromes/susie_finemap_decode_me_37_chr1_173_locus_stackplot/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.without_palindromes.susie_finemap_decode_me_37_chr1_173_locus_stackplot","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.without_palindromes.susie_finemap_decode_me_37_chr1_173_locus_stackplot","text":"<p>Task to create a stacked plot illustrating the fine-mapping of the DecodeME Chromosome 1 locus</p> <p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_SUSIE_FINEMAP_CHR1_173_000_001_LOCUS_STACKPLOT</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/without_palindromes/susie_finemap_decode_me_37_chr1_173_locus_stackplot/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.without_palindromes.susie_finemap_decode_me_37_chr1_173_locus_stackplot.DECODE_ME_GWAS_1_SUSIE_FINEMAP_CHR1_173_000_001_LOCUS_STACKPLOT","title":"DECODE_ME_GWAS_1_SUSIE_FINEMAP_CHR1_173_000_001_LOCUS_STACKPLOT  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_SUSIE_FINEMAP_CHR1_173_000_001_LOCUS_STACKPLOT = create(\n    asset_id=\"stackplot_decode_me_gwas_1_37_susie_finemap_chr1_173000001_locus\",\n    susie_task=DECODE_ME_GWAS_1_SUSIE_FINEMAP_CHR1_173_000_001_LOCUS,\n    gene_info_task=MAGMA_ENSEMBL_GENE_LOCATION_REFERENCE_DATA_BUILD_37_RAW,\n    gene_info_pipe=IdentityPipe(),\n    region_mode=RegionSelectDefault(),\n    heatmap_options=HeatmapOptions(\n        heatmap_bin_options=None, mode=\"ld2\", cmap=\"plasma\"\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/without_palindromes/susie_finemap_decode_me_37_chr20_47_653_230_locus/","title":"susie_finemap_decode_me_37_chr20_47_653_230_locus","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/without_palindromes/susie_finemap_decode_me_37_chr20_47_653_230_locus/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.without_palindromes.susie_finemap_decode_me_37_chr20_47_653_230_locus","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.without_palindromes.susie_finemap_decode_me_37_chr20_47_653_230_locus","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_37_CHR20_47_653_000_FINEMAP</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/without_palindromes/susie_finemap_decode_me_37_chr20_47_653_230_locus/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.without_palindromes.susie_finemap_decode_me_37_chr20_47_653_230_locus.DECODE_ME_GWAS_37_CHR20_47_653_000_FINEMAP","title":"DECODE_ME_GWAS_37_CHR20_47_653_000_FINEMAP  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_37_CHR20_47_653_000_FINEMAP = (\n    generate_assets_broad_ukbb_fine_map(\n        chrom=20,\n        pos=47653230,\n        build_37_sumstats_task=join_task,\n        base_name=\"decode_me\",\n        sumstats_pipe=IdentityPipe(),\n        sample_size_or_effect_sample_size=int(\n            4 / (1 / 15579 + 1 / 259909)\n        ),\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/without_palindromes/susie_finemap_decode_me_37_chr6_26_215_000_locus/","title":"susie_finemap_decode_me_37_chr6_26_215_000_locus","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/without_palindromes/susie_finemap_decode_me_37_chr6_26_215_000_locus/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.without_palindromes.susie_finemap_decode_me_37_chr6_26_215_000_locus","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.without_palindromes.susie_finemap_decode_me_37_chr6_26_215_000_locus","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_37_CHR6_26_215_000_FINEMAP</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/without_palindromes/susie_finemap_decode_me_37_chr6_26_215_000_locus/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.without_palindromes.susie_finemap_decode_me_37_chr6_26_215_000_locus.DECODE_ME_GWAS_37_CHR6_26_215_000_FINEMAP","title":"DECODE_ME_GWAS_37_CHR6_26_215_000_FINEMAP  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_37_CHR6_26_215_000_FINEMAP = (\n    generate_assets_broad_ukbb_fine_map(\n        chrom=6,\n        pos=26215000,\n        build_37_sumstats_task=join_task,\n        base_name=\"decode_me\",\n        sumstats_pipe=IdentityPipe(),\n        sample_size_or_effect_sample_size=int(\n            4 / (1 / 15579 + 1 / 259909)\n        ),\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/without_palindromes/susie_finemap_decode_me_37_chr6_97_505_620_locus/","title":"susie_finemap_decode_me_37_chr6_97_505_620_locus","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/without_palindromes/susie_finemap_decode_me_37_chr6_97_505_620_locus/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.without_palindromes.susie_finemap_decode_me_37_chr6_97_505_620_locus","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.without_palindromes.susie_finemap_decode_me_37_chr6_97_505_620_locus","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_37_CHR6_97_505_620_FINEMAP</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/fine_mapping/without_palindromes/susie_finemap_decode_me_37_chr6_97_505_620_locus/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.fine_mapping.without_palindromes.susie_finemap_decode_me_37_chr6_97_505_620_locus.DECODE_ME_GWAS_37_CHR6_97_505_620_FINEMAP","title":"DECODE_ME_GWAS_37_CHR6_97_505_620_FINEMAP  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_37_CHR6_97_505_620_FINEMAP = (\n    generate_assets_broad_ukbb_fine_map(\n        chrom=6,\n        pos=97505620,\n        build_37_sumstats_task=join_task,\n        base_name=\"decode_me\",\n        sumstats_pipe=IdentityPipe(),\n        sample_size_or_effect_sample_size=int(\n            4 / (1 / 15579 + 1 / 259909)\n        ),\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/","title":"magma","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma","text":"<p>Tasks analyzing DecodeME data using MAGMA</p> <p>Modules:</p> <ul> <li> <code>decode_me_filtered_gene_list</code>           \u2013            </li> <li> <code>decode_me_filtered_gene_list_with_gene_metadata</code>           \u2013            <p>Add Gene symbols, Entrez IDs, and Gene descriptions to the list of significant genes produced by MAGMA.</p> </li> <li> <code>decode_me_filtered_gene_list_with_gene_metadata_drop_cols</code>           \u2013            <p>Keep only the essential columns from the filtered genelist</p> </li> <li> <code>decode_me_gwas_1_build_37_entrez_gsea_hallmark_gene_sets</code>           \u2013            </li> <li> <code>decode_me_gwas_1_build_37_magma_ensembl_specific_tissue_gene_sets</code>           \u2013            </li> <li> <code>decode_me_gwas_1_build_37_magma_ensembl_specific_tissue_gene_sets_brain_average</code>           \u2013            <p>Similar to  MAGMA_DECODE_ME_SPECIFIC_TISSUE_GENE_SET_ANALYSIS, but averages across brain tissues.</p> </li> <li> <code>decode_me_hba_magma_analysis</code>           \u2013            <p>Task generator to analyze decodeME GWAS 1 using the human brian atlas reference dataset</p> </li> <li> <code>magma_specific_tissue_bar_plot</code>           \u2013            </li> <li> <code>magma_specific_tissue_bar_plot_brain_average</code>           \u2013            <p>Analogous to MAGMA_DECODE_ME_SPECIFIC_TISSUE_ANALYSIS_BAR_PLOT, but controls for average across brain tissue, not all tissues.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/decode_me_filtered_gene_list/","title":"decode_me_filtered_gene_list","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/decode_me_filtered_gene_list/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.decode_me_filtered_gene_list","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.decode_me_filtered_gene_list","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_MAGMA_FILTERED_GENE_LIST</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/decode_me_filtered_gene_list/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.decode_me_filtered_gene_list.DECODE_ME_GWAS_1_MAGMA_FILTERED_GENE_LIST","title":"DECODE_ME_GWAS_1_MAGMA_FILTERED_GENE_LIST  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_MAGMA_FILTERED_GENE_LIST = create_from_magma_gene_analysis_task(\n    asset_id=\"decode_me_gwas_1_magma_filtered_gene_list\",\n    alpha=0.01,\n    method=\"fdr_bh\",\n    source_task=DECODE_ME_GWAS_1_MAGMA_ENSEMBL_GENE_ANALYSIS,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/decode_me_filtered_gene_list_with_gene_metadata/","title":"decode_me_filtered_gene_list_with_gene_metadata","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/decode_me_filtered_gene_list_with_gene_metadata/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.decode_me_filtered_gene_list_with_gene_metadata","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.decode_me_filtered_gene_list_with_gene_metadata","text":"<p>Add Gene symbols, Entrez IDs, and Gene descriptions to the list of significant genes produced by MAGMA.</p> <p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_MAGMA_FILTERED_GENE_LIST_WITH_GENE_METADATA</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/decode_me_filtered_gene_list_with_gene_metadata/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.decode_me_filtered_gene_list_with_gene_metadata.DECODE_ME_GWAS_1_MAGMA_FILTERED_GENE_LIST_WITH_GENE_METADATA","title":"DECODE_ME_GWAS_1_MAGMA_FILTERED_GENE_LIST_WITH_GENE_METADATA  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_MAGMA_FILTERED_GENE_LIST_WITH_GENE_METADATA = create_from_result_df(\n    asset_id=\"decode_me_gwas_1_magma_filtered_gene_list_with_metadata\",\n    result_df_task=DECODE_ME_GWAS_1_MAGMA_FILTERED_GENE_LIST,\n    reference_df_task=GENE_THESAURUS,\n    how=\"left\",\n    left_on=[\"GENE\"],\n    right_on=[\"Gene stable ID\"],\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/decode_me_filtered_gene_list_with_gene_metadata_drop_cols/","title":"decode_me_filtered_gene_list_with_gene_metadata_drop_cols","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/decode_me_filtered_gene_list_with_gene_metadata_drop_cols/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.decode_me_filtered_gene_list_with_gene_metadata_drop_cols","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.decode_me_filtered_gene_list_with_gene_metadata_drop_cols","text":"<p>Keep only the essential columns from the filtered genelist</p> <p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_MAGMA_FILTERED_GENE_LIST_WITH_GENE_METADATA_DROP_COLS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/decode_me_filtered_gene_list_with_gene_metadata_drop_cols/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.decode_me_filtered_gene_list_with_gene_metadata_drop_cols.DECODE_ME_GWAS_1_MAGMA_FILTERED_GENE_LIST_WITH_GENE_METADATA_DROP_COLS","title":"DECODE_ME_GWAS_1_MAGMA_FILTERED_GENE_LIST_WITH_GENE_METADATA_DROP_COLS  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_MAGMA_FILTERED_GENE_LIST_WITH_GENE_METADATA_DROP_COLS = create(\n    source_task=DECODE_ME_GWAS_1_MAGMA_FILTERED_GENE_LIST_WITH_GENE_METADATA,\n    asset_id=\"decode_me_gwas_1_magma_filtered_gene_list_with_metadata_essential_cols\",\n    out_format=CSVOutFormat(sep=\",\"),\n    pipes=[\n        SelectColPipe(\n            cols_to_select=[\n                \"GENE\",\n                \"Gene name\",\n                \"CHR\",\n                \"P\",\n                \"Gene description\",\n            ]\n        ),\n        LogMarkdownPipe(),\n    ],\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/decode_me_gwas_1_build_37_entrez_gsea_hallmark_gene_sets/","title":"decode_me_gwas_1_build_37_entrez_gsea_hallmark_gene_sets","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/decode_me_gwas_1_build_37_entrez_gsea_hallmark_gene_sets/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.decode_me_gwas_1_build_37_entrez_gsea_hallmark_gene_sets","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.decode_me_gwas_1_build_37_entrez_gsea_hallmark_gene_sets","text":"<p>Attributes:</p> <ul> <li> <code>MAGMA_DECODE_ME_GSEA_HALLMARK_GENE_SET_ANALYSIS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/decode_me_gwas_1_build_37_entrez_gsea_hallmark_gene_sets/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.decode_me_gwas_1_build_37_entrez_gsea_hallmark_gene_sets.MAGMA_DECODE_ME_GSEA_HALLMARK_GENE_SET_ANALYSIS","title":"MAGMA_DECODE_ME_GSEA_HALLMARK_GENE_SET_ANALYSIS  <code>module-attribute</code>","text":"<pre><code>MAGMA_DECODE_ME_GSEA_HALLMARK_GENE_SET_ANALYSIS = create(\n    asset_id=\"decode_me_gwas_1_build_37_magma_entrez_gse_hallmark_gene_set_analysis\",\n    magma_gene_analysis_task=DECODE_ME_GWAS_1_MAGMA_ENTREZ_GENE_ANALYSIS,\n    magma_binary_task=MAGMA_1_1_BINARY_EXTRACTED,\n    gene_set_task=DirectoryGeneSetSpec(\n        gene_set_task=GSEA_HUMAN_GENE_SET_2025_V1_EXTRACTED,\n        path_in_dir=PurePath(\n            \"msigdb_v2025.1.Hs_files_to_download_locally/msigdb_v2025.1.Hs_GMTs/h.all.v2025.1.Hs.entrez.gmt\"\n        ),\n    ),\n    set_or_covar=\"set\",\n    model_params=None,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/decode_me_gwas_1_build_37_magma_ensembl_specific_tissue_gene_sets/","title":"decode_me_gwas_1_build_37_magma_ensembl_specific_tissue_gene_sets","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/decode_me_gwas_1_build_37_magma_ensembl_specific_tissue_gene_sets/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.decode_me_gwas_1_build_37_magma_ensembl_specific_tissue_gene_sets","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.decode_me_gwas_1_build_37_magma_ensembl_specific_tissue_gene_sets","text":"<p>Attributes:</p> <ul> <li> <code>MAGMA_DECODE_ME_SPECIFIC_TISSUE_GENE_SET_ANALYSIS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/decode_me_gwas_1_build_37_magma_ensembl_specific_tissue_gene_sets/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.decode_me_gwas_1_build_37_magma_ensembl_specific_tissue_gene_sets.MAGMA_DECODE_ME_SPECIFIC_TISSUE_GENE_SET_ANALYSIS","title":"MAGMA_DECODE_ME_SPECIFIC_TISSUE_GENE_SET_ANALYSIS  <code>module-attribute</code>","text":"<pre><code>MAGMA_DECODE_ME_SPECIFIC_TISSUE_GENE_SET_ANALYSIS = create(\n    asset_id=\"decode_me_gwas_1_build_37_magma_ensemble_specific_tissue_gene_covar_analysis\",\n    magma_gene_analysis_task=DECODE_ME_GWAS_1_MAGMA_ENSEMBL_GENE_ANALYSIS,\n    magma_binary_task=MAGMA_1_1_BINARY_EXTRACTED,\n    gene_set_task=GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_PREP_FOR_MAGMA,\n    set_or_covar=\"covar\",\n    model_params=ModelParams(\n        direction_covar=\"greater\",\n        condition_hide=[\"Average\"],\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/decode_me_gwas_1_build_37_magma_ensembl_specific_tissue_gene_sets_brain_average/","title":"decode_me_gwas_1_build_37_magma_ensembl_specific_tissue_gene_sets_brain_average","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/decode_me_gwas_1_build_37_magma_ensembl_specific_tissue_gene_sets_brain_average/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.decode_me_gwas_1_build_37_magma_ensembl_specific_tissue_gene_sets_brain_average","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.decode_me_gwas_1_build_37_magma_ensembl_specific_tissue_gene_sets_brain_average","text":"<p>Similar to  MAGMA_DECODE_ME_SPECIFIC_TISSUE_GENE_SET_ANALYSIS, but averages across brain tissues.</p> <p>The idea is that gene expression is very correlated among brain tissues, in comparison to correlation of a given brain tissue with a non-brain tissue (see for example, Fig 3A from Urbut 2019). Thus, even when controlling for average expression across all body tissues, multiple non-causal brain tissues may still be significant simply due to their high correlation to a different causal brain tissue.</p> <p>By controlling for average expression across brain tissues, we can see if expression in any brain tissues is associated with a phenotype, and which is not simply due to general brain-wide expression. This may potentially narrow down which specific tissue may be causal.</p> <p>Attributes:</p> <ul> <li> <code>MAGMA_DECODE_ME_SPECIFIC_TISSUE_GENE_SET_ANALYSIS_BRAIN_AVERAGE</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/decode_me_gwas_1_build_37_magma_ensembl_specific_tissue_gene_sets_brain_average/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.decode_me_gwas_1_build_37_magma_ensembl_specific_tissue_gene_sets_brain_average.MAGMA_DECODE_ME_SPECIFIC_TISSUE_GENE_SET_ANALYSIS_BRAIN_AVERAGE","title":"MAGMA_DECODE_ME_SPECIFIC_TISSUE_GENE_SET_ANALYSIS_BRAIN_AVERAGE  <code>module-attribute</code>","text":"<pre><code>MAGMA_DECODE_ME_SPECIFIC_TISSUE_GENE_SET_ANALYSIS_BRAIN_AVERAGE = create(\n    asset_id=\"decode_me_gwas_1_build_37_magma_ensemble_specific_tissue_gene_covar_analysis_brain_average\",\n    magma_gene_analysis_task=DECODE_ME_GWAS_1_MAGMA_ENSEMBL_GENE_ANALYSIS,\n    magma_binary_task=MAGMA_1_1_BINARY_EXTRACTED,\n    gene_set_task=GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_PREP_FOR_MAGMA_BRAIN_AVERAGE,\n    set_or_covar=\"covar\",\n    model_params=ModelParams(\n        direction_covar=\"greater\",\n        condition_hide=[\"Average\"],\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/decode_me_hba_magma_analysis/","title":"decode_me_hba_magma_analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/decode_me_hba_magma_analysis/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.decode_me_hba_magma_analysis","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.decode_me_hba_magma_analysis","text":"<p>Task generator to analyze decodeME GWAS 1 using the human brian atlas reference dataset</p> <p>Attributes:</p> <ul> <li> <code>DECODE_ME_HBA_MAGMA_TASKS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/decode_me_hba_magma_analysis/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.decode_me_hba_magma_analysis.DECODE_ME_HBA_MAGMA_TASKS","title":"DECODE_ME_HBA_MAGMA_TASKS  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_HBA_MAGMA_TASKS = (\n    generate_human_brain_atlas_magma_tasks(\n        base_name=\"decode_me_hba_magma_tasks\",\n        gwas_parquet_with_rsids_task=join_task,\n        sample_size=275488,\n        plot_settings=PlotSettings(\"plotly_white\"),\n        include_independent_cluster_plot=True,\n        pipes=[\n            RenameColPipe(\n                old_name=\"rsid\", new_name=GWASLAB_RSID_COL\n            )\n        ],\n        hba_indep_plot_options=HBAIndepPlotOptions(\n            annotation_text_size=13\n        ),\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/magma_specific_tissue_bar_plot/","title":"magma_specific_tissue_bar_plot","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/magma_specific_tissue_bar_plot/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.magma_specific_tissue_bar_plot","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.magma_specific_tissue_bar_plot","text":"<p>Attributes:</p> <ul> <li> <code>MAGMA_DECODE_ME_SPECIFIC_TISSUE_ANALYSIS_BAR_PLOT</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/magma_specific_tissue_bar_plot/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.magma_specific_tissue_bar_plot.MAGMA_DECODE_ME_SPECIFIC_TISSUE_ANALYSIS_BAR_PLOT","title":"MAGMA_DECODE_ME_SPECIFIC_TISSUE_ANALYSIS_BAR_PLOT  <code>module-attribute</code>","text":"<pre><code>MAGMA_DECODE_ME_SPECIFIC_TISSUE_ANALYSIS_BAR_PLOT = create(\n    gene_set_analysis_task=MAGMA_DECODE_ME_SPECIFIC_TISSUE_GENE_SET_ANALYSIS,\n    asset_id=\"decode_me_gwas_1_build_37_magma_ensemble_specific_tissue_gene_covar_analysis_bar_plot\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/magma_specific_tissue_bar_plot_brain_average/","title":"magma_specific_tissue_bar_plot_brain_average","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/magma_specific_tissue_bar_plot_brain_average/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.magma_specific_tissue_bar_plot_brain_average","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.magma_specific_tissue_bar_plot_brain_average","text":"<p>Analogous to MAGMA_DECODE_ME_SPECIFIC_TISSUE_ANALYSIS_BAR_PLOT, but controls for average across brain tissue, not all tissues.</p> <p>Attributes:</p> <ul> <li> <code>MAGMA_DECODE_ME_SPECIFIC_TISSUE_ANALYSIS_BAR_PLOT_BRAIN_AVERAGE</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/analysis/magma/magma_specific_tissue_bar_plot_brain_average/#mecfs_bio.assets.gwas.me_cfs.decode_me.analysis.magma.magma_specific_tissue_bar_plot_brain_average.MAGMA_DECODE_ME_SPECIFIC_TISSUE_ANALYSIS_BAR_PLOT_BRAIN_AVERAGE","title":"MAGMA_DECODE_ME_SPECIFIC_TISSUE_ANALYSIS_BAR_PLOT_BRAIN_AVERAGE  <code>module-attribute</code>","text":"<pre><code>MAGMA_DECODE_ME_SPECIFIC_TISSUE_ANALYSIS_BAR_PLOT_BRAIN_AVERAGE = create(\n    gene_set_analysis_task=MAGMA_DECODE_ME_SPECIFIC_TISSUE_GENE_SET_ANALYSIS_BRAIN_AVERAGE,\n    asset_id=\"decode_me_gwas_1_build_37_magma_ensemble_specific_tissue_gene_covar_analysis_bar_plot_brain_average\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/","title":"processed_gwas_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data","text":"<p>Tasks for organizing and preprocessing DecodeME data.</p> <p>Modules:</p> <ul> <li> <code>decode_me_annovar_37_rsids_assignment</code>           \u2013            <p>Generate a chain of tasks to assign rsids to the decodeME genetic variants using dbSNP 150 reference data as pre-processed by annovar.</p> </li> <li> <code>decode_me_gwas_1_37_parquet_file</code>           \u2013            <p>Task to dump summary stats to a parquet file</p> </li> <li> <code>decode_me_gwas_1_annovar_37_sumstats</code>           \u2013            <p>Task to create a new GWASLab Sumstats object from the GRCh37 version of DECODE ME GWAS-1 with rsids assigned.</p> </li> <li> <code>decode_me_gwas_1_build_37_with_rsid</code>           \u2013            <p>Task to Assign rsids to SNPs using the ucsc hg19 sbSNP build 151 reference file.</p> </li> <li> <code>decode_me_gwas_1_sumstats_liftover_to_37</code>           \u2013            <p>Task to convert the DECODE ME GWAS-1 summary statistics into a GWASLab Sumstats object, while lifting over to genome build GRCh37.</p> </li> <li> <code>decode_me_gwas_1_sumstats_minimal_processing</code>           \u2013            <p>Task to convert the DECODE ME GWAS-1 summary statistics into a GWASLab Sumstats object, while performing minimal processing.</p> </li> <li> <code>decode_me_with_annovar_37_rsids_sumstats</code>           \u2013            </li> <li> <code>filtered_snps_gwas_1</code>           \u2013            <p>Task to filter genetic variants from DecodeME GWAS 1 to keep only those passing quality control.</p> </li> <li> <code>magma</code>           \u2013            <p>Tasks preparing DecodeME data for use by MAGMA.</p> </li> <li> <code>prep_for_fine_mapping</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/decode_me_annovar_37_rsids_assignment/","title":"decode_me_annovar_37_rsids_assignment","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/decode_me_annovar_37_rsids_assignment/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.decode_me_annovar_37_rsids_assignment","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.decode_me_annovar_37_rsids_assignment","text":"<p>Generate a chain of tasks to assign rsids to the decodeME genetic variants using dbSNP 150 reference data as pre-processed by annovar. Note that that unlike the approach based on ucsc hg19 sbSNP, this approach does allow assignment of rsids to non-SNP genetic variants.</p> <p>There are two versions of the rsid-assigned data.  One discards strand-ambiguous palindromic variants, and one keeps them. The version that keeps ambiguous variants is suitable for downstream tasks like MAGMA, which ignore variant direction of effect. On the other hand, it should not be used for downstream tasks like Mendelian Randomization, which crucially depend on direction of effect.</p> <p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_37_ANNOVAR_DBSNP150_RSID_ASSIGNED</code>           \u2013            </li> <li> <code>DECODE_ME_GWAS_1_37_ANNOVAR_DBSNP150_RSID_ASSIGNED_KEEP_AMBIGUOUS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/decode_me_annovar_37_rsids_assignment/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.decode_me_annovar_37_rsids_assignment.DECODE_ME_GWAS_1_37_ANNOVAR_DBSNP150_RSID_ASSIGNED","title":"DECODE_ME_GWAS_1_37_ANNOVAR_DBSNP150_RSID_ASSIGNED  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_37_ANNOVAR_DBSNP150_RSID_ASSIGNED = annovar_37_basic_rsid_assignment(\n    sumstats_task=DECODE_ME_GWAS_1_SUMSTATS_LIFTOVER_TO_37,\n    base_name=\"decode_me_gwas_1\",\n    drop_palindromic_ambiguous=True,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/decode_me_annovar_37_rsids_assignment/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.decode_me_annovar_37_rsids_assignment.DECODE_ME_GWAS_1_37_ANNOVAR_DBSNP150_RSID_ASSIGNED_KEEP_AMBIGUOUS","title":"DECODE_ME_GWAS_1_37_ANNOVAR_DBSNP150_RSID_ASSIGNED_KEEP_AMBIGUOUS  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_37_ANNOVAR_DBSNP150_RSID_ASSIGNED_KEEP_AMBIGUOUS = annovar_37_basic_rsid_assignment(\n    sumstats_task=DECODE_ME_GWAS_1_SUMSTATS_LIFTOVER_TO_37,\n    base_name=\"decode_me_gwas_1_keep_ambiguous\",\n    drop_palindromic_ambiguous=False,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/decode_me_gwas_1_37_parquet_file/","title":"decode_me_gwas_1_37_parquet_file","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/decode_me_gwas_1_37_parquet_file/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.decode_me_gwas_1_37_parquet_file","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.decode_me_gwas_1_37_parquet_file","text":"<p>Task to dump summary stats to a parquet file</p> <p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_LIFTOVER_TO_37_PARQUET</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/decode_me_gwas_1_37_parquet_file/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.decode_me_gwas_1_37_parquet_file.DECODE_ME_GWAS_1_LIFTOVER_TO_37_PARQUET","title":"DECODE_ME_GWAS_1_LIFTOVER_TO_37_PARQUET  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_LIFTOVER_TO_37_PARQUET = create_from_source_task(\n    source_tsk=DECODE_ME_GWAS_1_SUMSTATS_LIFTOVER_TO_37,\n    asset_id=\"decode_me_gwas_1_liftover_to_37_parquet_file\",\n    sub_dir=\"processed\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/decode_me_gwas_1_annovar_37_sumstats/","title":"decode_me_gwas_1_annovar_37_sumstats","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/decode_me_gwas_1_annovar_37_sumstats/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.decode_me_gwas_1_annovar_37_sumstats","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.decode_me_gwas_1_annovar_37_sumstats","text":"<p>Task to create a new GWASLab Sumstats object from the GRCh37 version of DECODE ME GWAS-1 with rsids assigned.</p> <p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_37_ANNOVAR_RSIDS_SUMSTATS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/decode_me_gwas_1_annovar_37_sumstats/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.decode_me_gwas_1_annovar_37_sumstats.DECODE_ME_GWAS_1_37_ANNOVAR_RSIDS_SUMSTATS","title":"DECODE_ME_GWAS_1_37_ANNOVAR_RSIDS_SUMSTATS  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_37_ANNOVAR_RSIDS_SUMSTATS = GWASLabCreateSumstatsTask(\n    df_source_task=join_task,\n    asset_id=AssetId(\n        \"decode_me_gwas_1_37_sumstats_rsids_from_annovar\"\n    ),\n    basic_check=True,\n    genome_build=\"infer\",\n    liftover_to=\"19\",\n    fmt=GWASLabColumnSpecifiers(\n        nea=GWASLAB_NON_EFFECT_ALLELE_COL,\n        ea=GWASLAB_EFFECT_ALLELE_COL,\n        chrom=GWASLAB_CHROM_COL,\n        pos=GWASLAB_POS_COL,\n        eaf=GWASLAB_EFFECT_ALLELE_FREQ_COL,\n        beta=GWASLAB_BETA_COL,\n        se=GWASLAB_SE_COL,\n        p=None,\n        chi_sq=GWASLAB_CHISQ_COL,\n        mlog10p=GWASLAB_MLOG10P_COL,\n        rsid=\"rsid\",\n        OR=None,\n        info=None,\n        snpid=GWASLAB_SNPID_COL,\n        n=GWASLAB_SAMPLE_SIZE_COLUMN,\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/decode_me_gwas_1_build_37_with_rsid/","title":"decode_me_gwas_1_build_37_with_rsid","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/decode_me_gwas_1_build_37_with_rsid/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.decode_me_gwas_1_build_37_with_rsid","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.decode_me_gwas_1_build_37_with_rsid","text":"<p>Task to Assign rsids to SNPs using the ucsc hg19 sbSNP build 151 reference file.</p> <p>Note that this approach only allows assignment of rsids to SNPs.  Non-SNP variants are dropped.</p> <p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_LIFTOVER_TO_37_WITH_RSID</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/decode_me_gwas_1_build_37_with_rsid/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.decode_me_gwas_1_build_37_with_rsid.DECODE_ME_GWAS_1_LIFTOVER_TO_37_WITH_RSID","title":"DECODE_ME_GWAS_1_LIFTOVER_TO_37_WITH_RSID  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_LIFTOVER_TO_37_WITH_RSID = create(\n    snp151_database_file_task=GENOME_ANNOTATION_DATABASE_BUILD_37_PARQUET,\n    raw_snp_data_task=DECODE_ME_GWAS_1_LIFTOVER_TO_37_PARQUET,\n    asset_id=\"decode_me_gwas_1_liftover_to_build_37_with_rsid\",\n    valid_chroms=HG19_SNP151_VALID_CHROMS,\n    chrom_replace_rules=CHROM_RENAME_RULES,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/decode_me_gwas_1_sumstats_liftover_to_37/","title":"decode_me_gwas_1_sumstats_liftover_to_37","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/decode_me_gwas_1_sumstats_liftover_to_37/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.decode_me_gwas_1_sumstats_liftover_to_37","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.decode_me_gwas_1_sumstats_liftover_to_37","text":"<p>Task to convert the DECODE ME GWAS-1 summary statistics into a GWASLab Sumstats object, while lifting over to genome build GRCh37. See https://github.com/Cloufield/gwaslab/blob/1f055b632f62ff69e7a9c8a73155771b0dca52d0/src/gwaslab/g_Sumstats.py#L177</p> <p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_SUMSTATS_LIFTOVER_TO_37</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/decode_me_gwas_1_sumstats_liftover_to_37/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.decode_me_gwas_1_sumstats_liftover_to_37.DECODE_ME_GWAS_1_SUMSTATS_LIFTOVER_TO_37","title":"DECODE_ME_GWAS_1_SUMSTATS_LIFTOVER_TO_37  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_SUMSTATS_LIFTOVER_TO_37 = (\n    GWASLabCreateSumstatsTask(\n        df_source_task=DECODE_ME_FILTER_SNPS_GWAS_1_TASK,\n        asset_id=AssetId(\n            \"decode_me_gwas_1_sumstats_liftover_to_37\"\n        ),\n        basic_check=True,\n        genome_build=\"infer\",\n        liftover_to=\"19\",\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/decode_me_gwas_1_sumstats_minimal_processing/","title":"decode_me_gwas_1_sumstats_minimal_processing","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/decode_me_gwas_1_sumstats_minimal_processing/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.decode_me_gwas_1_sumstats_minimal_processing","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.decode_me_gwas_1_sumstats_minimal_processing","text":"<p>Task to convert the DECODE ME GWAS-1 summary statistics into a GWASLab Sumstats object, while performing minimal processing. See https://github.com/Cloufield/gwaslab/blob/1f055b632f62ff69e7a9c8a73155771b0dca52d0/src/gwaslab/g_Sumstats.py#L177</p> <p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_SUMSTATS_MINIMAL_FILTERING</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/decode_me_gwas_1_sumstats_minimal_processing/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.decode_me_gwas_1_sumstats_minimal_processing.DECODE_ME_GWAS_1_SUMSTATS_MINIMAL_FILTERING","title":"DECODE_ME_GWAS_1_SUMSTATS_MINIMAL_FILTERING  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_SUMSTATS_MINIMAL_FILTERING = (\n    GWASLabCreateSumstatsTask(\n        df_source_task=DECODE_ME_FILTER_SNPS_GWAS_1_TASK,\n        asset_id=AssetId(\n            \"decode_me_gwas_1_sumstats_minimal_processing\"\n        ),\n        basic_check=True,\n        genome_build=\"infer\",\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/decode_me_with_annovar_37_rsids_sumstats/","title":"decode_me_with_annovar_37_rsids_sumstats","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/decode_me_with_annovar_37_rsids_sumstats/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.decode_me_with_annovar_37_rsids_sumstats","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.decode_me_with_annovar_37_rsids_sumstats","text":"<p>Attributes:</p> <ul> <li> <code>DECODEME_ME_SUMSTATS_37_WITH_ANNOVAR_RSID</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/decode_me_with_annovar_37_rsids_sumstats/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.decode_me_with_annovar_37_rsids_sumstats.DECODEME_ME_SUMSTATS_37_WITH_ANNOVAR_RSID","title":"DECODEME_ME_SUMSTATS_37_WITH_ANNOVAR_RSID  <code>module-attribute</code>","text":"<pre><code>DECODEME_ME_SUMSTATS_37_WITH_ANNOVAR_RSID = (\n    GWASLabCreateSumstatsTask(\n        df_source_task=join_task,\n        asset_id=AssetId(\n            \"decode_me_sumstats_37_with_annovar_rsids\"\n        ),\n        basic_check=True,\n        genome_build=\"19\",\n        pre_pipe=RenameColPipe(\n            old_name=\"rsid\", new_name=GWASLAB_RSID_COL\n        ),\n        fmt=\"gwaslab\",\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/filtered_snps_gwas_1/","title":"filtered_snps_gwas_1","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/filtered_snps_gwas_1/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.filtered_snps_gwas_1","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.filtered_snps_gwas_1","text":"<p>Task to filter genetic variants from DecodeME GWAS 1 to keep only those passing quality control.</p> <p>This is consistent with the README here: https://osf.io/rgqs3/files/axp4k.</p> <p>Attributes:</p> <ul> <li> <code>DECODE_ME_FILTER_SNPS_GWAS_1_TASK</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/filtered_snps_gwas_1/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.filtered_snps_gwas_1.DECODE_ME_FILTER_SNPS_GWAS_1_TASK","title":"DECODE_ME_FILTER_SNPS_GWAS_1_TASK  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_FILTER_SNPS_GWAS_1_TASK = FilterSNPsTask(\n    raw_gwas_task=DECODE_ME_GWAS_1_TASK,\n    snp_list_task=DECODE_ME_QC_SNPS,\n    meta=FilteredGWASDataMeta(\n        id=AssetId(\n            \"decode_me_gwas_1_filtered_for_quality_control\"\n        ),\n        trait=\"ME_CFS\",\n        project=\"DecodeME\",\n        sub_dir=\"processed\",\n        read_spec=DataFrameReadSpec(\n            format=DataFrameParquetFormat()\n        ),\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/magma/","title":"magma","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/magma/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.magma","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.magma","text":"<p>Tasks preparing DecodeME data for use by MAGMA.</p> <p>Modules:</p> <ul> <li> <code>decode_me_gwas_1_build_37_magma_ensembl_annotations</code>           \u2013            </li> <li> <code>decode_me_gwas_1_build_37_magma_ensembl_gene_analysis</code>           \u2013            </li> <li> <code>decode_me_gwas_1_build_37_magma_entrez_annotations</code>           \u2013            </li> <li> <code>decode_me_gwas_1_build_37_magma_entrez_gene_analysis</code>           \u2013            </li> <li> <code>decode_me_gwas_1_build_37_magma_snp_locs</code>           \u2013            </li> <li> <code>decode_me_gwas_1_build_37_magma_snp_p_values</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/magma/decode_me_gwas_1_build_37_magma_ensembl_annotations/","title":"decode_me_gwas_1_build_37_magma_ensembl_annotations","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/magma/decode_me_gwas_1_build_37_magma_ensembl_annotations/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.magma.decode_me_gwas_1_build_37_magma_ensembl_annotations","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.magma.decode_me_gwas_1_build_37_magma_ensembl_annotations","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_MAGMA_ENSEMBL_ANNOTATIONS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/magma/decode_me_gwas_1_build_37_magma_ensembl_annotations/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.magma.decode_me_gwas_1_build_37_magma_ensembl_annotations.DECODE_ME_GWAS_1_MAGMA_ENSEMBL_ANNOTATIONS","title":"DECODE_ME_GWAS_1_MAGMA_ENSEMBL_ANNOTATIONS  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_MAGMA_ENSEMBL_ANNOTATIONS = create(\n    asset_id=\"decode_me_gwas_1_build_37_magma_ensembl_annotations\",\n    magma_binary_task=MAGMA_1_1_BINARY_EXTRACTED,\n    snp_loc_file_task=DECODE_ME_GWAS_1_BUILD_37_MAGMA_SNP_LOCS,\n    gene_loc_file_task=MAGMA_ENSEMBL_GENE_LOCATION_REFERENCE_DATA_BUILD_37_RAW,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/magma/decode_me_gwas_1_build_37_magma_ensembl_gene_analysis/","title":"decode_me_gwas_1_build_37_magma_ensembl_gene_analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/magma/decode_me_gwas_1_build_37_magma_ensembl_gene_analysis/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.magma.decode_me_gwas_1_build_37_magma_ensembl_gene_analysis","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.magma.decode_me_gwas_1_build_37_magma_ensembl_gene_analysis","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_MAGMA_ENSEMBL_GENE_ANALYSIS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/magma/decode_me_gwas_1_build_37_magma_ensembl_gene_analysis/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.magma.decode_me_gwas_1_build_37_magma_ensembl_gene_analysis.DECODE_ME_GWAS_1_MAGMA_ENSEMBL_GENE_ANALYSIS","title":"DECODE_ME_GWAS_1_MAGMA_ENSEMBL_GENE_ANALYSIS  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_MAGMA_ENSEMBL_GENE_ANALYSIS = create(\n    asset_id=\"decode_me_gwas_1_build_37_magma_ensemble_gene_analysis\",\n    magma_annotation_task=DECODE_ME_GWAS_1_MAGMA_ENSEMBL_ANNOTATIONS,\n    magma_p_value_task=DECODE_ME_GWAS_1_BUILD_37_MAGMA_SNP_P_VALUES,\n    magma_binary_task=MAGMA_1_1_BINARY_EXTRACTED,\n    magma_ld_ref_task=MAGMA_EUR_BUILD_37_1K_GENOMES_EXTRACTED,\n    ld_ref_file_stem=\"g1000_eur\",\n    sample_size=275488,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/magma/decode_me_gwas_1_build_37_magma_entrez_annotations/","title":"decode_me_gwas_1_build_37_magma_entrez_annotations","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/magma/decode_me_gwas_1_build_37_magma_entrez_annotations/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.magma.decode_me_gwas_1_build_37_magma_entrez_annotations","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.magma.decode_me_gwas_1_build_37_magma_entrez_annotations","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_MAGMA_ENTREZ_ANNOTATIONS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/magma/decode_me_gwas_1_build_37_magma_entrez_annotations/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.magma.decode_me_gwas_1_build_37_magma_entrez_annotations.DECODE_ME_GWAS_1_MAGMA_ENTREZ_ANNOTATIONS","title":"DECODE_ME_GWAS_1_MAGMA_ENTREZ_ANNOTATIONS  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_MAGMA_ENTREZ_ANNOTATIONS = create(\n    asset_id=\"decode_me_gwas_1_build_37_magma_annotations\",\n    magma_binary_task=MAGMA_1_1_BINARY_EXTRACTED,\n    snp_loc_file_task=DECODE_ME_GWAS_1_BUILD_37_MAGMA_SNP_LOCS,\n    gene_loc_file_task=MAGMA_ENTREZ_GENE_LOCATION_REFERENCE_DATA_BUILD_37_EXTRACTED,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/magma/decode_me_gwas_1_build_37_magma_entrez_gene_analysis/","title":"decode_me_gwas_1_build_37_magma_entrez_gene_analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/magma/decode_me_gwas_1_build_37_magma_entrez_gene_analysis/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.magma.decode_me_gwas_1_build_37_magma_entrez_gene_analysis","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.magma.decode_me_gwas_1_build_37_magma_entrez_gene_analysis","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_MAGMA_ENTREZ_GENE_ANALYSIS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/magma/decode_me_gwas_1_build_37_magma_entrez_gene_analysis/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.magma.decode_me_gwas_1_build_37_magma_entrez_gene_analysis.DECODE_ME_GWAS_1_MAGMA_ENTREZ_GENE_ANALYSIS","title":"DECODE_ME_GWAS_1_MAGMA_ENTREZ_GENE_ANALYSIS  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_MAGMA_ENTREZ_GENE_ANALYSIS = create(\n    asset_id=\"decode_me_gwas_1_build_37_magma_gene_analysis\",\n    magma_annotation_task=DECODE_ME_GWAS_1_MAGMA_ENTREZ_ANNOTATIONS,\n    magma_p_value_task=DECODE_ME_GWAS_1_BUILD_37_MAGMA_SNP_P_VALUES,\n    magma_binary_task=MAGMA_1_1_BINARY_EXTRACTED,\n    magma_ld_ref_task=MAGMA_EUR_BUILD_37_1K_GENOMES_EXTRACTED,\n    ld_ref_file_stem=\"g1000_eur\",\n    sample_size=275488,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/magma/decode_me_gwas_1_build_37_magma_snp_locs/","title":"decode_me_gwas_1_build_37_magma_snp_locs","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/magma/decode_me_gwas_1_build_37_magma_snp_locs/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.magma.decode_me_gwas_1_build_37_magma_snp_locs","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.magma.decode_me_gwas_1_build_37_magma_snp_locs","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_BUILD_37_MAGMA_SNP_LOCS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/magma/decode_me_gwas_1_build_37_magma_snp_locs/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.magma.decode_me_gwas_1_build_37_magma_snp_locs.DECODE_ME_GWAS_1_BUILD_37_MAGMA_SNP_LOCS","title":"DECODE_ME_GWAS_1_BUILD_37_MAGMA_SNP_LOCS  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_BUILD_37_MAGMA_SNP_LOCS = create_for_magma_snp_pos_file(\n    gwas_parquet_with_rsids_task=DECODE_ME_GWAS_1_LIFTOVER_TO_37_WITH_RSID,\n    asset_id=\"decode_me_gwas_1_build_37_magma_snp_locs\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/magma/decode_me_gwas_1_build_37_magma_snp_p_values/","title":"decode_me_gwas_1_build_37_magma_snp_p_values","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/magma/decode_me_gwas_1_build_37_magma_snp_p_values/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.magma.decode_me_gwas_1_build_37_magma_snp_p_values","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.magma.decode_me_gwas_1_build_37_magma_snp_p_values","text":"<p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_BUILD_37_MAGMA_SNP_P_VALUES</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/magma/decode_me_gwas_1_build_37_magma_snp_p_values/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.magma.decode_me_gwas_1_build_37_magma_snp_p_values.DECODE_ME_GWAS_1_BUILD_37_MAGMA_SNP_P_VALUES","title":"DECODE_ME_GWAS_1_BUILD_37_MAGMA_SNP_P_VALUES  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_BUILD_37_MAGMA_SNP_P_VALUES = create_for_magma_snp_p_value_file(\n    gwas_parquet_with_rsids_task=DECODE_ME_GWAS_1_LIFTOVER_TO_37_WITH_RSID,\n    asset_id=\"decode_me_gwas_1_build_37_magma_snp_p_values\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/prep_for_fine_mapping/","title":"prep_for_fine_mapping","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/prep_for_fine_mapping/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.prep_for_fine_mapping","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.prep_for_fine_mapping","text":"<p>Modules:</p> <ul> <li> <code>chr1_173_locus</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/prep_for_fine_mapping/chr1_173_locus/","title":"chr1_173_locus","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/prep_for_fine_mapping/chr1_173_locus/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.prep_for_fine_mapping.chr1_173_locus","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.prep_for_fine_mapping.chr1_173_locus","text":"<p>Modules:</p> <ul> <li> <code>harmonize_with_polyfun_reference_alleles</code>           \u2013            <p>Harmonize DecodeME GWAS data at the chr1 locus with the reference LD matrix using matching on chrom/pos/ea/nea</p> </li> <li> <code>harmonize_with_polyfun_reference_rsid</code>           \u2013            <p>Harmonize DecodeME GWAS data at the chr1 locus with the reference LD matrix by matching on rsid</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/prep_for_fine_mapping/chr1_173_locus/harmonize_with_polyfun_reference_alleles/","title":"harmonize_with_polyfun_reference_alleles","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/prep_for_fine_mapping/chr1_173_locus/harmonize_with_polyfun_reference_alleles/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.prep_for_fine_mapping.chr1_173_locus.harmonize_with_polyfun_reference_alleles","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.prep_for_fine_mapping.chr1_173_locus.harmonize_with_polyfun_reference_alleles","text":"<p>Harmonize DecodeME GWAS data at the chr1 locus with the reference LD matrix using matching on chrom/pos/ea/nea</p> <p>Attributes:</p> <ul> <li> <code>DECODE_ME_HARMONIZE_WITH_CHR1_173_000_001_LD_VIA_ALLELES</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/prep_for_fine_mapping/chr1_173_locus/harmonize_with_polyfun_reference_alleles/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.prep_for_fine_mapping.chr1_173_locus.harmonize_with_polyfun_reference_alleles.DECODE_ME_HARMONIZE_WITH_CHR1_173_000_001_LD_VIA_ALLELES","title":"DECODE_ME_HARMONIZE_WITH_CHR1_173_000_001_LD_VIA_ALLELES  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_HARMONIZE_WITH_CHR1_173_000_001_LD_VIA_ALLELES = create(\n    asset_id=\"decode_me_1_harmonize_with_ld_chr1_173000001_via_alleles\",\n    gwas_data_task=join_task,\n    reference_task=CHR1_173000001_17600000_UKBB_LD_LABELS_DOWNLOAD,\n    palindrome_strategy=\"drop\",\n    gwas_pipe=CompositePipe(\n        [\n            RenameColPipe(\n                old_name=\"rsid\", new_name=GWASLAB_RSID_COL\n            ),\n            UniquePipe(\n                by=[\n                    GWASLAB_CHROM_COL,\n                    GWASLAB_POS_COL,\n                    GWASLAB_EFFECT_ALLELE_COL,\n                    GWASLAB_NON_EFFECT_ALLELE_COL,\n                ],\n                keep=\"none\",\n                order_by=[\n                    GWASLAB_CHROM_COL,\n                    GWASLAB_POS_COL,\n                    GWASLAB_EFFECT_ALLELE_COL,\n                    GWASLAB_NON_EFFECT_ALLELE_COL,\n                    GWASLAB_RSID_COL,\n                ],\n            ),\n        ]\n    ),\n    ref_pipe=CompositePipe(\n        [\n            RenameColPipe(\n                old_name=\"rsid\", new_name=GWASLAB_RSID_COL\n            ),\n            RenameColPipe(\n                old_name=\"chromosome\",\n                new_name=GWASLAB_CHROM_COL,\n            ),\n            RenameColPipe(\n                old_name=\"position\",\n                new_name=GWASLAB_POS_COL,\n            ),\n            RenameColPipe(\n                old_name=\"allele1\",\n                new_name=GWASLAB_NON_EFFECT_ALLELE_COL,\n            ),\n            RenameColPipe(\n                old_name=\"allele2\",\n                new_name=GWASLAB_EFFECT_ALLELE_COL,\n            ),\n        ]\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/prep_for_fine_mapping/chr1_173_locus/harmonize_with_polyfun_reference_rsid/","title":"harmonize_with_polyfun_reference_rsid","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/prep_for_fine_mapping/chr1_173_locus/harmonize_with_polyfun_reference_rsid/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.prep_for_fine_mapping.chr1_173_locus.harmonize_with_polyfun_reference_rsid","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.prep_for_fine_mapping.chr1_173_locus.harmonize_with_polyfun_reference_rsid","text":"<p>Harmonize DecodeME GWAS data at the chr1 locus with the reference LD matrix by matching on rsid</p> <p>Attributes:</p> <ul> <li> <code>DECODE_ME_HARMONIZE_WITH_CHR1_173_000_001_LD</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/processed_gwas_data/prep_for_fine_mapping/chr1_173_locus/harmonize_with_polyfun_reference_rsid/#mecfs_bio.assets.gwas.me_cfs.decode_me.processed_gwas_data.prep_for_fine_mapping.chr1_173_locus.harmonize_with_polyfun_reference_rsid.DECODE_ME_HARMONIZE_WITH_CHR1_173_000_001_LD","title":"DECODE_ME_HARMONIZE_WITH_CHR1_173_000_001_LD  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_HARMONIZE_WITH_CHR1_173_000_001_LD = create(\n    asset_id=\"decode_me_1_harmonize_with_ld_chr1_173000001\",\n    gwas_data_task=join_task,\n    reference_task=CHR1_173000001_17600000_UKBB_LD_LABELS_DOWNLOAD,\n    palindrome_strategy=\"drop\",\n    chrom_pos_strategy=\"drop\",\n    mismatched_alleles_strategy=\"drop\",\n    gwas_pipe=CompositePipe(\n        [\n            RenameColPipe(\n                old_name=\"rsid\", new_name=GWASLAB_RSID_COL\n            ),\n            UniquePipe(\n                by=[GWASLAB_RSID_COL],\n                keep=\"first\",\n                order_by=[GWASLAB_RSID_COL],\n            ),\n        ]\n    ),\n    ref_pipe=CompositePipe(\n        [\n            RenameColPipe(\n                old_name=\"rsid\", new_name=GWASLAB_RSID_COL\n            ),\n            RenameColPipe(\n                old_name=\"chromosome\",\n                new_name=GWASLAB_CHROM_COL,\n            ),\n            RenameColPipe(\n                old_name=\"position\",\n                new_name=GWASLAB_POS_COL,\n            ),\n            RenameColPipe(\n                old_name=\"allele1\",\n                new_name=GWASLAB_NON_EFFECT_ALLELE_COL,\n            ),\n            RenameColPipe(\n                old_name=\"allele2\",\n                new_name=GWASLAB_EFFECT_ALLELE_COL,\n            ),\n            UniquePipe(\n                by=[GWASLAB_RSID_COL],\n                keep=\"first\",\n                order_by=[GWASLAB_RSID_COL],\n            ),\n        ]\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/raw_gwas_data/","title":"raw_gwas_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/raw_gwas_data/#mecfs_bio.assets.gwas.me_cfs.decode_me.raw_gwas_data","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.raw_gwas_data","text":"<p>Tasks retrieving raw GWAS data from the DecodeME OSF repository.</p> <p>Modules:</p> <ul> <li> <code>decode_me_gwas_1</code>           \u2013            <p>Task to download summary statistics for GWAS-1 from Decode ME via OSF.</p> </li> <li> <code>decode_me_quality_control_snps</code>           \u2013            <p>Task to get the list of genetic variants passing quality control in DECODE ME.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/raw_gwas_data/decode_me_gwas_1/","title":"decode_me_gwas_1","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/raw_gwas_data/decode_me_gwas_1/#mecfs_bio.assets.gwas.me_cfs.decode_me.raw_gwas_data.decode_me_gwas_1","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.raw_gwas_data.decode_me_gwas_1","text":"<p>Task to download summary statistics for GWAS-1 from Decode ME via OSF.</p> <p>GWAS-1 is the primary GWAS in the DECODE ME paper, with the largest number of cases and controls: See: https://www.medrxiv.org/content/10.1101/2025.08.06.25333109v1.full-text#:~:text=DecodeME%20GWAS%3A%20Overall%20and%20stratified%20analyses</p> <p>Attributes:</p> <ul> <li> <code>DECODE_ME_GWAS_1_TASK</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/raw_gwas_data/decode_me_gwas_1/#mecfs_bio.assets.gwas.me_cfs.decode_me.raw_gwas_data.decode_me_gwas_1.DECODE_ME_GWAS_1_TASK","title":"DECODE_ME_GWAS_1_TASK  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_GWAS_1_TASK = OSFRetrievalTask(\n    meta=GWASSummaryDataFileMeta(\n        id=AssetId(\"decode_me_gwas_1_raw\"),\n        trait=\"ME_CFS\",\n        project=\"DecodeME\",\n        sub_dir=\"raw\",\n        project_path=PurePath(\"DecodeME Summary Statistics\")\n        / \"gwas_1.regenie.gz\",\n        read_spec=DataFrameReadSpec(\n            format=DataFrameTextFormat(separator=\" \")\n        ),\n    ),\n    osf_project_id=\"rgqs3\",\n    md5_hash=\"eabd3c06ffdeb2ec6382bfa67eed7f37\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/raw_gwas_data/decode_me_quality_control_snps/","title":"decode_me_quality_control_snps","text":""},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/raw_gwas_data/decode_me_quality_control_snps/#mecfs_bio.assets.gwas.me_cfs.decode_me.raw_gwas_data.decode_me_quality_control_snps","title":"mecfs_bio.assets.gwas.me_cfs.decode_me.raw_gwas_data.decode_me_quality_control_snps","text":"<p>Task to get the list of genetic variants passing quality control in DECODE ME.</p> <p>See the DECODE ME Summary Stats README for an explanation of quality control steps: https://osf.io/rgqs3/files/axp4k</p> <p>Attributes:</p> <ul> <li> <code>DECODE_ME_QC_SNPS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/me_cfs/decode_me/raw_gwas_data/decode_me_quality_control_snps/#mecfs_bio.assets.gwas.me_cfs.decode_me.raw_gwas_data.decode_me_quality_control_snps.DECODE_ME_QC_SNPS","title":"DECODE_ME_QC_SNPS  <code>module-attribute</code>","text":"<pre><code>DECODE_ME_QC_SNPS = OSFRetrievalTask(\n    meta=GWASSummaryDataFileMeta(\n        id=AssetId(\n            \"decode_me_snps_passing_quality_control\"\n        ),\n        trait=\"ME_CFS\",\n        project=\"DecodeME\",\n        sub_dir=\"raw\",\n        project_path=PurePath(\"DecodeME Summary Statistics\")\n        / \"gwas_qced.var.gz\",\n        read_spec=DataFrameReadSpec(\n            format=DataFrameTextFormat(separator=\" \")\n        ),\n    ),\n    osf_project_id=\"rgqs3\",\n    md5_hash=\"b62e4dc634627b461c666bc444e9b0bf\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/multisite_pain/","title":"multisite_pain","text":""},{"location":"reference/mecfs_bio/assets/gwas/multisite_pain/#mecfs_bio.assets.gwas.multisite_pain","title":"mecfs_bio.assets.gwas.multisite_pain","text":"<p>Modules:</p> <ul> <li> <code>johnston_et_al</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/multisite_pain/johnston_et_al/","title":"johnston_et_al","text":""},{"location":"reference/mecfs_bio/assets/gwas/multisite_pain/johnston_et_al/#mecfs_bio.assets.gwas.multisite_pain.johnston_et_al","title":"mecfs_bio.assets.gwas.multisite_pain.johnston_et_al","text":"<p>Modules:</p> <ul> <li> <code>analysis</code>           \u2013            </li> <li> <code>processed</code>           \u2013            </li> <li> <code>raw</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/multisite_pain/johnston_et_al/analysis/","title":"analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/multisite_pain/johnston_et_al/analysis/#mecfs_bio.assets.gwas.multisite_pain.johnston_et_al.analysis","title":"mecfs_bio.assets.gwas.multisite_pain.johnston_et_al.analysis","text":"<p>Modules:</p> <ul> <li> <code>johnston_standard_analysis</code>           \u2013            <p>Apply standard MAGMA and S-LDSC analysis to Johnston et al.'s GWAS of multisite pain</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/multisite_pain/johnston_et_al/analysis/johnston_standard_analysis/","title":"johnston_standard_analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/multisite_pain/johnston_et_al/analysis/johnston_standard_analysis/#mecfs_bio.assets.gwas.multisite_pain.johnston_et_al.analysis.johnston_standard_analysis","title":"mecfs_bio.assets.gwas.multisite_pain.johnston_et_al.analysis.johnston_standard_analysis","text":"<p>Apply standard MAGMA and S-LDSC analysis to Johnston et al.'s GWAS of multisite pain</p> <p>Attributes:</p> <ul> <li> <code>JOHNSTON_ET_AL_PAIN_STANDARD_ANALYSIS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/multisite_pain/johnston_et_al/analysis/johnston_standard_analysis/#mecfs_bio.assets.gwas.multisite_pain.johnston_et_al.analysis.johnston_standard_analysis.JOHNSTON_ET_AL_PAIN_STANDARD_ANALYSIS","title":"JOHNSTON_ET_AL_PAIN_STANDARD_ANALYSIS  <code>module-attribute</code>","text":"<pre><code>JOHNSTON_ET_AL_PAIN_STANDARD_ANALYSIS = concrete_standard_analysis_generator_assume_already_has_rsid(\n    base_name=\"johnston_et_al_pain\",\n    raw_gwas_data_task=JOHNSTON_ET_AL_PAIN_EXTRACTED,\n    sample_size=387649,\n    include_hba_magma_tasks=True,\n    fmt=GWASLabColumnSpecifiers(\n        rsid=\"SNP\",\n        chrom=\"CHR\",\n        pos=\"BP\",\n        ea=\"ALLELE1\",\n        nea=\"ALLELE0\",\n        beta=\"BETA\",\n        se=\"SE\",\n        p=\"P_BOLT_LMM_INF\",\n        eaf=\"A1FREQ\",\n    ),\n    hba_plot_settings=PlotSettings(\"plotly_white\"),\n    include_independent_cluster_plot_in_hba=True,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/multisite_pain/johnston_et_al/processed/","title":"processed","text":""},{"location":"reference/mecfs_bio/assets/gwas/multisite_pain/johnston_et_al/processed/#mecfs_bio.assets.gwas.multisite_pain.johnston_et_al.processed","title":"mecfs_bio.assets.gwas.multisite_pain.johnston_et_al.processed","text":"<p>Modules:</p> <ul> <li> <code>extracted_johnston_data</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/multisite_pain/johnston_et_al/processed/extracted_johnston_data/","title":"extracted_johnston_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/multisite_pain/johnston_et_al/processed/extracted_johnston_data/#mecfs_bio.assets.gwas.multisite_pain.johnston_et_al.processed.extracted_johnston_data","title":"mecfs_bio.assets.gwas.multisite_pain.johnston_et_al.processed.extracted_johnston_data","text":"<p>Attributes:</p> <ul> <li> <code>JOHNSTON_ET_AL_PAIN_EXTRACTED</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/multisite_pain/johnston_et_al/processed/extracted_johnston_data/#mecfs_bio.assets.gwas.multisite_pain.johnston_et_al.processed.extracted_johnston_data.JOHNSTON_ET_AL_PAIN_EXTRACTED","title":"JOHNSTON_ET_AL_PAIN_EXTRACTED  <code>module-attribute</code>","text":"<pre><code>JOHNSTON_ET_AL_PAIN_EXTRACTED = create_for_gwas_file(\n    source_file_task=JOHNSTON_ET_AL_PAIN_RAW,\n    asset_id=\"johnston_et_al_pain_extracted\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/multisite_pain/johnston_et_al/raw/","title":"raw","text":""},{"location":"reference/mecfs_bio/assets/gwas/multisite_pain/johnston_et_al/raw/#mecfs_bio.assets.gwas.multisite_pain.johnston_et_al.raw","title":"mecfs_bio.assets.gwas.multisite_pain.johnston_et_al.raw","text":"<p>Modules:</p> <ul> <li> <code>raw_johnston_data</code>           \u2013            <p>Task to download GWAS summary statistics from Johnston et al's multisite pain GWAS</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/multisite_pain/johnston_et_al/raw/raw_johnston_data/","title":"raw_johnston_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/multisite_pain/johnston_et_al/raw/raw_johnston_data/#mecfs_bio.assets.gwas.multisite_pain.johnston_et_al.raw.raw_johnston_data","title":"mecfs_bio.assets.gwas.multisite_pain.johnston_et_al.raw.raw_johnston_data","text":"<p>Task to download GWAS summary statistics from Johnston et al's multisite pain GWAS</p> <p>see: https://www.ebi.ac.uk/gwas/studies/GCST008512</p> <p>Citation: Johnston, Keira J A et al. \u201cGenome-wide association study of multisite chronic pain in UK Biobank.\u201d PLoS genetics vol. 15,6 e1008164. 13 Jun. 2019, doi:10.1371/journal.pgen.1008164</p> <p>Attributes:</p> <ul> <li> <code>JOHNSTON_ET_AL_PAIN_RAW</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/multisite_pain/johnston_et_al/raw/raw_johnston_data/#mecfs_bio.assets.gwas.multisite_pain.johnston_et_al.raw.raw_johnston_data.JOHNSTON_ET_AL_PAIN_RAW","title":"JOHNSTON_ET_AL_PAIN_RAW  <code>module-attribute</code>","text":"<pre><code>JOHNSTON_ET_AL_PAIN_RAW = DownloadFileTask(\n    meta=GWASSummaryDataFileMeta(\n        id=AssetId(\"johnston_et_al_pain_raw\"),\n        trait=\"multisite_pain\",\n        project=\"johnston_et_al\",\n        sub_dir=\"raw\",\n        project_path=PurePath(\"chronic_pain-bgen.stats.gz\"),\n        read_spec=DataFrameReadSpec(\n            format=DataFrameTextFormat(\n                separator=\"\\t\",\n                null_values=[\"NaN\", \"NA\"],\n                schema_overrides={\"GENPOS\": Float32()},\n            )\n        ),\n    ),\n    url=\"https://ftp.ebi.ac.uk/pub/databases/gwas/summary_statistics/GCST008001-GCST009000/GCST008512/chronic_pain-bgen.stats.gz\",\n    md5_hash=\"cc175d6a6e5ee80005f3bdb78b0b7694\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/psoriasis/","title":"psoriasis","text":""},{"location":"reference/mecfs_bio/assets/gwas/psoriasis/#mecfs_bio.assets.gwas.psoriasis","title":"mecfs_bio.assets.gwas.psoriasis","text":"<p>Modules:</p> <ul> <li> <code>million_veterans</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/psoriasis/million_veterans/","title":"million_veterans","text":""},{"location":"reference/mecfs_bio/assets/gwas/psoriasis/million_veterans/#mecfs_bio.assets.gwas.psoriasis.million_veterans","title":"mecfs_bio.assets.gwas.psoriasis.million_veterans","text":"<p>Modules:</p> <ul> <li> <code>processed_gwas_data</code>           \u2013            </li> <li> <code>raw_gwas_data</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/psoriasis/million_veterans/processed_gwas_data/","title":"processed_gwas_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/psoriasis/million_veterans/processed_gwas_data/#mecfs_bio.assets.gwas.psoriasis.million_veterans.processed_gwas_data","title":"mecfs_bio.assets.gwas.psoriasis.million_veterans.processed_gwas_data","text":"<p>Modules:</p> <ul> <li> <code>million_veterans_psoriasis_eur_magma_task_generator</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/psoriasis/million_veterans/processed_gwas_data/million_veterans_psoriasis_eur_magma_task_generator/","title":"million_veterans_psoriasis_eur_magma_task_generator","text":""},{"location":"reference/mecfs_bio/assets/gwas/psoriasis/million_veterans/processed_gwas_data/million_veterans_psoriasis_eur_magma_task_generator/#mecfs_bio.assets.gwas.psoriasis.million_veterans.processed_gwas_data.million_veterans_psoriasis_eur_magma_task_generator","title":"mecfs_bio.assets.gwas.psoriasis.million_veterans.processed_gwas_data.million_veterans_psoriasis_eur_magma_task_generator","text":"<p>Attributes:</p> <ul> <li> <code>MILLION_VETERANS_EUR_PSORIASIS_COMBINED_MAGMA_TASKS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/psoriasis/million_veterans/processed_gwas_data/million_veterans_psoriasis_eur_magma_task_generator/#mecfs_bio.assets.gwas.psoriasis.million_veterans.processed_gwas_data.million_veterans_psoriasis_eur_magma_task_generator.MILLION_VETERANS_EUR_PSORIASIS_COMBINED_MAGMA_TASKS","title":"MILLION_VETERANS_EUR_PSORIASIS_COMBINED_MAGMA_TASKS  <code>module-attribute</code>","text":"<pre><code>MILLION_VETERANS_EUR_PSORIASIS_COMBINED_MAGMA_TASKS = create(\n    raw_gwas_data_task=MILLION_VETERAN_PSORIASIS_EUR_DATA_RAW,\n    magma_binary_task=MAGMA_1_1_BINARY_EXTRACTED,\n    gene_loc_file_task=MAGMA_ENSEMBL_GENE_LOCATION_REFERENCE_DATA_BUILD_37_RAW,\n    magma_ld_ref_task=MAGMA_EUR_BUILD_37_1K_GENOMES_EXTRACTED,\n    tissue_expression_gene_set_task=GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_PREP_FOR_MAGMA,\n    base_name=\"million_veterans_eur_psoriasis\",\n    sample_size=443794,\n    fmt=GWASLabColumnSpecifiers(\n        rsid=None,\n        chrom=\"chromosome\",\n        pos=\"base_pair_location\",\n        ea=\"effect_allele\",\n        nea=\"other_allele\",\n        eaf=\"effect_allele_frequency\",\n        p=\"p_value\",\n        OR=\"odds_ratio\",\n        se=None,\n        n=\"n\",\n        ncase=\"num_cases\",\n        ncontrol=\"num_controls\",\n        info=\"r2\",\n        snpid=None,\n        or_95l=\"ci_lower\",\n        or_95u=\"ci_upper\",\n    ),\n    pipe=CompositePipe(pipes=[ComputeBetaPipe()]),\n    pre_pipe=FilterRowsByInfoScorePipe(\n        min_score=0.9, info_col=\"r2\"\n    ),\n    genome_build=\"infer\",\n    snp151_database_file_task=GENOME_ANNOTATION_DATABASE_BUILD_37_PARQUET,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/psoriasis/million_veterans/raw_gwas_data/","title":"raw_gwas_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/psoriasis/million_veterans/raw_gwas_data/#mecfs_bio.assets.gwas.psoriasis.million_veterans.raw_gwas_data","title":"mecfs_bio.assets.gwas.psoriasis.million_veterans.raw_gwas_data","text":"<p>Modules:</p> <ul> <li> <code>raw_psoriasis_data</code>           \u2013            <p>Raw Summary Statistics from the Million Veterans Program GWAS of Psoriasis.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/psoriasis/million_veterans/raw_gwas_data/raw_psoriasis_data/","title":"raw_psoriasis_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/psoriasis/million_veterans/raw_gwas_data/raw_psoriasis_data/#mecfs_bio.assets.gwas.psoriasis.million_veterans.raw_gwas_data.raw_psoriasis_data","title":"mecfs_bio.assets.gwas.psoriasis.million_veterans.raw_gwas_data.raw_psoriasis_data","text":"<p>Raw Summary Statistics from the Million Veterans Program GWAS of Psoriasis.</p> <p>See here for the ftp download page: https://ftp.ebi.ac.uk/pub/databases/gwas/summary_statistics/GCST90476001-GCST90477000/GCST90476186/</p> <p>See the GWAS catalog page here: https://www.ebi.ac.uk/gwas/studies/GCST90476186</p> <p>Note that this is a gwas of Psoriasis and related disorder (PheCode 696).</p> <p>Attributes:</p> <ul> <li> <code>MILLION_VETERAN_PSORIASIS_EUR_DATA_RAW</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/psoriasis/million_veterans/raw_gwas_data/raw_psoriasis_data/#mecfs_bio.assets.gwas.psoriasis.million_veterans.raw_gwas_data.raw_psoriasis_data.MILLION_VETERAN_PSORIASIS_EUR_DATA_RAW","title":"MILLION_VETERAN_PSORIASIS_EUR_DATA_RAW  <code>module-attribute</code>","text":"<pre><code>MILLION_VETERAN_PSORIASIS_EUR_DATA_RAW = DownloadFileTask(\n    meta=GWASSummaryDataFileMeta(\n        id=AssetId(\"million_veterans_psoriasis_eur_raw\"),\n        trait=\"psoriasis\",\n        project=\"million_veterans\",\n        sub_dir=\"raw\",\n        project_path=PurePath(\"GCST90476186.tsv.gz\"),\n        read_spec=DataFrameReadSpec(\n            format=DataFrameTextFormat(separator=\"\\t\")\n        ),\n    ),\n    url=\"https://ftp.ebi.ac.uk/pub/databases/gwas/summary_statistics/GCST90476001-GCST90477000/GCST90476186/GCST90476186.tsv.gz\",\n    md5_hash=\"72c556837df9e1d3df092a484d3a4449\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/red_blood_cell_volume/","title":"red_blood_cell_volume","text":""},{"location":"reference/mecfs_bio/assets/gwas/red_blood_cell_volume/#mecfs_bio.assets.gwas.red_blood_cell_volume","title":"mecfs_bio.assets.gwas.red_blood_cell_volume","text":"<p>Modules:</p> <ul> <li> <code>million_veterans</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/red_blood_cell_volume/million_veterans/","title":"million_veterans","text":""},{"location":"reference/mecfs_bio/assets/gwas/red_blood_cell_volume/million_veterans/#mecfs_bio.assets.gwas.red_blood_cell_volume.million_veterans","title":"mecfs_bio.assets.gwas.red_blood_cell_volume.million_veterans","text":"<p>Modules:</p> <ul> <li> <code>analysis</code>           \u2013            </li> <li> <code>raw_gwas_data</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/red_blood_cell_volume/million_veterans/analysis/","title":"analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/red_blood_cell_volume/million_veterans/analysis/#mecfs_bio.assets.gwas.red_blood_cell_volume.million_veterans.analysis","title":"mecfs_bio.assets.gwas.red_blood_cell_volume.million_veterans.analysis","text":"<p>Modules:</p> <ul> <li> <code>rbc_vol_sldsc</code>           \u2013            <p>Pipe to apply S-LSDC to the Million Veterans GWAS of red blood cell volume</p> </li> <li> <code>rbc_volume_magma_task_generator</code>           \u2013            <p>Generate the tasks required to apply MAGMA to the red blood cell volume GWAS</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/red_blood_cell_volume/million_veterans/analysis/rbc_vol_sldsc/","title":"rbc_vol_sldsc","text":""},{"location":"reference/mecfs_bio/assets/gwas/red_blood_cell_volume/million_veterans/analysis/rbc_vol_sldsc/#mecfs_bio.assets.gwas.red_blood_cell_volume.million_veterans.analysis.rbc_vol_sldsc","title":"mecfs_bio.assets.gwas.red_blood_cell_volume.million_veterans.analysis.rbc_vol_sldsc","text":"<p>Pipe to apply S-LSDC to the Million Veterans GWAS of red blood cell volume</p> <p>Attributes:</p> <ul> <li> <code>MILLION_VETERANS_EUR_RBC_VOL_S_LDSC_TASKS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/red_blood_cell_volume/million_veterans/analysis/rbc_vol_sldsc/#mecfs_bio.assets.gwas.red_blood_cell_volume.million_veterans.analysis.rbc_vol_sldsc.MILLION_VETERANS_EUR_RBC_VOL_S_LDSC_TASKS","title":"MILLION_VETERANS_EUR_RBC_VOL_S_LDSC_TASKS  <code>module-attribute</code>","text":"<pre><code>MILLION_VETERANS_EUR_RBC_VOL_S_LDSC_TASKS = (\n    standard_sldsc_task_generator(\n        sumstats_task=sumstats_task,\n        base_name=\"million_veterans_eur_rbc_vol\",\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/red_blood_cell_volume/million_veterans/analysis/rbc_volume_magma_task_generator/","title":"rbc_volume_magma_task_generator","text":""},{"location":"reference/mecfs_bio/assets/gwas/red_blood_cell_volume/million_veterans/analysis/rbc_volume_magma_task_generator/#mecfs_bio.assets.gwas.red_blood_cell_volume.million_veterans.analysis.rbc_volume_magma_task_generator","title":"mecfs_bio.assets.gwas.red_blood_cell_volume.million_veterans.analysis.rbc_volume_magma_task_generator","text":"<p>Generate the tasks required to apply MAGMA to the red blood cell volume GWAS</p> <p>Attributes:</p> <ul> <li> <code>MILLION_VETERANS_EUR_RBC_VOLUME_MAGMA_TASKS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/red_blood_cell_volume/million_veterans/analysis/rbc_volume_magma_task_generator/#mecfs_bio.assets.gwas.red_blood_cell_volume.million_veterans.analysis.rbc_volume_magma_task_generator.MILLION_VETERANS_EUR_RBC_VOLUME_MAGMA_TASKS","title":"MILLION_VETERANS_EUR_RBC_VOLUME_MAGMA_TASKS  <code>module-attribute</code>","text":"<pre><code>MILLION_VETERANS_EUR_RBC_VOLUME_MAGMA_TASKS = create(\n    raw_gwas_data_task=MILLION_VETERAN_RED_BLOOD_VOLUME_EUR_DATA_RAW_HARMONIZED,\n    base_name=\"million_veterans_eur_rbc_vol\",\n    sample_size=407294,\n    magma_binary_task=MAGMA_1_1_BINARY_EXTRACTED,\n    gene_loc_file_task=MAGMA_ENSEMBL_GENE_LOCATION_REFERENCE_DATA_BUILD_37_RAW,\n    magma_ld_ref_task=MAGMA_EUR_BUILD_37_1K_GENOMES_EXTRACTED,\n    tissue_expression_gene_set_task=GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_PREP_FOR_MAGMA,\n    fmt=GWASLabColumnSpecifiers(\n        rsid=\"rsid\",\n        OR=None,\n        se=\"standard_error\",\n        chrom=\"chromosome\",\n        pos=\"base_pair_location\",\n        ea=\"effect_allele\",\n        nea=\"other_allele\",\n        eaf=\"effect_allele_frequency\",\n        beta=\"beta\",\n        p=\"p_value\",\n        n=\"n\",\n        info=\"r2\",\n        snpid=None,\n    ),\n    pre_pipe=FilterRowsByInfoScorePipe(\n        min_score=0.8, info_col=\"r2\"\n    ),\n    gene_thesaurus_task=GENE_THESAURUS,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/red_blood_cell_volume/million_veterans/raw_gwas_data/","title":"raw_gwas_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/red_blood_cell_volume/million_veterans/raw_gwas_data/#mecfs_bio.assets.gwas.red_blood_cell_volume.million_veterans.raw_gwas_data","title":"mecfs_bio.assets.gwas.red_blood_cell_volume.million_veterans.raw_gwas_data","text":"<p>Modules:</p> <ul> <li> <code>raw_red_blood_volume</code>           \u2013            <p>Raw Summary Statistics from the Million Veterans Program GWAS of red-blood cell volume amomng Europeans.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/red_blood_cell_volume/million_veterans/raw_gwas_data/raw_red_blood_volume/","title":"raw_red_blood_volume","text":""},{"location":"reference/mecfs_bio/assets/gwas/red_blood_cell_volume/million_veterans/raw_gwas_data/raw_red_blood_volume/#mecfs_bio.assets.gwas.red_blood_cell_volume.million_veterans.raw_gwas_data.raw_red_blood_volume","title":"mecfs_bio.assets.gwas.red_blood_cell_volume.million_veterans.raw_gwas_data.raw_red_blood_volume","text":"<p>Raw Summary Statistics from the Million Veterans Program GWAS of red-blood cell volume amomng Europeans.</p> <p>See:</p> <p>https://www.ebi.ac.uk/gwas/studies/GCST90475466</p> <p>Attributes:</p> <ul> <li> <code>MILLION_VETERAN_RED_BLOOD_VOLUME_EUR_DATA_RAW</code>           \u2013            </li> <li> <code>MILLION_VETERAN_RED_BLOOD_VOLUME_EUR_DATA_RAW_HARMONIZED</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/red_blood_cell_volume/million_veterans/raw_gwas_data/raw_red_blood_volume/#mecfs_bio.assets.gwas.red_blood_cell_volume.million_veterans.raw_gwas_data.raw_red_blood_volume.MILLION_VETERAN_RED_BLOOD_VOLUME_EUR_DATA_RAW","title":"MILLION_VETERAN_RED_BLOOD_VOLUME_EUR_DATA_RAW  <code>module-attribute</code>","text":"<pre><code>MILLION_VETERAN_RED_BLOOD_VOLUME_EUR_DATA_RAW = DownloadFileTask(\n    meta=GWASSummaryDataFileMeta(\n        id=AssetId(\n            \"million_veterans_red_blood_cell_volume_eur_raw\"\n        ),\n        trait=\"red_blood_cell_volume\",\n        project=\"million_veterans\",\n        sub_dir=\"raw\",\n        project_path=PurePath(\"GCST90475466.tsv.gz\"),\n        read_spec=DataFrameReadSpec(\n            format=DataFrameTextFormat(separator=\"\\t\")\n        ),\n    ),\n    url=\"https://ftp.ebi.ac.uk/pub/databases/gwas/summary_statistics/GCST90475001-GCST90476000/GCST90475466/GCST90475466.tsv.gz\",\n    md5_hash=\"62f0eda1fdac54a06b8259f137a43ddd\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/red_blood_cell_volume/million_veterans/raw_gwas_data/raw_red_blood_volume/#mecfs_bio.assets.gwas.red_blood_cell_volume.million_veterans.raw_gwas_data.raw_red_blood_volume.MILLION_VETERAN_RED_BLOOD_VOLUME_EUR_DATA_RAW_HARMONIZED","title":"MILLION_VETERAN_RED_BLOOD_VOLUME_EUR_DATA_RAW_HARMONIZED  <code>module-attribute</code>","text":"<pre><code>MILLION_VETERAN_RED_BLOOD_VOLUME_EUR_DATA_RAW_HARMONIZED = DownloadFileTask(\n    meta=GWASSummaryDataFileMeta(\n        id=AssetId(\n            \"million_veterans_red_blood_cell_volume_eur_raw_harmonized\"\n        ),\n        trait=\"red_blood_cell_volume\",\n        project=\"million_veterans\",\n        sub_dir=\"raw\",\n        project_path=PurePath(\"GCST90475466.h.tsv.gz\"),\n        read_spec=DataFrameReadSpec(\n            format=DataFrameTextFormat(separator=\"\\t\")\n        ),\n    ),\n    url=\"https://ftp.ebi.ac.uk/pub/databases/gwas/summary_statistics/GCST90475001-GCST90476000/GCST90475466/harmonised/GCST90475466.h.tsv.gz\",\n    md5_hash=\"3e96c443607751e95419359dde49d3b6\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/","title":"schizophrenia","text":""},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/#mecfs_bio.assets.gwas.schizophrenia","title":"mecfs_bio.assets.gwas.schizophrenia","text":"<p>Modules:</p> <ul> <li> <code>pgc2022</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/","title":"pgc2022","text":""},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/#mecfs_bio.assets.gwas.schizophrenia.pgc2022","title":"mecfs_bio.assets.gwas.schizophrenia.pgc2022","text":"<p>Modules:</p> <ul> <li> <code>analysis</code>           \u2013            </li> <li> <code>processed</code>           \u2013            </li> <li> <code>raw</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/","title":"analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis","title":"mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis","text":"<p>Modules:</p> <ul> <li> <code>magma</code>           \u2013            </li> <li> <code>sch_clustermap_plot</code>           \u2013            <p>Generate a clustermap showing gene/tissue specificity for the most significant Schizophrenia genes as detected by MAGMA</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/","title":"magma","text":""},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma","title":"mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma","text":"<p>Modules:</p> <ul> <li> <code>pgc2022_sch_magma_human_brain_atlas</code>           \u2013            </li> <li> <code>pgc2022_sch_magma_human_brain_atlas_conditional_analysis</code>           \u2013            </li> <li> <code>pgc2022_sch_magma_human_brain_atlas_plot</code>           \u2013            </li> <li> <code>pgc2022_sch_magma_human_brain_atlas_results_extract</code>           \u2013            </li> <li> <code>pgc2022_sch_magma_human_brain_atlas_results_labeled</code>           \u2013            </li> <li> <code>pgc2022_sch_magma_human_brain_atlas_results_multiple_testing</code>           \u2013            </li> <li> <code>pgc_2022_magma_hba_spec_matrix_filtered</code>           \u2013            </li> <li> <code>pgc_2022_sch_human_brain_atlas_stepwise_plot</code>           \u2013            </li> <li> <code>pgc_2022_sch_magma_human_brain_atlas_forward_stepwise</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc2022_sch_magma_human_brain_atlas/","title":"pgc2022_sch_magma_human_brain_atlas","text":""},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc2022_sch_magma_human_brain_atlas/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc2022_sch_magma_human_brain_atlas","title":"mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc2022_sch_magma_human_brain_atlas","text":"<p>Attributes:</p> <ul> <li> <code>MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc2022_sch_magma_human_brain_atlas/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc2022_sch_magma_human_brain_atlas.MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR","title":"MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR  <code>module-attribute</code>","text":"<pre><code>MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR = create(\n    asset_id=\"pgc2022_sch_human_brain_atlas_gene_covar\",\n    magma_gene_analysis_task=PGC2022_SCH_MAGMA_ENTREZ_GENE_ANALYSIS,\n    magma_binary_task=MAGMA_1_1_BINARY_EXTRACTED,\n    gene_set_task=MAGMA_ENTREZ_SPECIFICITY_MATRIX_HBCA_RNA_DUNCAN,\n    set_or_covar=\"covar\",\n    model_params=ModelParams(\n        direction_covar=\"greater\", condition_hide=[]\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc2022_sch_magma_human_brain_atlas_conditional_analysis/","title":"pgc2022_sch_magma_human_brain_atlas_conditional_analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc2022_sch_magma_human_brain_atlas_conditional_analysis/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc2022_sch_magma_human_brain_atlas_conditional_analysis","title":"mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc2022_sch_magma_human_brain_atlas_conditional_analysis","text":"<p>Attributes:</p> <ul> <li> <code>MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_CONDITIONAL_ANALYSIS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc2022_sch_magma_human_brain_atlas_conditional_analysis/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc2022_sch_magma_human_brain_atlas_conditional_analysis.MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_CONDITIONAL_ANALYSIS","title":"MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_CONDITIONAL_ANALYSIS  <code>module-attribute</code>","text":"<pre><code>MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_CONDITIONAL_ANALYSIS = create(\n    asset_id=\"pgc2022_sch_human_brain_atlas_gene_conditional_analysis\",\n    magma_gene_analysis_task=PGC2022_SCH_MAGMA_ENTREZ_GENE_ANALYSIS,\n    magma_binary_task=MAGMA_1_1_BINARY_EXTRACTED,\n    gene_set_task=PGC2022_HBA_MAGMA_SPEC_MATRIX_FILTERED,\n    set_or_covar=\"covar\",\n    model_params=ModelParams(\n        direction_covar=\"greater\",\n        condition_hide=[],\n        joint_pairs=True,\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc2022_sch_magma_human_brain_atlas_plot/","title":"pgc2022_sch_magma_human_brain_atlas_plot","text":""},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc2022_sch_magma_human_brain_atlas_plot/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc2022_sch_magma_human_brain_atlas_plot","title":"mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc2022_sch_magma_human_brain_atlas_plot","text":"<p>Attributes:</p> <ul> <li> <code>PGC_2022_SCH_MAGMA_HUMAN_BRAIN_ATLAS_PLOT</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc2022_sch_magma_human_brain_atlas_plot/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc2022_sch_magma_human_brain_atlas_plot.PGC_2022_SCH_MAGMA_HUMAN_BRAIN_ATLAS_PLOT","title":"PGC_2022_SCH_MAGMA_HUMAN_BRAIN_ATLAS_PLOT  <code>module-attribute</code>","text":"<pre><code>PGC_2022_SCH_MAGMA_HUMAN_BRAIN_ATLAS_PLOT = create(\n    result_table_task=MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR_MULTIPLE_TESTING,\n    cluster_annotation_task=CLUSTER_ANNOTATION_TERM_METADATA,\n    asset_id=\"pgc2022_sch_human_brain_atlas_magma_plot\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc2022_sch_magma_human_brain_atlas_results_extract/","title":"pgc2022_sch_magma_human_brain_atlas_results_extract","text":""},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc2022_sch_magma_human_brain_atlas_results_extract/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc2022_sch_magma_human_brain_atlas_results_extract","title":"mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc2022_sch_magma_human_brain_atlas_results_extract","text":"<p>Attributes:</p> <ul> <li> <code>MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR_EXTRACTED</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc2022_sch_magma_human_brain_atlas_results_extract/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc2022_sch_magma_human_brain_atlas_results_extract.MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR_EXTRACTED","title":"MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR_EXTRACTED  <code>module-attribute</code>","text":"<pre><code>MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR_EXTRACTED = create_result_table(\n    \"pgc2022_sch_human_brain_atlas_gene_covar_results_extracted\",\n    source_directory_task=MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR,\n    path_inside_directory=PurePath(\n        str(GENE_SET_ANALYSIS_OUTPUT_STEM_NAME + \".gsa.out\")\n    ),\n    extension=\".txt\",\n    read_spec=DataFrameReadSpec(\n        DataFrameWhiteSpaceSepTextFormat(comment_code=\"#\")\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc2022_sch_magma_human_brain_atlas_results_labeled/","title":"pgc2022_sch_magma_human_brain_atlas_results_labeled","text":""},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc2022_sch_magma_human_brain_atlas_results_labeled/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc2022_sch_magma_human_brain_atlas_results_labeled","title":"mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc2022_sch_magma_human_brain_atlas_results_labeled","text":"<p>Attributes:</p> <ul> <li> <code>MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR_LABELED</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc2022_sch_magma_human_brain_atlas_results_labeled/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc2022_sch_magma_human_brain_atlas_results_labeled.MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR_LABELED","title":"MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR_LABELED  <code>module-attribute</code>","text":"<pre><code>MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR_LABELED = create_from_result_df(\n    asset_id=\"pgc2022_sch_human_brain_atlas_gene_covar_results_labeled\",\n    result_df_task=MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR_EXTRACTED,\n    reference_df_task=DUNCAN_ET_AL_2025_ST1_LABEL_COLS,\n    how=\"left\",\n    left_on=[\"VARIABLE\"],\n    right_on=[\"VARIABLE\"],\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc2022_sch_magma_human_brain_atlas_results_multiple_testing/","title":"pgc2022_sch_magma_human_brain_atlas_results_multiple_testing","text":""},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc2022_sch_magma_human_brain_atlas_results_multiple_testing/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc2022_sch_magma_human_brain_atlas_results_multiple_testing","title":"mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc2022_sch_magma_human_brain_atlas_results_multiple_testing","text":"<p>Attributes:</p> <ul> <li> <code>MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR_MULTIPLE_TESTING</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc2022_sch_magma_human_brain_atlas_results_multiple_testing/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc2022_sch_magma_human_brain_atlas_results_multiple_testing.MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR_MULTIPLE_TESTING","title":"MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR_MULTIPLE_TESTING  <code>module-attribute</code>","text":"<pre><code>MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR_MULTIPLE_TESTING = create_from_result_table_task(\n    alpha=0.01,\n    source_task=MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR_LABELED,\n    method=\"bonferroni\",\n    asset_id=\"pgc2022_sch_human_brain_atlas_gene_covar_results_multiple_testing\",\n    p_value_column=\"P\",\n    apply_filter=False,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc_2022_magma_hba_spec_matrix_filtered/","title":"pgc_2022_magma_hba_spec_matrix_filtered","text":""},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc_2022_magma_hba_spec_matrix_filtered/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc_2022_magma_hba_spec_matrix_filtered","title":"mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc_2022_magma_hba_spec_matrix_filtered","text":"<p>Attributes:</p> <ul> <li> <code>PGC2022_HBA_MAGMA_SPEC_MATRIX_FILTERED</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc_2022_magma_hba_spec_matrix_filtered/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc_2022_magma_hba_spec_matrix_filtered.PGC2022_HBA_MAGMA_SPEC_MATRIX_FILTERED","title":"PGC2022_HBA_MAGMA_SPEC_MATRIX_FILTERED  <code>module-attribute</code>","text":"<pre><code>PGC2022_HBA_MAGMA_SPEC_MATRIX_FILTERED = create(\n    asset_id=\"pgc2022_magma_hba_spec_matrix_filtered\",\n    specificity_matrix_task=MAGMA_ENTREZ_SPECIFICITY_MATRIX_HBCA_RNA_DUNCAN,\n    magma_gene_covar_analysis_task=MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc_2022_sch_human_brain_atlas_stepwise_plot/","title":"pgc_2022_sch_human_brain_atlas_stepwise_plot","text":""},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc_2022_sch_human_brain_atlas_stepwise_plot/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc_2022_sch_human_brain_atlas_stepwise_plot","title":"mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc_2022_sch_human_brain_atlas_stepwise_plot","text":"<p>Attributes:</p> <ul> <li> <code>PGC2022_HBA_MAGMA_STEPWISE_PLOT</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc_2022_sch_human_brain_atlas_stepwise_plot/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc_2022_sch_human_brain_atlas_stepwise_plot.PGC2022_HBA_MAGMA_STEPWISE_PLOT","title":"PGC2022_HBA_MAGMA_STEPWISE_PLOT  <code>module-attribute</code>","text":"<pre><code>PGC2022_HBA_MAGMA_STEPWISE_PLOT = create(\n    result_table_task=MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR_MULTIPLE_TESTING,\n    asset_id=\"pgc2022_sch_human_brain_atlas_magma_stepwise_plot\",\n    stepwise_cluster_list_task=MAGMA_PGC2022_HBA_FORWARD_STEPWISE_CLUSTER_SELECT,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc_2022_sch_magma_human_brain_atlas_forward_stepwise/","title":"pgc_2022_sch_magma_human_brain_atlas_forward_stepwise","text":""},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc_2022_sch_magma_human_brain_atlas_forward_stepwise/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc_2022_sch_magma_human_brain_atlas_forward_stepwise","title":"mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc_2022_sch_magma_human_brain_atlas_forward_stepwise","text":"<p>Attributes:</p> <ul> <li> <code>MAGMA_PGC2022_HBA_FORWARD_STEPWISE_CLUSTER_SELECT</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/magma/pgc_2022_sch_magma_human_brain_atlas_forward_stepwise/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.magma.pgc_2022_sch_magma_human_brain_atlas_forward_stepwise.MAGMA_PGC2022_HBA_FORWARD_STEPWISE_CLUSTER_SELECT","title":"MAGMA_PGC2022_HBA_FORWARD_STEPWISE_CLUSTER_SELECT  <code>module-attribute</code>","text":"<pre><code>MAGMA_PGC2022_HBA_FORWARD_STEPWISE_CLUSTER_SELECT = create(\n    asset_id=\"pgc2022_sch_forward_stepwise_cluster_select\",\n    magma_marginal_output_task=MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_GENE_COVAR,\n    magma_conditional_output_task=MAGMA_PGC2022_SCH_HUMAN_BRAIN_ATLAS_CONDITIONAL_ANALYSIS,\n    significance_threshold=0.01,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/sch_clustermap_plot/","title":"sch_clustermap_plot","text":""},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/sch_clustermap_plot/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.sch_clustermap_plot","title":"mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.sch_clustermap_plot","text":"<p>Generate a clustermap showing gene/tissue specificity for the most significant Schizophrenia genes as detected by MAGMA</p> <p>Attributes:</p> <ul> <li> <code>SCH_PGC_2022_MAGMA_CLUSTER_MAP</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/analysis/sch_clustermap_plot/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.analysis.sch_clustermap_plot.SCH_PGC_2022_MAGMA_CLUSTER_MAP","title":"SCH_PGC_2022_MAGMA_CLUSTER_MAP  <code>module-attribute</code>","text":"<pre><code>SCH_PGC_2022_MAGMA_CLUSTER_MAP = create_standard_gene_magma_heatmap(\n    asset_id=\"sch_pgc_2022_cluster_map_v2\",\n    gene_specificity_matrix_source=SpecificityMatrixSource(\n        GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_PREP_FOR_MAGMA,\n        pipe=DropColPipe([\"Average\"]),\n        gene_col=\"Gene\",\n    ),\n    extracted_magma_gene_results_source=GeneInfoSource(\n        gene_analysis_extracted_result_task,\n        pipe=IdentityPipe(),\n        gene_col=MAGMA_GENE_COL,\n    ),\n    gene_thesaurus_source=GeneInfoSource(\n        GENE_THESAURUS,\n        pipe=IdentityPipe(),\n        gene_col=\"Gene stable ID\",\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/processed/","title":"processed","text":""},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/processed/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.processed","title":"mecfs_bio.assets.gwas.schizophrenia.pgc2022.processed","text":"<p>Modules:</p> <ul> <li> <code>magma</code>           \u2013            </li> <li> <code>standard_analysis_sc_pgc_2022</code>           \u2013            <p>Analyze GWAS data from the 2022 PGC Schizophrenia GWAS.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/processed/magma/","title":"magma","text":""},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/processed/magma/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.processed.magma","title":"mecfs_bio.assets.gwas.schizophrenia.pgc2022.processed.magma","text":"<p>Modules:</p> <ul> <li> <code>pgc2022_sch_entrez_annotations</code>           \u2013            <p>Associate Entrez gene ids with SNPs from the schizophrenia GWAS</p> </li> <li> <code>pgc2022_sch_magna_entrez_gene_analysis</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/processed/magma/pgc2022_sch_entrez_annotations/","title":"pgc2022_sch_entrez_annotations","text":""},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/processed/magma/pgc2022_sch_entrez_annotations/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.processed.magma.pgc2022_sch_entrez_annotations","title":"mecfs_bio.assets.gwas.schizophrenia.pgc2022.processed.magma.pgc2022_sch_entrez_annotations","text":"<p>Associate Entrez gene ids with SNPs from the schizophrenia GWAS Note that we use an asymmetric window of 35 kb/10kb. This is consistent with what is done in the Duncan paper: https://github.com/Integrative-Mental-Health-Lab/linking_cell_types_to_brain_phenotypes/blob/675b5c9b58b8762934183a3ca61ae49ad587934a/MAGMA/1.annotationAndGeneAnalysis.sh#L12</p> <p>Attributes:</p> <ul> <li> <code>PGC2022_SCH_MAGMA_ENTREZ_ANNOTATIONS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/processed/magma/pgc2022_sch_entrez_annotations/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.processed.magma.pgc2022_sch_entrez_annotations.PGC2022_SCH_MAGMA_ENTREZ_ANNOTATIONS","title":"PGC2022_SCH_MAGMA_ENTREZ_ANNOTATIONS  <code>module-attribute</code>","text":"<pre><code>PGC2022_SCH_MAGMA_ENTREZ_ANNOTATIONS = create(\n    asset_id=\"pgc2022_sch_magma_annotations\",\n    magma_binary_task=MAGMA_1_1_BINARY_EXTRACTED,\n    snp_loc_file_task=snp_loc_task,\n    gene_loc_file_task=MAGMA_ENTREZ_GENE_LOCATION_REFERENCE_DATA_BUILD_37_EXTRACTED,\n    window=(35, 10),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/processed/magma/pgc2022_sch_magna_entrez_gene_analysis/","title":"pgc2022_sch_magna_entrez_gene_analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/processed/magma/pgc2022_sch_magna_entrez_gene_analysis/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.processed.magma.pgc2022_sch_magna_entrez_gene_analysis","title":"mecfs_bio.assets.gwas.schizophrenia.pgc2022.processed.magma.pgc2022_sch_magna_entrez_gene_analysis","text":"<p>Attributes:</p> <ul> <li> <code>PGC2022_SCH_MAGMA_ENTREZ_GENE_ANALYSIS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/processed/magma/pgc2022_sch_magna_entrez_gene_analysis/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.processed.magma.pgc2022_sch_magna_entrez_gene_analysis.PGC2022_SCH_MAGMA_ENTREZ_GENE_ANALYSIS","title":"PGC2022_SCH_MAGMA_ENTREZ_GENE_ANALYSIS  <code>module-attribute</code>","text":"<pre><code>PGC2022_SCH_MAGMA_ENTREZ_GENE_ANALYSIS = create(\n    asset_id=\"pgc_2022_sch_magma_entrez_gene_analysis\",\n    magma_annotation_task=PGC2022_SCH_MAGMA_ENTREZ_ANNOTATIONS,\n    magma_p_value_task=p_value_task,\n    magma_binary_task=MAGMA_1_1_BINARY_EXTRACTED,\n    magma_ld_ref_task=MAGMA_EUR_BUILD_37_1K_GENOMES_EXTRACTED,\n    ld_ref_file_stem=\"g1000_eur\",\n    sample_size=77258,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/processed/standard_analysis_sc_pgc_2022/","title":"standard_analysis_sc_pgc_2022","text":""},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/processed/standard_analysis_sc_pgc_2022/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.processed.standard_analysis_sc_pgc_2022","title":"mecfs_bio.assets.gwas.schizophrenia.pgc2022.processed.standard_analysis_sc_pgc_2022","text":"<p>Analyze GWAS data from the 2022 PGC Schizophrenia GWAS. Citation: Trubetskoy, Vassily, et al. \"Mapping genomic loci implicates genes and synaptic biology in schizophrenia.\" Nature 604.7906 (2022): 502-508.</p> <p>Attributes:</p> <ul> <li> <code>SCH_PGC_2022_STANDARD_ANALYSIS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/processed/standard_analysis_sc_pgc_2022/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.processed.standard_analysis_sc_pgc_2022.SCH_PGC_2022_STANDARD_ANALYSIS","title":"SCH_PGC_2022_STANDARD_ANALYSIS  <code>module-attribute</code>","text":"<pre><code>SCH_PGC_2022_STANDARD_ANALYSIS = concrete_standard_analysis_generator_assume_already_has_rsid(\n    base_name=\"pgc_2022_sch\",\n    raw_gwas_data_task=PGC_2022_SCH_RAW,\n    fmt=GWASLabColumnSpecifiers(\n        rsid=\"ID\",\n        chrom=\"CHROM\",\n        pos=\"POS\",\n        ea=\"A1\",\n        nea=\"A2\",\n        info=\"IMPINFO\",\n        beta=\"BETA\",\n        se=\"SE\",\n        p=\"PVAL\",\n        n=\"NEFF\",\n        snpid=None,\n        OR=None,\n    ),\n    sample_size=58749,\n    include_master_gene_lists=False,\n    include_hba_magma_tasks=True,\n    include_independent_cluster_plot_in_hba=True,\n    hba_plot_settings=PlotSettings(),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/raw/","title":"raw","text":""},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/raw/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.raw","title":"mecfs_bio.assets.gwas.schizophrenia.pgc2022.raw","text":"<p>Modules:</p> <ul> <li> <code>raw_sch_pgc2022</code>           \u2013            <p>Download raw data from the 2022 Schizophrenia GWAS</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/raw/raw_sch_pgc2022/","title":"raw_sch_pgc2022","text":""},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/raw/raw_sch_pgc2022/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.raw.raw_sch_pgc2022","title":"mecfs_bio.assets.gwas.schizophrenia.pgc2022.raw.raw_sch_pgc2022","text":"<p>Download raw data from the 2022 Schizophrenia GWAS</p> <p>Citation: Trubetskoy, Vassily, et al. \"Mapping genomic loci implicates genes and synaptic biology in schizophrenia.\" Nature 604.7906 (2022): 502-508.</p> <p>Download home: https://figshare.com/articles/dataset/scz2022/19426775</p> <p>Attributes:</p> <ul> <li> <code>PGC_2022_SCH_RAW</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/schizophrenia/pgc2022/raw/raw_sch_pgc2022/#mecfs_bio.assets.gwas.schizophrenia.pgc2022.raw.raw_sch_pgc2022.PGC_2022_SCH_RAW","title":"PGC_2022_SCH_RAW  <code>module-attribute</code>","text":"<pre><code>PGC_2022_SCH_RAW = DownloadFileTask(\n    meta=GWASSummaryDataFileMeta(\n        id=AssetId(\"pgc_2022_sch_raw\"),\n        trait=\"schizophrenia\",\n        project=\"pgc_2022\",\n        sub_dir=\"raw\",\n        project_path=PurePath(\n            \"PGC3_SCZ_wave3.european.autosome.public.v3.vcf.tsv.gz\"\n        ),\n        read_spec=DataFrameReadSpec(\n            format=DataFrameTextFormat(\n                separator=\"\\t\", comment_char=\"#\"\n            )\n        ),\n    ),\n    url=\"https://ndownloader.figshare.com/files/34517828\",\n    md5_hash=\"6ebe2376f5cda972d37efa0f214c4df0\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/syncope/","title":"syncope","text":""},{"location":"reference/mecfs_bio/assets/gwas/syncope/#mecfs_bio.assets.gwas.syncope","title":"mecfs_bio.assets.gwas.syncope","text":"<p>Modules:</p> <ul> <li> <code>aegisdottir_et_al</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/","title":"aegisdottir_et_al","text":""},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/#mecfs_bio.assets.gwas.syncope.aegisdottir_et_al","title":"mecfs_bio.assets.gwas.syncope.aegisdottir_et_al","text":"<p>Modules:</p> <ul> <li> <code>analysis</code>           \u2013            </li> <li> <code>processed</code>           \u2013            </li> <li> <code>raw</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/analysis/","title":"analysis","text":""},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/analysis/#mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.analysis","title":"mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.analysis","text":"<p>Modules:</p> <ul> <li> <code>syncope_hba_magma_task_generator</code>           \u2013            <p>Apply HBA MAGMA to syncope data.</p> </li> <li> <code>syncope_magma_task_generator</code>           \u2013            <p>Generate MAGMA tasks for the Syncope GWAS study of Aegisdottir et al.</p> </li> <li> <code>syncope_s_ldsc</code>           \u2013            <p>Task generator to apply S-LDSC to the Aegisdottir et al. Syncope GWAS summary statistics.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/analysis/syncope_hba_magma_task_generator/","title":"syncope_hba_magma_task_generator","text":""},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/analysis/syncope_hba_magma_task_generator/#mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.analysis.syncope_hba_magma_task_generator","title":"mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.analysis.syncope_hba_magma_task_generator","text":"<p>Apply HBA MAGMA to syncope data. MAGMA's synonym handling capability should automatically deal with the duplicate SNPs in these summary statistics</p> <p>Attributes:</p> <ul> <li> <code>HBA_MAGMA_AEGISDOTTIR_SYCNOPE_GWAS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/analysis/syncope_hba_magma_task_generator/#mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.analysis.syncope_hba_magma_task_generator.HBA_MAGMA_AEGISDOTTIR_SYCNOPE_GWAS","title":"HBA_MAGMA_AEGISDOTTIR_SYCNOPE_GWAS  <code>module-attribute</code>","text":"<pre><code>HBA_MAGMA_AEGISDOTTIR_SYCNOPE_GWAS = generate_human_brain_atlas_magma_tasks(\n    base_name=\"aegisdottir_syncope\",\n    gwas_parquet_with_rsids_task=AEGISDOTTIR_SUMSTATS_DUMP_TO_PARQUET,\n    sample_size=946861,\n    plot_settings=PlotSettings(\"plotly_white\"),\n    include_independent_cluster_plot=True,\n    hba_indep_plot_options=HBAIndepPlotOptions(\n        annotation_text_size=10\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/analysis/syncope_magma_task_generator/","title":"syncope_magma_task_generator","text":""},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/analysis/syncope_magma_task_generator/#mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.analysis.syncope_magma_task_generator","title":"mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.analysis.syncope_magma_task_generator","text":"<p>Generate MAGMA tasks for the Syncope GWAS study of Aegisdottir et al. MAGMA's synonym handling capability should automatically deal with duplicate SNPs</p> <p>Attributes:</p> <ul> <li> <code>AEGISDOTTIR_COMBINED_MAGMA_TASKS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/analysis/syncope_magma_task_generator/#mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.analysis.syncope_magma_task_generator.AEGISDOTTIR_COMBINED_MAGMA_TASKS","title":"AEGISDOTTIR_COMBINED_MAGMA_TASKS  <code>module-attribute</code>","text":"<pre><code>AEGISDOTTIR_COMBINED_MAGMA_TASKS = create(\n    raw_gwas_data_task=AEGISDOTTIR_SUMSTATS_DUMP_TO_PARQUET,\n    magma_binary_task=MAGMA_1_1_BINARY_EXTRACTED,\n    gene_loc_file_task=MAGMA_ENSEMBL_GENE_LOCATION_REFERENCE_DATA_BUILD_37_RAW,\n    magma_ld_ref_task=MAGMA_EUR_BUILD_37_1K_GENOMES_EXTRACTED,\n    tissue_expression_gene_set_task=GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_PREP_FOR_MAGMA,\n    base_name=\"aegisdottir_et_al_2023\",\n    sample_size=946861,\n    fmt=\"gwaslab\",\n    post_pipe=ComputeBetaPipe(),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/analysis/syncope_s_ldsc/","title":"syncope_s_ldsc","text":""},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/analysis/syncope_s_ldsc/#mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.analysis.syncope_s_ldsc","title":"mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.analysis.syncope_s_ldsc","text":"<p>Task generator to apply S-LDSC to the Aegisdottir et al. Syncope GWAS summary statistics.</p> <p>Attributes:</p> <ul> <li> <code>SYNCOPE_S_LDSC_TASKS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/analysis/syncope_s_ldsc/#mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.analysis.syncope_s_ldsc.SYNCOPE_S_LDSC_TASKS","title":"SYNCOPE_S_LDSC_TASKS  <code>module-attribute</code>","text":"<pre><code>SYNCOPE_S_LDSC_TASKS = standard_sldsc_task_generator(\n    sumstats_task=AEGISDOTTIR_SYNCOPE_LIFTOVER_SUMSTATS_HAPMAP3_DEDUP,\n    base_name=\"aegisdottir_syncope_sldcs\",\n    pre_pipe=CompositePipe(\n        [\n            ComputeBetaPipe(),\n            SetColToConstantPipe(\n                col_name=GWASLAB_SAMPLE_SIZE_COLUMN,\n                constant=946861,\n            ),\n        ]\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/processed/","title":"processed","text":""},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/processed/#mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.processed","title":"mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.processed","text":"<p>Modules:</p> <ul> <li> <code>sumstats_liftover_dump_to_parquet</code>           \u2013            </li> <li> <code>syncope_sumstats_explode_and_scale</code>           \u2013            <p>The Syncope GWAS sumstats file is formatted in an unusual way:</p> </li> <li> <code>syncope_sumstats_liftover</code>           \u2013            <p>Liftover the Aegisdottir et al. syncope summary statistics to the hg19 genome build.</p> </li> <li> <code>syncope_sumstats_liftover_hapmap3_dedup</code>           \u2013            <p>Task to restrict the Aegisdottir et al. summary statistics to hapmap3 and deduplicate them.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/processed/sumstats_liftover_dump_to_parquet/","title":"sumstats_liftover_dump_to_parquet","text":""},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/processed/sumstats_liftover_dump_to_parquet/#mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.processed.sumstats_liftover_dump_to_parquet","title":"mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.processed.sumstats_liftover_dump_to_parquet","text":"<p>Attributes:</p> <ul> <li> <code>AEGISDOTTIR_SUMSTATS_DUMP_TO_PARQUET</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/processed/sumstats_liftover_dump_to_parquet/#mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.processed.sumstats_liftover_dump_to_parquet.AEGISDOTTIR_SUMSTATS_DUMP_TO_PARQUET","title":"AEGISDOTTIR_SUMSTATS_DUMP_TO_PARQUET  <code>module-attribute</code>","text":"<pre><code>AEGISDOTTIR_SUMSTATS_DUMP_TO_PARQUET = create_from_source_task(\n    source_tsk=AEGISDOTTIR_SYNCOPE_LIFTOVER_SUMSTATS,\n    asset_id=\"aegissdottir_sumstats_37_dump_to_parquet_task\",\n    sub_dir=\"processed\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/processed/syncope_sumstats_explode_and_scale/","title":"syncope_sumstats_explode_and_scale","text":""},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/processed/syncope_sumstats_explode_and_scale/#mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.processed.syncope_sumstats_explode_and_scale","title":"mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.processed.syncope_sumstats_explode_and_scale","text":"<p>The Syncope GWAS sumstats file is formatted in an unusual way: - Effect allele frequency is expressed as a percent, not a proportion. - Some rows have multiple rsIDS, to account for rsid synonyms.</p> <p>This Task preprocesses the file to address these issues, then creates GWASLAB sumstats - Note 1: if the sumstats issues are not fixed prior to conversion to GWASlab sumstats format, this can cause a large number of SNPs to be unnecessarily discarded. - Note 2:  This task resolves the issues of synonymous rsids by creating separate row for each synonym.  Downstream tasks  need to take this into account to avoid double-counting SNPs</p> <p>Attributes:</p> <ul> <li> <code>SYNCOPE_SUMSTATS_EXPLODE_AND_SCALE</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/processed/syncope_sumstats_explode_and_scale/#mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.processed.syncope_sumstats_explode_and_scale.SYNCOPE_SUMSTATS_EXPLODE_AND_SCALE","title":"SYNCOPE_SUMSTATS_EXPLODE_AND_SCALE  <code>module-attribute</code>","text":"<pre><code>SYNCOPE_SUMSTATS_EXPLODE_AND_SCALE = GWASLabCreateSumstatsTask(\n    df_source_task=AEGISDOTTIR_ET_AL_RAW_SYNCOPE_DATA,\n    fmt=GWASLabColumnSpecifiers(\n        chrom=\"Chrom\",\n        pos=\"Pos\",\n        ea=\"EA\",\n        nea=\"OA\",\n        eaf=\"EAF\",\n        p=\"Pval\",\n        snpid=\"ID\",\n        OR=\"OR\",\n        se=\"SE\",\n        info=\"Info\",\n        rsid=\"rsName\",\n    ),\n    basic_check=True,\n    genome_build=\"infer\",\n    pre_pipe=CompositePipe(\n        [\n            ScaleColPipe(col=\"EAF\", scale_factor=1 / 100),\n            SplitColPipe(\n                col_to_split=\"rsName\",\n                split_by=\",\",\n                new_col_name=\"rsName\",\n            ),\n            UNNestPipe(col_to_unnest=\"rsName\"),\n        ]\n    ),\n    asset_id=AssetId(\n        \"aegisdottir_et_al_raw_sumstats_exploded_and_scaled\"\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/processed/syncope_sumstats_liftover/","title":"syncope_sumstats_liftover","text":""},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/processed/syncope_sumstats_liftover/#mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.processed.syncope_sumstats_liftover","title":"mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.processed.syncope_sumstats_liftover","text":"<p>Liftover the Aegisdottir et al. syncope summary statistics to the hg19 genome build.</p> <p>Attributes:</p> <ul> <li> <code>AEGISDOTTIR_SYNCOPE_LIFTOVER_SUMSTATS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/processed/syncope_sumstats_liftover/#mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.processed.syncope_sumstats_liftover.AEGISDOTTIR_SYNCOPE_LIFTOVER_SUMSTATS","title":"AEGISDOTTIR_SYNCOPE_LIFTOVER_SUMSTATS  <code>module-attribute</code>","text":"<pre><code>AEGISDOTTIR_SYNCOPE_LIFTOVER_SUMSTATS = (\n    create_from_source_task(\n        source_tsk=SYNCOPE_SUMSTATS_EXPLODE_AND_SCALE,\n        asset_id=\"aegissdotir_sumstats_liftover\",\n        spec=GwasLabTransformSpec(\n            genome_build=\"infer\", liftover_to=\"19\"\n        ),\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/processed/syncope_sumstats_liftover_hapmap3_dedup/","title":"syncope_sumstats_liftover_hapmap3_dedup","text":""},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/processed/syncope_sumstats_liftover_hapmap3_dedup/#mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.processed.syncope_sumstats_liftover_hapmap3_dedup","title":"mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.processed.syncope_sumstats_liftover_hapmap3_dedup","text":"<p>Task to restrict the Aegisdottir et al. summary statistics to hapmap3 and deduplicate them. This avoids any potential issue downstream due to multiple rows referring to the same variant with different rsi</p> <p>Attributes:</p> <ul> <li> <code>AEGISDOTTIR_SYNCOPE_LIFTOVER_SUMSTATS_HAPMAP3_DEDUP</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/processed/syncope_sumstats_liftover_hapmap3_dedup/#mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.processed.syncope_sumstats_liftover_hapmap3_dedup.AEGISDOTTIR_SYNCOPE_LIFTOVER_SUMSTATS_HAPMAP3_DEDUP","title":"AEGISDOTTIR_SYNCOPE_LIFTOVER_SUMSTATS_HAPMAP3_DEDUP  <code>module-attribute</code>","text":"<pre><code>AEGISDOTTIR_SYNCOPE_LIFTOVER_SUMSTATS_HAPMAP3_DEDUP = create_from_source_task(\n    source_tsk=AEGISDOTTIR_SYNCOPE_LIFTOVER_SUMSTATS,\n    asset_id=\"aegissdotir_sumstats_liftover_hapmap3_dedup\",\n    spec=GwasLabTransformSpec(\n        genome_build=\"infer\",\n        filter_hapmap3=True,\n        liftover_to=\"19\",\n    ),\n    post_pipe=UniquePipe(\n        by=[\n            GWASLAB_CHROM_COL,\n            GWASLAB_POS_COL,\n            GWASLAB_EFFECT_ALLELE_COL,\n            GWASLAB_NON_EFFECT_ALLELE_COL,\n        ],\n        keep=\"first\",\n        order_by=[GWASLAB_RSID_COL],\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/raw/","title":"raw","text":""},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/raw/#mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.raw","title":"mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.raw","text":"<p>Modules:</p> <ul> <li> <code>raw_syncope_data</code>           \u2013            <p>Task to retrieve data form Aegisdottir et al's GWAS of Syncope</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/raw/raw_syncope_data/","title":"raw_syncope_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/raw/raw_syncope_data/#mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.raw.raw_syncope_data","title":"mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.raw.raw_syncope_data","text":"<p>Task to retrieve data form Aegisdottir et al's GWAS of Syncope Citation:  Aegisdottir, Hildur M., et al. \"Genetic variants associated with syncope implicate neural and autonomic processes.\" European heart journal 44.12 (2023): 1070-1080.</p> <p>Attributes:</p> <ul> <li> <code>AEGISDOTTIR_ET_AL_RAW_SYNCOPE_DATA</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/syncope/aegisdottir_et_al/raw/raw_syncope_data/#mecfs_bio.assets.gwas.syncope.aegisdottir_et_al.raw.raw_syncope_data.AEGISDOTTIR_ET_AL_RAW_SYNCOPE_DATA","title":"AEGISDOTTIR_ET_AL_RAW_SYNCOPE_DATA  <code>module-attribute</code>","text":"<pre><code>AEGISDOTTIR_ET_AL_RAW_SYNCOPE_DATA = DownloadFileTask(\n    meta=GWASSummaryDataFileMeta(\n        id=AssetId(\"aegisdottir_et_al_raw_syncope_data\"),\n        trait=\"syncope\",\n        project=\"aegisdottir\",\n        sub_dir=\"\",\n        project_path=PurePath(\"syncope2023.gz\"),\n        read_spec=DataFrameReadSpec(\n            format=DataFrameTextFormat(separator=\"\\t\")\n        ),\n    ),\n    url=\"https://www.dropbox.com/scl/fi/sy1pitlnd1ywe9rsr8qqa/syncope2023.gz?rlkey=crno0suvqolsrp8fsrsjvc17j&amp;dl=1\",\n    md5_hash=\"ffe32aefc6f91ad2be0c23a4a1ecbac6\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/","title":"systemic_lupus_erythematosus","text":""},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/#mecfs_bio.assets.gwas.systemic_lupus_erythematosus","title":"mecfs_bio.assets.gwas.systemic_lupus_erythematosus","text":"<p>Modules:</p> <ul> <li> <code>bentham_et_al_2015</code>           \u2013            <p>Tasks pertaining to Bentham et al.'s 2015 GWAS of Lupus.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/","title":"bentham_et_al_2015","text":""},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/#mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015","title":"mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015","text":"<p>Tasks pertaining to Bentham et al.'s 2015 GWAS of Lupus.</p> <p>Modules:</p> <ul> <li> <code>analysis_results</code>           \u2013            </li> <li> <code>processed_gwas_data</code>           \u2013            </li> <li> <code>raw_gwas_data</code>           \u2013            </li> <li> <code>raw_gwas_data_harmonized</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/analysis_results/","title":"analysis_results","text":""},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/analysis_results/#mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.analysis_results","title":"mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.analysis_results","text":"<p>Modules:</p> <ul> <li> <code>bentham_2015_raw_37_lead_variant_region_plots</code>           \u2013            </li> <li> <code>bentham_2015_raw_37_lead_variants</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/analysis_results/bentham_2015_raw_37_lead_variant_region_plots/","title":"bentham_2015_raw_37_lead_variant_region_plots","text":""},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/analysis_results/bentham_2015_raw_37_lead_variant_region_plots/#mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.analysis_results.bentham_2015_raw_37_lead_variant_region_plots","title":"mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.analysis_results.bentham_2015_raw_37_lead_variant_region_plots","text":"<p>Attributes:</p> <ul> <li> <code>BENTHAM_2105_RAW_LEAD_VARIANT_REGION_PLOTS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/analysis_results/bentham_2015_raw_37_lead_variant_region_plots/#mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.analysis_results.bentham_2015_raw_37_lead_variant_region_plots.BENTHAM_2105_RAW_LEAD_VARIANT_REGION_PLOTS","title":"BENTHAM_2105_RAW_LEAD_VARIANT_REGION_PLOTS  <code>module-attribute</code>","text":"<pre><code>BENTHAM_2105_RAW_LEAD_VARIANT_REGION_PLOTS = GwasLabRegionPlotsFromLeadVariantsTask(\n    lead_variants_task=BENTHAM_2015_RAW_LEAD_VARIANTS,\n    sumstats_task=BENTHAM_2015_SUMSTATS_MINIMAL_PROCESSING_FROM_RAW_BUILD_37,\n    vcf_name_for_ld=None,\n    short_id=\"bentham_2015_raw_37_lead_variant_region_plots\",\n    plot_top=5,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/analysis_results/bentham_2015_raw_37_lead_variants/","title":"bentham_2015_raw_37_lead_variants","text":""},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/analysis_results/bentham_2015_raw_37_lead_variants/#mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.analysis_results.bentham_2015_raw_37_lead_variants","title":"mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.analysis_results.bentham_2015_raw_37_lead_variants","text":"<p>Attributes:</p> <ul> <li> <code>BENTHAM_2015_RAW_LEAD_VARIANTS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/analysis_results/bentham_2015_raw_37_lead_variants/#mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.analysis_results.bentham_2015_raw_37_lead_variants.BENTHAM_2015_RAW_LEAD_VARIANTS","title":"BENTHAM_2015_RAW_LEAD_VARIANTS  <code>module-attribute</code>","text":"<pre><code>BENTHAM_2015_RAW_LEAD_VARIANTS = GwasLabLeadVariantsTask(\n    sumstats_task=BENTHAM_2015_SUMSTATS_MINIMAL_PROCESSING_FROM_RAW_BUILD_37,\n    short_id=\"bentham_2015_raw_lead_variants\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/processed_gwas_data/","title":"processed_gwas_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/processed_gwas_data/#mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.processed_gwas_data","title":"mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.processed_gwas_data","text":"<p>Modules:</p> <ul> <li> <code>bentham_2015_harmonized_sumstats_minimal_processing</code>           \u2013            </li> <li> <code>bentham_2015_raw_sumstats_minimal_processing</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/processed_gwas_data/bentham_2015_harmonized_sumstats_minimal_processing/","title":"bentham_2015_harmonized_sumstats_minimal_processing","text":""},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/processed_gwas_data/bentham_2015_harmonized_sumstats_minimal_processing/#mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.processed_gwas_data.bentham_2015_harmonized_sumstats_minimal_processing","title":"mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.processed_gwas_data.bentham_2015_harmonized_sumstats_minimal_processing","text":"<p>Attributes:</p> <ul> <li> <code>BENTHAM_2015_SUMSTATS_MINIMAL_PROCESSING</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/processed_gwas_data/bentham_2015_harmonized_sumstats_minimal_processing/#mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.processed_gwas_data.bentham_2015_harmonized_sumstats_minimal_processing.BENTHAM_2015_SUMSTATS_MINIMAL_PROCESSING","title":"BENTHAM_2015_SUMSTATS_MINIMAL_PROCESSING  <code>module-attribute</code>","text":"<pre><code>BENTHAM_2015_SUMSTATS_MINIMAL_PROCESSING = GWASLabCreateSumstatsTask(\n    df_source_task=BENTHAM_2015_HARMONIZED_BUILD_38,\n    asset_id=AssetId(\n        \"bentham_2015_harmonized_build_38_sumstats_minimal_processing\"\n    ),\n    basic_check=True,\n    genome_build=\"infer\",\n    fmt=\"gwascatalog\",\n    drop_col_list=[\"effect_allele_frequency\"],\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/processed_gwas_data/bentham_2015_raw_sumstats_minimal_processing/","title":"bentham_2015_raw_sumstats_minimal_processing","text":""},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/processed_gwas_data/bentham_2015_raw_sumstats_minimal_processing/#mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.processed_gwas_data.bentham_2015_raw_sumstats_minimal_processing","title":"mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.processed_gwas_data.bentham_2015_raw_sumstats_minimal_processing","text":"<p>Attributes:</p> <ul> <li> <code>BENTHAM_2015_SUMSTATS_MINIMAL_PROCESSING_FROM_RAW_BUILD_37</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/processed_gwas_data/bentham_2015_raw_sumstats_minimal_processing/#mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.processed_gwas_data.bentham_2015_raw_sumstats_minimal_processing.BENTHAM_2015_SUMSTATS_MINIMAL_PROCESSING_FROM_RAW_BUILD_37","title":"BENTHAM_2015_SUMSTATS_MINIMAL_PROCESSING_FROM_RAW_BUILD_37  <code>module-attribute</code>","text":"<pre><code>BENTHAM_2015_SUMSTATS_MINIMAL_PROCESSING_FROM_RAW_BUILD_37 = GWASLabCreateSumstatsTask(\n    df_source_task=BENTHAM_2015_RAW_BUILD_37,\n    asset_id=AssetId(\n        \"bentham_2015_raw_build_37_sumstats_minimal_processing\"\n    ),\n    basic_check=True,\n    genome_build=\"infer\",\n    fmt=GWASLabColumnSpecifiers(\n        rsid=\"rsid\",\n        snpid=None,\n        chrom=\"chrom\",\n        pos=\"pos\",\n        ea=\"effect_allele\",\n        nea=\"other_allele\",\n        OR=\"OR\",\n        se=\"se\",\n        p=\"p\",\n        info=None,\n        beta=\"beta\",\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/raw_gwas_data/","title":"raw_gwas_data","text":""},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/raw_gwas_data/#mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.raw_gwas_data","title":"mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.raw_gwas_data","text":"<p>Modules:</p> <ul> <li> <code>bentham_2015_raw_build_37</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/raw_gwas_data/bentham_2015_raw_build_37/","title":"bentham_2015_raw_build_37","text":""},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/raw_gwas_data/bentham_2015_raw_build_37/#mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.raw_gwas_data.bentham_2015_raw_build_37","title":"mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.raw_gwas_data.bentham_2015_raw_build_37","text":"<p>Attributes:</p> <ul> <li> <code>BENTHAM_2015_RAW_BUILD_37</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/raw_gwas_data/bentham_2015_raw_build_37/#mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.raw_gwas_data.bentham_2015_raw_build_37.BENTHAM_2015_RAW_BUILD_37","title":"BENTHAM_2015_RAW_BUILD_37  <code>module-attribute</code>","text":"<pre><code>BENTHAM_2015_RAW_BUILD_37 = DownloadFileTask(\n    meta=GWASSummaryDataFileMeta(\n        id=AssetId(\"bentham_2015_raw_build_37\"),\n        trait=\"systemic_lupus_erythematosus\",\n        project=\"bentham_et_al_2015\",\n        sub_dir=\"raw\",\n        project_path=None,\n        read_spec=DataFrameReadSpec(\n            format=DataFrameTextFormat(\n                separator=\"\\t\",\n                null_values=[\"NA\"],\n                schema_overrides={\"chrom\": String()},\n            )\n        ),\n        extension=\".tsv.gz\",\n    ),\n    url=\"https://ftp.ebi.ac.uk/pub/databases/gwas/summary_statistics/GCST003001-GCST004000/GCST003156/bentham_2015_26502338_sle_efo0002690_1_gwas.sumstats.tsv.gz\",\n    md5_hash=None,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/raw_gwas_data_harmonized/","title":"raw_gwas_data_harmonized","text":""},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/raw_gwas_data_harmonized/#mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.raw_gwas_data_harmonized","title":"mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.raw_gwas_data_harmonized","text":"<p>Modules:</p> <ul> <li> <code>bentham_2015_harmonized_build_38</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/raw_gwas_data_harmonized/bentham_2015_harmonized_build_38/","title":"bentham_2015_harmonized_build_38","text":""},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/raw_gwas_data_harmonized/bentham_2015_harmonized_build_38/#mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.raw_gwas_data_harmonized.bentham_2015_harmonized_build_38","title":"mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.raw_gwas_data_harmonized.bentham_2015_harmonized_build_38","text":"<p>Attributes:</p> <ul> <li> <code>BENTHAM_2015_HARMONIZED_BUILD_38</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/systemic_lupus_erythematosus/bentham_et_al_2015/raw_gwas_data_harmonized/bentham_2015_harmonized_build_38/#mecfs_bio.assets.gwas.systemic_lupus_erythematosus.bentham_et_al_2015.raw_gwas_data_harmonized.bentham_2015_harmonized_build_38.BENTHAM_2015_HARMONIZED_BUILD_38","title":"BENTHAM_2015_HARMONIZED_BUILD_38  <code>module-attribute</code>","text":"<pre><code>BENTHAM_2015_HARMONIZED_BUILD_38 = DownloadFileTask(\n    meta=GWASSummaryDataFileMeta(\n        id=AssetId(\"bentham_2015_harmonized_build_38\"),\n        trait=\"systemic_lupus_erythematosus\",\n        project=\"bentham_et_al_2015\",\n        project_path=PurePath(\n            \"26502338-GCST003156-EFO_0002690.h.tsv.gz\"\n        ),\n        sub_dir=\"raw_harmonized\",\n        read_spec=DataFrameReadSpec(\n            format=DataFrameTextFormat(\n                separator=\"\\t\",\n                null_values=[\"NA\"],\n                schema_overrides={\"hm_chrom\": String()},\n            )\n        ),\n    ),\n    url=\"https://ftp.ebi.ac.uk/pub/databases/gwas/summary_statistics/GCST003001-GCST004000/GCST003156/harmonised/26502338-GCST003156-EFO_0002690.h.tsv.gz\",\n    md5_hash=\"bae52c67bcea4b8e4308eb6f0c45f924\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/ukbb_ppp/","title":"ukbb_ppp","text":""},{"location":"reference/mecfs_bio/assets/gwas/ukbb_ppp/#mecfs_bio.assets.gwas.ukbb_ppp","title":"mecfs_bio.assets.gwas.ukbb_ppp","text":"<p>Modules:</p> <ul> <li> <code>btn1a1</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/ukbb_ppp/btn1a1/","title":"btn1a1","text":""},{"location":"reference/mecfs_bio/assets/gwas/ukbb_ppp/btn1a1/#mecfs_bio.assets.gwas.ukbb_ppp.btn1a1","title":"mecfs_bio.assets.gwas.ukbb_ppp.btn1a1","text":"<p>Modules:</p> <ul> <li> <code>generator</code>           \u2013            </li> <li> <code>raw</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/ukbb_ppp/btn1a1/generator/","title":"generator","text":""},{"location":"reference/mecfs_bio/assets/gwas/ukbb_ppp/btn1a1/generator/#mecfs_bio.assets.gwas.ukbb_ppp.btn1a1.generator","title":"mecfs_bio.assets.gwas.ukbb_ppp.btn1a1.generator","text":"<p>Modules:</p> <ul> <li> <code>retrieve_and_process</code>           \u2013            <p>Download and preprocess data from the UK Biobank Pharma Proteomics Project GWAS of plasma BTN1A1</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/ukbb_ppp/btn1a1/generator/retrieve_and_process/","title":"retrieve_and_process","text":""},{"location":"reference/mecfs_bio/assets/gwas/ukbb_ppp/btn1a1/generator/retrieve_and_process/#mecfs_bio.assets.gwas.ukbb_ppp.btn1a1.generator.retrieve_and_process","title":"mecfs_bio.assets.gwas.ukbb_ppp.btn1a1.generator.retrieve_and_process","text":"<p>Download and preprocess data from the UK Biobank Pharma Proteomics Project GWAS of plasma BTN1A1</p> <p>Attributes:</p> <ul> <li> <code>BTN1A1_UKBB_PPP_GWAS_PROCESS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/gwas/ukbb_ppp/btn1a1/generator/retrieve_and_process/#mecfs_bio.assets.gwas.ukbb_ppp.btn1a1.generator.retrieve_and_process.BTN1A1_UKBB_PPP_GWAS_PROCESS","title":"BTN1A1_UKBB_PPP_GWAS_PROCESS  <code>module-attribute</code>","text":"<pre><code>BTN1A1_UKBB_PPP_GWAS_PROCESS = ubbb_ppp_gwas_prep(\n    gene_name=\"btn1a1\",\n    syn_id=\"syn52362950\",\n    expected_filename=\"BTN1A1_Q13410_OID31363_v1_Oncology_II.tar\",\n    region_to_plot_chrom=6,\n    region_to_plot_37_pos=26465384,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/gwas/ukbb_ppp/btn1a1/raw/","title":"raw","text":""},{"location":"reference/mecfs_bio/assets/gwas/ukbb_ppp/btn1a1/raw/#mecfs_bio.assets.gwas.ukbb_ppp.btn1a1.raw","title":"mecfs_bio.assets.gwas.ukbb_ppp.btn1a1.raw","text":""},{"location":"reference/mecfs_bio/assets/multi_gwas/","title":"multi_gwas","text":""},{"location":"reference/mecfs_bio/assets/multi_gwas/#mecfs_bio.assets.multi_gwas","title":"mecfs_bio.assets.multi_gwas","text":"<p>Modules:</p> <ul> <li> <code>genetic_correlation</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/multi_gwas/genetic_correlation/","title":"genetic_correlation","text":""},{"location":"reference/mecfs_bio/assets/multi_gwas/genetic_correlation/#mecfs_bio.assets.multi_gwas.genetic_correlation","title":"mecfs_bio.assets.multi_gwas.genetic_correlation","text":"<p>Modules:</p> <ul> <li> <code>ct_ldsc_initial_asset_generator</code>           \u2013            <p>Task generator to use cross-trait LD Score Regression to estimate genetic correlation between a several traits.</p> </li> <li> <code>ct_ldsc_plot</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/multi_gwas/genetic_correlation/ct_ldsc_initial_asset_generator/","title":"ct_ldsc_initial_asset_generator","text":""},{"location":"reference/mecfs_bio/assets/multi_gwas/genetic_correlation/ct_ldsc_initial_asset_generator/#mecfs_bio.assets.multi_gwas.genetic_correlation.ct_ldsc_initial_asset_generator","title":"mecfs_bio.assets.multi_gwas.genetic_correlation.ct_ldsc_initial_asset_generator","text":"<p>Task generator to use cross-trait LD Score Regression to estimate genetic correlation between a several traits. Each pair of traits is a Task.  This facilitates caching of results</p> <p>Attributes:</p> <ul> <li> <code>CT_LDSC_INITIAL_ASSET_GENERATOR</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/multi_gwas/genetic_correlation/ct_ldsc_initial_asset_generator/#mecfs_bio.assets.multi_gwas.genetic_correlation.ct_ldsc_initial_asset_generator.CT_LDSC_INITIAL_ASSET_GENERATOR","title":"CT_LDSC_INITIAL_ASSET_GENERATOR  <code>module-attribute</code>","text":"<pre><code>CT_LDSC_INITIAL_ASSET_GENERATOR = genetic_corr_by_ct_ldsc_asset_generator(\n    \"initial_rg\",\n    sources=[\n        SumstatsSource(\n            DECODEME_ME_SUMSTATS_37_WITH_ANNOVAR_RSID,\n            alias=\"DecodeME\",\n            pipe=SetColToConstantPipe(\n                GWASLAB_SAMPLE_SIZE_COLUMN, constant=275488\n            ),\n            sample_info=BinaryPhenotypeSampleInfo(\n                sample_prevalence=0.0566,\n                estimated_population_prevalence=0.006,\n            ),\n        ),\n        SumstatsSource(\n            sumstats_task,\n            alias=\"HR_recovery\",\n            pipe=SetColToConstantPipe(\n                GWASLAB_SAMPLE_SIZE_COLUMN, 58818\n            ),\n            sample_info=QuantPhenotype(),\n        ),\n        SumstatsSource(\n            sumstats_task,\n            alias=\"Multisite_pain\",\n            pipe=SetColToConstantPipe(\n                GWASLAB_SAMPLE_SIZE_COLUMN, constant=387649\n            ),\n            sample_info=QuantPhenotype(),\n        ),\n        SumstatsSource(\n            sumstats_task,\n            alias=\"Schizophrenia\",\n            pipe=SetColToConstantPipe(\n                GWASLAB_SAMPLE_SIZE_COLUMN, constant=130644\n            ),\n            sample_info=BinaryPhenotypeSampleInfo(\n                sample_prevalence=0.408,\n                estimated_population_prevalence=0.01,\n            ),\n        ),\n        SumstatsSource(\n            sumstats_task,\n            alias=\"Asthma\",\n            pipe=CompositePipe(\n                [\n                    SetColToConstantPipe(\n                        GWASLAB_SAMPLE_SIZE_COLUMN,\n                        constant=393859,\n                    ),\n                    ComputeBetaPipe(),\n                    ComputeSEPipe(),\n                ]\n            ),\n            sample_info=BinaryPhenotypeSampleInfo(\n                sample_prevalence=0.1638,\n                estimated_population_prevalence=0.117,\n            ),\n        ),\n        SumstatsSource(\n            sumstats_task,\n            alias=\"DBP\",\n            pipe=SetColToConstantPipe(\n                GWASLAB_SAMPLE_SIZE_COLUMN, 729882\n            ),\n            sample_info=QuantPhenotype(),\n        ),\n        SumstatsSource(\n            sumstats_task,\n            alias=\"Educational_attainment\",\n            pipe=SetColToConstantPipe(\n                GWASLAB_SAMPLE_SIZE_COLUMN, 257841\n            ),\n            sample_info=QuantPhenotype(),\n        ),\n        SumstatsSource(\n            LIU_ET_AL_SUMSTATS_WITH_RSID_FROM_SNP150,\n            alias=\"Inflammatory_bowel_disease\",\n            pipe=SetColToConstantPipe(\n                GWASLAB_SAMPLE_SIZE_COLUMN, 59957\n            ),\n            sample_info=BinaryPhenotypeSampleInfo(\n                sample_prevalence=0.4177,\n                estimated_population_prevalence=0.002,\n            ),\n        ),\n        SumstatsSource(\n            AEGISDOTTIR_SYNCOPE_LIFTOVER_SUMSTATS_HAPMAP3_DEDUP,\n            alias=\"Syncope\",\n            pipe=CompositePipe(\n                [\n                    SetColToConstantPipe(\n                        GWASLAB_SAMPLE_SIZE_COLUMN, 946861\n                    ),\n                    ComputeBetaIfNeededPipe(),\n                ]\n            ),\n            sample_info=BinaryPhenotypeSampleInfo(\n                sample_prevalence=56071 / 946861,\n                estimated_population_prevalence=0.3,\n            ),\n        ),\n    ],\n    ld_ref_task=THOUSAND_GENOME_EUR_LD_REFERENCE_DATA_V1_EXTRACTED,\n    build=\"19\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/multi_gwas/genetic_correlation/ct_ldsc_plot/","title":"ct_ldsc_plot","text":""},{"location":"reference/mecfs_bio/assets/multi_gwas/genetic_correlation/ct_ldsc_plot/#mecfs_bio.assets.multi_gwas.genetic_correlation.ct_ldsc_plot","title":"mecfs_bio.assets.multi_gwas.genetic_correlation.ct_ldsc_plot","text":"<p>Attributes:</p> <ul> <li> <code>CT_LDSC_INITIAL_PLOT</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/multi_gwas/genetic_correlation/ct_ldsc_plot/#mecfs_bio.assets.multi_gwas.genetic_correlation.ct_ldsc_plot.CT_LDSC_INITIAL_PLOT","title":"CT_LDSC_INITIAL_PLOT  <code>module-attribute</code>","text":"<pre><code>CT_LDSC_INITIAL_PLOT = create_std_with_clustering(\n    \"initial_genetic_correlation_by_ct_ldsc_plot\",\n    genetic_corr_source=GeneticCorrSource(\n        task=aggregation_task\n    ),\n    plot_options=RGWithAsterisk(color_scale=\"tropic\"),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/","title":"reference_data","text":""},{"location":"reference/mecfs_bio/assets/reference_data/#mecfs_bio.assets.reference_data","title":"mecfs_bio.assets.reference_data","text":"<p>Tasks to download and prepare reference data.</p> <p>Modules:</p> <ul> <li> <code>db_snp</code>           \u2013            </li> <li> <code>ensembl_biomart</code>           \u2013            <p>Reference data downloaded from Ensembl Biomart.</p> </li> <li> <code>gene_set_data</code>           \u2013            </li> <li> <code>human_brain_atlas</code>           \u2013            </li> <li> <code>linkage_disequilibrium_score_reference_data</code>           \u2013            </li> <li> <code>magma_gene_locations</code>           \u2013            </li> <li> <code>magma_ld_reference</code>           \u2013            </li> <li> <code>magma_specificity_matrices</code>           \u2013            </li> <li> <code>pqtls</code>           \u2013            </li> <li> <code>research_paper_supplementary_material</code>           \u2013            </li> <li> <code>rna_seq_data</code>           \u2013            </li> <li> <code>ukbb_ld_matrices</code>           \u2013            <p>Tasks for downloading LD matrices generated from UK Biobank data.</p> </li> <li> <code>ukbb_ppp_sumstats</code>           \u2013            </li> <li> <code>uniprot</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/","title":"db_snp","text":""},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/#mecfs_bio.assets.reference_data.db_snp","title":"mecfs_bio.assets.reference_data.db_snp","text":"<p>Modules:</p> <ul> <li> <code>db_sn150_build_37_annovar_proc_parquet</code>           \u2013            </li> <li> <code>db_sn150_build_37_annovar_proc_parquet_rename</code>           \u2013            <p>Task to rename the chromosomes in the annovar version of dbsnp 150 to match</p> </li> <li> <code>db_sn150_build_37_annovar_proc_parquet_rename_unique</code>           \u2013            <p>Task to deduplicate variants in the annovar version of dbSNP150</p> </li> <li> <code>db_snp150_build_37_annovar_proc</code>           \u2013            </li> <li> <code>db_snp_build_37_as_parquet</code>           \u2013            <p>Task to convert dbsnp to parquet form, to make subsequent steps more efficient.</p> </li> <li> <code>db_snp_build_37_as_parquet_unnest_ref</code>           \u2013            <p>unnest dbsnp in parquet form.</p> </li> <li> <code>db_snp_build_37_as_parquet_unnest_ref_sorted</code>           \u2013            </li> <li> <code>db_snp_vcf_file_for_rsid_assignment_build_37</code>           \u2013            </li> <li> <code>db_snp_vcf_file_with_index</code>           \u2013            <p>Task that downloads a vcf file containing the genome build 37 dbSNP reference database into a directory,</p> </li> <li> <code>snp151_build37_parquet</code>           \u2013            </li> <li> <code>snp151_build_37</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_sn150_build_37_annovar_proc_parquet/","title":"db_sn150_build_37_annovar_proc_parquet","text":""},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_sn150_build_37_annovar_proc_parquet/#mecfs_bio.assets.reference_data.db_snp.db_sn150_build_37_annovar_proc_parquet","title":"mecfs_bio.assets.reference_data.db_snp.db_sn150_build_37_annovar_proc_parquet","text":"<p>Attributes:</p> <ul> <li> <code>PARQUET_DBSNP150_37_ANNOVAR_PROC</code>           \u2013            </li> <li> <code>PARQUET_DBSNP150_37_ANNOVAR_PROC_NON_RD</code>           \u2013            </li> <li> <code>PARQUET_DBSNP150_37_ANNOVAR_PROC_RD</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_sn150_build_37_annovar_proc_parquet/#mecfs_bio.assets.reference_data.db_snp.db_sn150_build_37_annovar_proc_parquet.PARQUET_DBSNP150_37_ANNOVAR_PROC","title":"PARQUET_DBSNP150_37_ANNOVAR_PROC  <code>module-attribute</code>","text":"<pre><code>PARQUET_DBSNP150_37_ANNOVAR_PROC = create(\n    csv_task=DB_SNP150_ANNOVAR_PROC_RD,\n    asset_id=\"db_snp150_annovar_proc_parquet\",\n    source_compression=None,\n    type_dict={\"CHROM\": \"VARCHAR\"},\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_sn150_build_37_annovar_proc_parquet/#mecfs_bio.assets.reference_data.db_snp.db_sn150_build_37_annovar_proc_parquet.PARQUET_DBSNP150_37_ANNOVAR_PROC_NON_RD","title":"PARQUET_DBSNP150_37_ANNOVAR_PROC_NON_RD  <code>module-attribute</code>","text":"<pre><code>PARQUET_DBSNP150_37_ANNOVAR_PROC_NON_RD = create(\n    csv_task=DB_SNP150_ANNOVAR_PROC,\n    asset_id=\"db_snp150_annovar_proc_parquet\",\n    source_compression=None,\n    type_dict={\"CHROM\": \"VARCHAR\"},\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_sn150_build_37_annovar_proc_parquet/#mecfs_bio.assets.reference_data.db_snp.db_sn150_build_37_annovar_proc_parquet.PARQUET_DBSNP150_37_ANNOVAR_PROC_RD","title":"PARQUET_DBSNP150_37_ANNOVAR_PROC_RD  <code>module-attribute</code>","text":"<pre><code>PARQUET_DBSNP150_37_ANNOVAR_PROC_RD = DiscardDepsWrapper(\n    PARQUET_DBSNP150_37_ANNOVAR_PROC\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_sn150_build_37_annovar_proc_parquet_rename/","title":"db_sn150_build_37_annovar_proc_parquet_rename","text":""},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_sn150_build_37_annovar_proc_parquet_rename/#mecfs_bio.assets.reference_data.db_snp.db_sn150_build_37_annovar_proc_parquet_rename","title":"mecfs_bio.assets.reference_data.db_snp.db_sn150_build_37_annovar_proc_parquet_rename","text":"<p>Task to rename the chromosomes in the annovar version of dbsnp 150 to match those used by gwaslab</p> <p>Attributes:</p> <ul> <li> <code>PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME</code>           \u2013            </li> <li> <code>PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_NON_RD</code>           \u2013            </li> <li> <code>PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_RD</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_sn150_build_37_annovar_proc_parquet_rename/#mecfs_bio.assets.reference_data.db_snp.db_sn150_build_37_annovar_proc_parquet_rename.PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME","title":"PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME  <code>module-attribute</code>","text":"<pre><code>PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME = create(\n    asset_id=\"db_snp150_annovar_proc_parquet_rename\",\n    source_task=PARQUET_DBSNP150_37_ANNOVAR_PROC_RD,\n    pipes=[\n        JoinWithMemTablePipe(\n            CHROM_RENAME_DF_NUMERIC_X_Y_M,\n            keys_left=[\"CHROM\"],\n            keys_right=[\"CHROM\"],\n            backend=\"ibis\",\n        ),\n        SortPipe(by=[\"int_chrom\", \"POS\"]),\n    ],\n    out_format=ParquetOutFormat(),\n    backend=\"ibis\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_sn150_build_37_annovar_proc_parquet_rename/#mecfs_bio.assets.reference_data.db_snp.db_sn150_build_37_annovar_proc_parquet_rename.PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_NON_RD","title":"PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_NON_RD  <code>module-attribute</code>","text":"<pre><code>PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_NON_RD = create(\n    asset_id=\"db_snp150_annovar_proc_parquet_rename\",\n    source_task=PARQUET_DBSNP150_37_ANNOVAR_PROC_NON_RD,\n    pipes=[\n        JoinWithMemTablePipe(\n            CHROM_RENAME_DF_NUMERIC_X_Y_M,\n            keys_left=[\"CHROM\"],\n            keys_right=[\"CHROM\"],\n            backend=\"ibis\",\n        ),\n        SortPipe(by=[\"int_chrom\", \"POS\"]),\n    ],\n    out_format=ParquetOutFormat(),\n    backend=\"ibis\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_sn150_build_37_annovar_proc_parquet_rename/#mecfs_bio.assets.reference_data.db_snp.db_sn150_build_37_annovar_proc_parquet_rename.PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_RD","title":"PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_RD  <code>module-attribute</code>","text":"<pre><code>PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_RD = (\n    DiscardDepsWrapper(\n        PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_sn150_build_37_annovar_proc_parquet_rename_unique/","title":"db_sn150_build_37_annovar_proc_parquet_rename_unique","text":""},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_sn150_build_37_annovar_proc_parquet_rename_unique/#mecfs_bio.assets.reference_data.db_snp.db_sn150_build_37_annovar_proc_parquet_rename_unique","title":"mecfs_bio.assets.reference_data.db_snp.db_sn150_build_37_annovar_proc_parquet_rename_unique","text":"<p>Task to deduplicate variants in the annovar version of dbSNP150 This is necessary because dbSNP can contain multiple rsids that refer to the same genetic variant.</p> <p>The current deduplication strategy is just to take the largest rsid in the string ordering sense This is not optimal.</p> <p>The optimal choice is to select the rsid that will match what is expected by the downstream task. For example, if we are going to perform S-LDSC, for each variant we should choose the rsid that matches the one in the S-LDSC reference data.</p> <p>There are several versions of the Task below: - A base version (PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_UNIQUE_NON_RD) - A version that discards its dependencies to save space (PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_UNIQUE) - A version that directly downloads a previously computed parquet file (PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_UNIQUE_DIRECT_DOWNLOAD).  This was added to prevent CI machines from running out of disk space.</p> <p>Attributes:</p> <ul> <li> <code>PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_UNIQUE</code>           \u2013            </li> <li> <code>PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_UNIQUE_DIRECT_DOWNLOAD</code>           \u2013            </li> <li> <code>PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_UNIQUE_NON_RD</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_sn150_build_37_annovar_proc_parquet_rename_unique/#mecfs_bio.assets.reference_data.db_snp.db_sn150_build_37_annovar_proc_parquet_rename_unique.PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_UNIQUE","title":"PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_UNIQUE  <code>module-attribute</code>","text":"<pre><code>PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_UNIQUE = DiscardDepsWrapper(\n    create(\n        asset_id=\"db_snp150_annovar_proc_parquet_rename_unique\",\n        source_task=PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_RD,\n        pipes=[\n            DuckdbMemLimitPipe(limit_gb=4),\n            UniquePipe(\n                by=[\"int_chrom\", \"POS\", \"ALT\", \"REF\"],\n                keep=\"last\",\n                order_by=[\n                    \"int_chrom\",\n                    \"POS\",\n                    \"ALT\",\n                    \"REF\",\n                    \"rsid\",\n                ],\n            ),\n        ],\n        out_format=ParquetOutFormat(),\n        backend=\"duckdb\",\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_sn150_build_37_annovar_proc_parquet_rename_unique/#mecfs_bio.assets.reference_data.db_snp.db_sn150_build_37_annovar_proc_parquet_rename_unique.PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_UNIQUE_DIRECT_DOWNLOAD","title":"PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_UNIQUE_DIRECT_DOWNLOAD  <code>module-attribute</code>","text":"<pre><code>PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_UNIQUE_DIRECT_DOWNLOAD = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        group=\"db_snp_reference_data\",\n        sub_group=\"build_37\",\n        sub_folder=PurePath(\"annovar\"),\n        id=\"db_snp150_annovar_proc_parquet_unique_direct_download\",\n        filename=\"db_snp150_annovar_proc_parquet_unique_direct_download\",\n        extension=\".parquet\",\n        read_spec=DataFrameReadSpec(\n            DataFrameParquetFormat()\n        ),\n    ),\n    url=\"https://www.dropbox.com/scl/fi/6oglew7b7eh3zk0bn9gen/db_snp150_annovar_proc_parquet_rename_unique.parquet?rlkey=geuwlsha5icnthu3bxoyvchnm&amp;dl=1\",\n    md5_hash=\"1e990169a3ff48bae01f53cc69336be3\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_sn150_build_37_annovar_proc_parquet_rename_unique/#mecfs_bio.assets.reference_data.db_snp.db_sn150_build_37_annovar_proc_parquet_rename_unique.PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_UNIQUE_NON_RD","title":"PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_UNIQUE_NON_RD  <code>module-attribute</code>","text":"<pre><code>PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_UNIQUE_NON_RD = create(\n    asset_id=\"db_snp150_annovar_proc_parquet_rename_unique\",\n    source_task=PARQUET_DBSNP150_37_ANNOVAR_PROC_RENAME_NON_RD,\n    pipes=[\n        DuckdbMemLimitPipe(limit_gb=4),\n        UniquePipe(\n            by=[\"int_chrom\", \"POS\", \"ALT\", \"REF\"],\n            keep=\"last\",\n            order_by=[\n                \"int_chrom\",\n                \"POS\",\n                \"ALT\",\n                \"REF\",\n                \"rsid\",\n            ],\n        ),\n    ],\n    out_format=ParquetOutFormat(),\n    backend=\"duckdb\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_snp150_build_37_annovar_proc/","title":"db_snp150_build_37_annovar_proc","text":""},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_snp150_build_37_annovar_proc/#mecfs_bio.assets.reference_data.db_snp.db_snp150_build_37_annovar_proc","title":"mecfs_bio.assets.reference_data.db_snp.db_snp150_build_37_annovar_proc","text":"<p>Attributes:</p> <ul> <li> <code>DB_SNP150_ANNOVAR_PROC</code>           \u2013            </li> <li> <code>DB_SNP150_ANNOVAR_PROC_RD</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_snp150_build_37_annovar_proc/#mecfs_bio.assets.reference_data.db_snp.db_snp150_build_37_annovar_proc.DB_SNP150_ANNOVAR_PROC","title":"DB_SNP150_ANNOVAR_PROC  <code>module-attribute</code>","text":"<pre><code>DB_SNP150_ANNOVAR_PROC = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        group=\"db_snp_reference_data\",\n        sub_group=\"build_37\",\n        sub_folder=PurePath(\"annovar\"),\n        id=\"db_snp150_annovar_proc\",\n        filename=\"hg19_avsnp150\",\n        extension=\".txt\",\n        read_spec=DataFrameReadSpec(\n            DataFrameTextFormat(\n                separator=\"\\\\t\",\n                has_header=False,\n                column_names=[\n                    \"CHROM\",\n                    \"POS\",\n                    \"END\",\n                    \"REF\",\n                    \"ALT\",\n                    \"rsid\",\n                ],\n            )\n        ),\n    ),\n    url=\"https://www.dropbox.com/scl/fi/rvonq6jk3o88mtzc83mrn/hg19_avsnp150.txt?rlkey=gitowj4jrw2wjzbx2uyqi2xxp&amp;dl=1\",\n    md5_hash=\"c17e8f96e9b36041455069be9c459555\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_snp150_build_37_annovar_proc/#mecfs_bio.assets.reference_data.db_snp.db_snp150_build_37_annovar_proc.DB_SNP150_ANNOVAR_PROC_RD","title":"DB_SNP150_ANNOVAR_PROC_RD  <code>module-attribute</code>","text":"<pre><code>DB_SNP150_ANNOVAR_PROC_RD = DiscardDepsWrapper(\n    DB_SNP150_ANNOVAR_PROC\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_snp_build_37_as_parquet/","title":"db_snp_build_37_as_parquet","text":""},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_snp_build_37_as_parquet/#mecfs_bio.assets.reference_data.db_snp.db_snp_build_37_as_parquet","title":"mecfs_bio.assets.reference_data.db_snp.db_snp_build_37_as_parquet","text":"<p>Task to convert dbsnp to parquet form, to make subsequent steps more efficient.</p> <p>Attributes:</p> <ul> <li> <code>PARQUET_DBSNP_37</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_snp_build_37_as_parquet/#mecfs_bio.assets.reference_data.db_snp.db_snp_build_37_as_parquet.PARQUET_DBSNP_37","title":"PARQUET_DBSNP_37  <code>module-attribute</code>","text":"<pre><code>PARQUET_DBSNP_37 = create(\n    csv_task=DB_SNP_VCF_FILE_BUILD_37,\n    asset_id=\"db_snp_vcf_build_37_parquet\",\n    source_compression=\"gzip\",\n    select_list=[\"CHROM\", \"POS\", \"ID\", \"REF\", \"ALT\"],\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_snp_build_37_as_parquet_unnest_ref/","title":"db_snp_build_37_as_parquet_unnest_ref","text":""},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_snp_build_37_as_parquet_unnest_ref/#mecfs_bio.assets.reference_data.db_snp.db_snp_build_37_as_parquet_unnest_ref","title":"mecfs_bio.assets.reference_data.db_snp.db_snp_build_37_as_parquet_unnest_ref","text":"<p>unnest dbsnp in parquet form. In the original dbnsp file, there are rows with multiple alleles This operation breaks these into multiple rows, each with one allele.</p> <p>Attributes:</p> <ul> <li> <code>PARQUET_DBSNP_37_UNNESTED</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_snp_build_37_as_parquet_unnest_ref/#mecfs_bio.assets.reference_data.db_snp.db_snp_build_37_as_parquet_unnest_ref.PARQUET_DBSNP_37_UNNESTED","title":"PARQUET_DBSNP_37_UNNESTED  <code>module-attribute</code>","text":"<pre><code>PARQUET_DBSNP_37_UNNESTED = create(\n    source_task=PARQUET_DBSNP_37,\n    asset_id=\"db_snp_build_37_parquet_unnested\",\n    out_format=ParquetOutFormat(),\n    pipes=[\n        SplitColPipe(\n            col_to_split=\"ALT\",\n            split_by=\",\",\n            new_col_name=\"ALT\",\n        ),\n        UNNestPipe(col_to_unnest=\"ALT\"),\n        FilterRowsByValue(\n            target_column=\"CHROM\", valid_values=list(keys())\n        ),\n        JoinWithMemTablePipe(\n            mem_table=NC_CHROM_TABLE,\n            keys_left=[\"CHROM\"],\n            keys_right=[\"nc_chrom\"],\n        ),\n    ],\n    backend=\"polars\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_snp_build_37_as_parquet_unnest_ref_sorted/","title":"db_snp_build_37_as_parquet_unnest_ref_sorted","text":""},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_snp_build_37_as_parquet_unnest_ref_sorted/#mecfs_bio.assets.reference_data.db_snp.db_snp_build_37_as_parquet_unnest_ref_sorted","title":"mecfs_bio.assets.reference_data.db_snp.db_snp_build_37_as_parquet_unnest_ref_sorted","text":"<p>Attributes:</p> <ul> <li> <code>PARQUET_DBSNP_37_UNNESTED_SORTED</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_snp_build_37_as_parquet_unnest_ref_sorted/#mecfs_bio.assets.reference_data.db_snp.db_snp_build_37_as_parquet_unnest_ref_sorted.PARQUET_DBSNP_37_UNNESTED_SORTED","title":"PARQUET_DBSNP_37_UNNESTED_SORTED  <code>module-attribute</code>","text":"<pre><code>PARQUET_DBSNP_37_UNNESTED_SORTED = create(\n    source_task=PARQUET_DBSNP_37_UNNESTED,\n    asset_id=\"db_snp_build_37_parquet_unnested_sorted\",\n    out_format=ParquetOutFormat(),\n    pipes=[SortPipe(by=[\"int_chrom\", \"POS\"])],\n    backend=\"ibis\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_snp_vcf_file_for_rsid_assignment_build_37/","title":"db_snp_vcf_file_for_rsid_assignment_build_37","text":""},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_snp_vcf_file_for_rsid_assignment_build_37/#mecfs_bio.assets.reference_data.db_snp.db_snp_vcf_file_for_rsid_assignment_build_37","title":"mecfs_bio.assets.reference_data.db_snp.db_snp_vcf_file_for_rsid_assignment_build_37","text":"<p>Attributes:</p> <ul> <li> <code>DB_SNP_VCF_FILE_BUILD_37</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_snp_vcf_file_for_rsid_assignment_build_37/#mecfs_bio.assets.reference_data.db_snp.db_snp_vcf_file_for_rsid_assignment_build_37.DB_SNP_VCF_FILE_BUILD_37","title":"DB_SNP_VCF_FILE_BUILD_37  <code>module-attribute</code>","text":"<pre><code>DB_SNP_VCF_FILE_BUILD_37 = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        group=\"db_snp_reference_data\",\n        sub_group=\"build_37\",\n        sub_folder=PurePath(\"vcf\"),\n        id=\"db_snp_vcf_reference_file_build_37\",\n        filename=\"GCF_000001405.25\",\n        extension=\".gz\",\n        read_spec=DataFrameReadSpec(\n            DataFrameTextFormat(\n                separator=\"\\t\",\n                comment_char=\"#\",\n                has_header=False,\n                column_names=[\n                    \"CHROM\",\n                    \"POS\",\n                    \"ID\",\n                    \"REF\",\n                    \"ALT\",\n                    \"QUAL\",\n                    \"FILTER\",\n                    \"INFO\",\n                ],\n            )\n        ),\n    ),\n    url=\"https://ftp.ncbi.nih.gov/snp/latest_release/VCF/GCF_000001405.25.gz\",\n    md5_hash=\"35db22bcd166f904e4775dbbc29f5965\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_snp_vcf_file_with_index/","title":"db_snp_vcf_file_with_index","text":""},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_snp_vcf_file_with_index/#mecfs_bio.assets.reference_data.db_snp.db_snp_vcf_file_with_index","title":"mecfs_bio.assets.reference_data.db_snp.db_snp_vcf_file_with_index","text":"<p>Task that downloads a vcf file containing the genome build 37 dbSNP reference database into a directory, then indexes it using bcftools.</p> <p>Attributes:</p> <ul> <li> <code>DB_SNP_VCF_FILE_WITH_INDEX_BUILD_37_DIR</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/db_snp_vcf_file_with_index/#mecfs_bio.assets.reference_data.db_snp.db_snp_vcf_file_with_index.DB_SNP_VCF_FILE_WITH_INDEX_BUILD_37_DIR","title":"DB_SNP_VCF_FILE_WITH_INDEX_BUILD_37_DIR  <code>module-attribute</code>","text":"<pre><code>DB_SNP_VCF_FILE_WITH_INDEX_BUILD_37_DIR = DownloadFilesIntoDirectoryTask(\n    meta=ReferenceDataDirectoryMeta(\n        id=\"db_snp_build_37_with_index\",\n        group=\"db_snp_reference_data\",\n        sub_group=\"build_37\",\n        sub_folder=PurePath(\"vcf\"),\n    ),\n    entries=[\n        create_with_bcftools_index(\n            url=\"https://ftp.ncbi.nih.gov/snp/latest_release/VCF/GCF_000001405.25.gz\",\n            md5hash=\"35db22bcd166f904e4775dbbc29f5965\",\n            filename=\"GCF_000001405.25.gz\",\n        )\n    ],\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/snp151_build37_parquet/","title":"snp151_build37_parquet","text":""},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/snp151_build37_parquet/#mecfs_bio.assets.reference_data.db_snp.snp151_build37_parquet","title":"mecfs_bio.assets.reference_data.db_snp.snp151_build37_parquet","text":"<p>Attributes:</p> <ul> <li> <code>GENOME_ANNOTATION_DATABASE_BUILD_37_PARQUET</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/snp151_build37_parquet/#mecfs_bio.assets.reference_data.db_snp.snp151_build37_parquet.GENOME_ANNOTATION_DATABASE_BUILD_37_PARQUET","title":"GENOME_ANNOTATION_DATABASE_BUILD_37_PARQUET  <code>module-attribute</code>","text":"<pre><code>GENOME_ANNOTATION_DATABASE_BUILD_37_PARQUET = create(\n    csv_task=GENOME_ANNOTATION_DATABASE_BUILD_37,\n    asset_id=\"genome_annotation_database_build_37_as_parquet\",\n    source_compression=\"gzip\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/snp151_build_37/","title":"snp151_build_37","text":""},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/snp151_build_37/#mecfs_bio.assets.reference_data.db_snp.snp151_build_37","title":"mecfs_bio.assets.reference_data.db_snp.snp151_build_37","text":"<p>Attributes:</p> <ul> <li> <code>GENOME_ANNOTATION_DATABASE_BUILD_37</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/db_snp/snp151_build_37/#mecfs_bio.assets.reference_data.db_snp.snp151_build_37.GENOME_ANNOTATION_DATABASE_BUILD_37","title":"GENOME_ANNOTATION_DATABASE_BUILD_37  <code>module-attribute</code>","text":"<pre><code>GENOME_ANNOTATION_DATABASE_BUILD_37 = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        group=\"genome_annotations\",\n        sub_group=\"build_37\",\n        sub_folder=PurePath(\"raw\"),\n        id=\"genome_annotation_database_build_37\",\n        extension=\".gz\",\n        filename=\"snp151.txt\",\n        read_spec=DataFrameReadSpec(\n            format=DataFrameTextFormat(\n                separator=\"\\t\",\n                column_names=HG19_SNP151_SCHEMA,\n                has_header=False,\n            )\n        ),\n    ),\n    url=\"https://hgdownload.soe.ucsc.edu/goldenPath/hg19/database/snp151.txt.gz\",\n    md5_hash=None,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/ensembl_biomart/","title":"ensembl_biomart","text":""},{"location":"reference/mecfs_bio/assets/reference_data/ensembl_biomart/#mecfs_bio.assets.reference_data.ensembl_biomart","title":"mecfs_bio.assets.reference_data.ensembl_biomart","text":"<p>Reference data downloaded from Ensembl Biomart.</p> <p>Modules:</p> <ul> <li> <code>gene_thesaurus</code>           \u2013            <p>Download a table containing Ensembl IDs, Entrez IDs, Gene symbols, and gene descriptions</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/ensembl_biomart/gene_thesaurus/","title":"gene_thesaurus","text":""},{"location":"reference/mecfs_bio/assets/reference_data/ensembl_biomart/gene_thesaurus/#mecfs_bio.assets.reference_data.ensembl_biomart.gene_thesaurus","title":"mecfs_bio.assets.reference_data.ensembl_biomart.gene_thesaurus","text":"<p>Download a table containing Ensembl IDs, Entrez IDs, Gene symbols, and gene descriptions for all known human genes.</p> <p>Original source: Ensembl Biomart (https://useast.ensembl.org/info/data/biomart/index.html)</p> <p>Attributes:</p> <ul> <li> <code>GENE_THESAURUS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/ensembl_biomart/gene_thesaurus/#mecfs_bio.assets.reference_data.ensembl_biomart.gene_thesaurus.GENE_THESAURUS","title":"GENE_THESAURUS  <code>module-attribute</code>","text":"<pre><code>GENE_THESAURUS = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        group=\"nomeclature\",\n        sub_group=\"ensembl_biomart\",\n        sub_folder=PurePath(\"raw\"),\n        filename=\"biomart_thesaurus\",\n        extension=\".csv\",\n        id=AssetId(\"gene_thesaurus\"),\n        read_spec=DataFrameReadSpec(\n            DataFrameTextFormat(separator=\",\")\n        ),\n    ),\n    url=\"https://www.dropbox.com/scl/fi/9yamk0bze0f509p9opcnk/biomart_thesaurus.csv?rlkey=r9f4sedug2l3f6b5ak7hs88o2&amp;dl=1\",\n    md5_hash=\"cd1774041d88a4f27c9b77e491c23263\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/gene_set_data/","title":"gene_set_data","text":""},{"location":"reference/mecfs_bio/assets/reference_data/gene_set_data/#mecfs_bio.assets.reference_data.gene_set_data","title":"mecfs_bio.assets.reference_data.gene_set_data","text":"<p>Modules:</p> <ul> <li> <code>for_magma</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/gene_set_data/for_magma/","title":"for_magma","text":""},{"location":"reference/mecfs_bio/assets/reference_data/gene_set_data/for_magma/#mecfs_bio.assets.reference_data.gene_set_data.for_magma","title":"mecfs_bio.assets.reference_data.gene_set_data.for_magma","text":"<p>Modules:</p> <ul> <li> <code>from_fuma</code>           \u2013            </li> <li> <code>from_gsea_msigdb</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/gene_set_data/for_magma/from_fuma/","title":"from_fuma","text":""},{"location":"reference/mecfs_bio/assets/reference_data/gene_set_data/for_magma/from_fuma/#mecfs_bio.assets.reference_data.gene_set_data.for_magma.from_fuma","title":"mecfs_bio.assets.reference_data.gene_set_data.for_magma.from_fuma","text":"<p>Modules:</p> <ul> <li> <code>gtex_v8_tissue_type_gene_sets</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/gene_set_data/for_magma/from_fuma/gtex_v8_tissue_type_gene_sets/","title":"gtex_v8_tissue_type_gene_sets","text":""},{"location":"reference/mecfs_bio/assets/reference_data/gene_set_data/for_magma/from_fuma/gtex_v8_tissue_type_gene_sets/#mecfs_bio.assets.reference_data.gene_set_data.for_magma.from_fuma.gtex_v8_tissue_type_gene_sets","title":"mecfs_bio.assets.reference_data.gene_set_data.for_magma.from_fuma.gtex_v8_tissue_type_gene_sets","text":"<p>Attributes:</p> <ul> <li> <code>GTEx_V8_TISSUE_EXPRESSION_BASED_GENE_SET_DATA</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/gene_set_data/for_magma/from_fuma/gtex_v8_tissue_type_gene_sets/#mecfs_bio.assets.reference_data.gene_set_data.for_magma.from_fuma.gtex_v8_tissue_type_gene_sets.GTEx_V8_TISSUE_EXPRESSION_BASED_GENE_SET_DATA","title":"GTEx_V8_TISSUE_EXPRESSION_BASED_GENE_SET_DATA  <code>module-attribute</code>","text":"<pre><code>GTEx_V8_TISSUE_EXPRESSION_BASED_GENE_SET_DATA = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        group=\"gene_set_data\",\n        sub_group=\"fuma_gtex_human_data\",\n        sub_folder=PurePath(\"raw\"),\n        id=AssetId(\"gtex_v8_tissue_expression_data\"),\n        filename=\"gtex_v8_ts_DEG\",\n        extension=\".txt\",\n    ),\n    url=\"https://www.dropbox.com/scl/fi/qpsg0l5nw1sngy04otzcj/gtex_v8_ts_DEG.txt?rlkey=ku0ittmmkehyuldiqy8wvl22w&amp;dl=1\",\n    md5_hash=\"9e0ff40fcb2dec7603ff335efc352f24\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/gene_set_data/for_magma/from_gsea_msigdb/","title":"from_gsea_msigdb","text":""},{"location":"reference/mecfs_bio/assets/reference_data/gene_set_data/for_magma/from_gsea_msigdb/#mecfs_bio.assets.reference_data.gene_set_data.for_magma.from_gsea_msigdb","title":"mecfs_bio.assets.reference_data.gene_set_data.for_magma.from_gsea_msigdb","text":"<p>Modules:</p> <ul> <li> <code>gsea_entrez_human_gene_set_2025_v1</code>           \u2013            </li> <li> <code>gsea_entrez_human_gene_set_2025_v1_extracted</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/gene_set_data/for_magma/from_gsea_msigdb/gsea_entrez_human_gene_set_2025_v1/","title":"gsea_entrez_human_gene_set_2025_v1","text":""},{"location":"reference/mecfs_bio/assets/reference_data/gene_set_data/for_magma/from_gsea_msigdb/gsea_entrez_human_gene_set_2025_v1/#mecfs_bio.assets.reference_data.gene_set_data.for_magma.from_gsea_msigdb.gsea_entrez_human_gene_set_2025_v1","title":"mecfs_bio.assets.reference_data.gene_set_data.for_magma.from_gsea_msigdb.gsea_entrez_human_gene_set_2025_v1","text":"<p>Attributes:</p> <ul> <li> <code>GSEA_HUMAN_GENE_SET_2025_V1</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/gene_set_data/for_magma/from_gsea_msigdb/gsea_entrez_human_gene_set_2025_v1/#mecfs_bio.assets.reference_data.gene_set_data.for_magma.from_gsea_msigdb.gsea_entrez_human_gene_set_2025_v1.GSEA_HUMAN_GENE_SET_2025_V1","title":"GSEA_HUMAN_GENE_SET_2025_V1  <code>module-attribute</code>","text":"<pre><code>GSEA_HUMAN_GENE_SET_2025_V1 = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        group=\"gene_set_data\",\n        sub_group=\"gsea_human_data\",\n        sub_folder=PurePath(\"raw\"),\n        id=AssetId(\"gsea_human_data_2025_v1\"),\n        filename=\"msigdb_v2025.1\",\n        extension=\".zip\",\n    ),\n    url=\"https://www.dropbox.com/scl/fi/4902crqdai9pmleiid4q5/msigdb_v2025.1.Hs_files_to_download_locally.zip?rlkey=12ib2iy5pzwxs3eauli4h1gip&amp;st=iojgsqok&amp;dl=1\",\n    md5_hash=\"eef0cc56521fecb1f0949733d211b8d2\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/gene_set_data/for_magma/from_gsea_msigdb/gsea_entrez_human_gene_set_2025_v1_extracted/","title":"gsea_entrez_human_gene_set_2025_v1_extracted","text":""},{"location":"reference/mecfs_bio/assets/reference_data/gene_set_data/for_magma/from_gsea_msigdb/gsea_entrez_human_gene_set_2025_v1_extracted/#mecfs_bio.assets.reference_data.gene_set_data.for_magma.from_gsea_msigdb.gsea_entrez_human_gene_set_2025_v1_extracted","title":"mecfs_bio.assets.reference_data.gene_set_data.for_magma.from_gsea_msigdb.gsea_entrez_human_gene_set_2025_v1_extracted","text":"<p>Attributes:</p> <ul> <li> <code>GSEA_HUMAN_GENE_SET_2025_V1_EXTRACTED</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/gene_set_data/for_magma/from_gsea_msigdb/gsea_entrez_human_gene_set_2025_v1_extracted/#mecfs_bio.assets.reference_data.gene_set_data.for_magma.from_gsea_msigdb.gsea_entrez_human_gene_set_2025_v1_extracted.GSEA_HUMAN_GENE_SET_2025_V1_EXTRACTED","title":"GSEA_HUMAN_GENE_SET_2025_V1_EXTRACTED  <code>module-attribute</code>","text":"<pre><code>GSEA_HUMAN_GENE_SET_2025_V1_EXTRACTED = (\n    create_from_zipped_reference_file(\n        source_task=GSEA_HUMAN_GENE_SET_2025_V1,\n        asset_id=\"gsea_human_data_2025_v1_extracted\",\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/human_brain_atlas/","title":"human_brain_atlas","text":""},{"location":"reference/mecfs_bio/assets/reference_data/human_brain_atlas/#mecfs_bio.assets.reference_data.human_brain_atlas","title":"mecfs_bio.assets.reference_data.human_brain_atlas","text":"<p>Modules:</p> <ul> <li> <code>raw</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/human_brain_atlas/raw/","title":"raw","text":""},{"location":"reference/mecfs_bio/assets/reference_data/human_brain_atlas/raw/#mecfs_bio.assets.reference_data.human_brain_atlas.raw","title":"mecfs_bio.assets.reference_data.human_brain_atlas.raw","text":"<p>Modules:</p> <ul> <li> <code>cluster_annotation_term_metadata</code>           \u2013            <p>Task to fetch some metadata from the human brain atlas.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/human_brain_atlas/raw/cluster_annotation_term_metadata/","title":"cluster_annotation_term_metadata","text":""},{"location":"reference/mecfs_bio/assets/reference_data/human_brain_atlas/raw/cluster_annotation_term_metadata/#mecfs_bio.assets.reference_data.human_brain_atlas.raw.cluster_annotation_term_metadata","title":"mecfs_bio.assets.reference_data.human_brain_atlas.raw.cluster_annotation_term_metadata","text":"<p>Task to fetch some metadata from the human brain atlas.</p> <p>Attributes:</p> <ul> <li> <code>CLUSTER_ANNOTATION_TERM_METADATA</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/human_brain_atlas/raw/cluster_annotation_term_metadata/#mecfs_bio.assets.reference_data.human_brain_atlas.raw.cluster_annotation_term_metadata.CLUSTER_ANNOTATION_TERM_METADATA","title":"CLUSTER_ANNOTATION_TERM_METADATA  <code>module-attribute</code>","text":"<pre><code>CLUSTER_ANNOTATION_TERM_METADATA = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        group=\"human_brain_atlas\",\n        sub_group=\"metadata\",\n        sub_folder=PurePath(\"raw\"),\n        id=AssetId(\n            \"human_brain_atlas_cluster_annotation_Term_metadata\"\n        ),\n        filename=\"cluster_annotation_term\",\n        extension=\".csv\",\n        read_spec=DataFrameReadSpec(\n            DataFrameTextFormat(separator=\",\")\n        ),\n    ),\n    url=\"https://allen-brain-cell-atlas.s3-us-west-2.amazonaws.com/metadata/WHB-taxonomy/20240330/cluster_annotation_term.csv\",\n    md5_hash=\"2533ac1498b35a1ce386a3d97137e9c3\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/","title":"linkage_disequilibrium_score_reference_data","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data","text":"<p>Modules:</p> <ul> <li> <code>custom</code>           \u2013            </li> <li> <code>extracted</code>           \u2013            </li> <li> <code>from_papers</code>           \u2013            </li> <li> <code>raw</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/custom/","title":"custom","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/custom/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.custom","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.custom","text":"<p>Modules:</p> <ul> <li> <code>roadmap_cell_type_categorization</code>           \u2013            <p>Categories for tissue and cell types from the roadmap project used in Finucane et al.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/custom/roadmap_cell_type_categorization/","title":"roadmap_cell_type_categorization","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/custom/roadmap_cell_type_categorization/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.custom.roadmap_cell_type_categorization","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.custom.roadmap_cell_type_categorization","text":"<p>Categories for tissue and cell types from the roadmap project used in Finucane et al.</p> <p>source: My judgement</p> <p>Attributes:</p> <ul> <li> <code>ROADMAP_CELL_TYPE_CATEGORIES_FOR_LDSC</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/custom/roadmap_cell_type_categorization/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.custom.roadmap_cell_type_categorization.ROADMAP_CELL_TYPE_CATEGORIES_FOR_LDSC","title":"ROADMAP_CELL_TYPE_CATEGORIES_FOR_LDSC  <code>module-attribute</code>","text":"<pre><code>ROADMAP_CELL_TYPE_CATEGORIES_FOR_LDSC = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        id=\"roadmap_tissue_type_categories\",\n        group=\"linkage_disequilibrium_score_regression_aux_data\",\n        sub_group=\"custom_data\",\n        sub_folder=PurePath(\"roadmap_categories\"),\n        filename=\"roadmap_cell_type_categories\",\n        extension=\".csv\",\n        read_spec=DataFrameReadSpec(\n            DataFrameTextFormat(separator=\",\")\n        ),\n    ),\n    url=\"https://www.dropbox.com/scl/fi/cz1yty9sj8vsqnddarpqb/cell_type_series_categorized.csv?rlkey=upn71pljutjywj7dz3fyb785e&amp;st=azq3dty6&amp;dl=1\",\n    md5_hash=\"b42baf62ad56d75a0213d39f64c177e7\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/","title":"extracted","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted","text":"<p>Modules:</p> <ul> <li> <code>eur_ld_scores_thousand_genome_phase_3_v1_extracted</code>           \u2013            </li> <li> <code>partitioned_model_cahoy_ld_scores_extracted</code>           \u2013            </li> <li> <code>partitioned_model_corces_atac_ld_scores_extracted</code>           \u2013            </li> <li> <code>partitioned_model_gtex_brain_ld_scores_extracted</code>           \u2013            </li> <li> <code>partitioned_model_immgen_ld_scores_extracted</code>           \u2013            </li> <li> <code>partitioned_model_multi_tissue_chromatin_ld_scores_extracted</code>           \u2013            </li> <li> <code>partitioned_model_multi_tissue_gene_expr_ld_score_extracted</code>           \u2013            </li> <li> <code>partitioned_model_regression_weights_extracted</code>           \u2013            </li> <li> <code>thousand_genome_baseline_ld_extracted</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/eur_ld_scores_thousand_genome_phase_3_v1_extracted/","title":"eur_ld_scores_thousand_genome_phase_3_v1_extracted","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/eur_ld_scores_thousand_genome_phase_3_v1_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.eur_ld_scores_thousand_genome_phase_3_v1_extracted","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.eur_ld_scores_thousand_genome_phase_3_v1_extracted","text":"<p>Attributes:</p> <ul> <li> <code>THOUSAND_GENOME_EUR_LD_REFERENCE_DATA_V1_EXTRACTED</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/eur_ld_scores_thousand_genome_phase_3_v1_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.eur_ld_scores_thousand_genome_phase_3_v1_extracted.THOUSAND_GENOME_EUR_LD_REFERENCE_DATA_V1_EXTRACTED","title":"THOUSAND_GENOME_EUR_LD_REFERENCE_DATA_V1_EXTRACTED  <code>module-attribute</code>","text":"<pre><code>THOUSAND_GENOME_EUR_LD_REFERENCE_DATA_V1_EXTRACTED = create(\n    asset_id=\"thousand_genomes_phase_3_v1_eur_ld_scores_extracted\",\n    source_task=THOUSAND_GENOME_EUR_LD_REFERENCE_DATA_V1_RAW,\n    sub_folder_name_inside_tar=\"LDscore\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_cahoy_ld_scores_extracted/","title":"partitioned_model_cahoy_ld_scores_extracted","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_cahoy_ld_scores_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_cahoy_ld_scores_extracted","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_cahoy_ld_scores_extracted","text":"<p>Attributes:</p> <ul> <li> <code>PARTITIONED_MODEL_CAHOY_LD_SCORES_EXTRACTED</code>           \u2013            </li> <li> <code>PARTITIONED_MODEL_CAHOY_LD_SCORES_EXTRACTED_RD</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_cahoy_ld_scores_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_cahoy_ld_scores_extracted.PARTITIONED_MODEL_CAHOY_LD_SCORES_EXTRACTED","title":"PARTITIONED_MODEL_CAHOY_LD_SCORES_EXTRACTED  <code>module-attribute</code>","text":"<pre><code>PARTITIONED_MODEL_CAHOY_LD_SCORES_EXTRACTED = create(\n    asset_id=\"partitioned_model_cahoy_ld_scores_extracted\",\n    source_task=PARTITIONED_MODEL_CAHOY_LD_SCORES_RAW,\n    read_mode=\"r\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_cahoy_ld_scores_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_cahoy_ld_scores_extracted.PARTITIONED_MODEL_CAHOY_LD_SCORES_EXTRACTED_RD","title":"PARTITIONED_MODEL_CAHOY_LD_SCORES_EXTRACTED_RD  <code>module-attribute</code>","text":"<pre><code>PARTITIONED_MODEL_CAHOY_LD_SCORES_EXTRACTED_RD = (\n    DiscardDepsWrapper(\n        PARTITIONED_MODEL_CAHOY_LD_SCORES_EXTRACTED\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_corces_atac_ld_scores_extracted/","title":"partitioned_model_corces_atac_ld_scores_extracted","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_corces_atac_ld_scores_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_corces_atac_ld_scores_extracted","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_corces_atac_ld_scores_extracted","text":"<p>Attributes:</p> <ul> <li> <code>PARTITIONED_MODEL_CORCES_ATAC_LD_SCORES_EXTRACTED</code>           \u2013            </li> <li> <code>PARTITIONED_MODEL_CORCES_ATAC_LD_SCORES_EXTRACTED_RD</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_corces_atac_ld_scores_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_corces_atac_ld_scores_extracted.PARTITIONED_MODEL_CORCES_ATAC_LD_SCORES_EXTRACTED","title":"PARTITIONED_MODEL_CORCES_ATAC_LD_SCORES_EXTRACTED  <code>module-attribute</code>","text":"<pre><code>PARTITIONED_MODEL_CORCES_ATAC_LD_SCORES_EXTRACTED = create(\n    asset_id=\"partitioned_model_corces_atac_ld_scores_extracted\",\n    source_task=PARTITIONED_MODEL_CORCES_ATAC_LD_SCORES_RAW,\n    read_mode=\"r\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_corces_atac_ld_scores_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_corces_atac_ld_scores_extracted.PARTITIONED_MODEL_CORCES_ATAC_LD_SCORES_EXTRACTED_RD","title":"PARTITIONED_MODEL_CORCES_ATAC_LD_SCORES_EXTRACTED_RD  <code>module-attribute</code>","text":"<pre><code>PARTITIONED_MODEL_CORCES_ATAC_LD_SCORES_EXTRACTED_RD = (\n    DiscardDepsWrapper(\n        PARTITIONED_MODEL_CORCES_ATAC_LD_SCORES_EXTRACTED\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_gtex_brain_ld_scores_extracted/","title":"partitioned_model_gtex_brain_ld_scores_extracted","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_gtex_brain_ld_scores_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_gtex_brain_ld_scores_extracted","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_gtex_brain_ld_scores_extracted","text":"<p>Attributes:</p> <ul> <li> <code>PARTITIONED_MODEL_GTEX_BRAIN_LD_SCORES_EXTRACTED</code>           \u2013            </li> <li> <code>PARTITIONED_MODEL_GTEX_BRAIN_LD_SCORES_EXTRACTED_RD</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_gtex_brain_ld_scores_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_gtex_brain_ld_scores_extracted.PARTITIONED_MODEL_GTEX_BRAIN_LD_SCORES_EXTRACTED","title":"PARTITIONED_MODEL_GTEX_BRAIN_LD_SCORES_EXTRACTED  <code>module-attribute</code>","text":"<pre><code>PARTITIONED_MODEL_GTEX_BRAIN_LD_SCORES_EXTRACTED = create(\n    asset_id=\"partitioned_model_gtex_brain_ld_scores_extracted\",\n    source_task=PARTITIONED_MODEL_GTEX_BRAIN_LD_SCORES_RAW,\n    read_mode=\"r\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_gtex_brain_ld_scores_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_gtex_brain_ld_scores_extracted.PARTITIONED_MODEL_GTEX_BRAIN_LD_SCORES_EXTRACTED_RD","title":"PARTITIONED_MODEL_GTEX_BRAIN_LD_SCORES_EXTRACTED_RD  <code>module-attribute</code>","text":"<pre><code>PARTITIONED_MODEL_GTEX_BRAIN_LD_SCORES_EXTRACTED_RD = (\n    DiscardDepsWrapper(\n        PARTITIONED_MODEL_GTEX_BRAIN_LD_SCORES_EXTRACTED\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_immgen_ld_scores_extracted/","title":"partitioned_model_immgen_ld_scores_extracted","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_immgen_ld_scores_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_immgen_ld_scores_extracted","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_immgen_ld_scores_extracted","text":"<p>Attributes:</p> <ul> <li> <code>PARTITIONED_MODEL_IMMGEN_LD_SCORES_EXTRACTED</code>           \u2013            </li> <li> <code>PARTITIONED_MODEL_IMMGEN_LD_SCORES_EXTRACTED_RD</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_immgen_ld_scores_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_immgen_ld_scores_extracted.PARTITIONED_MODEL_IMMGEN_LD_SCORES_EXTRACTED","title":"PARTITIONED_MODEL_IMMGEN_LD_SCORES_EXTRACTED  <code>module-attribute</code>","text":"<pre><code>PARTITIONED_MODEL_IMMGEN_LD_SCORES_EXTRACTED = create(\n    asset_id=\"partitioned_model_immgen_ld_scores_extracted\",\n    source_task=PARTITIONED_MODEL_IMMGEN_LD_SCORES_RAW,\n    read_mode=\"r\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_immgen_ld_scores_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_immgen_ld_scores_extracted.PARTITIONED_MODEL_IMMGEN_LD_SCORES_EXTRACTED_RD","title":"PARTITIONED_MODEL_IMMGEN_LD_SCORES_EXTRACTED_RD  <code>module-attribute</code>","text":"<pre><code>PARTITIONED_MODEL_IMMGEN_LD_SCORES_EXTRACTED_RD = (\n    DiscardDepsWrapper(\n        PARTITIONED_MODEL_IMMGEN_LD_SCORES_EXTRACTED\n    )\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_multi_tissue_chromatin_ld_scores_extracted/","title":"partitioned_model_multi_tissue_chromatin_ld_scores_extracted","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_multi_tissue_chromatin_ld_scores_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_multi_tissue_chromatin_ld_scores_extracted","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_multi_tissue_chromatin_ld_scores_extracted","text":"<p>Attributes:</p> <ul> <li> <code>PARTITIONED_MODEL_MULTI_TISSUE_CHROMATIN_LD_SCORES_EXTRACTED</code>           \u2013            </li> <li> <code>PARTITIONED_MODEL_MULTI_TISSUE_CHROMATIN_LD_SCORES_EXTRACTED_RD</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_multi_tissue_chromatin_ld_scores_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_multi_tissue_chromatin_ld_scores_extracted.PARTITIONED_MODEL_MULTI_TISSUE_CHROMATIN_LD_SCORES_EXTRACTED","title":"PARTITIONED_MODEL_MULTI_TISSUE_CHROMATIN_LD_SCORES_EXTRACTED  <code>module-attribute</code>","text":"<pre><code>PARTITIONED_MODEL_MULTI_TISSUE_CHROMATIN_LD_SCORES_EXTRACTED = create(\n    asset_id=\"partitioned_model_multi_tissue_chromatin_ld_scores_extracted\",\n    source_task=PARTITIONED_MODEL_MULTI_TISSUE_CHROMATIN_LD_SCORES_RAW,\n    read_mode=\"r\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_multi_tissue_chromatin_ld_scores_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_multi_tissue_chromatin_ld_scores_extracted.PARTITIONED_MODEL_MULTI_TISSUE_CHROMATIN_LD_SCORES_EXTRACTED_RD","title":"PARTITIONED_MODEL_MULTI_TISSUE_CHROMATIN_LD_SCORES_EXTRACTED_RD  <code>module-attribute</code>","text":"<pre><code>PARTITIONED_MODEL_MULTI_TISSUE_CHROMATIN_LD_SCORES_EXTRACTED_RD = DiscardDepsWrapper(\n    PARTITIONED_MODEL_MULTI_TISSUE_CHROMATIN_LD_SCORES_EXTRACTED\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_multi_tissue_gene_expr_ld_score_extracted/","title":"partitioned_model_multi_tissue_gene_expr_ld_score_extracted","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_multi_tissue_gene_expr_ld_score_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_multi_tissue_gene_expr_ld_score_extracted","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_multi_tissue_gene_expr_ld_score_extracted","text":"<p>Attributes:</p> <ul> <li> <code>PARTITIONED_MODEL_MULTI_TISSUE_GENE_EXPR_LD_SCORES_EXTRACTED</code>           \u2013            </li> <li> <code>PARTITIONED_MODEL_MULTI_TISSUE_GENE_EXPR_LD_SCORES_EXTRACTED_RD</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_multi_tissue_gene_expr_ld_score_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_multi_tissue_gene_expr_ld_score_extracted.PARTITIONED_MODEL_MULTI_TISSUE_GENE_EXPR_LD_SCORES_EXTRACTED","title":"PARTITIONED_MODEL_MULTI_TISSUE_GENE_EXPR_LD_SCORES_EXTRACTED  <code>module-attribute</code>","text":"<pre><code>PARTITIONED_MODEL_MULTI_TISSUE_GENE_EXPR_LD_SCORES_EXTRACTED = create(\n    asset_id=\"multi_tissue_gene_expression_partitioned_ld_scores_extracted\",\n    source_task=THOUSAND_GENOME_PARTITIONED_MODEL_MULTI_TISSUE_GENE_EXPR_LD_SCORES_RAW,\n    read_mode=\"r\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_multi_tissue_gene_expr_ld_score_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_multi_tissue_gene_expr_ld_score_extracted.PARTITIONED_MODEL_MULTI_TISSUE_GENE_EXPR_LD_SCORES_EXTRACTED_RD","title":"PARTITIONED_MODEL_MULTI_TISSUE_GENE_EXPR_LD_SCORES_EXTRACTED_RD  <code>module-attribute</code>","text":"<pre><code>PARTITIONED_MODEL_MULTI_TISSUE_GENE_EXPR_LD_SCORES_EXTRACTED_RD = DiscardDepsWrapper(\n    PARTITIONED_MODEL_MULTI_TISSUE_GENE_EXPR_LD_SCORES_EXTRACTED\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_regression_weights_extracted/","title":"partitioned_model_regression_weights_extracted","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_regression_weights_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_regression_weights_extracted","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_regression_weights_extracted","text":"<p>Attributes:</p> <ul> <li> <code>PARTITIONED_MODEL_REGRESSION_WEIGHTS_EXTRACTED</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/partitioned_model_regression_weights_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.partitioned_model_regression_weights_extracted.PARTITIONED_MODEL_REGRESSION_WEIGHTS_EXTRACTED","title":"PARTITIONED_MODEL_REGRESSION_WEIGHTS_EXTRACTED  <code>module-attribute</code>","text":"<pre><code>PARTITIONED_MODEL_REGRESSION_WEIGHTS_EXTRACTED = create(\n    asset_id=\"s_ldsc_hapmap3_regression_weights_extracted\",\n    source_task=HM3_LD_SCORE_REGRESSION_WEIGHTS,\n    read_mode=\"r\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/thousand_genome_baseline_ld_extracted/","title":"thousand_genome_baseline_ld_extracted","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/thousand_genome_baseline_ld_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.thousand_genome_baseline_ld_extracted","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.thousand_genome_baseline_ld_extracted","text":"<p>Attributes:</p> <ul> <li> <code>BASE_MODEL_PARTITIONED_LD_SCORES_EXTRACTED</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/extracted/thousand_genome_baseline_ld_extracted/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.extracted.thousand_genome_baseline_ld_extracted.BASE_MODEL_PARTITIONED_LD_SCORES_EXTRACTED","title":"BASE_MODEL_PARTITIONED_LD_SCORES_EXTRACTED  <code>module-attribute</code>","text":"<pre><code>BASE_MODEL_PARTITIONED_LD_SCORES_EXTRACTED = create(\n    asset_id=\"base_model_partitioned_ld_scores_extracted\",\n    source_task=THOUSAND_GENOME_BASE_MODEL_PARTITIONED_LD_SCORES,\n    read_mode=\"r\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/from_papers/","title":"from_papers","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/from_papers/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.from_papers","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.from_papers","text":"<p>Modules:</p> <ul> <li> <code>finucane_2018_franke_gtex_categories</code>           \u2013            <p>Categories for tissue and cell types from the GTEx and Franke lab datasets</p> </li> <li> <code>finucane_2018_immgen_categories</code>           \u2013            <p>Categories for mouse immune cell types from the Immgen project</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/from_papers/finucane_2018_franke_gtex_categories/","title":"finucane_2018_franke_gtex_categories","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/from_papers/finucane_2018_franke_gtex_categories/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.from_papers.finucane_2018_franke_gtex_categories","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.from_papers.finucane_2018_franke_gtex_categories","text":"<p>Categories for tissue and cell types from the GTEx and Franke lab datasets</p> <p>source: Supplementary material to Finucane, Hilary K., et al. \"Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types.\" Nature genetics 50.4 (2018): 621-629.</p> <p>Attributes:</p> <ul> <li> <code>FICUANE_2018_FRANKE_GTEX_CATEGORIES</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/from_papers/finucane_2018_franke_gtex_categories/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.from_papers.finucane_2018_franke_gtex_categories.FICUANE_2018_FRANKE_GTEX_CATEGORIES","title":"FICUANE_2018_FRANKE_GTEX_CATEGORIES  <code>module-attribute</code>","text":"<pre><code>FICUANE_2018_FRANKE_GTEX_CATEGORIES = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        id=\"ficuane_2018_combined_gtex_franke_categories\",\n        group=\"linkage_disequilibrium_score_regression_aux_data\",\n        sub_group=\"data_from_papers\",\n        sub_folder=PurePath(\"ficuane_2018\"),\n        filename=\"ficuane_2018_combined_gtex_franke_categories.csv\",\n        extension=\".csv\",\n        read_spec=DataFrameReadSpec(\n            DataFrameTextFormat(separator=\",\")\n        ),\n    ),\n    url=\"https://www.dropbox.com/scl/fi/2cr5ipddzkde6rj33tcxk/Finucane_2018_combined_gtex_franke.csv?rlkey=w5knnradpjugl2l1orml9j0g9&amp;dl=1\",\n    md5_hash=\"3f121ae8936e380828a14dc76c2fd309\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/from_papers/finucane_2018_immgen_categories/","title":"finucane_2018_immgen_categories","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/from_papers/finucane_2018_immgen_categories/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.from_papers.finucane_2018_immgen_categories","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.from_papers.finucane_2018_immgen_categories","text":"<p>Categories for mouse immune cell types from the Immgen project</p> <p>source: Supplementary Table 10 in Finucane, Hilary K., et al. \"Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types.\" Nature genetics 50.4 (2018): 621-629.</p> <p>Attributes:</p> <ul> <li> <code>FICUANE_2018_IMMGEN_CATEGORIES</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/from_papers/finucane_2018_immgen_categories/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.from_papers.finucane_2018_immgen_categories.FICUANE_2018_IMMGEN_CATEGORIES","title":"FICUANE_2018_IMMGEN_CATEGORIES  <code>module-attribute</code>","text":"<pre><code>FICUANE_2018_IMMGEN_CATEGORIES = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        id=\"ficuane_2018_immgen_categories\",\n        group=\"linkage_disequilibrium_score_regression_aux_data\",\n        sub_group=\"data_from_papers\",\n        sub_folder=PurePath(\"ficuane_2018\"),\n        filename=\"ficuane_2018_immgen_categories.csv\",\n        extension=\".csv\",\n        read_spec=DataFrameReadSpec(\n            DataFrameTextFormat(separator=\",\")\n        ),\n    ),\n    url=\"https://www.dropbox.com/scl/fi/587e0eypohr2azdlt0x54/Finucane_2018_Immgen_categories.csv?rlkey=nmjm7nrrpinqpm78q9wrbfft0&amp;dl=1\",\n    md5_hash=\"6a1d3c65ace87be0be6f56bd493eb3db\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/","title":"raw","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw","text":"<p>Modules:</p> <ul> <li> <code>eur_ld_scores_thousand_genome_phase_3_v1_raw</code>           \u2013            </li> <li> <code>partitioned_model_allele_freq</code>           \u2013            <p>This is allele frequency reference data for use with S-LDSC.</p> </li> <li> <code>partitioned_model_baseline_ld_scores</code>           \u2013            <p>This is one of the reference datasets from the Stratified Linkage Disequilibrium Score Regression Paper.</p> </li> <li> <code>partitioned_model_cahoy_ld_scores</code>           \u2013            <p>This is a dataset of partitioned LD scores associated with brain cell types.</p> </li> <li> <code>partitioned_model_corces_atac</code>           \u2013            <p>Partitioned LD scores associated from ATAC Seq of immunological cell types.</p> </li> <li> <code>partitioned_model_gtex_brain_ld_scores</code>           \u2013            <p>Partitioned LD scores associated from brain tissue types.</p> </li> <li> <code>partitioned_model_immgen_ld_scores</code>           \u2013            <p>Partitioned LD scores associated from immunological cell types.</p> </li> <li> <code>partitioned_model_multi_tissue_chromatin_ld_scores</code>           \u2013            <p>Tissue-specific LD scores for use with S-LDSC</p> </li> <li> <code>partitioned_model_multi_tissue_gene_expr_ld_scores</code>           \u2013            <p>Tissue-specific LD scores for use with S-LDSC</p> </li> <li> <code>partitioned_model_regression_weights</code>           \u2013            <p>This is one of the reference datasets from the Stratified Linkage Disequilibrium Score Regression Paper.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/eur_ld_scores_thousand_genome_phase_3_v1_raw/","title":"eur_ld_scores_thousand_genome_phase_3_v1_raw","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/eur_ld_scores_thousand_genome_phase_3_v1_raw/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.eur_ld_scores_thousand_genome_phase_3_v1_raw","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.eur_ld_scores_thousand_genome_phase_3_v1_raw","text":"<p>Attributes:</p> <ul> <li> <code>THOUSAND_GENOME_EUR_LD_REFERENCE_DATA_V1_RAW</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/eur_ld_scores_thousand_genome_phase_3_v1_raw/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.eur_ld_scores_thousand_genome_phase_3_v1_raw.THOUSAND_GENOME_EUR_LD_REFERENCE_DATA_V1_RAW","title":"THOUSAND_GENOME_EUR_LD_REFERENCE_DATA_V1_RAW  <code>module-attribute</code>","text":"<pre><code>THOUSAND_GENOME_EUR_LD_REFERENCE_DATA_V1_RAW = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        id=\"thousand_genomes_phase_3_v1_eur_ld_scores_tar_gzip\",\n        group=\"linkage_disequilibrium_scores\",\n        sub_group=\"thousand_genomes_phase_3_v1\",\n        sub_folder=PurePath(\"raw\"),\n        extension=\".tar.gz\",\n    ),\n    url=\"https://zenodo.org/records/7768714/files/1000G_Phase3_ldscores.tgz?download=1\",\n    md5_hash=\"e4352ccf778f296835d73985350a863b\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_allele_freq/","title":"partitioned_model_allele_freq","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_allele_freq/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_allele_freq","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_allele_freq","text":"<p>This is allele frequency reference data for use with S-LDSC. See: https://github.com/bulik/ldsc/wiki/Partitioned-Heritability and Finucane, Hilary K., et al. \"Partitioning heritability by functional annotation using genome-wide association summary statistics.\" Nature genetics 47.11 (2015): 1228-1235.</p> <p>Data is officially located at : https://console.cloud.google.com/storage/browser/broad-alkesgroup-public-requester-pays</p> <p>Attributes:</p> <ul> <li> <code>LD_SCORE_REGRESSION_ALLELE_FREQS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_allele_freq/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_allele_freq.LD_SCORE_REGRESSION_ALLELE_FREQS","title":"LD_SCORE_REGRESSION_ALLELE_FREQS  <code>module-attribute</code>","text":"<pre><code>LD_SCORE_REGRESSION_ALLELE_FREQS = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        id=\"s_ldsc_allele_freqs\",\n        group=\"linkage_disequilibrium_score_regression_aux_data\",\n        sub_group=\"LDSCORE_1000G_Phase\",\n        sub_folder=PurePath(\"raw\"),\n        filename=\"LDSCORE_1000G_Phase3_frq\",\n        extension=\"tar\",\n    ),\n    url=\"https://www.dropbox.com/scl/fi/wx987fuu6s3utt6po993e/LDSCORE_1000G_Phase3_frq.tar?rlkey=li2v633jnktnfnkoy00awkzf2&amp;dl=1\",\n    md5_hash=\"ac29686ffd5b6378789857a522ebca77\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_baseline_ld_scores/","title":"partitioned_model_baseline_ld_scores","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_baseline_ld_scores/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_baseline_ld_scores","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_baseline_ld_scores","text":"<p>This is one of the reference datasets from the Stratified Linkage Disequilibrium Score Regression Paper. It contains per-functional-category LD scores for variants across the genome. Functional categories</p> <p>See: Finucane, Hilary K., et al. \"Partitioning heritability by functional annotation using genome-wide association summary statistics.\" Nature genetics 47.11 (2015): 1228-1235.</p> <p>Excerpt:</p> <p>Functional category annotations were largely derived from  ROADMAP and ENCODE</p> <p>In detail (from the paper): \u2022 Coding, 3\u2019-UTR, 5\u2019-UTR promoter, and intron annotations from the RefSeq gene model were obtained from UCSC17 and post-processed by Gusev et al.13 \u2022 Digital genomic footprint and transcription factor binding site annotations were obtained from ENCODE3 and post-processed by Gusev et al.13 \u2022 The combined chromHMM/Segway annotations for six cell lines were obtained from Hoffman et al.20 CTCF, promoter flanking, transcribed, transcription start site, strong enhancer, and weak enhancers are a union the six cell lines; repressed is an intersection over the six cell lines. \u2022 DNase I hypersensitive sites (DHSs) are a combination of ENCODE and Roadmap data, postprocessed by Trynka et al.5 We combined the cell-type-specific annotations into two annotations for inclusion in the full baseline model: a union of all cell types, and a union of only fetal cell types. DHS and fetal DHS. \u2022 H3K4me1, H3K4me, and H3K9ac were all obtained from Roadmap and post-processed by Trynka et al.5 For each, we took a union over cell types for the full baseline model, and used the individual cell types for our cell-type-specific analysis. \u2022 One version of H3K27ac was obtained from Roadmap, post-processed,18 and a second version of H3K27ac was obtained from the data of Hnisz et al.19 For each, we took a union over cell types for the full baseline model, and used the individual cell types for our cell-type-specific analysis. \u2022 Super enhancers were also obtained from Hnisz et al,19 and comprise a subset of the H3K27ac annotation from that paper. We took a union over cell types for the full baseline model \u2022 Regions conserved in mammals were obtained from Lindblad-Toh et al.,21 post-processed by Ward and Kellis.31 \u2022 FANTOM5 enhancers were obtained from Andersson et al.22 \u2022 For each of these 24 categories, we added a 500bp window around the category as an additional category to keep our heritability estimates from being inflated by heritability in flanking regions. \u2022 For each of DHS, H3K4me1, H3K4me3, and H3K9ac, we added a 100bp window around the ChIPseq peak as an additional category. \u2022 We added an additional category containing all SNPs</p> <p>Since this dataset is hosted in a requester-pays Google Cloud bucket, I have mirrored it in my dropbox.</p> <p>Data is officially located at : https://console.cloud.google.com/storage/browser/broad-alkesgroup-public-requester-pays</p> <p>Attributes:</p> <ul> <li> <code>THOUSAND_GENOME_BASE_MODEL_PARTITIONED_LD_SCORES</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_baseline_ld_scores/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_baseline_ld_scores.THOUSAND_GENOME_BASE_MODEL_PARTITIONED_LD_SCORES","title":"THOUSAND_GENOME_BASE_MODEL_PARTITIONED_LD_SCORES  <code>module-attribute</code>","text":"<pre><code>THOUSAND_GENOME_BASE_MODEL_PARTITIONED_LD_SCORES = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        id=\"thousand_genomes_baseline_model_partitioned_ld_scores\",\n        group=\"linkage_disequilibrium_scores\",\n        sub_group=\"LDSCORE_1000G_Phase3_baseline\",\n        sub_folder=PurePath(\"raw\"),\n        filename=\"LDSCORE_1000G_Phase3_baseline_v1.2_ldscores\",\n        extension=\".tar\",\n    ),\n    url=\"https://www.dropbox.com/scl/fi/w0syfa29pnhd3heq3slmq/LDSCORE_1000G_Phase3_baseline_v1.2_ldscores.tar?rlkey=vizywdwx79s7d0xg0t5yh2man&amp;dl=1\",\n    md5_hash=\"4a8faf1ec665d9cbfb67ea18139d98bf\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_cahoy_ld_scores/","title":"partitioned_model_cahoy_ld_scores","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_cahoy_ld_scores/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_cahoy_ld_scores","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_cahoy_ld_scores","text":"<p>This is a dataset of partitioned LD scores associated with brain cell types.</p> <p>It comes from the  paper</p> <p>\"Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types.\" Nature genetics 50.4 (2018): 621-629.</p> <p>The data is originally derived from transcriptome data from experiments on mouse brains reported in</p> <p>Cahoy, John D., et al. \"A transcriptome database for astrocytes, neurons, and oligodendrocytes: a new resource for understanding brain development and function.\" Journal of Neuroscience 28.1 (2008): 264-278.</p> <p>Data is officially located at : https://console.cloud.google.com/storage/browser/broad-alkesgroup-public-requester-pays</p> <p>I re-hosted on dropbox.</p> <p>Attributes:</p> <ul> <li> <code>PARTITIONED_MODEL_CAHOY_LD_SCORES_RAW</code>               (<code>DownloadFileTask</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_cahoy_ld_scores/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_cahoy_ld_scores.PARTITIONED_MODEL_CAHOY_LD_SCORES_RAW","title":"PARTITIONED_MODEL_CAHOY_LD_SCORES_RAW  <code>module-attribute</code>","text":"<pre><code>PARTITIONED_MODEL_CAHOY_LD_SCORES_RAW: DownloadFileTask = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        id=\"cahoy_partitioned_ld_scores\",\n        group=\"linkage_disequilibrium_scores\",\n        sub_group=\"LDSCORE_LDSC_SEG\",\n        sub_folder=PurePath(\"raw\"),\n        filename=\"LDSCORE_LDSC_SEG_ldscores_Cahoy_1000Gv3_ldscores\",\n        extension=\".tar\",\n    ),\n    url=\"https://www.dropbox.com/scl/fi/jnxzjt6wytng8xtdwkgeb/LDSCORE_LDSC_SEG_ldscores_Cahoy_1000Gv3_ldscores.tar?rlkey=ed12zeugsc6q8ddawcy1cifqm&amp;dl=1\",\n    md5_hash=\"15c5e5e8f056a12f1da65cd5d45b1963\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_corces_atac/","title":"partitioned_model_corces_atac","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_corces_atac/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_corces_atac","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_corces_atac","text":"<p>Partitioned LD scores associated from ATAC Seq of immunological cell types.</p> <p>From the paper:</p> <p>\"Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types.\" Nature genetics 50.4 (2018): 621-629.</p> <p>Data originally derived from:</p> <p>Corces, M. R. et al. Lineage-specific and single-cell chromatin accessibility charts human hematopoiesis and leukemia evolution. Nat. Genet. 48, 1193\u20131203 (2016).</p> <p>Data is officially located at : https://console.cloud.google.com/storage/browser/broad-alkesgroup-public-requester-pays</p> <p>I re-hosted on dropbox.</p> <p>Attributes:</p> <ul> <li> <code>PARTITIONED_MODEL_CORCES_ATAC_LD_SCORES_RAW</code>               (<code>DownloadFileTask</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_corces_atac/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_corces_atac.PARTITIONED_MODEL_CORCES_ATAC_LD_SCORES_RAW","title":"PARTITIONED_MODEL_CORCES_ATAC_LD_SCORES_RAW  <code>module-attribute</code>","text":"<pre><code>PARTITIONED_MODEL_CORCES_ATAC_LD_SCORES_RAW: DownloadFileTask = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        id=\"coreces_atac_partitioned_ld_scores\",\n        group=\"linkage_disequilibrium_scores\",\n        sub_group=\"LDSCORE_LDSC_SEG\",\n        sub_folder=PurePath(\"raw\"),\n        filename=\"LDSCORE_LDSC_SEG_ldscores_Corces_ATAC_1000Gv3_ldscores\",\n        extension=\".tar\",\n    ),\n    url=\"https://www.dropbox.com/scl/fi/val9agrddn58ivw5i1ym4/LDSCORE_LDSC_SEG_ldscores_Corces_ATAC_1000Gv3_ldscores.tar?rlkey=4yizbyor0of49jotv8la1ke56&amp;dl=1\",\n    md5_hash=\"e39132c2695830a18ef525622c1b037d\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_gtex_brain_ld_scores/","title":"partitioned_model_gtex_brain_ld_scores","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_gtex_brain_ld_scores/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_gtex_brain_ld_scores","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_gtex_brain_ld_scores","text":"<p>Partitioned LD scores associated from brain tissue types.</p> <p>Comes from the paper:</p> <p>\"Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types.\" Nature genetics 50.4 (2018): 621-629.</p> <p>Originally derived from the GTEx project</p> <p>Data is officially located at : https://console.cloud.google.com/storage/browser/broad-alkesgroup-public-requester-pays</p> <p>I re-hosted on dropbox.</p> <p>Attributes:</p> <ul> <li> <code>PARTITIONED_MODEL_GTEX_BRAIN_LD_SCORES_RAW</code>               (<code>DownloadFileTask</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_gtex_brain_ld_scores/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_gtex_brain_ld_scores.PARTITIONED_MODEL_GTEX_BRAIN_LD_SCORES_RAW","title":"PARTITIONED_MODEL_GTEX_BRAIN_LD_SCORES_RAW  <code>module-attribute</code>","text":"<pre><code>PARTITIONED_MODEL_GTEX_BRAIN_LD_SCORES_RAW: DownloadFileTask = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        id=\"gtex_brain_partitioned_ld_scores\",\n        group=\"linkage_disequilibrium_scores\",\n        sub_group=\"LDSCORE_LDSC_SEG\",\n        sub_folder=PurePath(\"raw\"),\n        filename=\"LDSCORE_LDSC_SEG_ldscores_GTEx_brain_1000Gv3_ldscores\",\n        extension=\".tar\",\n    ),\n    url=\"https://www.dropbox.com/scl/fi/yg0bf3tq077ut74040wed/LDSCORE_LDSC_SEG_ldscores_GTEx_brain_1000Gv3_ldscores.tar?rlkey=dz8me7skwswwfsybytbe4wg8o&amp;dl=1\",\n    md5_hash=\"b9842d0ef3b0b9afe0434d63c43067b2\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_immgen_ld_scores/","title":"partitioned_model_immgen_ld_scores","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_immgen_ld_scores/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_immgen_ld_scores","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_immgen_ld_scores","text":"<p>Partitioned LD scores associated from immunological cell types.</p> <p>From the paper:</p> <p>\"Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types.\" Nature genetics 50.4 (2018): 621-629.</p> <p>Data originally derived from:</p> <p>Heng, Tracy SP, et al. \"The Immunological Genome Project: networks of gene expression in immune cells.\" Nature immunology 9.10 (2008): 1091-1094.</p> <p>Data is officially located at : https://console.cloud.google.com/storage/browser/broad-alkesgroup-public-requester-pays</p> <p>I re-hosted on dropbox.</p> <p>Attributes:</p> <ul> <li> <code>PARTITIONED_MODEL_IMMGEN_LD_SCORES_RAW</code>               (<code>DownloadFileTask</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_immgen_ld_scores/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_immgen_ld_scores.PARTITIONED_MODEL_IMMGEN_LD_SCORES_RAW","title":"PARTITIONED_MODEL_IMMGEN_LD_SCORES_RAW  <code>module-attribute</code>","text":"<pre><code>PARTITIONED_MODEL_IMMGEN_LD_SCORES_RAW: DownloadFileTask = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        id=\"immgen_partitioned_ld_scores\",\n        group=\"linkage_disequilibrium_scores\",\n        sub_group=\"LDSCORE_LDSC_SEG\",\n        sub_folder=PurePath(\"raw\"),\n        filename=\"LDSCORE_LDSC_SEG_ldscores_ImmGen_1000Gv3_ldscores\",\n        extension=\".tar\",\n    ),\n    url=\"https://www.dropbox.com/scl/fi/kb30br7qcc68lsn84zak0/LDSCORE_LDSC_SEG_ldscores_ImmGen_1000Gv3_ldscores.tar?rlkey=rndsvy5q7m14sxp3swgu4r0lt&amp;dl=1\",\n    md5_hash=\"0cddb5ac5348045e4adabe9dac1c9485\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_multi_tissue_chromatin_ld_scores/","title":"partitioned_model_multi_tissue_chromatin_ld_scores","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_multi_tissue_chromatin_ld_scores/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_multi_tissue_chromatin_ld_scores","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_multi_tissue_chromatin_ld_scores","text":"<p>Tissue-specific LD scores for use with S-LDSC</p> <p>Derived from chromatin datasets as described in  \"Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types.\" Nature genetics 50.4 (2018): 621-629.</p> <p>The paper says: We downloaded narrow peaks from the Roadmap Epigenomics consortium for DNase hypersensitivity and five activating histone marks: H3K27ac, H3K4me3, H3K4me1, H3K9ac, and H3K36me3 (see URLs). Each of these six features was present in a subset of the 88 primary cell types/tissues, for a total of 397 cell-type-/tissue-specific annotations. We also analyzed peaks called using Homer from EN-TEx, a subgroup of the ENCODE project, for four activating histone marks: H3K27ac, H3K4m3, H3K4me1, and H3K36me3. Each of these four features was present in a subset of 27 tissues that were also included in the GTEx data set, for a total of 93 cell-type-/tissue-specific annotations. For each of these two datasets, of each of the annotations, we tested for enrichment by adding the annotation to the baseline model (see Table S1), together with the union of cell-type-specific annotations within each mark and the average of cell-type-specific annotations within each mark. A positive regression coefficient for a tissue-/cell-type-specific annotation represents a positive contribution of the annotation to per-SNP heritability, conditional on the other annotations. We again computed a P-value to test whether the regression coefficient was positive</p> <p>Roughly speaking the underlying logic of this dataset is as follows: In certain tissue or cell types, certain regions of the genome are known to be marked by special histone marks in certain . These marks indicate that a nearby gene is being transcribed in those tissues or cell types.</p> <p>Data is officially located at : https://console.cloud.google.com/storage/browser/broad-alkesgroup-public-requester-pays</p> <p>I re-hosted on dropbox.</p> <p>Attributes:</p> <ul> <li> <code>PARTITIONED_MODEL_MULTI_TISSUE_CHROMATIN_LD_SCORES_RAW</code>               (<code>DownloadFileTask</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_multi_tissue_chromatin_ld_scores/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_multi_tissue_chromatin_ld_scores.PARTITIONED_MODEL_MULTI_TISSUE_CHROMATIN_LD_SCORES_RAW","title":"PARTITIONED_MODEL_MULTI_TISSUE_CHROMATIN_LD_SCORES_RAW  <code>module-attribute</code>","text":"<pre><code>PARTITIONED_MODEL_MULTI_TISSUE_CHROMATIN_LD_SCORES_RAW: DownloadFileTask = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        id=\"multi_tissue_chromatin_partitioned_ld_scores\",\n        group=\"linkage_disequilibrium_scores\",\n        sub_group=\"LDSCORE_LDSC_SEG\",\n        sub_folder=PurePath(\"raw\"),\n        filename=\"LDSCORE_LDSC_SEG_ldscores_Multi_tissue_chromatin_1000Gv3_ldscores\",\n        extension=\".tar\",\n    ),\n    url=\"https://www.dropbox.com/scl/fi/8gdia1hhbjg65l4lvvpnt/LDSCORE_LDSC_SEG_ldscores_Multi_tissue_chromatin_1000Gv3_ldscores.tar?rlkey=94v5r1mjawbd1ha2gzmrg3bur&amp;dl=1\",\n    md5_hash=\"8aa379558c9ff8986965b4337b5ce6d2\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_multi_tissue_gene_expr_ld_scores/","title":"partitioned_model_multi_tissue_gene_expr_ld_scores","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_multi_tissue_gene_expr_ld_scores/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_multi_tissue_gene_expr_ld_scores","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_multi_tissue_gene_expr_ld_scores","text":"<p>Tissue-specific LD scores for use with S-LDSC</p> <p>Derived from the GTEx and Franke Lab gene expression datasets as described in Finucane, Hilary K., et al.  \"Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types.\" Nature genetics 50.4 (2018): 621-629.</p> <p>The Franke Lab dataset is described as:</p> <p>an aggregation of publicly available microarray gene expression data sets comprising 37,427 samples in human, mouse, and rat</p> <p>See instructions here: https://github.com/bulik/ldsc/wiki/Cell-type-specific-analyses</p> <p>Data is officially located at : https://console.cloud.google.com/storage/browser/broad-alkesgroup-public-requester-pays</p> <p>Attributes:</p> <ul> <li> <code>THOUSAND_GENOME_PARTITIONED_MODEL_MULTI_TISSUE_GENE_EXPR_LD_SCORES_RAW</code>               (<code>DownloadFileTask</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_multi_tissue_gene_expr_ld_scores/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_multi_tissue_gene_expr_ld_scores.THOUSAND_GENOME_PARTITIONED_MODEL_MULTI_TISSUE_GENE_EXPR_LD_SCORES_RAW","title":"THOUSAND_GENOME_PARTITIONED_MODEL_MULTI_TISSUE_GENE_EXPR_LD_SCORES_RAW  <code>module-attribute</code>","text":"<pre><code>THOUSAND_GENOME_PARTITIONED_MODEL_MULTI_TISSUE_GENE_EXPR_LD_SCORES_RAW: DownloadFileTask = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        id=\"multi_tissue_gene_expression_thousand_genomes_partitioned_ld_scores\",\n        group=\"linkage_disequilibrium_scores\",\n        sub_group=\"LDSCORE_LDSC_SEG\",\n        sub_folder=PurePath(\"raw\"),\n        filename=\"LDSCORE_LDSC_SEG_ldscores_Multi_tissue_gene_expr_1000Gv3_ldscores\",\n        extension=\".tar\",\n    ),\n    url=\"https://www.dropbox.com/scl/fi/uabu3197gchjtuamn0691/LDSCORE_LDSC_SEG_ldscores_Multi_tissue_gene_expr_1000Gv3_ldscores.tar?rlkey=8lanxtrs146nsxrkhyqeiczmu&amp;dl=1\",\n    md5_hash=\"fa2750675688474d8fceeab675a14f90\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_regression_weights/","title":"partitioned_model_regression_weights","text":""},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_regression_weights/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_regression_weights","title":"mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_regression_weights","text":"<p>This is one of the reference datasets from the Stratified Linkage Disequilibrium Score Regression Paper. It contains SNP-weights for use in the regression.</p> <p>These weights attempt to adjust for two issues: - The chi squared statistics used by S-LDSC as regression targets are not independent - Heteroskedasticity: chi-squared statistics corresponding to SNPs with higher LD scores will have higher variance</p> <p>see: Finucane, Hilary K., et al. \"Partitioning heritability by functional annotation using genome-wide association summary statistics.\" Nature genetics 47.11 (2015): 1228-1235.</p> <p>https://github.com/bulik/ldsc/wiki/Partitioned-Heritability</p> <p>Data is officially located at : https://console.cloud.google.com/storage/browser/broad-alkesgroup-public-requester-pays</p> <p>Attributes:</p> <ul> <li> <code>HM3_LD_SCORE_REGRESSION_WEIGHTS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/linkage_disequilibrium_score_reference_data/raw/partitioned_model_regression_weights/#mecfs_bio.assets.reference_data.linkage_disequilibrium_score_reference_data.raw.partitioned_model_regression_weights.HM3_LD_SCORE_REGRESSION_WEIGHTS","title":"HM3_LD_SCORE_REGRESSION_WEIGHTS  <code>module-attribute</code>","text":"<pre><code>HM3_LD_SCORE_REGRESSION_WEIGHTS = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        id=\"s_ldsc_hapmap3_regression_weights\",\n        group=\"linkage_disequilibrium_score_regression_aux_data\",\n        sub_group=\"LDSCORE_1000G_Phase\",\n        sub_folder=PurePath(\"raw\"),\n        filename=\"LDSCORE_1000G_Phase3_weights_hm3_no_MHC\",\n        extension=\".tar\",\n    ),\n    url=\"https://www.dropbox.com/scl/fi/wycm3egtm4if69wcs65pb/LDSCORE_1000G_Phase3_weights_hm3_no_MHC.tar?rlkey=e11bcg1rpkh4d7subfwjixfpj&amp;dl=1\",\n    md5_hash=\"a98ac0f089ee285177544a3e6e721ca3\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/magma_gene_locations/","title":"magma_gene_locations","text":""},{"location":"reference/mecfs_bio/assets/reference_data/magma_gene_locations/#mecfs_bio.assets.reference_data.magma_gene_locations","title":"mecfs_bio.assets.reference_data.magma_gene_locations","text":"<p>Modules:</p> <ul> <li> <code>processed</code>           \u2013            </li> <li> <code>raw</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/magma_gene_locations/processed/","title":"processed","text":""},{"location":"reference/mecfs_bio/assets/reference_data/magma_gene_locations/processed/#mecfs_bio.assets.reference_data.magma_gene_locations.processed","title":"mecfs_bio.assets.reference_data.magma_gene_locations.processed","text":"<p>Modules:</p> <ul> <li> <code>magma_entrez_gene_locations_data_build_37_unzipped</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/magma_gene_locations/processed/magma_entrez_gene_locations_data_build_37_unzipped/","title":"magma_entrez_gene_locations_data_build_37_unzipped","text":""},{"location":"reference/mecfs_bio/assets/reference_data/magma_gene_locations/processed/magma_entrez_gene_locations_data_build_37_unzipped/#mecfs_bio.assets.reference_data.magma_gene_locations.processed.magma_entrez_gene_locations_data_build_37_unzipped","title":"mecfs_bio.assets.reference_data.magma_gene_locations.processed.magma_entrez_gene_locations_data_build_37_unzipped","text":"<p>Attributes:</p> <ul> <li> <code>MAGMA_ENTREZ_GENE_LOCATION_REFERENCE_DATA_BUILD_37_EXTRACTED</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/magma_gene_locations/processed/magma_entrez_gene_locations_data_build_37_unzipped/#mecfs_bio.assets.reference_data.magma_gene_locations.processed.magma_entrez_gene_locations_data_build_37_unzipped.MAGMA_ENTREZ_GENE_LOCATION_REFERENCE_DATA_BUILD_37_EXTRACTED","title":"MAGMA_ENTREZ_GENE_LOCATION_REFERENCE_DATA_BUILD_37_EXTRACTED  <code>module-attribute</code>","text":"<pre><code>MAGMA_ENTREZ_GENE_LOCATION_REFERENCE_DATA_BUILD_37_EXTRACTED = create_from_zipped_reference_file(\n    source_task=MAGMA_ENTREZ_GENE_LOCATION_REFERENCE_DATA_BUILD_37_RAW,\n    asset_id=\"magma_gene_location_reference_data_build_37_extracted\",\n    file_to_extract=\"NCBI37.3.gene.loc\",\n    extension=\".loc\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/magma_gene_locations/raw/","title":"raw","text":""},{"location":"reference/mecfs_bio/assets/reference_data/magma_gene_locations/raw/#mecfs_bio.assets.reference_data.magma_gene_locations.raw","title":"mecfs_bio.assets.reference_data.magma_gene_locations.raw","text":"<p>Modules:</p> <ul> <li> <code>magma_ensembl_gene_location_reference_data_build_37</code>           \u2013            <p>Task to retrieve a file listing the hg19 locations of human genes, together with their strand and Ensembl id.</p> </li> <li> <code>magma_entrez_gene_location_reference_data_build_37</code>           \u2013            </li> <li> <code>magma_entrez_gene_location_reference_data_build_38</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/magma_gene_locations/raw/magma_ensembl_gene_location_reference_data_build_37/","title":"magma_ensembl_gene_location_reference_data_build_37","text":""},{"location":"reference/mecfs_bio/assets/reference_data/magma_gene_locations/raw/magma_ensembl_gene_location_reference_data_build_37/#mecfs_bio.assets.reference_data.magma_gene_locations.raw.magma_ensembl_gene_location_reference_data_build_37","title":"mecfs_bio.assets.reference_data.magma_gene_locations.raw.magma_ensembl_gene_location_reference_data_build_37","text":"<p>Task to retrieve a file listing the hg19 locations of human genes, together with their strand and Ensembl id.</p> <p>Official site:https://fuma.ctglab.nl/downloadPage File labeled \"MAGMA gene boundaries Ensembl v110\" No direct link from official site, so hosted on dropbox.</p> <p>Attributes:</p> <ul> <li> <code>MAGMA_ENSEMBL_GENE_LOCATION_REFERENCE_DATA_BUILD_37_RAW</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/magma_gene_locations/raw/magma_ensembl_gene_location_reference_data_build_37/#mecfs_bio.assets.reference_data.magma_gene_locations.raw.magma_ensembl_gene_location_reference_data_build_37.MAGMA_ENSEMBL_GENE_LOCATION_REFERENCE_DATA_BUILD_37_RAW","title":"MAGMA_ENSEMBL_GENE_LOCATION_REFERENCE_DATA_BUILD_37_RAW  <code>module-attribute</code>","text":"<pre><code>MAGMA_ENSEMBL_GENE_LOCATION_REFERENCE_DATA_BUILD_37_RAW = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        group=\"magma_reference_data\",\n        sub_group=\"ensembl_gene_locations\",\n        sub_folder=PurePath(\"raw\"),\n        id=\"magma_ensembl_gene_location_reference_data_build_37_raw\",\n        extension=\".txt\",\n        filename=\"ENSGv102.coding.genes\",\n        read_spec=DataFrameReadSpec(\n            DataFrameWhiteSpaceSepTextFormat(\n                col_names=[\n                    \"ensembl_name\",\n                    GENE_INFO_CHROM_COL,\n                    GENE_INFO_START_COL,\n                    GENE_INFO_END_COL,\n                    GENE_INFO_STRAND_COL,\n                    GENE_INFO_NAME_COL,\n                ],\n                comment_code=\"#\",\n            )\n        ),\n    ),\n    url=\"https://www.dropbox.com/scl/fi/watz1v757xzjrawkl60se/ENSGv102.coding.genes.txt?rlkey=8lnk7i3nqxfnz7og8fasnn0zg&amp;dl=1\",\n    md5_hash=\"8541ce5c7c95d67956672e1d37479ead\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/magma_gene_locations/raw/magma_entrez_gene_location_reference_data_build_37/","title":"magma_entrez_gene_location_reference_data_build_37","text":""},{"location":"reference/mecfs_bio/assets/reference_data/magma_gene_locations/raw/magma_entrez_gene_location_reference_data_build_37/#mecfs_bio.assets.reference_data.magma_gene_locations.raw.magma_entrez_gene_location_reference_data_build_37","title":"mecfs_bio.assets.reference_data.magma_gene_locations.raw.magma_entrez_gene_location_reference_data_build_37","text":"<p>Attributes:</p> <ul> <li> <code>MAGMA_ENTREZ_GENE_LOCATION_REFERENCE_DATA_BUILD_37_RAW</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/magma_gene_locations/raw/magma_entrez_gene_location_reference_data_build_37/#mecfs_bio.assets.reference_data.magma_gene_locations.raw.magma_entrez_gene_location_reference_data_build_37.MAGMA_ENTREZ_GENE_LOCATION_REFERENCE_DATA_BUILD_37_RAW","title":"MAGMA_ENTREZ_GENE_LOCATION_REFERENCE_DATA_BUILD_37_RAW  <code>module-attribute</code>","text":"<pre><code>MAGMA_ENTREZ_GENE_LOCATION_REFERENCE_DATA_BUILD_37_RAW = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        group=\"magma_reference_data\",\n        sub_group=\"gene_locations\",\n        sub_folder=PurePath(\"raw\"),\n        id=\"magma_gene_location_reference_data_build_37_raw\",\n        extension=\".zip\",\n        filename=\"NCBI37.3\",\n    ),\n    url=\"https://vu.data.surf.nl/public.php/dav/files/Pj2orwuF2JYyKxq/?accept=zip\",\n    md5_hash=None,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/magma_gene_locations/raw/magma_entrez_gene_location_reference_data_build_38/","title":"magma_entrez_gene_location_reference_data_build_38","text":""},{"location":"reference/mecfs_bio/assets/reference_data/magma_gene_locations/raw/magma_entrez_gene_location_reference_data_build_38/#mecfs_bio.assets.reference_data.magma_gene_locations.raw.magma_entrez_gene_location_reference_data_build_38","title":"mecfs_bio.assets.reference_data.magma_gene_locations.raw.magma_entrez_gene_location_reference_data_build_38","text":"<p>Attributes:</p> <ul> <li> <code>MAGMA_GENE_LOCATION_REFERENCE_DATA_BUILD_38_RAW</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/magma_gene_locations/raw/magma_entrez_gene_location_reference_data_build_38/#mecfs_bio.assets.reference_data.magma_gene_locations.raw.magma_entrez_gene_location_reference_data_build_38.MAGMA_GENE_LOCATION_REFERENCE_DATA_BUILD_38_RAW","title":"MAGMA_GENE_LOCATION_REFERENCE_DATA_BUILD_38_RAW  <code>module-attribute</code>","text":"<pre><code>MAGMA_GENE_LOCATION_REFERENCE_DATA_BUILD_38_RAW = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        group=\"magma_reference_data\",\n        sub_group=\"gene_locations\",\n        sub_folder=PurePath(\"raw\"),\n        id=\"magma_gene_location_reference_data_build_38_raw\",\n        extension=\".zip\",\n        filename=\"NCBI38\",\n    ),\n    url=\"https://vu.data.surf.nl/public.php/dav/files/yj952iHqy5anYhH/?accept=zip\",\n    md5_hash=None,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/magma_ld_reference/","title":"magma_ld_reference","text":""},{"location":"reference/mecfs_bio/assets/reference_data/magma_ld_reference/#mecfs_bio.assets.reference_data.magma_ld_reference","title":"mecfs_bio.assets.reference_data.magma_ld_reference","text":"<p>Modules:</p> <ul> <li> <code>magma_eur_build_37_1k_genomes_ref_extracted</code>           \u2013            </li> <li> <code>magma_eur_build_37_1k_genomes_ref_raw</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/magma_ld_reference/magma_eur_build_37_1k_genomes_ref_extracted/","title":"magma_eur_build_37_1k_genomes_ref_extracted","text":""},{"location":"reference/mecfs_bio/assets/reference_data/magma_ld_reference/magma_eur_build_37_1k_genomes_ref_extracted/#mecfs_bio.assets.reference_data.magma_ld_reference.magma_eur_build_37_1k_genomes_ref_extracted","title":"mecfs_bio.assets.reference_data.magma_ld_reference.magma_eur_build_37_1k_genomes_ref_extracted","text":"<p>Attributes:</p> <ul> <li> <code>MAGMA_EUR_BUILD_37_1K_GENOMES_EXTRACTED</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/magma_ld_reference/magma_eur_build_37_1k_genomes_ref_extracted/#mecfs_bio.assets.reference_data.magma_ld_reference.magma_eur_build_37_1k_genomes_ref_extracted.MAGMA_EUR_BUILD_37_1K_GENOMES_EXTRACTED","title":"MAGMA_EUR_BUILD_37_1K_GENOMES_EXTRACTED  <code>module-attribute</code>","text":"<pre><code>MAGMA_EUR_BUILD_37_1K_GENOMES_EXTRACTED = create_from_zipped_reference_file(\n    source_task=MAGMA_EUR_BUILD_37_1K_GENOMES_REF,\n    asset_id=\"magma_eur_1k_genomes_build_37_ld_ref_extracted\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/magma_ld_reference/magma_eur_build_37_1k_genomes_ref_raw/","title":"magma_eur_build_37_1k_genomes_ref_raw","text":""},{"location":"reference/mecfs_bio/assets/reference_data/magma_ld_reference/magma_eur_build_37_1k_genomes_ref_raw/#mecfs_bio.assets.reference_data.magma_ld_reference.magma_eur_build_37_1k_genomes_ref_raw","title":"mecfs_bio.assets.reference_data.magma_ld_reference.magma_eur_build_37_1k_genomes_ref_raw","text":"<p>Attributes:</p> <ul> <li> <code>MAGMA_EUR_BUILD_37_1K_GENOMES_REF</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/magma_ld_reference/magma_eur_build_37_1k_genomes_ref_raw/#mecfs_bio.assets.reference_data.magma_ld_reference.magma_eur_build_37_1k_genomes_ref_raw.MAGMA_EUR_BUILD_37_1K_GENOMES_REF","title":"MAGMA_EUR_BUILD_37_1K_GENOMES_REF  <code>module-attribute</code>","text":"<pre><code>MAGMA_EUR_BUILD_37_1K_GENOMES_REF = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        group=\"magma_reference_data\",\n        sub_group=\"magma_ld_ref\",\n        sub_folder=PurePath(\"raw\"),\n        id=AssetId(\n            \"magma_eur_1k_genomes_build_37_ld_ref_raw\"\n        ),\n        extension=\".zip\",\n        filename=\"g1000_eur\",\n    ),\n    url=\"https://vu.data.surf.nl/public.php/dav/files/VZNByNwpD8qqINe/?accept=zip\",\n    md5_hash=\"1919cb5c79bbe7871aed71ae4abe6217\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/magma_specificity_matrices/","title":"magma_specificity_matrices","text":""},{"location":"reference/mecfs_bio/assets/reference_data/magma_specificity_matrices/#mecfs_bio.assets.reference_data.magma_specificity_matrices","title":"mecfs_bio.assets.reference_data.magma_specificity_matrices","text":"<p>Modules:</p> <ul> <li> <code>raw</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/magma_specificity_matrices/raw/","title":"raw","text":""},{"location":"reference/mecfs_bio/assets/reference_data/magma_specificity_matrices/raw/#mecfs_bio.assets.reference_data.magma_specificity_matrices.raw","title":"mecfs_bio.assets.reference_data.magma_specificity_matrices.raw","text":"<p>Modules:</p> <ul> <li> <code>magma_specificity_matrix_from_hbca_rna_duncan</code>           \u2013            <p>Download a MAGMA gene specific matrix derived from the human brain cell atlas</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/magma_specificity_matrices/raw/magma_specificity_matrix_from_hbca_rna_duncan/","title":"magma_specificity_matrix_from_hbca_rna_duncan","text":""},{"location":"reference/mecfs_bio/assets/reference_data/magma_specificity_matrices/raw/magma_specificity_matrix_from_hbca_rna_duncan/#mecfs_bio.assets.reference_data.magma_specificity_matrices.raw.magma_specificity_matrix_from_hbca_rna_duncan","title":"mecfs_bio.assets.reference_data.magma_specificity_matrices.raw.magma_specificity_matrix_from_hbca_rna_duncan","text":"<p>Download a MAGMA gene specific matrix derived from the human brain cell atlas</p> <p>This matrix was used in the paper: Duncan, Laramie E., et al. \"Mapping the Cellular Etiology of Schizophrenia and Diverse Brain Phenotypes.\" medRxiv (2024): 2024-10.</p> <p>source github repo: https://github.com/Integrative-Mental-Health-Lab/linking_cell_types_to_brain_phenotypes?tab=readme-ov-file</p> <p>Attributes:</p> <ul> <li> <code>MAGMA_ENTREZ_SPECIFICITY_MATRIX_HBCA_RNA_DUNCAN</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/magma_specificity_matrices/raw/magma_specificity_matrix_from_hbca_rna_duncan/#mecfs_bio.assets.reference_data.magma_specificity_matrices.raw.magma_specificity_matrix_from_hbca_rna_duncan.MAGMA_ENTREZ_SPECIFICITY_MATRIX_HBCA_RNA_DUNCAN","title":"MAGMA_ENTREZ_SPECIFICITY_MATRIX_HBCA_RNA_DUNCAN  <code>module-attribute</code>","text":"<pre><code>MAGMA_ENTREZ_SPECIFICITY_MATRIX_HBCA_RNA_DUNCAN = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        group=\"magma_reference_data\",\n        sub_group=\"gene_specificity_matrix\",\n        sub_folder=PurePath(\"raw\"),\n        id=\"magma_specificity_matrix_entrez_hbca_rna_duncan\",\n        extension=\".txt\",\n        filename=\"conti_specificity_matrix\",\n        read_spec=DataFrameReadSpec(\n            DataFrameTextFormat(separator=\"\\t\")\n        ),\n    ),\n    url=\"https://www.dropbox.com/scl/fi/3p5qoyfw5c3q8yf38s0di/conti_specificity_matrix.txt?rlkey=1aoza02mqxn9il5aj3bjn6shq&amp;e=1&amp;dl=1\",\n    md5_hash=\"6a422064ef5ac68d3d4beccec8ab230a\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/pqtls/","title":"pqtls","text":""},{"location":"reference/mecfs_bio/assets/reference_data/pqtls/#mecfs_bio.assets.reference_data.pqtls","title":"mecfs_bio.assets.reference_data.pqtls","text":"<p>Modules:</p> <ul> <li> <code>processed</code>           \u2013            </li> <li> <code>raw</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/pqtls/processed/","title":"processed","text":""},{"location":"reference/mecfs_bio/assets/reference_data/pqtls/processed/#mecfs_bio.assets.reference_data.pqtls.processed","title":"mecfs_bio.assets.reference_data.pqtls.processed","text":"<p>Modules:</p> <ul> <li> <code>sun_et_al_2023_pqtls_combined_extracted</code>           \u2013            <p>Task to extract supplementary table 9 from the Sun et al paper.  This contains the full set of pQTLS</p> </li> <li> <code>sun_et_al_2023_pqtls_discovery_extracted</code>           \u2013            <p>Task to extract supplementary table 9 from the Sun et al paper.  This contains the discovery pQTLS</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/pqtls/processed/sun_et_al_2023_pqtls_combined_extracted/","title":"sun_et_al_2023_pqtls_combined_extracted","text":""},{"location":"reference/mecfs_bio/assets/reference_data/pqtls/processed/sun_et_al_2023_pqtls_combined_extracted/#mecfs_bio.assets.reference_data.pqtls.processed.sun_et_al_2023_pqtls_combined_extracted","title":"mecfs_bio.assets.reference_data.pqtls.processed.sun_et_al_2023_pqtls_combined_extracted","text":"<p>Task to extract supplementary table 9 from the Sun et al paper.  This contains the full set of pQTLS</p> <p>Attributes:</p> <ul> <li> <code>SUN_ET_AL_2023_COMBINED_PQTLS_EXTRACTED</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/pqtls/processed/sun_et_al_2023_pqtls_combined_extracted/#mecfs_bio.assets.reference_data.pqtls.processed.sun_et_al_2023_pqtls_combined_extracted.SUN_ET_AL_2023_COMBINED_PQTLS_EXTRACTED","title":"SUN_ET_AL_2023_COMBINED_PQTLS_EXTRACTED  <code>module-attribute</code>","text":"<pre><code>SUN_ET_AL_2023_COMBINED_PQTLS_EXTRACTED = create(\n    asset_id=\"sun_et_al_2023_combined_pqtls_extracted\",\n    source_excel_file_task=SUN_ET_AL_2023_PQTL_SUPPLEMENTARY_RAW,\n    sheet_name=\"ST10\",\n    out_format=ParquetOutFormat(),\n    skiprows=4,\n    col_type_mapping={\"FitCons_score\": str},\n    post_pipe=SplitExactColPipe(\n        col_to_split=\"Variant ID (CHROM:GENPOS (hg37):A0:A1:imp:v1)\",\n        split_by=\":\",\n        new_col_names=(\n            \"CHROM_hg37\",\n            \"GENPOS_hg37\",\n            \"A0\",\n            \"A1\",\n            \"imp\",\n            \"v1\",\n        ),\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/pqtls/processed/sun_et_al_2023_pqtls_discovery_extracted/","title":"sun_et_al_2023_pqtls_discovery_extracted","text":""},{"location":"reference/mecfs_bio/assets/reference_data/pqtls/processed/sun_et_al_2023_pqtls_discovery_extracted/#mecfs_bio.assets.reference_data.pqtls.processed.sun_et_al_2023_pqtls_discovery_extracted","title":"mecfs_bio.assets.reference_data.pqtls.processed.sun_et_al_2023_pqtls_discovery_extracted","text":"<p>Task to extract supplementary table 9 from the Sun et al paper.  This contains the discovery pQTLS</p> <p>Attributes:</p> <ul> <li> <code>SUN_ET_AL_2023_DISCOVERY_PQTLS_EXTRACTED</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/pqtls/processed/sun_et_al_2023_pqtls_discovery_extracted/#mecfs_bio.assets.reference_data.pqtls.processed.sun_et_al_2023_pqtls_discovery_extracted.SUN_ET_AL_2023_DISCOVERY_PQTLS_EXTRACTED","title":"SUN_ET_AL_2023_DISCOVERY_PQTLS_EXTRACTED  <code>module-attribute</code>","text":"<pre><code>SUN_ET_AL_2023_DISCOVERY_PQTLS_EXTRACTED = create(\n    asset_id=\"sun_et_al_2023_discovery_pqtls_extracted\",\n    source_excel_file_task=SUN_ET_AL_2023_PQTL_SUPPLEMENTARY_RAW,\n    sheet_name=\"ST9\",\n    out_format=ParquetOutFormat(),\n    skiprows=4,\n    col_type_mapping={\"FitCons_score\": str},\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/pqtls/raw/","title":"raw","text":""},{"location":"reference/mecfs_bio/assets/reference_data/pqtls/raw/#mecfs_bio.assets.reference_data.pqtls.raw","title":"mecfs_bio.assets.reference_data.pqtls.raw","text":"<p>Modules:</p> <ul> <li> <code>sun_et_al_2023_pqtls</code>           \u2013            <p>Access the supplementary material from the paper Sun, Benjamin B., et al. \"Plasma proteomic associations with genetics and health in the UK Biobank.\" Nature 622.7982 (2023): 329-338.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/pqtls/raw/sun_et_al_2023_pqtls/","title":"sun_et_al_2023_pqtls","text":""},{"location":"reference/mecfs_bio/assets/reference_data/pqtls/raw/sun_et_al_2023_pqtls/#mecfs_bio.assets.reference_data.pqtls.raw.sun_et_al_2023_pqtls","title":"mecfs_bio.assets.reference_data.pqtls.raw.sun_et_al_2023_pqtls","text":"<p>Access the supplementary material from the paper Sun, Benjamin B., et al. \"Plasma proteomic associations with genetics and health in the UK Biobank.\" Nature 622.7982 (2023): 329-338.</p> <p>Contains tables of pQTLs from the UK Biobank Pharma Proteomics  Project</p> <p>Attributes:</p> <ul> <li> <code>SUN_ET_AL_2023_PQTL_SUPPLEMENTARY_RAW</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/pqtls/raw/sun_et_al_2023_pqtls/#mecfs_bio.assets.reference_data.pqtls.raw.sun_et_al_2023_pqtls.SUN_ET_AL_2023_PQTL_SUPPLEMENTARY_RAW","title":"SUN_ET_AL_2023_PQTL_SUPPLEMENTARY_RAW  <code>module-attribute</code>","text":"<pre><code>SUN_ET_AL_2023_PQTL_SUPPLEMENTARY_RAW = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        group=\"pqtl_data\",\n        sub_group=\"sun_et_al_2023\",\n        sub_folder=PurePath(\"raw\"),\n        id=\"sun_et_al_2023_pqtl\",\n        filename=\"sun_et_al_2023_supplementary\",\n        extension=\".xlsx\",\n    ),\n    url=\"https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-023-06592-6/MediaObjects/41586_2023_6592_MOESM3_ESM.xlsx\",\n    md5_hash=\"aeb2acdc5586034e91197658a10a7d70\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/research_paper_supplementary_material/","title":"research_paper_supplementary_material","text":""},{"location":"reference/mecfs_bio/assets/reference_data/research_paper_supplementary_material/#mecfs_bio.assets.reference_data.research_paper_supplementary_material","title":"mecfs_bio.assets.reference_data.research_paper_supplementary_material","text":"<p>Modules:</p> <ul> <li> <code>duncan_et_al_2025</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/research_paper_supplementary_material/duncan_et_al_2025/","title":"duncan_et_al_2025","text":""},{"location":"reference/mecfs_bio/assets/reference_data/research_paper_supplementary_material/duncan_et_al_2025/#mecfs_bio.assets.reference_data.research_paper_supplementary_material.duncan_et_al_2025","title":"mecfs_bio.assets.reference_data.research_paper_supplementary_material.duncan_et_al_2025","text":"<p>Modules:</p> <ul> <li> <code>processed</code>           \u2013            </li> <li> <code>raw</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/research_paper_supplementary_material/duncan_et_al_2025/processed/","title":"processed","text":""},{"location":"reference/mecfs_bio/assets/reference_data/research_paper_supplementary_material/duncan_et_al_2025/processed/#mecfs_bio.assets.reference_data.research_paper_supplementary_material.duncan_et_al_2025.processed","title":"mecfs_bio.assets.reference_data.research_paper_supplementary_material.duncan_et_al_2025.processed","text":"<p>Modules:</p> <ul> <li> <code>duncan_et_al_2025_st1_extracted</code>           \u2013            <p>Extract supplementary table 1 from the Duncan et al supplementary material</p> </li> <li> <code>duncan_et_al_2025_st1_label_columns</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/research_paper_supplementary_material/duncan_et_al_2025/processed/duncan_et_al_2025_st1_extracted/","title":"duncan_et_al_2025_st1_extracted","text":""},{"location":"reference/mecfs_bio/assets/reference_data/research_paper_supplementary_material/duncan_et_al_2025/processed/duncan_et_al_2025_st1_extracted/#mecfs_bio.assets.reference_data.research_paper_supplementary_material.duncan_et_al_2025.processed.duncan_et_al_2025_st1_extracted","title":"mecfs_bio.assets.reference_data.research_paper_supplementary_material.duncan_et_al_2025.processed.duncan_et_al_2025_st1_extracted","text":"<p>Extract supplementary table 1 from the Duncan et al supplementary material</p> <p>This table includes cluster weights for schizophrenia, as well as cluster descriptions I think we may be able to reuse the cluster descriptions for our own analysis.</p> <p>Attributes:</p> <ul> <li> <code>DUNCAN_ET_AL_2025_ST1_EXTRACTED</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/research_paper_supplementary_material/duncan_et_al_2025/processed/duncan_et_al_2025_st1_extracted/#mecfs_bio.assets.reference_data.research_paper_supplementary_material.duncan_et_al_2025.processed.duncan_et_al_2025_st1_extracted.DUNCAN_ET_AL_2025_ST1_EXTRACTED","title":"DUNCAN_ET_AL_2025_ST1_EXTRACTED  <code>module-attribute</code>","text":"<pre><code>DUNCAN_ET_AL_2025_ST1_EXTRACTED = create(\n    asset_id=\"duncan_et_al_2025_st1_extracted\",\n    source_excel_file_task=DUNCAN_ET_AL_2025_SUPPLEMENTARY_RAW,\n    sheet_name=\"Supp_Table_1_SCHIZOPHRENIA\",\n    out_format=ParquetOutFormat(),\n    col_type_mapping={\n        \"Class auto-annotation\": str,\n        \"Neurotransmitter auto-annotation\": str,\n        \"Subtype auto-annotation\": str,\n        \"Neuropeptide auto-annotation\": str,\n    },\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/research_paper_supplementary_material/duncan_et_al_2025/processed/duncan_et_al_2025_st1_label_columns/","title":"duncan_et_al_2025_st1_label_columns","text":""},{"location":"reference/mecfs_bio/assets/reference_data/research_paper_supplementary_material/duncan_et_al_2025/processed/duncan_et_al_2025_st1_label_columns/#mecfs_bio.assets.reference_data.research_paper_supplementary_material.duncan_et_al_2025.processed.duncan_et_al_2025_st1_label_columns","title":"mecfs_bio.assets.reference_data.research_paper_supplementary_material.duncan_et_al_2025.processed.duncan_et_al_2025_st1_label_columns","text":"<p>Attributes:</p> <ul> <li> <code>DUNCAN_ET_AL_2025_ST1_LABEL_COLS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/research_paper_supplementary_material/duncan_et_al_2025/processed/duncan_et_al_2025_st1_label_columns/#mecfs_bio.assets.reference_data.research_paper_supplementary_material.duncan_et_al_2025.processed.duncan_et_al_2025_st1_label_columns.DUNCAN_ET_AL_2025_ST1_LABEL_COLS","title":"DUNCAN_ET_AL_2025_ST1_LABEL_COLS  <code>module-attribute</code>","text":"<pre><code>DUNCAN_ET_AL_2025_ST1_LABEL_COLS = create(\n    source_task=DUNCAN_ET_AL_2025_ST1_EXTRACTED,\n    asset_id=\"duncan_et_al_2025_st1_label_columns\",\n    out_format=ParquetOutFormat(),\n    pipes=[\n        SelectColPipe(\n            [\n                \"VARIABLE\",\n                \"Supercluster\",\n                \"Class auto-annotation\",\n                \"Neurotransmitter auto-annotation\",\n                \"Neuropeptide auto-annotation\",\n                \"Subtype auto-annotation\",\n                \"Transferred MTG Label\",\n                \"Top three regions\",\n                \"Top Enriched Genes\",\n            ]\n        )\n    ],\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/research_paper_supplementary_material/duncan_et_al_2025/raw/","title":"raw","text":""},{"location":"reference/mecfs_bio/assets/reference_data/research_paper_supplementary_material/duncan_et_al_2025/raw/#mecfs_bio.assets.reference_data.research_paper_supplementary_material.duncan_et_al_2025.raw","title":"mecfs_bio.assets.reference_data.research_paper_supplementary_material.duncan_et_al_2025.raw","text":"<p>Modules:</p> <ul> <li> <code>duncan_et_al_2025_supplementary_raw</code>           \u2013            <p>Task to download the supplementary material from the paper Duncan, Laramie E., et al. \"Mapping the cellular etiology of schizophrenia and complex brain phenotypes.\"Nature Neuroscience\" 28.2 (2025): 248-258.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/research_paper_supplementary_material/duncan_et_al_2025/raw/duncan_et_al_2025_supplementary_raw/","title":"duncan_et_al_2025_supplementary_raw","text":""},{"location":"reference/mecfs_bio/assets/reference_data/research_paper_supplementary_material/duncan_et_al_2025/raw/duncan_et_al_2025_supplementary_raw/#mecfs_bio.assets.reference_data.research_paper_supplementary_material.duncan_et_al_2025.raw.duncan_et_al_2025_supplementary_raw","title":"mecfs_bio.assets.reference_data.research_paper_supplementary_material.duncan_et_al_2025.raw.duncan_et_al_2025_supplementary_raw","text":"<p>Task to download the supplementary material from the paper Duncan, Laramie E., et al. \"Mapping the cellular etiology of schizophrenia and complex brain phenotypes.\"Nature Neuroscience\" 28.2 (2025): 248-258.</p> <p>May be useful for interpreting the results of MAGMA runs that use the human brain atlas reference data.</p> <p>Attributes:</p> <ul> <li> <code>DUNCAN_ET_AL_2025_SUPPLEMENTARY_RAW</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/research_paper_supplementary_material/duncan_et_al_2025/raw/duncan_et_al_2025_supplementary_raw/#mecfs_bio.assets.reference_data.research_paper_supplementary_material.duncan_et_al_2025.raw.duncan_et_al_2025_supplementary_raw.DUNCAN_ET_AL_2025_SUPPLEMENTARY_RAW","title":"DUNCAN_ET_AL_2025_SUPPLEMENTARY_RAW  <code>module-attribute</code>","text":"<pre><code>DUNCAN_ET_AL_2025_SUPPLEMENTARY_RAW = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        group=\"research_paper_supplementary_material\",\n        sub_group=\"duncan_et_al_2025\",\n        sub_folder=PurePath(\"raw\"),\n        id=\"duncan_el_al_2025_raw\",\n        filename=\"41593_2024_1834_MOESM2_ESM\",\n        extension=\".xlsx\",\n    ),\n    url=\"https://static-content.springer.com/esm/art%3A10.1038%2Fs41593-024-01834-w/MediaObjects/41593_2024_1834_MOESM2_ESM.xlsx\",\n    md5_hash=\"5774e0a767514b086a49f1b0fe59893b\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/","title":"rna_seq_data","text":""},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/#mecfs_bio.assets.reference_data.rna_seq_data","title":"mecfs_bio.assets.reference_data.rna_seq_data","text":"<p>Modules:</p> <ul> <li> <code>gtex</code>           \u2013            </li> <li> <code>yu_drg</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/gtex/","title":"gtex","text":""},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/gtex/#mecfs_bio.assets.reference_data.rna_seq_data.gtex","title":"mecfs_bio.assets.reference_data.rna_seq_data.gtex","text":"<p>Modules:</p> <ul> <li> <code>gtex_v10_median_tissue_expression_rna_seq_extracted</code>           \u2013            </li> <li> <code>gtex_v10_median_tissue_expression_rna_seq_prep_for_magma</code>           \u2013            </li> <li> <code>gtex_v10_median_tissue_expression_rna_seq_prep_for_magma_brain_average</code>           \u2013            <p>Analogous to GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_PREP_FOR_MAGMA, but average is across brain tissue.</p> </li> <li> <code>gtex_v10_median_tissue_expression_rna_seq_raw</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/gtex/gtex_v10_median_tissue_expression_rna_seq_extracted/","title":"gtex_v10_median_tissue_expression_rna_seq_extracted","text":""},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/gtex/gtex_v10_median_tissue_expression_rna_seq_extracted/#mecfs_bio.assets.reference_data.rna_seq_data.gtex.gtex_v10_median_tissue_expression_rna_seq_extracted","title":"mecfs_bio.assets.reference_data.rna_seq_data.gtex.gtex_v10_median_tissue_expression_rna_seq_extracted","text":"<p>Attributes:</p> <ul> <li> <code>GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_EXTRACTED</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/gtex/gtex_v10_median_tissue_expression_rna_seq_extracted/#mecfs_bio.assets.reference_data.rna_seq_data.gtex.gtex_v10_median_tissue_expression_rna_seq_extracted.GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_EXTRACTED","title":"GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_EXTRACTED  <code>module-attribute</code>","text":"<pre><code>GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_EXTRACTED = create_for_reference_file(\n    source_file_task=GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ,\n    asset_id=\"gtex_v10_rna_seq_median_tissue_expression_extracted\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/gtex/gtex_v10_median_tissue_expression_rna_seq_prep_for_magma/","title":"gtex_v10_median_tissue_expression_rna_seq_prep_for_magma","text":""},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/gtex/gtex_v10_median_tissue_expression_rna_seq_prep_for_magma/#mecfs_bio.assets.reference_data.rna_seq_data.gtex.gtex_v10_median_tissue_expression_rna_seq_prep_for_magma","title":"mecfs_bio.assets.reference_data.rna_seq_data.gtex.gtex_v10_median_tissue_expression_rna_seq_prep_for_magma","text":"<p>Attributes:</p> <ul> <li> <code>GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_PREP_FOR_MAGMA</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/gtex/gtex_v10_median_tissue_expression_rna_seq_prep_for_magma/#mecfs_bio.assets.reference_data.rna_seq_data.gtex.gtex_v10_median_tissue_expression_rna_seq_prep_for_magma.GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_PREP_FOR_MAGMA","title":"GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_PREP_FOR_MAGMA  <code>module-attribute</code>","text":"<pre><code>GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_PREP_FOR_MAGMA = create(\n    source_task=GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ,\n    asset_id=\"gtex_v10_rna_seq_median_tissue_expression_prep_for_magma\",\n    out_format=CSVOutFormat(sep=\"\\t\"),\n    pipes=[\n        DropColPipe(cols_to_drop=[\"Description\"]),\n        FilterRowsByMin(\n            min_value=1, exclude_columns=[\"Name\"]\n        ),\n        WinsorizeAllPipe(\n            max_value=50, cols_to_exclude=[\"Name\"]\n        ),\n        SplitExactColPipe(\n            col_to_split=\"Name\",\n            split_by=\".\",\n            new_col_names=(\"Gene\", \"Version\"),\n        ),\n        DropColPipe(cols_to_drop=[\"Version\", \"Name\"]),\n        ShiftedLogPipe(\n            cols_to_exclude=[\"Gene\"], base=2, pseudocount=1\n        ),\n        AddAveragePipe(cols_to_exclude=[\"Gene\"]),\n        MoveColToFrontPipe(target_col=\"Gene\"),\n    ],\n    backend=\"polars\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/gtex/gtex_v10_median_tissue_expression_rna_seq_prep_for_magma_brain_average/","title":"gtex_v10_median_tissue_expression_rna_seq_prep_for_magma_brain_average","text":""},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/gtex/gtex_v10_median_tissue_expression_rna_seq_prep_for_magma_brain_average/#mecfs_bio.assets.reference_data.rna_seq_data.gtex.gtex_v10_median_tissue_expression_rna_seq_prep_for_magma_brain_average","title":"mecfs_bio.assets.reference_data.rna_seq_data.gtex.gtex_v10_median_tissue_expression_rna_seq_prep_for_magma_brain_average","text":"<p>Analogous to GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_PREP_FOR_MAGMA, but average is across brain tissue. By controlling for average expression across brain tissues, we can see if expression in any brain tissues is associated with a phenotype, and which is not simply due to general brain-wide expression. This may potentially narrow down which specific tissue may be causal.</p> <p>Attributes:</p> <ul> <li> <code>GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_PREP_FOR_MAGMA_BRAIN_AVERAGE</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/gtex/gtex_v10_median_tissue_expression_rna_seq_prep_for_magma_brain_average/#mecfs_bio.assets.reference_data.rna_seq_data.gtex.gtex_v10_median_tissue_expression_rna_seq_prep_for_magma_brain_average.GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_PREP_FOR_MAGMA_BRAIN_AVERAGE","title":"GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_PREP_FOR_MAGMA_BRAIN_AVERAGE  <code>module-attribute</code>","text":"<pre><code>GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ_PREP_FOR_MAGMA_BRAIN_AVERAGE = create(\n    source_task=GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ,\n    asset_id=\"gtex_v10_rna_seq_median_tissue_expression_prep_for_magma_brain_average\",\n    out_format=CSVOutFormat(sep=\"\\t\"),\n    pipes=[\n        DropColPipe(cols_to_drop=[\"Description\"]),\n        FilterRowsByMin(\n            min_value=1, exclude_columns=[\"Name\"]\n        ),\n        WinsorizeAllPipe(\n            max_value=50, cols_to_exclude=[\"Name\"]\n        ),\n        SplitExactColPipe(\n            col_to_split=\"Name\",\n            split_by=\".\",\n            new_col_names=(\"Gene\", \"Version\"),\n        ),\n        DropColPipe(cols_to_drop=[\"Version\", \"Name\"]),\n        ShiftedLogPipe(\n            cols_to_exclude=[\"Gene\"], base=2, pseudocount=1\n        ),\n        AddAveragePipe(\n            cols_to_exclude=[\n                \"Gene\",\n                \"Adipose_Subcutaneous\",\n                \"Adipose_Visceral_Omentum\",\n                \"Adrenal_Gland\",\n                \"Artery_Aorta\",\n                \"Artery_Coronary\",\n                \"Artery_Tibial\",\n                \"Bladder\",\n                \"Breast_Mammary_Tissue\",\n                \"Cells_Cultured_fibroblasts\",\n                \"Cells_EBV-transformed_lymphocytes\",\n                \"Cervix_Ectocervix\",\n                \"Cervix_Endocervix\",\n                \"Colon_Sigmoid\",\n                \"Colon_Transverse\",\n                \"Colon_Transverse_Mixed_Cell\",\n                \"Colon_Transverse_Mucosa\",\n                \"Colon_Transverse_Muscularis\",\n                \"Esophagus_Gastroesophageal_Junction\",\n                \"Esophagus_Mucosa\",\n                \"Esophagus_Muscularis\",\n                \"Fallopian_Tube\",\n                \"Heart_Atrial_Appendage\",\n                \"Heart_Left_Ventricle\",\n                \"Kidney_Cortex\",\n                \"Kidney_Medulla\",\n                \"Liver\",\n                \"Liver_Hepatocyte\",\n                \"Liver_Mixed_Cell\",\n                \"Liver_Portal_Tract\",\n                \"Lung\",\n                \"Minor_Salivary_Gland\",\n                \"Muscle_Skeletal\",\n                \"Nerve_Tibial\",\n                \"Ovary\",\n                \"Pancreas\",\n                \"Pancreas_Acini\",\n                \"Pancreas_Islets\",\n                \"Pancreas_Mixed_Cell\",\n                \"Pituitary\",\n                \"Prostate\",\n                \"Skin_Not_Sun_Exposed_Suprapubic\",\n                \"Skin_Sun_Exposed_Lower_leg\",\n                \"Small_Intestine_Terminal_Ileum\",\n                \"Small_Intestine_Terminal_Ileum_Lymphode_Aggregate\",\n                \"Small_Intestine_Terminal_Ileum_Mixed_Cell\",\n                \"Spleen\",\n                \"Stomach\",\n                \"Stomach_Mixed_Cell\",\n                \"Stomach_Mucosa\",\n                \"Stomach_Muscularis\",\n                \"Testis\",\n                \"Thyroid\",\n                \"Uterus\",\n                \"Vagina\",\n                \"Whole_Blood\",\n            ]\n        ),\n        MoveColToFrontPipe(target_col=\"Gene\"),\n    ],\n    backend=\"polars\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/gtex/gtex_v10_median_tissue_expression_rna_seq_raw/","title":"gtex_v10_median_tissue_expression_rna_seq_raw","text":""},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/gtex/gtex_v10_median_tissue_expression_rna_seq_raw/#mecfs_bio.assets.reference_data.rna_seq_data.gtex.gtex_v10_median_tissue_expression_rna_seq_raw","title":"mecfs_bio.assets.reference_data.rna_seq_data.gtex.gtex_v10_median_tissue_expression_rna_seq_raw","text":"<p>Attributes:</p> <ul> <li> <code>GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/gtex/gtex_v10_median_tissue_expression_rna_seq_raw/#mecfs_bio.assets.reference_data.rna_seq_data.gtex.gtex_v10_median_tissue_expression_rna_seq_raw.GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ","title":"GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ  <code>module-attribute</code>","text":"<pre><code>GTEx_V10_MEDIAN_TISSUE_EXPRESSION_RNA_SEQ = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        group=\"rna_seq_data\",\n        sub_group=\"gtex\",\n        sub_folder=PurePath(\"raw\"),\n        filename=\"GTEx_Analysis_v10_RNASeQCv2.4.2_gene_median_tpm.gct.gz\",\n        extension=\".gz\",\n        id=AssetId(\n            \"gtex_v10_rna_seq_median_tissue_expression_raw\"\n        ),\n        read_spec=DataFrameReadSpec(\n            DataFrameTextFormat(separator=\"\\t\", skip_rows=2)\n        ),\n    ),\n    url=\"https://storage.googleapis.com/adult-gtex/bulk-gex/v10/rna-seq/GTEx_Analysis_v10_RNASeQCv2.4.2_gene_median_tpm.gct.gz\",\n    md5_hash=\"13dfdd0cb73c5899cd0b102aee5ee6c3\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/","title":"yu_drg","text":""},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/#mecfs_bio.assets.reference_data.rna_seq_data.yu_drg","title":"mecfs_bio.assets.reference_data.rna_seq_data.yu_drg","text":"<p>Modules:</p> <ul> <li> <code>processed</code>           \u2013            </li> <li> <code>raw</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/processed/","title":"processed","text":""},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/processed/#mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.processed","title":"mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.processed","text":"<p>Modules:</p> <ul> <li> <code>yu_drg_cepo_specificity_matrix</code>           \u2013            <p>Create the gene/cell specificity matrix for the YU DRG dataset using CEPO</p> </li> <li> <code>yu_drg_counts_long</code>           \u2013            </li> <li> <code>yu_drg_counts_long_with_cell_type</code>           \u2013            </li> <li> <code>yu_drg_extracted_counts_data</code>           \u2013            </li> <li> <code>yu_drg_extracted_counts_with_ensemlb_gene_names</code>           \u2013            </li> <li> <code>yu_drg_frac_specificity_matrix</code>           \u2013            <p>Create the cell/gene specificity matrix for the YU DRG dataset using the traditional fractional approach.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/processed/yu_drg_cepo_specificity_matrix/","title":"yu_drg_cepo_specificity_matrix","text":""},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/processed/yu_drg_cepo_specificity_matrix/#mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.processed.yu_drg_cepo_specificity_matrix","title":"mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.processed.yu_drg_cepo_specificity_matrix","text":"<p>Create the gene/cell specificity matrix for the YU DRG dataset using CEPO see: Kim, Hani Jieun, et al. \"Cepo uncovers cell identity through differential stability.\" bioRxiv (2021): 2021-01.</p> <p>Attributes:</p> <ul> <li> <code>YU_DRG_CEPO_SPECIFICITY_MATRIX</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/processed/yu_drg_cepo_specificity_matrix/#mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.processed.yu_drg_cepo_specificity_matrix.YU_DRG_CEPO_SPECIFICITY_MATRIX","title":"YU_DRG_CEPO_SPECIFICITY_MATRIX  <code>module-attribute</code>","text":"<pre><code>YU_DRG_CEPO_SPECIFICITY_MATRIX = create(\n    asset_id=\"yu_drg_cepo_specificity_matrix\",\n    long_count_df_task=YU_DRG_COUNTS_LONG_WITH_CELL_TYPE,\n    cell_type_col=\"cl.conserv_final\",\n    count_col=\"expression\",\n    gene_col=\"Gene stable ID\",\n    cell_col=\"cell\",\n    min_cells_per_type=10,\n    out_format=CSVOutFormat(sep=\"\\t\"),\n    pre_pipe=ShiftedLogPipeInclude(\n        base=10,\n        pseudocount=1,\n        cols_to_include=[\"expression\"],\n    ),\n    post_pipe=CompositePipe(\n        [\n            PivotPipe(\n                on=\"cl.conserv_final\",\n                index=\"Gene stable ID\",\n                values=DIFFERENTIAL_STABILITY,\n            ),\n            RenameColPipe(\n                old_name=\"Gene stable ID\",\n                new_name=MAGMA_GENE_COL,\n            ),\n            MoveColToFrontPipe(target_col=MAGMA_GENE_COL),\n        ]\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/processed/yu_drg_counts_long/","title":"yu_drg_counts_long","text":""},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/processed/yu_drg_counts_long/#mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.processed.yu_drg_counts_long","title":"mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.processed.yu_drg_counts_long","text":"<p>Attributes:</p> <ul> <li> <code>YU_DRG_COUNTS_LONG</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/processed/yu_drg_counts_long/#mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.processed.yu_drg_counts_long.YU_DRG_COUNTS_LONG","title":"YU_DRG_COUNTS_LONG  <code>module-attribute</code>","text":"<pre><code>YU_DRG_COUNTS_LONG = create(\n    YU_DRG_COUNTS_WITH_ENSEMBL,\n    asset_id=\"yu_drg_counts_long\",\n    out_format=ParquetOutFormat(),\n    pipes=[\n        UnPivotPipe(\n            on=None,\n            index=[\"Gene stable ID\"],\n            variable_name=\"cell\",\n            value_name=\"expression\",\n        )\n    ],\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/processed/yu_drg_counts_long_with_cell_type/","title":"yu_drg_counts_long_with_cell_type","text":""},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/processed/yu_drg_counts_long_with_cell_type/#mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.processed.yu_drg_counts_long_with_cell_type","title":"mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.processed.yu_drg_counts_long_with_cell_type","text":"<p>Attributes:</p> <ul> <li> <code>YU_DRG_COUNTS_LONG_WITH_CELL_TYPE</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/processed/yu_drg_counts_long_with_cell_type/#mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.processed.yu_drg_counts_long_with_cell_type.YU_DRG_COUNTS_LONG_WITH_CELL_TYPE","title":"YU_DRG_COUNTS_LONG_WITH_CELL_TYPE  <code>module-attribute</code>","text":"<pre><code>YU_DRG_COUNTS_LONG_WITH_CELL_TYPE = create_from_result_df(\n    asset_id=\"yu_drg_counts_with_cell_types\",\n    result_df_task=YU_DRG_COUNTS_LONG,\n    reference_df_task=YU_DRG_METADATA_TABLE,\n    how=\"inner\",\n    left_on=[\"cell\"],\n    right_on=[\"cell\"],\n    out_format=ParquetOutFormat(),\n    df_2_pipe=CompositePipe(\n        [\n            RenameColByPositionPipe(\n                col_position=0, col_new_name=\"cell\"\n            ),\n            SelectColPipe([\"cell\", \"cl.conserv_final\"]),\n        ]\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/processed/yu_drg_extracted_counts_data/","title":"yu_drg_extracted_counts_data","text":""},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/processed/yu_drg_extracted_counts_data/#mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.processed.yu_drg_extracted_counts_data","title":"mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.processed.yu_drg_extracted_counts_data","text":"<p>Attributes:</p> <ul> <li> <code>YU_DRG_EXTRACTED_COUNTS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/processed/yu_drg_extracted_counts_data/#mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.processed.yu_drg_extracted_counts_data.YU_DRG_EXTRACTED_COUNTS","title":"YU_DRG_EXTRACTED_COUNTS  <code>module-attribute</code>","text":"<pre><code>YU_DRG_EXTRACTED_COUNTS = create(\n    asset_id=\"yu_drg_extracted_counts\",\n    rdata_file_task=YU_DRG_SRC1_RDATA,\n    r_dataframe_name=\"HS.counts.raw\",\n    r_package_list=[\"Seurat\", \"base\"],\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/processed/yu_drg_extracted_counts_with_ensemlb_gene_names/","title":"yu_drg_extracted_counts_with_ensemlb_gene_names","text":""},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/processed/yu_drg_extracted_counts_with_ensemlb_gene_names/#mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.processed.yu_drg_extracted_counts_with_ensemlb_gene_names","title":"mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.processed.yu_drg_extracted_counts_with_ensemlb_gene_names","text":"<p>Attributes:</p> <ul> <li> <code>INDEX_COL_NAME</code>           \u2013            </li> <li> <code>YU_DRG_COUNTS_WITH_ENSEMBL</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/processed/yu_drg_extracted_counts_with_ensemlb_gene_names/#mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.processed.yu_drg_extracted_counts_with_ensemlb_gene_names.INDEX_COL_NAME","title":"INDEX_COL_NAME  <code>module-attribute</code>","text":"<pre><code>INDEX_COL_NAME = '__index_level_0__'\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/processed/yu_drg_extracted_counts_with_ensemlb_gene_names/#mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.processed.yu_drg_extracted_counts_with_ensemlb_gene_names.YU_DRG_COUNTS_WITH_ENSEMBL","title":"YU_DRG_COUNTS_WITH_ENSEMBL  <code>module-attribute</code>","text":"<pre><code>YU_DRG_COUNTS_WITH_ENSEMBL = create_from_result_df(\n    asset_id=\"yu_drg_counts_with_ensembl_id\",\n    result_df_task=YU_DRG_EXTRACTED_COUNTS,\n    reference_df_task=GENE_THESAURUS,\n    how=\"inner\",\n    left_on=[INDEX_COL_NAME],\n    right_on=[\"Gene name\"],\n    out_format=ParquetOutFormat(),\n    df_2_pipe=CompositePipe(\n        [\n            UniquePipe(\n                by=[\"Gene name\"],\n                keep=\"first\",\n                order_by=[\"Gene stable ID\"],\n            ),\n            SelectColPipe([\"Gene name\", \"Gene stable ID\"]),\n        ]\n    ),\n    out_pipe=DropColPipe([INDEX_COL_NAME]),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/processed/yu_drg_frac_specificity_matrix/","title":"yu_drg_frac_specificity_matrix","text":""},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/processed/yu_drg_frac_specificity_matrix/#mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.processed.yu_drg_frac_specificity_matrix","title":"mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.processed.yu_drg_frac_specificity_matrix","text":"<p>Create the cell/gene specificity matrix for the YU DRG dataset using the traditional fractional approach.</p> <p>Here the specificity of gene X for cell Y is log(1+ expression of X in Y)/(sum_Z log(1+ expression of X in Z))</p> <p>Attributes:</p> <ul> <li> <code>YU_DRG_FRAC_SPECIFICITY_MATRIX</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/processed/yu_drg_frac_specificity_matrix/#mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.processed.yu_drg_frac_specificity_matrix.YU_DRG_FRAC_SPECIFICITY_MATRIX","title":"YU_DRG_FRAC_SPECIFICITY_MATRIX  <code>module-attribute</code>","text":"<pre><code>YU_DRG_FRAC_SPECIFICITY_MATRIX = create(\n    asset_id=\"yu_drg_frac_specificity_matrix\",\n    long_count_df_task=YU_DRG_COUNTS_LONG_WITH_CELL_TYPE,\n    cell_type_col=\"cl.conserv_final\",\n    count_col=\"expression\",\n    gene_col=\"Gene stable ID\",\n    cell_col=\"cell\",\n    min_cells_per_type=5,\n    out_format=CSVOutFormat(sep=\"\\t\"),\n    pre_pipe=ShiftedLogPipeInclude(\n        base=10,\n        pseudocount=1,\n        cols_to_include=[\"expression\"],\n    ),\n    post_pipe=CompositePipe(\n        [\n            PivotPipe(\n                on=\"cl.conserv_final\",\n                index=\"Gene stable ID\",\n                values=NORMALIZED_MEAN,\n            ),\n            RenameColPipe(\n                old_name=\"Gene stable ID\",\n                new_name=MAGMA_GENE_COL,\n            ),\n            MoveColToFrontPipe(target_col=MAGMA_GENE_COL),\n        ]\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/raw/","title":"raw","text":""},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/raw/#mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.raw","title":"mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.raw","text":"<p>Modules:</p> <ul> <li> <code>yu_drg_metadata_table</code>           \u2013            <p>Task to download cluster metadata from the paper \"Leveraging deep single-soma RNA sequencing to explore the neural basis of human somatosensation\" by Yu et al.</p> </li> <li> <code>yu_drg_raw_counts_rdata</code>           \u2013            <p>Task to RDATA object containing RNAseq count data from the paper \"Leveraging deep single-soma RNA sequencing to explore the neural basis of human somatosensation\" by Yu et al.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/raw/yu_drg_metadata_table/","title":"yu_drg_metadata_table","text":""},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/raw/yu_drg_metadata_table/#mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.raw.yu_drg_metadata_table","title":"mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.raw.yu_drg_metadata_table","text":"<p>Task to download cluster metadata from the paper \"Leveraging deep single-soma RNA sequencing to explore the neural basis of human somatosensation\" by Yu et al. Main github repo for this paper is here: https://github.com/taimeimiaole/NN_hDRG-neuron-sequencing/</p> <p>Attributes:</p> <ul> <li> <code>YU_DRG_METADATA_TABLE</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/raw/yu_drg_metadata_table/#mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.raw.yu_drg_metadata_table.YU_DRG_METADATA_TABLE","title":"YU_DRG_METADATA_TABLE  <code>module-attribute</code>","text":"<pre><code>YU_DRG_METADATA_TABLE = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        group=\"rna_seq_data\",\n        sub_group=\"yu_dorsal_root_ganglia\",\n        sub_folder=PurePath(\"raw\"),\n        id=\"yu_drg_source_3_metadata_table\",\n        filename=\"human_drg_meta_data_newname\",\n        extension=\".csv\",\n        read_spec=DataFrameReadSpec(\n            DataFrameTextFormat(separator=\",\")\n        ),\n    ),\n    url=\"https://raw.githubusercontent.com/taimeimiaole/NN_hDRG-neuron-sequencing/refs/heads/main/Source_code_3/human_drg_meta_data_newname.csv\",\n    md5_hash=\"db997c9076aca4d38e0646a254670974\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/raw/yu_drg_raw_counts_rdata/","title":"yu_drg_raw_counts_rdata","text":""},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/raw/yu_drg_raw_counts_rdata/#mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.raw.yu_drg_raw_counts_rdata","title":"mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.raw.yu_drg_raw_counts_rdata","text":"<p>Task to RDATA object containing RNAseq count data from the paper \"Leveraging deep single-soma RNA sequencing to explore the neural basis of human somatosensation\" by Yu et al.</p> <p>Main github repo for this paper is here: https://github.com/taimeimiaole/NN_hDRG-neuron-sequencing/</p> <p>Attributes:</p> <ul> <li> <code>YU_DRG_SRC1_RDATA</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/rna_seq_data/yu_drg/raw/yu_drg_raw_counts_rdata/#mecfs_bio.assets.reference_data.rna_seq_data.yu_drg.raw.yu_drg_raw_counts_rdata.YU_DRG_SRC1_RDATA","title":"YU_DRG_SRC1_RDATA  <code>module-attribute</code>","text":"<pre><code>YU_DRG_SRC1_RDATA = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        group=\"rna_seq_data\",\n        sub_group=\"yu_dorsal_root_ganglia\",\n        sub_folder=PurePath(\"raw\"),\n        id=\"yu_drg_source_1_rdata\",\n        filename=\"Hs_LCM_final\",\n        extension=\".RData\",\n    ),\n    url=\"https://github.com/taimeimiaole/NN_hDRG-neuron-sequencing/raw/refs/heads/main/Source_code_1/Hs_LCM_final.RData\",\n    md5_hash=\"3064b44e1ee61c8d7835114adbf75d31\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ld_matrices/","title":"ukbb_ld_matrices","text":""},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ld_matrices/#mecfs_bio.assets.reference_data.ukbb_ld_matrices","title":"mecfs_bio.assets.reference_data.ukbb_ld_matrices","text":"<p>Tasks for downloading LD matrices generated from UK Biobank data.</p> <p>Having a large, population-matched LD matrix is important for multiple-causal variant fine-mapping.</p> <p>Hilary Finucane briefly discusses the importance of having an appropriate LD matrix in this Broad Institute talk: https://www.youtube.com/watch?v=S6vfOr336b0</p> <p>Modules:</p> <ul> <li> <code>from_polyfun</code>           \u2013            <p>Tasks to pull UK Biobank LD matrices from polyfun data store.</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ld_matrices/from_polyfun/","title":"from_polyfun","text":""},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ld_matrices/from_polyfun/#mecfs_bio.assets.reference_data.ukbb_ld_matrices.from_polyfun","title":"mecfs_bio.assets.reference_data.ukbb_ld_matrices.from_polyfun","text":"<p>Tasks to pull UK Biobank LD matrices from polyfun data store.</p> <p>See https://github.com/omerwe/polyfun</p> <p>See also https://github.com/omerwe/polyfun/wiki/3.-Functionally-informed-fine-mapping-with-finemapper</p> <p>Modules:</p> <ul> <li> <code>chr1_173000001</code>           \u2013            </li> <li> <code>chr_1_174000001</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ld_matrices/from_polyfun/chr1_173000001/","title":"chr1_173000001","text":""},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ld_matrices/from_polyfun/chr1_173000001/#mecfs_bio.assets.reference_data.ukbb_ld_matrices.from_polyfun.chr1_173000001","title":"mecfs_bio.assets.reference_data.ukbb_ld_matrices.from_polyfun.chr1_173000001","text":"<p>Modules:</p> <ul> <li> <code>chr1_173000001_176000001_labels</code>           \u2013            <p>Download genetic variant labels for the Broad institute's UK Biobank LD matrix</p> </li> <li> <code>chr1_173000001_176000001_matrix</code>           \u2013            <p>Task to download UKBB LD matrix for a small subset of the genome</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ld_matrices/from_polyfun/chr1_173000001/chr1_173000001_176000001_labels/","title":"chr1_173000001_176000001_labels","text":""},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ld_matrices/from_polyfun/chr1_173000001/chr1_173000001_176000001_labels/#mecfs_bio.assets.reference_data.ukbb_ld_matrices.from_polyfun.chr1_173000001.chr1_173000001_176000001_labels","title":"mecfs_bio.assets.reference_data.ukbb_ld_matrices.from_polyfun.chr1_173000001.chr1_173000001_176000001_labels","text":"<p>Download genetic variant labels for the Broad institute's UK Biobank LD matrix at Chromosome 1 173000001-17600000 (GRCh37)</p> <p>Attributes:</p> <ul> <li> <code>CHR1_173000001_17600000_UKBB_LD_LABELS_DOWNLOAD</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ld_matrices/from_polyfun/chr1_173000001/chr1_173000001_176000001_labels/#mecfs_bio.assets.reference_data.ukbb_ld_matrices.from_polyfun.chr1_173000001.chr1_173000001_176000001_labels.CHR1_173000001_17600000_UKBB_LD_LABELS_DOWNLOAD","title":"CHR1_173000001_17600000_UKBB_LD_LABELS_DOWNLOAD  <code>module-attribute</code>","text":"<pre><code>CHR1_173000001_17600000_UKBB_LD_LABELS_DOWNLOAD = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        group=\"ukbb_reference_ld\",\n        sub_group=\"chr1_173000001_17600000\",\n        sub_folder=PurePath(\"raw\"),\n        id=AssetId(\n            \"ukbb_chr1_173000001_17600000_ld_labels\"\n        ),\n        filename=\"chr1_173000001_176000001\",\n        extension=\".gz\",\n        read_spec=DataFrameReadSpec(\n            DataFrameTextFormat(separator=\"\\t\")\n        ),\n    ),\n    url=\"https://broad-alkesgroup-ukbb-ld.s3.amazonaws.com/UKBB_LD/chr1_173000001_176000001.gz\",\n    md5_hash=None,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ld_matrices/from_polyfun/chr1_173000001/chr1_173000001_176000001_matrix/","title":"chr1_173000001_176000001_matrix","text":""},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ld_matrices/from_polyfun/chr1_173000001/chr1_173000001_176000001_matrix/#mecfs_bio.assets.reference_data.ukbb_ld_matrices.from_polyfun.chr1_173000001.chr1_173000001_176000001_matrix","title":"mecfs_bio.assets.reference_data.ukbb_ld_matrices.from_polyfun.chr1_173000001.chr1_173000001_176000001_matrix","text":"<p>Task to download UKBB LD matrix for a small subset of the genome Chromosome 1 from 174000001 to 17700000 (genome build GRCh37).</p> <p>Attributes:</p> <ul> <li> <code>CHR1_173000001_17600000_UKBB_LD_MATRIX_DOWNLOAD</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ld_matrices/from_polyfun/chr1_173000001/chr1_173000001_176000001_matrix/#mecfs_bio.assets.reference_data.ukbb_ld_matrices.from_polyfun.chr1_173000001.chr1_173000001_176000001_matrix.CHR1_173000001_17600000_UKBB_LD_MATRIX_DOWNLOAD","title":"CHR1_173000001_17600000_UKBB_LD_MATRIX_DOWNLOAD  <code>module-attribute</code>","text":"<pre><code>CHR1_173000001_17600000_UKBB_LD_MATRIX_DOWNLOAD = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        group=\"ukbb_reference_ld\",\n        sub_group=\"chr1_173000001_17600000\",\n        sub_folder=PurePath(\"raw\"),\n        id=AssetId(\n            \"ukbb_chr1_173000001_17600000_ld_matrix\"\n        ),\n        filename=\"chr1_173000001_176000001\",\n        extension=\".npz\",\n    ),\n    url=\"https://broad-alkesgroup-ukbb-ld.s3.amazonaws.com/UKBB_LD/chr1_173000001_176000001.npz\",\n    md5_hash=None,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ld_matrices/from_polyfun/chr_1_174000001/","title":"chr_1_174000001","text":""},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ld_matrices/from_polyfun/chr_1_174000001/#mecfs_bio.assets.reference_data.ukbb_ld_matrices.from_polyfun.chr_1_174000001","title":"mecfs_bio.assets.reference_data.ukbb_ld_matrices.from_polyfun.chr_1_174000001","text":"<p>Modules:</p> <ul> <li> <code>chr1_174000001_177000001_labels</code>           \u2013            </li> <li> <code>chr1_174000001_177000001_matrix</code>           \u2013            <p>Task to download UKBB LD matrix for a small subset of the genome</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ld_matrices/from_polyfun/chr_1_174000001/chr1_174000001_177000001_labels/","title":"chr1_174000001_177000001_labels","text":""},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ld_matrices/from_polyfun/chr_1_174000001/chr1_174000001_177000001_labels/#mecfs_bio.assets.reference_data.ukbb_ld_matrices.from_polyfun.chr_1_174000001.chr1_174000001_177000001_labels","title":"mecfs_bio.assets.reference_data.ukbb_ld_matrices.from_polyfun.chr_1_174000001.chr1_174000001_177000001_labels","text":"<p>Attributes:</p> <ul> <li> <code>CHR1_174000001_17700000_UKBB_LD_LABELS_DOWNLOAD</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ld_matrices/from_polyfun/chr_1_174000001/chr1_174000001_177000001_labels/#mecfs_bio.assets.reference_data.ukbb_ld_matrices.from_polyfun.chr_1_174000001.chr1_174000001_177000001_labels.CHR1_174000001_17700000_UKBB_LD_LABELS_DOWNLOAD","title":"CHR1_174000001_17700000_UKBB_LD_LABELS_DOWNLOAD  <code>module-attribute</code>","text":"<pre><code>CHR1_174000001_17700000_UKBB_LD_LABELS_DOWNLOAD = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        group=\"ukbb_reference_ld\",\n        sub_group=\"chr1_174000001_17700000\",\n        sub_folder=PurePath(\"raw\"),\n        id=AssetId(\n            \"ukbb_chr1_174000001_17700000_ld_labels\"\n        ),\n        filename=\"chr1_174000001_177000001\",\n        extension=\".gz\",\n    ),\n    url=\"https://broad-alkesgroup-ukbb-ld.s3.amazonaws.com/UKBB_LD/chr1_174000001_177000001.gz\",\n    md5_hash=None,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ld_matrices/from_polyfun/chr_1_174000001/chr1_174000001_177000001_matrix/","title":"chr1_174000001_177000001_matrix","text":""},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ld_matrices/from_polyfun/chr_1_174000001/chr1_174000001_177000001_matrix/#mecfs_bio.assets.reference_data.ukbb_ld_matrices.from_polyfun.chr_1_174000001.chr1_174000001_177000001_matrix","title":"mecfs_bio.assets.reference_data.ukbb_ld_matrices.from_polyfun.chr_1_174000001.chr1_174000001_177000001_matrix","text":"<p>Task to download UKBB LD matrix for a small subset of the genome Chromosome 1 from 174000001 to 17700000 (genome build GRCh37).</p> <p>Attributes:</p> <ul> <li> <code>CHR1_174000001_17700000_UKBB_LD_MATRIX_DOWNLOAD</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ld_matrices/from_polyfun/chr_1_174000001/chr1_174000001_177000001_matrix/#mecfs_bio.assets.reference_data.ukbb_ld_matrices.from_polyfun.chr_1_174000001.chr1_174000001_177000001_matrix.CHR1_174000001_17700000_UKBB_LD_MATRIX_DOWNLOAD","title":"CHR1_174000001_17700000_UKBB_LD_MATRIX_DOWNLOAD  <code>module-attribute</code>","text":"<pre><code>CHR1_174000001_17700000_UKBB_LD_MATRIX_DOWNLOAD = DownloadFileTask(\n    meta=ReferenceFileMeta(\n        group=\"ukbb_reference_ld\",\n        sub_group=\"chr1_174000001_17700000\",\n        sub_folder=PurePath(\"raw\"),\n        id=AssetId(\n            \"ukbb_chr1_174000001_17700000_ld_matrix\"\n        ),\n        filename=\"chr1_174000001_177000001\",\n        extension=\".npz\",\n    ),\n    url=\"https://broad-alkesgroup-ukbb-ld.s3.amazonaws.com/UKBB_LD/chr1_174000001_177000001.npz\",\n    md5_hash=None,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/","title":"ukbb_ppp_sumstats","text":""},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/#mecfs_bio.assets.reference_data.ukbb_ppp_sumstats","title":"mecfs_bio.assets.reference_data.ukbb_ppp_sumstats","text":"<p>Modules:</p> <ul> <li> <code>rabgap1l</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/rabgap1l/","title":"rabgap1l","text":""},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/rabgap1l/#mecfs_bio.assets.reference_data.ukbb_ppp_sumstats.rabgap1l","title":"mecfs_bio.assets.reference_data.ukbb_ppp_sumstats.rabgap1l","text":"<p>Modules:</p> <ul> <li> <code>analysis</code>           \u2013            </li> <li> <code>processed</code>           \u2013            </li> <li> <code>raw</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/rabgap1l/analysis/","title":"analysis","text":""},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/rabgap1l/analysis/#mecfs_bio.assets.reference_data.ukbb_ppp_sumstats.rabgap1l.analysis","title":"mecfs_bio.assets.reference_data.ukbb_ppp_sumstats.rabgap1l.analysis","text":"<p>Modules:</p> <ul> <li> <code>ukbb_rabgap1l_region_plot_37</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/rabgap1l/analysis/ukbb_rabgap1l_region_plot_37/","title":"ukbb_rabgap1l_region_plot_37","text":""},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/rabgap1l/analysis/ukbb_rabgap1l_region_plot_37/#mecfs_bio.assets.reference_data.ukbb_ppp_sumstats.rabgap1l.analysis.ukbb_rabgap1l_region_plot_37","title":"mecfs_bio.assets.reference_data.ukbb_ppp_sumstats.rabgap1l.analysis.ukbb_rabgap1l_region_plot_37","text":"<p>Attributes:</p> <ul> <li> <code>UKBBPPP_RABGAP1L_RABGAP1L_REGION_PLOT_37</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/rabgap1l/analysis/ukbb_rabgap1l_region_plot_37/#mecfs_bio.assets.reference_data.ukbb_ppp_sumstats.rabgap1l.analysis.ukbb_rabgap1l_region_plot_37.UKBBPPP_RABGAP1L_RABGAP1L_REGION_PLOT_37","title":"UKBBPPP_RABGAP1L_RABGAP1L_REGION_PLOT_37  <code>module-attribute</code>","text":"<pre><code>UKBBPPP_RABGAP1L_RABGAP1L_REGION_PLOT_37 = create(\n    asset_id=\"rabgap1l_region_plot_rabgap1l_locus\",\n    sumstats_task=UKBBPPP_RABGAP1l_SUMSTATS_37,\n    vcf_name_for_ld=\"1kg_eur_hg19\",\n    chrom=1,\n    pos=174104743,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/rabgap1l/processed/","title":"processed","text":""},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/rabgap1l/processed/#mecfs_bio.assets.reference_data.ukbb_ppp_sumstats.rabgap1l.processed","title":"mecfs_bio.assets.reference_data.ukbb_ppp_sumstats.rabgap1l.processed","text":"<p>Modules:</p> <ul> <li> <code>stack_ukbb_rabgap1l</code>           \u2013            </li> <li> <code>ukbb_rabgap1l_sumstats_37</code>           \u2013            </li> <li> <code>untar_ukbb_rabgap_1l</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/rabgap1l/processed/stack_ukbb_rabgap1l/","title":"stack_ukbb_rabgap1l","text":""},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/rabgap1l/processed/stack_ukbb_rabgap1l/#mecfs_bio.assets.reference_data.ukbb_ppp_sumstats.rabgap1l.processed.stack_ukbb_rabgap1l","title":"mecfs_bio.assets.reference_data.ukbb_ppp_sumstats.rabgap1l.processed.stack_ukbb_rabgap1l","text":"<p>Attributes:</p> <ul> <li> <code>STACK_UKBBPPP_RABGAP1L</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/rabgap1l/processed/stack_ukbb_rabgap1l/#mecfs_bio.assets.reference_data.ukbb_ppp_sumstats.rabgap1l.processed.stack_ukbb_rabgap1l.STACK_UKBBPPP_RABGAP1L","title":"STACK_UKBBPPP_RABGAP1L  <code>module-attribute</code>","text":"<pre><code>STACK_UKBBPPP_RABGAP1L = create(\n    asset_id=\"ukbb_ppp_rabgap1l_sumstats_stacked\",\n    source_dir_task=UKBB_PPP_RABGAP1L_UNTAR,\n    path_glob=\"*.gz\",\n    read_spec_for_frames=DataFrameReadSpec(\n        DataFrameTextFormat(separator=\" \")\n    ),\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/rabgap1l/processed/ukbb_rabgap1l_sumstats_37/","title":"ukbb_rabgap1l_sumstats_37","text":""},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/rabgap1l/processed/ukbb_rabgap1l_sumstats_37/#mecfs_bio.assets.reference_data.ukbb_ppp_sumstats.rabgap1l.processed.ukbb_rabgap1l_sumstats_37","title":"mecfs_bio.assets.reference_data.ukbb_ppp_sumstats.rabgap1l.processed.ukbb_rabgap1l_sumstats_37","text":"<p>Attributes:</p> <ul> <li> <code>UKBBPPP_RABGAP1l_SUMSTATS_37</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/rabgap1l/processed/ukbb_rabgap1l_sumstats_37/#mecfs_bio.assets.reference_data.ukbb_ppp_sumstats.rabgap1l.processed.ukbb_rabgap1l_sumstats_37.UKBBPPP_RABGAP1l_SUMSTATS_37","title":"UKBBPPP_RABGAP1l_SUMSTATS_37  <code>module-attribute</code>","text":"<pre><code>UKBBPPP_RABGAP1l_SUMSTATS_37 = GWASLabCreateSumstatsTask(\n    df_source_task=STACK_UKBBPPP_RABGAP1L,\n    asset_id=AssetId(\"sumstats_37_ukbb_rabgap1l_gwaslab\"),\n    basic_check=True,\n    genome_build=\"infer\",\n    liftover_to=\"19\",\n    fmt=\"regenie\",\n    harmonize_options=None,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/rabgap1l/processed/untar_ukbb_rabgap_1l/","title":"untar_ukbb_rabgap_1l","text":""},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/rabgap1l/processed/untar_ukbb_rabgap_1l/#mecfs_bio.assets.reference_data.ukbb_ppp_sumstats.rabgap1l.processed.untar_ukbb_rabgap_1l","title":"mecfs_bio.assets.reference_data.ukbb_ppp_sumstats.rabgap1l.processed.untar_ukbb_rabgap_1l","text":"<p>Attributes:</p> <ul> <li> <code>UKBB_PPP_RABGAP1L_UNTAR</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/rabgap1l/processed/untar_ukbb_rabgap_1l/#mecfs_bio.assets.reference_data.ukbb_ppp_sumstats.rabgap1l.processed.untar_ukbb_rabgap_1l.UKBB_PPP_RABGAP1L_UNTAR","title":"UKBB_PPP_RABGAP1L_UNTAR  <code>module-attribute</code>","text":"<pre><code>UKBB_PPP_RABGAP1L_UNTAR = create(\n    asset_id=\"ukbb_ppp_rabgap_1l_untar\",\n    source_task=UKBB_PPP_RABGAP1L,\n    read_mode=\"r\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/rabgap1l/raw/","title":"raw","text":""},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/rabgap1l/raw/#mecfs_bio.assets.reference_data.ukbb_ppp_sumstats.rabgap1l.raw","title":"mecfs_bio.assets.reference_data.ukbb_ppp_sumstats.rabgap1l.raw","text":"<p>Modules:</p> <ul> <li> <code>ukbb_ppp_rabgap1l</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/rabgap1l/raw/ukbb_ppp_rabgap1l/","title":"ukbb_ppp_rabgap1l","text":""},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/rabgap1l/raw/ukbb_ppp_rabgap1l/#mecfs_bio.assets.reference_data.ukbb_ppp_sumstats.rabgap1l.raw.ukbb_ppp_rabgap1l","title":"mecfs_bio.assets.reference_data.ukbb_ppp_sumstats.rabgap1l.raw.ukbb_ppp_rabgap1l","text":"<p>Attributes:</p> <ul> <li> <code>UKBB_PPP_RABGAP1L</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/ukbb_ppp_sumstats/rabgap1l/raw/ukbb_ppp_rabgap1l/#mecfs_bio.assets.reference_data.ukbb_ppp_sumstats.rabgap1l.raw.ukbb_ppp_rabgap1l.UKBB_PPP_RABGAP1L","title":"UKBB_PPP_RABGAP1L  <code>module-attribute</code>","text":"<pre><code>UKBB_PPP_RABGAP1L = GetFileFromSynapseTask(\n    ReferenceFileMeta(\n        group=\"ukbb_ppp\",\n        sub_group=\"sun_et_al_2023\",\n        sub_folder=PurePath(\"raw\"),\n        id=\"rabgap1l_sumstats\",\n        filename=\"RABGAP1L_Q5R372_OID20447_v1_Inflammation\",\n        extension=\".tar\",\n    ),\n    synid=\"syn51470978\",\n    expected_filename=\"RABGAP1L_Q5R372_OID20447_v1_Inflammation.tar\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/assets/reference_data/uniprot/","title":"uniprot","text":""},{"location":"reference/mecfs_bio/assets/reference_data/uniprot/#mecfs_bio.assets.reference_data.uniprot","title":"mecfs_bio.assets.reference_data.uniprot","text":"<p>Modules:</p> <ul> <li> <code>uniprot_lookup_table</code>           \u2013            <p>Task to download reference information about proteins from UniProt</p> </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/uniprot/uniprot_lookup_table/","title":"uniprot_lookup_table","text":""},{"location":"reference/mecfs_bio/assets/reference_data/uniprot/uniprot_lookup_table/#mecfs_bio.assets.reference_data.uniprot.uniprot_lookup_table","title":"mecfs_bio.assets.reference_data.uniprot.uniprot_lookup_table","text":"<p>Task to download reference information about proteins from UniProt</p> <p>Attributes:</p> <ul> <li> <code>UNIPROT_LOOKUP</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/assets/reference_data/uniprot/uniprot_lookup_table/#mecfs_bio.assets.reference_data.uniprot.uniprot_lookup_table.UNIPROT_LOOKUP","title":"UNIPROT_LOOKUP  <code>module-attribute</code>","text":"<pre><code>UNIPROT_LOOKUP = create('uniprot_lookup_table')\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/","title":"build_system","text":""},{"location":"reference/mecfs_bio/build_system/#mecfs_bio.build_system","title":"mecfs_bio.build_system","text":"<p>Incremental build system framework. See \"Build Systems a la Carte\" by Mokhov, Mitchell, and Peyton Jones for a conceptual discussion.</p> <p>Modules:</p> <ul> <li> <code>asset</code>           \u2013            <p>An asset is a materialized directory or file that is either of interest in itself, or is an input to downstream Task.</p> </li> <li> <code>data_manipulation</code>           \u2013            <p>Reusable data processing code</p> </li> <li> <code>meta</code>           \u2013            <p>Meta objects are uniquely identifying metadata describing either an asset that currently exists, or an asset that can be created by a build system.</p> </li> <li> <code>rebuilder</code>           \u2013            <p>A rebuilder performs the following key operations: A) Decide whether a given asset is up-to-date using the info-store. B) If the asset is up-to-date, return it together with the info-store. C) If the asset is not up-to-date, bring it up-to-date, update the info-store, and return the new values of both.</p> </li> <li> <code>reference</code>           \u2013            <p>Vendored reference data.</p> </li> <li> <code>runner</code>           \u2013            <p>Runners are convenience objects that bundle a scheduler with a rebuilder to create a complete build system.</p> </li> <li> <code>scheduler</code>           \u2013            <p>Given target assets, the scheduler is responsible for traversing the dependency graph to reach those target assets.</p> </li> <li> <code>serialization</code>           \u2013            <p>Utilities for serializing the state of the build system.</p> </li> <li> <code>task</code>           \u2013            <p>Task objects are where the \"real work\" of the build system is encapsulated.</p> </li> <li> <code>task_generator</code>           \u2013            <p>A Task generator concisely generates multiple inter-related tasks with a few lines of code.</p> </li> <li> <code>tasks</code>           \u2013            <p>A \"Tasks\" is a collection that maps each asset id to the Task that materializes the corresponding Asset.</p> </li> <li> <code>wf</code>           \u2013            <p>A WF (or Workflow) is an interface tasks can use to download files.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/asset/","title":"asset","text":""},{"location":"reference/mecfs_bio/build_system/asset/#mecfs_bio.build_system.asset","title":"mecfs_bio.build_system.asset","text":"<p>An asset is a materialized directory or file that is either of interest in itself, or is an input to downstream Task.</p> <p>Modules:</p> <ul> <li> <code>base_asset</code>           \u2013            <p>The Asset Abstract Base Class.</p> </li> <li> <code>directory_asset</code>           \u2013            <p>An Asset representing a directory.</p> </li> <li> <code>file_asset</code>           \u2013            <p>An Asset representing a file.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/asset/base_asset/","title":"base_asset","text":""},{"location":"reference/mecfs_bio/build_system/asset/base_asset/#mecfs_bio.build_system.asset.base_asset","title":"mecfs_bio.build_system.asset.base_asset","text":"<p>The Asset Abstract Base Class.</p> <p>Classes:</p> <ul> <li> <code>Asset</code>           \u2013            <p>Stores a reference to a materialized asset like a file or directory</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/asset/base_asset/#mecfs_bio.build_system.asset.base_asset.Asset","title":"Asset","text":"<p>               Bases: <code>ABC</code></p> <p>Stores a reference to a materialized asset like a file or directory</p>"},{"location":"reference/mecfs_bio/build_system/asset/directory_asset/","title":"directory_asset","text":""},{"location":"reference/mecfs_bio/build_system/asset/directory_asset/#mecfs_bio.build_system.asset.directory_asset","title":"mecfs_bio.build_system.asset.directory_asset","text":"<p>An Asset representing a directory.</p> <p>Classes:</p> <ul> <li> <code>DirectoryAsset</code>           \u2013            <p>A materialized directory output of a Task.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/asset/directory_asset/#mecfs_bio.build_system.asset.directory_asset.DirectoryAsset","title":"DirectoryAsset","text":"<p>               Bases: <code>Asset</code></p> <p>A materialized directory output of a Task.</p> <p>Attributes:</p> <ul> <li> <code>path</code>               (<code>Path</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/asset/directory_asset/#mecfs_bio.build_system.asset.directory_asset.DirectoryAsset.path","title":"path  <code>instance-attribute</code>","text":"<pre><code>path: Path\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/asset/file_asset/","title":"file_asset","text":""},{"location":"reference/mecfs_bio/build_system/asset/file_asset/#mecfs_bio.build_system.asset.file_asset","title":"mecfs_bio.build_system.asset.file_asset","text":"<p>An Asset representing a file.</p> <p>Classes:</p> <ul> <li> <code>FileAsset</code>           \u2013            <p>A materialized file output of a Task.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/asset/file_asset/#mecfs_bio.build_system.asset.file_asset.FileAsset","title":"FileAsset","text":"<p>               Bases: <code>Asset</code></p> <p>A materialized file output of a Task.</p> <p>Attributes:</p> <ul> <li> <code>path</code>               (<code>Path</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/asset/file_asset/#mecfs_bio.build_system.asset.file_asset.FileAsset.path","title":"path  <code>instance-attribute</code>","text":"<pre><code>path: Path\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/","title":"data_manipulation","text":""},{"location":"reference/mecfs_bio/build_system/data_manipulation/#mecfs_bio.build_system.data_manipulation","title":"mecfs_bio.build_system.data_manipulation","text":"<p>Reusable data processing code</p> <p>Modules:</p> <ul> <li> <code>xr_data</code>           \u2013            <p>Code for manipulating data represented as xarray Datasets and DataArrays</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/","title":"xr_data","text":""},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/#mecfs_bio.build_system.data_manipulation.xr_data","title":"mecfs_bio.build_system.data_manipulation.xr_data","text":"<p>Code for manipulating data represented as xarray Datasets and DataArrays</p> <p>Modules:</p> <ul> <li> <code>pipes</code>           \u2013            </li> <li> <code>xr_gene_dataset</code>           \u2013            </li> <li> <code>xr_gene_dataset_load</code>           \u2013            </li> <li> <code>xr_gene_specificity_heatmap</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/","title":"pipes","text":""},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/#mecfs_bio.build_system.data_manipulation.xr_data.pipes","title":"mecfs_bio.build_system.data_manipulation.xr_data.pipes","text":"<p>Modules:</p> <ul> <li> <code>xr_cluster</code>           \u2013            </li> <li> <code>xr_composite</code>           \u2013            </li> <li> <code>xr_data_pipe</code>           \u2013            </li> <li> <code>xr_identity</code>           \u2013            </li> <li> <code>xr_most_significant</code>           \u2013            </li> <li> <code>xr_significance_filter</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_cluster/","title":"xr_cluster","text":""},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_cluster/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_cluster","title":"mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_cluster","text":"<p>Classes:</p> <ul> <li> <code>XRCluster</code>           \u2013            <p>Cluster a DataArray in an xarray dataset along a given dimension</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>Linkage</code>           \u2013            </li> <li> <code>Metric</code>           \u2013            </li> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_cluster/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_cluster.Linkage","title":"Linkage  <code>module-attribute</code>","text":"<pre><code>Linkage = Literal['average']\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_cluster/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_cluster.Metric","title":"Metric  <code>module-attribute</code>","text":"<pre><code>Metric = Literal['correlation', 'euclidean']\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_cluster/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_cluster.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_cluster/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_cluster.XRCluster","title":"XRCluster","text":"<p>               Bases: <code>XRDataPipe</code></p> <p>Cluster a DataArray in an xarray dataset along a given dimension</p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>array_name</code>               (<code>str</code>)           \u2013            </li> <li> <code>dim</code>               (<code>str</code>)           \u2013            </li> <li> <code>method</code>               (<code>Linkage</code>)           \u2013            </li> <li> <code>metric</code>               (<code>Metric</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_cluster/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_cluster.XRCluster.array_name","title":"array_name  <code>instance-attribute</code>","text":"<pre><code>array_name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_cluster/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_cluster.XRCluster.dim","title":"dim  <code>instance-attribute</code>","text":"<pre><code>dim: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_cluster/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_cluster.XRCluster.method","title":"method  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>method: Linkage = 'average'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_cluster/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_cluster.XRCluster.metric","title":"metric  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>metric: Metric = 'correlation'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_cluster/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_cluster.XRCluster.process","title":"process","text":"<pre><code>process(ds: Dataset) -&gt; xr.Dataset\n</code></pre> Source code in <code>mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_cluster.py</code> <pre><code>def process(self, ds: xr.Dataset) -&gt; xr.Dataset:\n    array = ds[self.array_name]\n    array = array.transpose(self.dim, ...)\n    X = array.values\n\n    logger.debug(f\"Clustering X with X.shape={X.shape}\")\n    row_dist = pdist(X, metric=self.metric)\n    row_linkage = linkage(row_dist, method=self.method)\n    row_order = leaves_list(row_linkage)\n    ds = ds.isel(\n        {\n            self.dim: row_order,\n        }\n    )\n    return ds\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_composite/","title":"xr_composite","text":""},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_composite/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_composite","title":"mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_composite","text":"<p>Classes:</p> <ul> <li> <code>XRCompositePipe</code>           \u2013            <p>Combine multiple XRDataPipes</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_composite/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_composite.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_composite/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_composite.XRCompositePipe","title":"XRCompositePipe","text":"<p>               Bases: <code>XRDataPipe</code></p> <p>Combine multiple XRDataPipes</p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>pipes</code>               (<code>Sequence[XRDataPipe]</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_composite/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_composite.XRCompositePipe.pipes","title":"pipes  <code>instance-attribute</code>","text":"<pre><code>pipes: Sequence[XRDataPipe]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_composite/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_composite.XRCompositePipe.process","title":"process","text":"<pre><code>process(ds: Dataset) -&gt; xr.Dataset\n</code></pre> Source code in <code>mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_composite.py</code> <pre><code>def process(self, ds: xr.Dataset) -&gt; xr.Dataset:\n    for pipe in self.pipes:\n        logger.debug(f\"Running pipe {pipe}\")\n        ds = pipe.process(ds)\n    return ds\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_data_pipe/","title":"xr_data_pipe","text":""},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_data_pipe/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_data_pipe","title":"mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_data_pipe","text":"<p>Classes:</p> <ul> <li> <code>XRDataPipe</code>           \u2013            <p>A transformation of an xarray dataset</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_data_pipe/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_data_pipe.XRDataPipe","title":"XRDataPipe","text":"<p>               Bases: <code>ABC</code></p> <p>A transformation of an xarray dataset</p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_data_pipe/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_data_pipe.XRDataPipe.process","title":"process  <code>abstractmethod</code>","text":"<pre><code>process(ds: Dataset) -&gt; xr.Dataset\n</code></pre> Source code in <code>mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_data_pipe.py</code> <pre><code>@abstractmethod\ndef process(self, ds: xr.Dataset) -&gt; xr.Dataset:\n    pass\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_identity/","title":"xr_identity","text":""},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_identity/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_identity","title":"mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_identity","text":"<p>Classes:</p> <ul> <li> <code>XRIdentityPipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_identity/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_identity.XRIdentityPipe","title":"XRIdentityPipe","text":"<p>               Bases: <code>XRDataPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_identity/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_identity.XRIdentityPipe.process","title":"process","text":"<pre><code>process(ds: Dataset) -&gt; xr.Dataset\n</code></pre> Source code in <code>mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_identity.py</code> <pre><code>def process(self, ds: xr.Dataset) -&gt; xr.Dataset:\n    return ds\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_most_significant/","title":"xr_most_significant","text":""},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_most_significant/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_most_significant","title":"mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_most_significant","text":"<p>Classes:</p> <ul> <li> <code>XRMostSignificant</code>           \u2013            <p>Sort a dataset by a datarray, and take the highest ranking rows.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_most_significant/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_most_significant.XRMostSignificant","title":"XRMostSignificant","text":"<p>               Bases: <code>XRDataPipe</code></p> <p>Sort a dataset by a datarray, and take the highest ranking rows.</p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>num_to_keep</code>               (<code>int</code>)           \u2013            </li> <li> <code>ordering_da</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_most_significant/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_most_significant.XRMostSignificant.num_to_keep","title":"num_to_keep  <code>instance-attribute</code>","text":"<pre><code>num_to_keep: int\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_most_significant/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_most_significant.XRMostSignificant.ordering_da","title":"ordering_da  <code>instance-attribute</code>","text":"<pre><code>ordering_da: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_most_significant/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_most_significant.XRMostSignificant.process","title":"process","text":"<pre><code>process(ds: Dataset) -&gt; xr.Dataset\n</code></pre> Source code in <code>mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_most_significant.py</code> <pre><code>def process(self, ds: xr.Dataset) -&gt; xr.Dataset:\n    target_dim = ds[self.ordering_da].dims[0]\n    ds = ds.sortby(self.ordering_da).isel(\n        {target_dim: slice(None, self.num_to_keep)}\n    )\n    return ds\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_significance_filter/","title":"xr_significance_filter","text":""},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_significance_filter/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_significance_filter","title":"mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_significance_filter","text":"<p>Classes:</p> <ul> <li> <code>XRSignificanceFilter</code>           \u2013            <p>Filter out rows that either do not have a positive z score or do not meet a p-value threshold along a given dimension</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_significance_filter/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_significance_filter.XRSignificanceFilter","title":"XRSignificanceFilter","text":"<p>               Bases: <code>XRDataPipe</code></p> <p>Filter out rows that either do not have a positive z score or do not meet a p-value threshold along a given dimension</p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>count_dim</code>               (<code>str</code>)           \u2013            </li> <li> <code>p_da</code>               (<code>str</code>)           \u2013            </li> <li> <code>p_threshold</code>               (<code>float</code>)           \u2013            </li> <li> <code>z_da</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_significance_filter/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_significance_filter.XRSignificanceFilter.count_dim","title":"count_dim  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>count_dim: str = XR_GENE_DIMENSION\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_significance_filter/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_significance_filter.XRSignificanceFilter.p_da","title":"p_da  <code>instance-attribute</code>","text":"<pre><code>p_da: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_significance_filter/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_significance_filter.XRSignificanceFilter.p_threshold","title":"p_threshold  <code>instance-attribute</code>","text":"<pre><code>p_threshold: float\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_significance_filter/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_significance_filter.XRSignificanceFilter.z_da","title":"z_da  <code>instance-attribute</code>","text":"<pre><code>z_da: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_significance_filter/#mecfs_bio.build_system.data_manipulation.xr_data.pipes.xr_significance_filter.XRSignificanceFilter.process","title":"process","text":"<pre><code>process(ds: Dataset) -&gt; xr.Dataset\n</code></pre> Source code in <code>mecfs_bio/build_system/data_manipulation/xr_data/pipes/xr_significance_filter.py</code> <pre><code>def process(self, ds: xr.Dataset) -&gt; xr.Dataset:\n    count = ds.sizes[self.count_dim]\n    adjusted_thresh = self.p_threshold / count\n    ds = ds.where(\n        (ds[self.p_da] &lt;= adjusted_thresh) &amp; (ds[self.z_da] &gt;= 0), drop=True\n    )\n    return ds\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset/","title":"xr_gene_dataset","text":""},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_dataset","title":"mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_dataset","text":"<p>Functions:</p> <ul> <li> <code>gene_annotation_df_to_ds</code>             \u2013              </li> <li> <code>gene_spec_df_to_da</code>             \u2013              </li> <li> <code>tissue_annotation_df_to_ds</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_dataset.gene_annotation_df_to_ds","title":"gene_annotation_df_to_ds","text":"<pre><code>gene_annotation_df_to_ds(\n    gene_annotation_df: DataFrame, gene_col: str | None\n) -&gt; xr.Dataset\n</code></pre> Source code in <code>mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset.py</code> <pre><code>def gene_annotation_df_to_ds(\n    gene_annotation_df: pd.DataFrame, gene_col: str | None\n) -&gt; xr.Dataset:\n    gene_annotation_df = gene_annotation_df.copy()\n    if gene_col is not None:\n        gene_annotation_df = gene_annotation_df.set_index(gene_col)\n    gene_annotation_df.index.name = XR_GENE_DIMENSION\n    return gene_annotation_df.to_xarray()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_dataset.gene_spec_df_to_da","title":"gene_spec_df_to_da","text":"<pre><code>gene_spec_df_to_da(\n    gene_tissue_df: DataFrame, gene_col: str\n) -&gt; xr.DataArray\n</code></pre> Source code in <code>mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset.py</code> <pre><code>def gene_spec_df_to_da(gene_tissue_df: pd.DataFrame, gene_col: str) -&gt; xr.DataArray:\n    return xr.DataArray(\n        gene_tissue_df.set_index(gene_col),\n        dims=(XR_GENE_DIMENSION, XR_TISSUE_DIMENSION),\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_dataset.tissue_annotation_df_to_ds","title":"tissue_annotation_df_to_ds","text":"<pre><code>tissue_annotation_df_to_ds(\n    tissue_annotation_df: DataFrame, tissue_col: str | None\n) -&gt; xr.Dataset\n</code></pre> Source code in <code>mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset.py</code> <pre><code>def tissue_annotation_df_to_ds(\n    tissue_annotation_df: pd.DataFrame, tissue_col: str | None\n) -&gt; xr.Dataset:\n    tissue_annotation_df = tissue_annotation_df.copy()\n    if tissue_col is not None:\n        tissue_annotation_df = tissue_annotation_df.set_index(tissue_col)\n    tissue_annotation_df.index.name = XR_TISSUE_DIMENSION\n    return tissue_annotation_df.to_xarray()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset_load/","title":"xr_gene_dataset_load","text":""},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset_load/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_dataset_load","title":"mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_dataset_load","text":"<p>Classes:</p> <ul> <li> <code>GeneInfoSource</code>           \u2013            </li> <li> <code>SpecificityMatrixSource</code>           \u2013            </li> <li> <code>TissueInfoSource</code>           \u2013            </li> </ul> <p>Functions:</p> <ul> <li> <code>load_xr_gene_tissue_dataset</code>             \u2013              <p>Load and construct a dataset consisting of a gene/tissue specificity matrix, together with optional annotations describing the genes and tissues</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset_load/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_dataset_load.GeneInfoSource","title":"GeneInfoSource","text":"<p>Attributes:</p> <ul> <li> <code>gene_col</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>task</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset_load/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_dataset_load.GeneInfoSource.gene_col","title":"gene_col  <code>instance-attribute</code>","text":"<pre><code>gene_col: str | None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset_load/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_dataset_load.GeneInfoSource.pipe","title":"pipe  <code>instance-attribute</code>","text":"<pre><code>pipe: DataProcessingPipe\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset_load/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_dataset_load.GeneInfoSource.task","title":"task  <code>instance-attribute</code>","text":"<pre><code>task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset_load/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_dataset_load.SpecificityMatrixSource","title":"SpecificityMatrixSource","text":"<p>Attributes:</p> <ul> <li> <code>gene_col</code>               (<code>str</code>)           \u2013            </li> <li> <code>pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>task</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset_load/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_dataset_load.SpecificityMatrixSource.gene_col","title":"gene_col  <code>instance-attribute</code>","text":"<pre><code>gene_col: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset_load/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_dataset_load.SpecificityMatrixSource.pipe","title":"pipe  <code>instance-attribute</code>","text":"<pre><code>pipe: DataProcessingPipe\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset_load/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_dataset_load.SpecificityMatrixSource.task","title":"task  <code>instance-attribute</code>","text":"<pre><code>task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset_load/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_dataset_load.TissueInfoSource","title":"TissueInfoSource","text":"<p>Attributes:</p> <ul> <li> <code>pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>tissue_col</code>               (<code>str | None</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset_load/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_dataset_load.TissueInfoSource.pipe","title":"pipe  <code>instance-attribute</code>","text":"<pre><code>pipe: DataProcessingPipe\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset_load/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_dataset_load.TissueInfoSource.task","title":"task  <code>instance-attribute</code>","text":"<pre><code>task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset_load/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_dataset_load.TissueInfoSource.tissue_col","title":"tissue_col  <code>instance-attribute</code>","text":"<pre><code>tissue_col: str | None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset_load/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_dataset_load.load_xr_gene_tissue_dataset","title":"load_xr_gene_tissue_dataset","text":"<pre><code>load_xr_gene_tissue_dataset(\n    gt_specificity_matrix_source: SpecificityMatrixSource,\n    gene_info_sources: Sequence[GeneInfoSource],\n    tissue_info_sources: Sequence[TissueInfoSource],\n    fetch: Fetch,\n) -&gt; xr.Dataset\n</code></pre> <p>Load and construct a dataset consisting of a gene/tissue specificity matrix, together with optional annotations describing the genes and tissues</p> Source code in <code>mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_dataset_load.py</code> <pre><code>def load_xr_gene_tissue_dataset(\n    gt_specificity_matrix_source: SpecificityMatrixSource,\n    gene_info_sources: Sequence[GeneInfoSource],\n    tissue_info_sources: Sequence[TissueInfoSource],\n    fetch: Fetch,\n) -&gt; xr.Dataset:\n    \"\"\"\n    Load and construct a dataset consisting of a gene/tissue specificity matrix, together with optional annotations describing the genes and tissues\n    \"\"\"\n    spec_asset = fetch(gt_specificity_matrix_source.task.asset_id)\n    spec_df = (\n        gt_specificity_matrix_source.pipe.process(\n            scan_dataframe_asset(\n                spec_asset,\n                meta=gt_specificity_matrix_source.task.meta,\n            )\n        )\n        .collect()\n        .to_pandas()\n    )\n\n    spec_da = gene_spec_df_to_da(\n        gene_tissue_df=spec_df,\n        gene_col=gt_specificity_matrix_source.gene_col,\n    )\n    ds = xr.Dataset({XR_SPECIFICITY_MATRIX: spec_da})\n    for gene_info_source in gene_info_sources:\n        gene_info_asset = fetch(gene_info_source.task.asset_id)\n        gene_info_df = (\n            gene_info_source.pipe.process(\n                scan_dataframe_asset(\n                    gene_info_asset,\n                    meta=gene_info_source.task.meta,\n                )\n            )\n            .collect()\n            .to_pandas()\n        )\n        gene_info_df = gene_info_df.drop_duplicates(subset=[gene_info_source.gene_col])\n        gene_info_ds = gene_annotation_df_to_ds(\n            gene_annotation_df=gene_info_df,\n            gene_col=gene_info_source.gene_col,\n        )\n        ds = xr.merge([ds, gene_info_ds], join=\"left\")\n\n    for tissue_info_source in tissue_info_sources:\n        tissue_info_asset = fetch(tissue_info_source.task.asset_id)\n        tissue_info_df = (\n            tissue_info_source.pipe.process(\n                scan_dataframe_asset(\n                    tissue_info_asset,\n                    meta=tissue_info_source.task.meta,\n                )\n            )\n            .collect()\n            .to_pandas()\n        )\n        tissue_info_ds = tissue_annotation_df_to_ds(\n            tissue_annotation_df=tissue_info_df,\n            tissue_col=tissue_info_source.tissue_col,\n        )\n        ds = xr.merge([ds, tissue_info_ds], join=\"left\")\n\n    return ds\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_specificity_heatmap/","title":"xr_gene_specificity_heatmap","text":""},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_specificity_heatmap/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_specificity_heatmap","title":"mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_specificity_heatmap","text":"<p>Classes:</p> <ul> <li> <code>GeneNormalizedPlotMode</code>           \u2013            </li> <li> <code>XRHeatmapPlotSpec</code>           \u2013            </li> </ul> <p>Functions:</p> <ul> <li> <code>xr_make_gene_spec_heatmap</code>             \u2013              <p>Generate a heatmap illustrating a gene/tissue specificity matrix45G</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>XRHeatmapPlotMode</code>           \u2013            </li> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_specificity_heatmap/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_specificity_heatmap.XRHeatmapPlotMode","title":"XRHeatmapPlotMode  <code>module-attribute</code>","text":"<pre><code>XRHeatmapPlotMode = GeneNormalizedPlotMode\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_specificity_heatmap/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_specificity_heatmap.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_specificity_heatmap/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_specificity_heatmap.GeneNormalizedPlotMode","title":"GeneNormalizedPlotMode","text":"<p>Attributes:</p> <ul> <li> <code>max_multiple</code>               (<code>float</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_specificity_heatmap/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_specificity_heatmap.GeneNormalizedPlotMode.max_multiple","title":"max_multiple  <code>instance-attribute</code>","text":"<pre><code>max_multiple: float\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_specificity_heatmap/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_specificity_heatmap.XRHeatmapPlotSpec","title":"XRHeatmapPlotSpec","text":"<p>Attributes:</p> <ul> <li> <code>color_scale</code>               (<code>str | list[str]</code>)           \u2013            </li> <li> <code>plot_mode</code>               (<code>XRHeatmapPlotMode</code>)           \u2013            </li> <li> <code>y_array</code>               (<code>str | None</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_specificity_heatmap/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_specificity_heatmap.XRHeatmapPlotSpec.color_scale","title":"color_scale  <code>instance-attribute</code>","text":"<pre><code>color_scale: str | list[str]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_specificity_heatmap/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_specificity_heatmap.XRHeatmapPlotSpec.plot_mode","title":"plot_mode  <code>instance-attribute</code>","text":"<pre><code>plot_mode: XRHeatmapPlotMode\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_specificity_heatmap/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_specificity_heatmap.XRHeatmapPlotSpec.y_array","title":"y_array  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>y_array: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_specificity_heatmap/#mecfs_bio.build_system.data_manipulation.xr_data.xr_gene_specificity_heatmap.xr_make_gene_spec_heatmap","title":"xr_make_gene_spec_heatmap","text":"<pre><code>xr_make_gene_spec_heatmap(\n    ds: Dataset, plot_spec: XRHeatmapPlotSpec\n) -&gt; Figure\n</code></pre> <p>Generate a heatmap illustrating a gene/tissue specificity matrix45G</p> Source code in <code>mecfs_bio/build_system/data_manipulation/xr_data/xr_gene_specificity_heatmap.py</code> <pre><code>def xr_make_gene_spec_heatmap(ds: xr.Dataset, plot_spec: XRHeatmapPlotSpec) -&gt; Figure:\n    \"\"\"\n    Generate a heatmap illustrating a gene/tissue specificity matrix45G\n    \"\"\"\n    ds = ds.copy()\n    plot_mode = plot_spec.plot_mode\n    logger.debug(f\"plotting gene/tissue dataset of dimension {ds.sizes}\")\n    plot_options: dict = {}\n    plot_options[\"aspect\"] = \"auto\"\n    if isinstance(plot_mode, GeneNormalizedPlotMode):\n        ds[XR_SPECIFICITY_MATRIX] = ds[XR_SPECIFICITY_MATRIX] / ds[\n            XR_SPECIFICITY_MATRIX\n        ].sum(dim=XR_TISSUE_DIMENSION)\n        num_tissues = ds.sizes[XR_TISSUE_DIMENSION]\n        expected_frac = 1 / num_tissues\n        zmin = expected_frac - plot_mode.max_multiple * expected_frac\n        zmax = expected_frac + plot_mode.max_multiple * expected_frac\n        plot_options[\"zmin\"] = zmin\n        plot_options[\"zmax\"] = zmax\n        plot_options[\"color_continuous_scale\"] = plot_spec.color_scale  # \"Tropic\"\n    if plot_spec.y_array is not None:\n        plot_options[\"y\"] = ds[plot_spec.y_array]\n    fig = px.imshow(ds[XR_SPECIFICITY_MATRIX], **plot_options)\n    return fig\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/","title":"meta","text":""},{"location":"reference/mecfs_bio/build_system/meta/#mecfs_bio.build_system.meta","title":"mecfs_bio.build_system.meta","text":"<p>Meta objects are uniquely identifying metadata describing either an asset that currently exists, or an asset that can be created by a build system.</p> <p>Modules:</p> <ul> <li> <code>asset_id</code>           \u2013            <p>An AssetId is a string uniquely identifying an asset.</p> </li> <li> <code>base_meta</code>           \u2013            <p>Base classes for the two types of metadata: FileMeta and DirMeta.</p> </li> <li> <code>executable_meta</code>           \u2013            <p>Metadata describing an executable file</p> </li> <li> <code>filtered_gwas_data_meta</code>           \u2013            <p>Metadata describing an asset resulting from the processing of GWAS data.</p> </li> <li> <code>gwas_summary_file_meta</code>           \u2013            <p>Metadata describing GWAS summary statistics.</p> </li> <li> <code>gwaslab_meta</code>           \u2013            </li> <li> <code>meta</code>           \u2013            <p>Meta objects are uniquely identifying metadata describing either an asset that currently exists, or an asset that can be created by a build system.</p> </li> <li> <code>plot_file_meta</code>           \u2013            <p>Metadata describing a single file plot</p> </li> <li> <code>plot_meta</code>           \u2013            <p>Metadata describing a plot directory resulting from the analysis of GWAS data.</p> </li> <li> <code>processed_gwas_data_directory_meta</code>           \u2013            <p>Metadata describing a directory containing plots from the analysis of GWAS data.</p> </li> <li> <code>read_spec</code>           \u2013            <p>A ReadSpec is a special form of metadata that specifies how an asset should be read from disk.</p> </li> <li> <code>reference_meta</code>           \u2013            </li> <li> <code>result_directory_meta</code>           \u2013            <p>Metadata describing a directory containing multiple analysis result files</p> </li> <li> <code>result_table_meta</code>           \u2013            <p>Metadata describing tabular data from the analysis of GWAS.</p> </li> <li> <code>simple_directory_meta</code>           \u2013            <p>Metadata describing a miscellaneous directory.</p> </li> <li> <code>simple_file_meta</code>           \u2013            <p>Metadata describing a miscellaneous file.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/asset_id/","title":"asset_id","text":""},{"location":"reference/mecfs_bio/build_system/meta/asset_id/#mecfs_bio.build_system.meta.asset_id","title":"mecfs_bio.build_system.meta.asset_id","text":"<p>An AssetId is a string uniquely identifying an asset.</p> <p>Attributes:</p> <ul> <li> <code>AssetId</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/asset_id/#mecfs_bio.build_system.meta.asset_id.AssetId","title":"AssetId  <code>module-attribute</code>","text":"<pre><code>AssetId = NewType('AssetId', str)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/base_meta/","title":"base_meta","text":""},{"location":"reference/mecfs_bio/build_system/meta/base_meta/#mecfs_bio.build_system.meta.base_meta","title":"mecfs_bio.build_system.meta.base_meta","text":"<p>Base classes for the two types of metadata: FileMeta and DirMeta.</p> <p>Classes:</p> <ul> <li> <code>DirMeta</code>           \u2013            <p>Metadata describing a directory asset that either currently exists or does not exist but can be materialized.</p> </li> <li> <code>FileMeta</code>           \u2013            <p>Metadata describing a file asset that either currently exists or does not exist but can be materialized.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/base_meta/#mecfs_bio.build_system.meta.base_meta.DirMeta","title":"DirMeta","text":"<p>               Bases: <code>ABC</code></p> <p>Metadata describing a directory asset that either currently exists or does not exist but can be materialized.</p> <p>Attributes:</p> <ul> <li> <code>asset_id</code>               (<code>AssetId</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/base_meta/#mecfs_bio.build_system.meta.base_meta.DirMeta.asset_id","title":"asset_id  <code>abstractmethod</code> <code>property</code>","text":"<pre><code>asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/base_meta/#mecfs_bio.build_system.meta.base_meta.FileMeta","title":"FileMeta","text":"<p>               Bases: <code>ABC</code></p> <p>Metadata describing a file asset that either currently exists or does not exist but can be materialized.</p> <p>Methods:</p> <ul> <li> <code>read_spec</code>             \u2013              <p>A specifier describing how the data should be read</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>asset_id</code>               (<code>AssetId</code>)           \u2013            <p>A uniquely identifying ID for the asset</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/base_meta/#mecfs_bio.build_system.meta.base_meta.FileMeta.asset_id","title":"asset_id  <code>abstractmethod</code> <code>property</code>","text":"<pre><code>asset_id: AssetId\n</code></pre> <p>A uniquely identifying ID for the asset</p>"},{"location":"reference/mecfs_bio/build_system/meta/base_meta/#mecfs_bio.build_system.meta.base_meta.FileMeta.read_spec","title":"read_spec","text":"<pre><code>read_spec() -&gt; ReadSpec | None\n</code></pre> <p>A specifier describing how the data should be read</p> Source code in <code>mecfs_bio/build_system/meta/base_meta.py</code> <pre><code>def read_spec(self) -&gt; ReadSpec | None:\n    \"\"\"\n    A specifier describing how the data should be read\n    \"\"\"\n    return None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/executable_meta/","title":"executable_meta","text":""},{"location":"reference/mecfs_bio/build_system/meta/executable_meta/#mecfs_bio.build_system.meta.executable_meta","title":"mecfs_bio.build_system.meta.executable_meta","text":"<p>Metadata describing an executable file</p> <p>Classes:</p> <ul> <li> <code>ExecutableMeta</code>           \u2013            <p>Metadata for executable files</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/executable_meta/#mecfs_bio.build_system.meta.executable_meta.ExecutableMeta","title":"ExecutableMeta","text":"<p>               Bases: <code>FileMeta</code></p> <p>Metadata for executable files</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>extension</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>filename</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>group</code>               (<code>str</code>)           \u2013            </li> <li> <code>id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>sub_folder</code>               (<code>PurePath</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/executable_meta/#mecfs_bio.build_system.meta.executable_meta.ExecutableMeta.asset_id","title":"asset_id  <code>property</code>","text":"<pre><code>asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/executable_meta/#mecfs_bio.build_system.meta.executable_meta.ExecutableMeta.extension","title":"extension  <code>instance-attribute</code>","text":"<pre><code>extension: str | None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/executable_meta/#mecfs_bio.build_system.meta.executable_meta.ExecutableMeta.filename","title":"filename  <code>instance-attribute</code>","text":"<pre><code>filename: str | None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/executable_meta/#mecfs_bio.build_system.meta.executable_meta.ExecutableMeta.group","title":"group  <code>instance-attribute</code>","text":"<pre><code>group: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/executable_meta/#mecfs_bio.build_system.meta.executable_meta.ExecutableMeta.id","title":"id  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>id: AssetId = field(converter=AssetId)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/executable_meta/#mecfs_bio.build_system.meta.executable_meta.ExecutableMeta.sub_folder","title":"sub_folder  <code>instance-attribute</code>","text":"<pre><code>sub_folder: PurePath\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/executable_meta/#mecfs_bio.build_system.meta.executable_meta.ExecutableMeta.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    group: str,\n    sub_folder: PurePath,\n    asset_id: str,\n    filename: str | None = None,\n    extension: str | None = None,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/meta/executable_meta.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    group: str,\n    sub_folder: PurePath,\n    asset_id: str,\n    filename: str | None = None,\n    extension: str | None = None,\n):\n    return cls(\n        group=group,\n        sub_folder=sub_folder,\n        filename=filename,\n        extension=extension,\n        id=AssetId(asset_id),\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/filtered_gwas_data_meta/","title":"filtered_gwas_data_meta","text":""},{"location":"reference/mecfs_bio/build_system/meta/filtered_gwas_data_meta/#mecfs_bio.build_system.meta.filtered_gwas_data_meta","title":"mecfs_bio.build_system.meta.filtered_gwas_data_meta","text":"<p>Metadata describing an asset resulting from the processing of GWAS data.</p> <p>Classes:</p> <ul> <li> <code>FilteredGWASDataMeta</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/filtered_gwas_data_meta/#mecfs_bio.build_system.meta.filtered_gwas_data_meta.FilteredGWASDataMeta","title":"FilteredGWASDataMeta","text":"<p>               Bases: <code>FileMeta</code></p> <p>Methods:</p> <ul> <li> <code>read_spec</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>extension</code>               (<code>str</code>)           \u2013            </li> <li> <code>id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>project</code>               (<code>str</code>)           \u2013            </li> <li> <code>sub_dir</code>               (<code>str | PurePath</code>)           \u2013            </li> <li> <code>trait</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/filtered_gwas_data_meta/#mecfs_bio.build_system.meta.filtered_gwas_data_meta.FilteredGWASDataMeta.asset_id","title":"asset_id  <code>property</code>","text":"<pre><code>asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/filtered_gwas_data_meta/#mecfs_bio.build_system.meta.filtered_gwas_data_meta.FilteredGWASDataMeta.extension","title":"extension  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>extension: str = '.parquet'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/filtered_gwas_data_meta/#mecfs_bio.build_system.meta.filtered_gwas_data_meta.FilteredGWASDataMeta.id","title":"id  <code>instance-attribute</code>","text":"<pre><code>id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/filtered_gwas_data_meta/#mecfs_bio.build_system.meta.filtered_gwas_data_meta.FilteredGWASDataMeta.project","title":"project  <code>instance-attribute</code>","text":"<pre><code>project: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/filtered_gwas_data_meta/#mecfs_bio.build_system.meta.filtered_gwas_data_meta.FilteredGWASDataMeta.sub_dir","title":"sub_dir  <code>instance-attribute</code>","text":"<pre><code>sub_dir: str | PurePath\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/filtered_gwas_data_meta/#mecfs_bio.build_system.meta.filtered_gwas_data_meta.FilteredGWASDataMeta.trait","title":"trait  <code>instance-attribute</code>","text":"<pre><code>trait: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/filtered_gwas_data_meta/#mecfs_bio.build_system.meta.filtered_gwas_data_meta.FilteredGWASDataMeta.read_spec","title":"read_spec","text":"<pre><code>read_spec() -&gt; ReadSpec | None\n</code></pre> Source code in <code>mecfs_bio/build_system/meta/filtered_gwas_data_meta.py</code> <pre><code>def read_spec(self) -&gt; ReadSpec | None:\n    return self._read_spec\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwas_summary_file_meta/","title":"gwas_summary_file_meta","text":""},{"location":"reference/mecfs_bio/build_system/meta/gwas_summary_file_meta/#mecfs_bio.build_system.meta.gwas_summary_file_meta","title":"mecfs_bio.build_system.meta.gwas_summary_file_meta","text":"<p>Metadata describing GWAS summary statistics.</p> <p>Classes:</p> <ul> <li> <code>GWASSummaryDataFileMeta</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/gwas_summary_file_meta/#mecfs_bio.build_system.meta.gwas_summary_file_meta.GWASSummaryDataFileMeta","title":"GWASSummaryDataFileMeta","text":"<p>               Bases: <code>FileMeta</code></p> <p>Methods:</p> <ul> <li> <code>read_spec</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>extension</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>project</code>               (<code>str</code>)           \u2013            </li> <li> <code>project_path</code>               (<code>PurePath | None</code>)           \u2013            </li> <li> <code>sub_dir</code>               (<code>str</code>)           \u2013            </li> <li> <code>trait</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/gwas_summary_file_meta/#mecfs_bio.build_system.meta.gwas_summary_file_meta.GWASSummaryDataFileMeta.asset_id","title":"asset_id  <code>property</code>","text":"<pre><code>asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwas_summary_file_meta/#mecfs_bio.build_system.meta.gwas_summary_file_meta.GWASSummaryDataFileMeta.extension","title":"extension  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>extension: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwas_summary_file_meta/#mecfs_bio.build_system.meta.gwas_summary_file_meta.GWASSummaryDataFileMeta.id","title":"id  <code>instance-attribute</code>","text":"<pre><code>id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwas_summary_file_meta/#mecfs_bio.build_system.meta.gwas_summary_file_meta.GWASSummaryDataFileMeta.project","title":"project  <code>instance-attribute</code>","text":"<pre><code>project: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwas_summary_file_meta/#mecfs_bio.build_system.meta.gwas_summary_file_meta.GWASSummaryDataFileMeta.project_path","title":"project_path  <code>instance-attribute</code>","text":"<pre><code>project_path: PurePath | None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwas_summary_file_meta/#mecfs_bio.build_system.meta.gwas_summary_file_meta.GWASSummaryDataFileMeta.sub_dir","title":"sub_dir  <code>instance-attribute</code>","text":"<pre><code>sub_dir: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwas_summary_file_meta/#mecfs_bio.build_system.meta.gwas_summary_file_meta.GWASSummaryDataFileMeta.trait","title":"trait  <code>instance-attribute</code>","text":"<pre><code>trait: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwas_summary_file_meta/#mecfs_bio.build_system.meta.gwas_summary_file_meta.GWASSummaryDataFileMeta.read_spec","title":"read_spec","text":"<pre><code>read_spec() -&gt; ReadSpec | None\n</code></pre> Source code in <code>mecfs_bio/build_system/meta/gwas_summary_file_meta.py</code> <pre><code>def read_spec(self) -&gt; ReadSpec | None:\n    return self._read_spec\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/","title":"gwaslab_meta","text":""},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/#mecfs_bio.build_system.meta.gwaslab_meta","title":"mecfs_bio.build_system.meta.gwaslab_meta","text":"<p>Modules:</p> <ul> <li> <code>gwaslab_lead_variants_meta</code>           \u2013            </li> <li> <code>gwaslab_manhattan_plot_meta</code>           \u2013            </li> <li> <code>gwaslab_region_plots_meta</code>           \u2013            </li> <li> <code>gwaslab_sumstats_meta</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_lead_variants_meta/","title":"gwaslab_lead_variants_meta","text":""},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_lead_variants_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_lead_variants_meta","title":"mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_lead_variants_meta","text":"<p>Classes:</p> <ul> <li> <code>GWASLabLeadVariantsMeta</code>           \u2013            <p>Metadata describing a file that lists the lead variants from a GWAS.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_lead_variants_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_lead_variants_meta.GWASLabLeadVariantsMeta","title":"GWASLabLeadVariantsMeta","text":"<p>               Bases: <code>FileMeta</code></p> <p>Metadata describing a file that lists the lead variants from a GWAS. Such files are generated by GWASLAB. see: https://cloufield.github.io/gwaslab/utility_get_lead_novel/</p> <p>Methods:</p> <ul> <li> <code>read_spec</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>project</code>               (<code>str</code>)           \u2013            </li> <li> <code>sub_dir</code>               (<code>PurePath</code>)           \u2013            </li> <li> <code>trait</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_lead_variants_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_lead_variants_meta.GWASLabLeadVariantsMeta.asset_id","title":"asset_id  <code>property</code>","text":"<pre><code>asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_lead_variants_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_lead_variants_meta.GWASLabLeadVariantsMeta.id","title":"id  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>id: AssetId = field(converter=AssetId)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_lead_variants_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_lead_variants_meta.GWASLabLeadVariantsMeta.project","title":"project  <code>instance-attribute</code>","text":"<pre><code>project: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_lead_variants_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_lead_variants_meta.GWASLabLeadVariantsMeta.sub_dir","title":"sub_dir  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>sub_dir: PurePath = PurePath('analysis/lead_variants')\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_lead_variants_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_lead_variants_meta.GWASLabLeadVariantsMeta.trait","title":"trait  <code>instance-attribute</code>","text":"<pre><code>trait: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_lead_variants_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_lead_variants_meta.GWASLabLeadVariantsMeta.read_spec","title":"read_spec","text":"<pre><code>read_spec() -&gt; ReadSpec | None\n</code></pre> Source code in <code>mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_lead_variants_meta.py</code> <pre><code>def read_spec(self) -&gt; ReadSpec | None:\n    return ReadSpec(format=DataFrameTextFormat(separator=\",\"))\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_manhattan_plot_meta/","title":"gwaslab_manhattan_plot_meta","text":""},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_manhattan_plot_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_manhattan_plot_meta","title":"mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_manhattan_plot_meta","text":"<p>Classes:</p> <ul> <li> <code>GWASLabManhattanQQPlotMeta</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_manhattan_plot_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_manhattan_plot_meta.GWASLabManhattanQQPlotMeta","title":"GWASLabManhattanQQPlotMeta","text":"<p>               Bases: <code>FileMeta</code></p> <p>Attributes:</p> <ul> <li> <code>asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>project</code>               (<code>str</code>)           \u2013            </li> <li> <code>sub_dir</code>               (<code>PurePath</code>)           \u2013            </li> <li> <code>trait</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_manhattan_plot_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_manhattan_plot_meta.GWASLabManhattanQQPlotMeta.asset_id","title":"asset_id  <code>property</code>","text":"<pre><code>asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_manhattan_plot_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_manhattan_plot_meta.GWASLabManhattanQQPlotMeta.id","title":"id  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>id: AssetId = field(converter=AssetId)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_manhattan_plot_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_manhattan_plot_meta.GWASLabManhattanQQPlotMeta.project","title":"project  <code>instance-attribute</code>","text":"<pre><code>project: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_manhattan_plot_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_manhattan_plot_meta.GWASLabManhattanQQPlotMeta.sub_dir","title":"sub_dir  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>sub_dir: PurePath = PurePath('analysis/manhattan_plot')\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_manhattan_plot_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_manhattan_plot_meta.GWASLabManhattanQQPlotMeta.trait","title":"trait  <code>instance-attribute</code>","text":"<pre><code>trait: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_region_plots_meta/","title":"gwaslab_region_plots_meta","text":""},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_region_plots_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_region_plots_meta","title":"mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_region_plots_meta","text":"<p>Classes:</p> <ul> <li> <code>GWASLabRegionPlotsMeta</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_region_plots_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_region_plots_meta.GWASLabRegionPlotsMeta","title":"GWASLabRegionPlotsMeta","text":"<p>               Bases: <code>DirMeta</code></p> <p>Attributes:</p> <ul> <li> <code>asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>project</code>               (<code>str</code>)           \u2013            </li> <li> <code>sub_dir</code>               (<code>PurePath</code>)           \u2013            </li> <li> <code>trait</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_region_plots_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_region_plots_meta.GWASLabRegionPlotsMeta.asset_id","title":"asset_id  <code>property</code>","text":"<pre><code>asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_region_plots_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_region_plots_meta.GWASLabRegionPlotsMeta.id","title":"id  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>id: AssetId = field(converter=AssetId)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_region_plots_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_region_plots_meta.GWASLabRegionPlotsMeta.project","title":"project  <code>instance-attribute</code>","text":"<pre><code>project: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_region_plots_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_region_plots_meta.GWASLabRegionPlotsMeta.sub_dir","title":"sub_dir  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>sub_dir: PurePath = PurePath(\n    \"analysis/lead_variant_region_plots\"\n)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_region_plots_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_region_plots_meta.GWASLabRegionPlotsMeta.trait","title":"trait  <code>instance-attribute</code>","text":"<pre><code>trait: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_sumstats_meta/","title":"gwaslab_sumstats_meta","text":""},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_sumstats_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_sumstats_meta","title":"mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_sumstats_meta","text":"<p>Classes:</p> <ul> <li> <code>GWASLabSumStatsMeta</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_sumstats_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_sumstats_meta.GWASLabSumStatsMeta","title":"GWASLabSumStatsMeta","text":"<p>               Bases: <code>FileMeta</code></p> <p>Attributes:</p> <ul> <li> <code>asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>project</code>               (<code>str</code>)           \u2013            </li> <li> <code>sub_dir</code>               (<code>str</code>)           \u2013            </li> <li> <code>trait</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_sumstats_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_sumstats_meta.GWASLabSumStatsMeta.asset_id","title":"asset_id  <code>property</code>","text":"<pre><code>asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_sumstats_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_sumstats_meta.GWASLabSumStatsMeta.id","title":"id  <code>instance-attribute</code>","text":"<pre><code>id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_sumstats_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_sumstats_meta.GWASLabSumStatsMeta.project","title":"project  <code>instance-attribute</code>","text":"<pre><code>project: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_sumstats_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_sumstats_meta.GWASLabSumStatsMeta.sub_dir","title":"sub_dir  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>sub_dir: str = 'gwaslab_sumstats'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/gwaslab_meta/gwaslab_sumstats_meta/#mecfs_bio.build_system.meta.gwaslab_meta.gwaslab_sumstats_meta.GWASLabSumStatsMeta.trait","title":"trait  <code>instance-attribute</code>","text":"<pre><code>trait: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/meta/","title":"meta","text":""},{"location":"reference/mecfs_bio/build_system/meta/meta/#mecfs_bio.build_system.meta.meta","title":"mecfs_bio.build_system.meta.meta","text":"<p>Meta objects are uniquely identifying metadata describing either an asset that currently exists, or an asset that can be created by a build system.</p> <p>Attributes:</p> <ul> <li> <code>Meta</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/meta/#mecfs_bio.build_system.meta.meta.Meta","title":"Meta  <code>module-attribute</code>","text":"<pre><code>Meta = (\n    SimpleFileMeta\n    | SimpleDirectoryMeta\n    | GWASSummaryDataFileMeta\n    | FilteredGWASDataMeta\n    | GWASLabSumStatsMeta\n    | GWASLabLeadVariantsMeta\n    | GWASLabRegionPlotsMeta\n    | ReferenceFileMeta\n    | GWASLabManhattanQQPlotMeta\n    | ReferenceDataDirectoryMeta\n    | ExecutableMeta\n    | ProcessedGwasDataDirectoryMeta\n    | GWASPlotDirectoryMeta\n    | GWASPlotFileMeta\n    | ResultTableMeta\n    | ResultDirectoryMeta\n)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/plot_file_meta/","title":"plot_file_meta","text":""},{"location":"reference/mecfs_bio/build_system/meta/plot_file_meta/#mecfs_bio.build_system.meta.plot_file_meta","title":"mecfs_bio.build_system.meta.plot_file_meta","text":"<p>Metadata describing a single file plot</p> <p>Classes:</p> <ul> <li> <code>GWASPlotFileMeta</code>           \u2013            <p>Metadata describing a single file plot</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/plot_file_meta/#mecfs_bio.build_system.meta.plot_file_meta.GWASPlotFileMeta","title":"GWASPlotFileMeta","text":"<p>               Bases: <code>FileMeta</code></p> <p>Metadata describing a single file plot</p> <p>Attributes:</p> <ul> <li> <code>asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>extension</code>               (<code>str</code>)           \u2013            </li> <li> <code>id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>project</code>               (<code>str</code>)           \u2013            </li> <li> <code>sub_dir</code>               (<code>PurePath</code>)           \u2013            </li> <li> <code>trait</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/plot_file_meta/#mecfs_bio.build_system.meta.plot_file_meta.GWASPlotFileMeta.asset_id","title":"asset_id  <code>property</code>","text":"<pre><code>asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/plot_file_meta/#mecfs_bio.build_system.meta.plot_file_meta.GWASPlotFileMeta.extension","title":"extension  <code>instance-attribute</code>","text":"<pre><code>extension: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/plot_file_meta/#mecfs_bio.build_system.meta.plot_file_meta.GWASPlotFileMeta.id","title":"id  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>id: AssetId = field(converter=AssetId)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/plot_file_meta/#mecfs_bio.build_system.meta.plot_file_meta.GWASPlotFileMeta.project","title":"project  <code>instance-attribute</code>","text":"<pre><code>project: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/plot_file_meta/#mecfs_bio.build_system.meta.plot_file_meta.GWASPlotFileMeta.sub_dir","title":"sub_dir  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>sub_dir: PurePath = PurePath('analysis/plots')\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/plot_file_meta/#mecfs_bio.build_system.meta.plot_file_meta.GWASPlotFileMeta.trait","title":"trait  <code>instance-attribute</code>","text":"<pre><code>trait: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/plot_meta/","title":"plot_meta","text":""},{"location":"reference/mecfs_bio/build_system/meta/plot_meta/#mecfs_bio.build_system.meta.plot_meta","title":"mecfs_bio.build_system.meta.plot_meta","text":"<p>Metadata describing a plot directory resulting from the analysis of GWAS data.</p> <p>Classes:</p> <ul> <li> <code>GWASPlotDirectoryMeta</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/plot_meta/#mecfs_bio.build_system.meta.plot_meta.GWASPlotDirectoryMeta","title":"GWASPlotDirectoryMeta","text":"<p>               Bases: <code>DirMeta</code></p> <p>Attributes:</p> <ul> <li> <code>asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>project</code>               (<code>str</code>)           \u2013            </li> <li> <code>sub_dir</code>               (<code>PurePath</code>)           \u2013            </li> <li> <code>trait</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/plot_meta/#mecfs_bio.build_system.meta.plot_meta.GWASPlotDirectoryMeta.asset_id","title":"asset_id  <code>property</code>","text":"<pre><code>asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/plot_meta/#mecfs_bio.build_system.meta.plot_meta.GWASPlotDirectoryMeta.id","title":"id  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>id: AssetId = field(converter=AssetId)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/plot_meta/#mecfs_bio.build_system.meta.plot_meta.GWASPlotDirectoryMeta.project","title":"project  <code>instance-attribute</code>","text":"<pre><code>project: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/plot_meta/#mecfs_bio.build_system.meta.plot_meta.GWASPlotDirectoryMeta.sub_dir","title":"sub_dir  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>sub_dir: PurePath = PurePath('analysis/plots')\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/plot_meta/#mecfs_bio.build_system.meta.plot_meta.GWASPlotDirectoryMeta.trait","title":"trait  <code>instance-attribute</code>","text":"<pre><code>trait: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/processed_gwas_data_directory_meta/","title":"processed_gwas_data_directory_meta","text":""},{"location":"reference/mecfs_bio/build_system/meta/processed_gwas_data_directory_meta/#mecfs_bio.build_system.meta.processed_gwas_data_directory_meta","title":"mecfs_bio.build_system.meta.processed_gwas_data_directory_meta","text":"<p>Metadata describing a directory containing plots from the analysis of GWAS data.</p> <p>Classes:</p> <ul> <li> <code>ProcessedGwasDataDirectoryMeta</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/processed_gwas_data_directory_meta/#mecfs_bio.build_system.meta.processed_gwas_data_directory_meta.ProcessedGwasDataDirectoryMeta","title":"ProcessedGwasDataDirectoryMeta","text":"<p>               Bases: <code>DirMeta</code></p> <p>Attributes:</p> <ul> <li> <code>asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>project</code>               (<code>str</code>)           \u2013            </li> <li> <code>sub_dir</code>               (<code>PurePath</code>)           \u2013            </li> <li> <code>trait</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/processed_gwas_data_directory_meta/#mecfs_bio.build_system.meta.processed_gwas_data_directory_meta.ProcessedGwasDataDirectoryMeta.asset_id","title":"asset_id  <code>property</code>","text":"<pre><code>asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/processed_gwas_data_directory_meta/#mecfs_bio.build_system.meta.processed_gwas_data_directory_meta.ProcessedGwasDataDirectoryMeta.id","title":"id  <code>instance-attribute</code>","text":"<pre><code>id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/processed_gwas_data_directory_meta/#mecfs_bio.build_system.meta.processed_gwas_data_directory_meta.ProcessedGwasDataDirectoryMeta.project","title":"project  <code>instance-attribute</code>","text":"<pre><code>project: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/processed_gwas_data_directory_meta/#mecfs_bio.build_system.meta.processed_gwas_data_directory_meta.ProcessedGwasDataDirectoryMeta.sub_dir","title":"sub_dir  <code>instance-attribute</code>","text":"<pre><code>sub_dir: PurePath\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/processed_gwas_data_directory_meta/#mecfs_bio.build_system.meta.processed_gwas_data_directory_meta.ProcessedGwasDataDirectoryMeta.trait","title":"trait  <code>instance-attribute</code>","text":"<pre><code>trait: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/","title":"read_spec","text":""},{"location":"reference/mecfs_bio/build_system/meta/read_spec/#mecfs_bio.build_system.meta.read_spec","title":"mecfs_bio.build_system.meta.read_spec","text":"<p>A ReadSpec is a special form of metadata that specifies how an asset should be read from disk.</p> <p>Modules:</p> <ul> <li> <code>dataframe_read_spec</code>           \u2013            </li> <li> <code>read_dataframe</code>           \u2013            </li> <li> <code>read_path</code>           \u2013            </li> <li> <code>read_spec</code>           \u2013            </li> <li> <code>read_sumstats</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/dataframe_read_spec/","title":"dataframe_read_spec","text":""},{"location":"reference/mecfs_bio/build_system/meta/read_spec/dataframe_read_spec/#mecfs_bio.build_system.meta.read_spec.dataframe_read_spec","title":"mecfs_bio.build_system.meta.read_spec.dataframe_read_spec","text":"<p>Classes:</p> <ul> <li> <code>DataFrameParquetFormat</code>           \u2013            </li> <li> <code>DataFrameReadSpec</code>           \u2013            <p>Specifies how a file containing a dataframe should be read.</p> </li> <li> <code>DataFrameTextFormat</code>           \u2013            </li> <li> <code>DataFrameWhiteSpaceSepTextFormat</code>           \u2013            </li> </ul> <p>Attributes:</p> <ul> <li> <code>Compression</code>           \u2013            </li> <li> <code>DataFrameFormat</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/dataframe_read_spec/#mecfs_bio.build_system.meta.read_spec.dataframe_read_spec.Compression","title":"Compression  <code>module-attribute</code>","text":"<pre><code>Compression = Literal['gzip']\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/dataframe_read_spec/#mecfs_bio.build_system.meta.read_spec.dataframe_read_spec.DataFrameFormat","title":"DataFrameFormat  <code>module-attribute</code>","text":"<pre><code>DataFrameFormat = (\n    DataFrameTextFormat\n    | DataFrameParquetFormat\n    | DataFrameWhiteSpaceSepTextFormat\n)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/dataframe_read_spec/#mecfs_bio.build_system.meta.read_spec.dataframe_read_spec.DataFrameParquetFormat","title":"DataFrameParquetFormat","text":""},{"location":"reference/mecfs_bio/build_system/meta/read_spec/dataframe_read_spec/#mecfs_bio.build_system.meta.read_spec.dataframe_read_spec.DataFrameReadSpec","title":"DataFrameReadSpec","text":"<p>Specifies how a file containing a dataframe should be read. Allows client code to operate without concern for the specifics of the dataframe format.</p> <p>Attributes:</p> <ul> <li> <code>format</code>               (<code>DataFrameFormat</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/dataframe_read_spec/#mecfs_bio.build_system.meta.read_spec.dataframe_read_spec.DataFrameReadSpec.format","title":"format  <code>instance-attribute</code>","text":"<pre><code>format: DataFrameFormat\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/dataframe_read_spec/#mecfs_bio.build_system.meta.read_spec.dataframe_read_spec.DataFrameTextFormat","title":"DataFrameTextFormat","text":"<p>Attributes:</p> <ul> <li> <code>column_names</code>               (<code>list[str] | None</code>)           \u2013            </li> <li> <code>comment_char</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>has_header</code>               (<code>bool</code>)           \u2013            </li> <li> <code>null_values</code>               (<code>Sequence[str] | None</code>)           \u2013            </li> <li> <code>schema_overrides</code>               (<code>Mapping[str, DataType]</code>)           \u2013            </li> <li> <code>separator</code>               (<code>str</code>)           \u2013            </li> <li> <code>skip_rows</code>               (<code>int</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/dataframe_read_spec/#mecfs_bio.build_system.meta.read_spec.dataframe_read_spec.DataFrameTextFormat.column_names","title":"column_names  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>column_names: list[str] | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/dataframe_read_spec/#mecfs_bio.build_system.meta.read_spec.dataframe_read_spec.DataFrameTextFormat.comment_char","title":"comment_char  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>comment_char: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/dataframe_read_spec/#mecfs_bio.build_system.meta.read_spec.dataframe_read_spec.DataFrameTextFormat.has_header","title":"has_header  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>has_header: bool = True\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/dataframe_read_spec/#mecfs_bio.build_system.meta.read_spec.dataframe_read_spec.DataFrameTextFormat.null_values","title":"null_values  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>null_values: Sequence[str] | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/dataframe_read_spec/#mecfs_bio.build_system.meta.read_spec.dataframe_read_spec.DataFrameTextFormat.schema_overrides","title":"schema_overrides  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>schema_overrides: Mapping[str, DataType] = field(\n    factory=dict\n)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/dataframe_read_spec/#mecfs_bio.build_system.meta.read_spec.dataframe_read_spec.DataFrameTextFormat.separator","title":"separator  <code>instance-attribute</code>","text":"<pre><code>separator: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/dataframe_read_spec/#mecfs_bio.build_system.meta.read_spec.dataframe_read_spec.DataFrameTextFormat.skip_rows","title":"skip_rows  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>skip_rows: int = 0\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/dataframe_read_spec/#mecfs_bio.build_system.meta.read_spec.dataframe_read_spec.DataFrameWhiteSpaceSepTextFormat","title":"DataFrameWhiteSpaceSepTextFormat","text":"<p>Attributes:</p> <ul> <li> <code>col_names</code>               (<code>list[str] | None</code>)           \u2013            </li> <li> <code>comment_code</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/dataframe_read_spec/#mecfs_bio.build_system.meta.read_spec.dataframe_read_spec.DataFrameWhiteSpaceSepTextFormat.col_names","title":"col_names  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>col_names: list[str] | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/dataframe_read_spec/#mecfs_bio.build_system.meta.read_spec.dataframe_read_spec.DataFrameWhiteSpaceSepTextFormat.comment_code","title":"comment_code  <code>instance-attribute</code>","text":"<pre><code>comment_code: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/read_dataframe/","title":"read_dataframe","text":""},{"location":"reference/mecfs_bio/build_system/meta/read_spec/read_dataframe/#mecfs_bio.build_system.meta.read_spec.read_dataframe","title":"mecfs_bio.build_system.meta.read_spec.read_dataframe","text":"<p>Functions:</p> <ul> <li> <code>scan_dataframe</code>             \u2013              </li> <li> <code>scan_dataframe_asset</code>             \u2013              <p>Use the information in an Asset's metadata to read it as a DataFrame</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>ValidBackend</code>           \u2013            </li> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/read_dataframe/#mecfs_bio.build_system.meta.read_spec.read_dataframe.ValidBackend","title":"ValidBackend  <code>module-attribute</code>","text":"<pre><code>ValidBackend = Literal['ibis', 'polars', 'duckdb']\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/read_dataframe/#mecfs_bio.build_system.meta.read_spec.read_dataframe.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/read_dataframe/#mecfs_bio.build_system.meta.read_spec.read_dataframe.scan_dataframe","title":"scan_dataframe","text":"<pre><code>scan_dataframe(\n    path: Path,\n    spec: DataFrameReadSpec,\n    parquet_backend: ValidBackend = \"polars\",\n) -&gt; nw.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/meta/read_spec/read_dataframe.py</code> <pre><code>def scan_dataframe(\n    path: Path, spec: DataFrameReadSpec, parquet_backend: ValidBackend = \"polars\"\n) -&gt; nw.LazyFrame:\n    if isinstance(spec.format, DataFrameParquetFormat):\n        logger.debug(f\"Scanning parquet asset at {path} with backend {parquet_backend}\")\n        return nw.scan_parquet(path, backend=parquet_backend)\n    if isinstance(spec.format, DataFrameTextFormat):\n        if spec.format.column_names is not None:\n            col_list: list[str] = spec.format.column_names\n            col_func = lambda x: col_list\n        else:\n            col_func = None\n        if parquet_backend == \"polars\":\n            logger.debug(\n                f\"scanning text table asset at {path} with backend {parquet_backend}\"\n            )\n            polars_scan = pl.scan_csv(\n                path,\n                separator=spec.format.separator,\n                null_values=spec.format.null_values,\n                schema_overrides=spec.format.schema_overrides,\n                with_column_names=col_func,\n                has_header=spec.format.has_header,\n                skip_rows=spec.format.skip_rows,\n                comment_prefix=spec.format.comment_char,\n            )\n            return nw.from_native(polars_scan)\n        raise ValueError(\"Only polars backend can be used to read text files\")\n    if isinstance(spec.format, DataFrameWhiteSpaceSepTextFormat):\n        extra_options: dict = {}\n        if spec.format.col_names is not None:\n            extra_options = extra_options | {\"names\": spec.format.col_names}\n        return nw.from_native(\n            pl.from_pandas(\n                pd.read_csv(\n                    path, sep=r\"\\s+\", comment=spec.format.comment_code, **extra_options\n                )\n            )\n        ).lazy()\n\n    raise ValueError(\"Unknown format\")\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/read_dataframe/#mecfs_bio.build_system.meta.read_spec.read_dataframe.scan_dataframe_asset","title":"scan_dataframe_asset","text":"<pre><code>scan_dataframe_asset(\n    asset: Asset,\n    meta: Meta,\n    parquet_backend: ValidBackend = \"polars\",\n) -&gt; nw.LazyFrame\n</code></pre> <p>Use the information in an Asset's metadata to read it as a DataFrame</p> Source code in <code>mecfs_bio/build_system/meta/read_spec/read_dataframe.py</code> <pre><code>def scan_dataframe_asset(\n    asset: Asset, meta: Meta, parquet_backend: ValidBackend = \"polars\"\n) -&gt; nw.LazyFrame:\n    \"\"\"\n    Use the information in an Asset's metadata to read it as a DataFrame\n    \"\"\"\n    assert isinstance(asset, FileAsset)\n    assert isinstance(meta, FileMeta)\n    return _scan_dataframe_asset(asset, meta, parquet_backend)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/read_path/","title":"read_path","text":""},{"location":"reference/mecfs_bio/build_system/meta/read_spec/read_path/#mecfs_bio.build_system.meta.read_spec.read_path","title":"mecfs_bio.build_system.meta.read_spec.read_path","text":"<p>Functions:</p> <ul> <li> <code>read_file_asset_path</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/read_path/#mecfs_bio.build_system.meta.read_spec.read_path.read_file_asset_path","title":"read_file_asset_path","text":"<pre><code>read_file_asset_path(asset: Asset) -&gt; Path\n</code></pre> Source code in <code>mecfs_bio/build_system/meta/read_spec/read_path.py</code> <pre><code>def read_file_asset_path(asset: Asset) -&gt; Path:\n    assert isinstance(asset, FileAsset)\n    return asset.path\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/read_spec/","title":"read_spec","text":""},{"location":"reference/mecfs_bio/build_system/meta/read_spec/read_spec/#mecfs_bio.build_system.meta.read_spec.read_spec","title":"mecfs_bio.build_system.meta.read_spec.read_spec","text":"<p>Attributes:</p> <ul> <li> <code>ReadSpec</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/read_spec/#mecfs_bio.build_system.meta.read_spec.read_spec.ReadSpec","title":"ReadSpec  <code>module-attribute</code>","text":"<pre><code>ReadSpec = DataFrameReadSpec\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/read_sumstats/","title":"read_sumstats","text":""},{"location":"reference/mecfs_bio/build_system/meta/read_spec/read_sumstats/#mecfs_bio.build_system.meta.read_spec.read_sumstats","title":"mecfs_bio.build_system.meta.read_spec.read_sumstats","text":"<p>Functions:</p> <ul> <li> <code>read_sumstats</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/read_sumstats/#mecfs_bio.build_system.meta.read_spec.read_sumstats.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/read_spec/read_sumstats/#mecfs_bio.build_system.meta.read_spec.read_sumstats.read_sumstats","title":"read_sumstats","text":"<pre><code>read_sumstats(asset: Asset) -&gt; gwaslab.Sumstats\n</code></pre> Source code in <code>mecfs_bio/build_system/meta/read_spec/read_sumstats.py</code> <pre><code>def read_sumstats(asset: Asset) -&gt; gwaslab.Sumstats:\n    assert isinstance(asset, FileAsset)\n    logger.debug(f\"reading sumstats from {asset.path}\")\n    return gwaslab.load_pickle(asset.path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/reference_meta/","title":"reference_meta","text":""},{"location":"reference/mecfs_bio/build_system/meta/reference_meta/#mecfs_bio.build_system.meta.reference_meta","title":"mecfs_bio.build_system.meta.reference_meta","text":"<p>Modules:</p> <ul> <li> <code>reference_data_directory_meta</code>           \u2013            </li> <li> <code>reference_file_meta</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/reference_meta/reference_data_directory_meta/","title":"reference_data_directory_meta","text":""},{"location":"reference/mecfs_bio/build_system/meta/reference_meta/reference_data_directory_meta/#mecfs_bio.build_system.meta.reference_meta.reference_data_directory_meta","title":"mecfs_bio.build_system.meta.reference_meta.reference_data_directory_meta","text":"<p>Classes:</p> <ul> <li> <code>ReferenceDataDirectoryMeta</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/reference_meta/reference_data_directory_meta/#mecfs_bio.build_system.meta.reference_meta.reference_data_directory_meta.ReferenceDataDirectoryMeta","title":"ReferenceDataDirectoryMeta","text":"<p>               Bases: <code>DirMeta</code></p> <p>Attributes:</p> <ul> <li> <code>asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>dirname</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>group</code>               (<code>str</code>)           \u2013            </li> <li> <code>id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>sub_folder</code>               (<code>PurePath</code>)           \u2013            </li> <li> <code>sub_group</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/reference_meta/reference_data_directory_meta/#mecfs_bio.build_system.meta.reference_meta.reference_data_directory_meta.ReferenceDataDirectoryMeta.asset_id","title":"asset_id  <code>property</code>","text":"<pre><code>asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/reference_meta/reference_data_directory_meta/#mecfs_bio.build_system.meta.reference_meta.reference_data_directory_meta.ReferenceDataDirectoryMeta.dirname","title":"dirname  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>dirname: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/reference_meta/reference_data_directory_meta/#mecfs_bio.build_system.meta.reference_meta.reference_data_directory_meta.ReferenceDataDirectoryMeta.group","title":"group  <code>instance-attribute</code>","text":"<pre><code>group: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/reference_meta/reference_data_directory_meta/#mecfs_bio.build_system.meta.reference_meta.reference_data_directory_meta.ReferenceDataDirectoryMeta.id","title":"id  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>id: AssetId = field(converter=AssetId)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/reference_meta/reference_data_directory_meta/#mecfs_bio.build_system.meta.reference_meta.reference_data_directory_meta.ReferenceDataDirectoryMeta.sub_folder","title":"sub_folder  <code>instance-attribute</code>","text":"<pre><code>sub_folder: PurePath\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/reference_meta/reference_data_directory_meta/#mecfs_bio.build_system.meta.reference_meta.reference_data_directory_meta.ReferenceDataDirectoryMeta.sub_group","title":"sub_group  <code>instance-attribute</code>","text":"<pre><code>sub_group: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/reference_meta/reference_file_meta/","title":"reference_file_meta","text":""},{"location":"reference/mecfs_bio/build_system/meta/reference_meta/reference_file_meta/#mecfs_bio.build_system.meta.reference_meta.reference_file_meta","title":"mecfs_bio.build_system.meta.reference_meta.reference_file_meta","text":"<p>Classes:</p> <ul> <li> <code>ReferenceFileMeta</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/reference_meta/reference_file_meta/#mecfs_bio.build_system.meta.reference_meta.reference_file_meta.ReferenceFileMeta","title":"ReferenceFileMeta","text":"<p>               Bases: <code>FileMeta</code></p> <p>Methods:</p> <ul> <li> <code>read_spec</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>extension</code>               (<code>str</code>)           \u2013            </li> <li> <code>filename</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>group</code>               (<code>str</code>)           \u2013            </li> <li> <code>id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>sub_folder</code>               (<code>PurePath</code>)           \u2013            </li> <li> <code>sub_group</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/reference_meta/reference_file_meta/#mecfs_bio.build_system.meta.reference_meta.reference_file_meta.ReferenceFileMeta.asset_id","title":"asset_id  <code>property</code>","text":"<pre><code>asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/reference_meta/reference_file_meta/#mecfs_bio.build_system.meta.reference_meta.reference_file_meta.ReferenceFileMeta.extension","title":"extension  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>extension: str = '.zip'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/reference_meta/reference_file_meta/#mecfs_bio.build_system.meta.reference_meta.reference_file_meta.ReferenceFileMeta.filename","title":"filename  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>filename: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/reference_meta/reference_file_meta/#mecfs_bio.build_system.meta.reference_meta.reference_file_meta.ReferenceFileMeta.group","title":"group  <code>instance-attribute</code>","text":"<pre><code>group: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/reference_meta/reference_file_meta/#mecfs_bio.build_system.meta.reference_meta.reference_file_meta.ReferenceFileMeta.id","title":"id  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>id: AssetId = field(converter=AssetId)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/reference_meta/reference_file_meta/#mecfs_bio.build_system.meta.reference_meta.reference_file_meta.ReferenceFileMeta.sub_folder","title":"sub_folder  <code>instance-attribute</code>","text":"<pre><code>sub_folder: PurePath\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/reference_meta/reference_file_meta/#mecfs_bio.build_system.meta.reference_meta.reference_file_meta.ReferenceFileMeta.sub_group","title":"sub_group  <code>instance-attribute</code>","text":"<pre><code>sub_group: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/reference_meta/reference_file_meta/#mecfs_bio.build_system.meta.reference_meta.reference_file_meta.ReferenceFileMeta.read_spec","title":"read_spec","text":"<pre><code>read_spec() -&gt; ReadSpec | None\n</code></pre> Source code in <code>mecfs_bio/build_system/meta/reference_meta/reference_file_meta.py</code> <pre><code>def read_spec(self) -&gt; ReadSpec | None:\n    return self._read_spec\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/result_directory_meta/","title":"result_directory_meta","text":""},{"location":"reference/mecfs_bio/build_system/meta/result_directory_meta/#mecfs_bio.build_system.meta.result_directory_meta","title":"mecfs_bio.build_system.meta.result_directory_meta","text":"<p>Metadata describing a directory containing multiple analysis result files</p> <p>Classes:</p> <ul> <li> <code>ResultDirectoryMeta</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/result_directory_meta/#mecfs_bio.build_system.meta.result_directory_meta.ResultDirectoryMeta","title":"ResultDirectoryMeta","text":"<p>               Bases: <code>DirMeta</code></p> <p>Attributes:</p> <ul> <li> <code>asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>id</code>               (<code>str</code>)           \u2013            </li> <li> <code>project</code>               (<code>str</code>)           \u2013            </li> <li> <code>sub_dir</code>               (<code>PurePath</code>)           \u2013            </li> <li> <code>trait</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/result_directory_meta/#mecfs_bio.build_system.meta.result_directory_meta.ResultDirectoryMeta.asset_id","title":"asset_id  <code>property</code>","text":"<pre><code>asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/result_directory_meta/#mecfs_bio.build_system.meta.result_directory_meta.ResultDirectoryMeta.id","title":"id  <code>instance-attribute</code>","text":"<pre><code>id: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/result_directory_meta/#mecfs_bio.build_system.meta.result_directory_meta.ResultDirectoryMeta.project","title":"project  <code>instance-attribute</code>","text":"<pre><code>project: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/result_directory_meta/#mecfs_bio.build_system.meta.result_directory_meta.ResultDirectoryMeta.sub_dir","title":"sub_dir  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>sub_dir: PurePath = PurePath('analysis')\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/result_directory_meta/#mecfs_bio.build_system.meta.result_directory_meta.ResultDirectoryMeta.trait","title":"trait  <code>instance-attribute</code>","text":"<pre><code>trait: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/result_table_meta/","title":"result_table_meta","text":""},{"location":"reference/mecfs_bio/build_system/meta/result_table_meta/#mecfs_bio.build_system.meta.result_table_meta","title":"mecfs_bio.build_system.meta.result_table_meta","text":"<p>Metadata describing tabular data from the analysis of GWAS.</p> <p>Classes:</p> <ul> <li> <code>ResultTableMeta</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/result_table_meta/#mecfs_bio.build_system.meta.result_table_meta.ResultTableMeta","title":"ResultTableMeta","text":"<p>               Bases: <code>FileMeta</code></p> <p>Methods:</p> <ul> <li> <code>read_spec</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>extension</code>               (<code>str</code>)           \u2013            </li> <li> <code>id</code>               (<code>str</code>)           \u2013            </li> <li> <code>project</code>               (<code>str</code>)           \u2013            </li> <li> <code>sub_dir</code>               (<code>PurePath</code>)           \u2013            </li> <li> <code>trait</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/result_table_meta/#mecfs_bio.build_system.meta.result_table_meta.ResultTableMeta.asset_id","title":"asset_id  <code>property</code>","text":"<pre><code>asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/result_table_meta/#mecfs_bio.build_system.meta.result_table_meta.ResultTableMeta.extension","title":"extension  <code>instance-attribute</code>","text":"<pre><code>extension: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/result_table_meta/#mecfs_bio.build_system.meta.result_table_meta.ResultTableMeta.id","title":"id  <code>instance-attribute</code>","text":"<pre><code>id: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/result_table_meta/#mecfs_bio.build_system.meta.result_table_meta.ResultTableMeta.project","title":"project  <code>instance-attribute</code>","text":"<pre><code>project: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/result_table_meta/#mecfs_bio.build_system.meta.result_table_meta.ResultTableMeta.sub_dir","title":"sub_dir  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>sub_dir: PurePath = PurePath('analysis')\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/result_table_meta/#mecfs_bio.build_system.meta.result_table_meta.ResultTableMeta.trait","title":"trait  <code>instance-attribute</code>","text":"<pre><code>trait: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/result_table_meta/#mecfs_bio.build_system.meta.result_table_meta.ResultTableMeta.read_spec","title":"read_spec","text":"<pre><code>read_spec() -&gt; ReadSpec | None\n</code></pre> Source code in <code>mecfs_bio/build_system/meta/result_table_meta.py</code> <pre><code>def read_spec(self) -&gt; ReadSpec | None:\n    return self._read_spec\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/simple_directory_meta/","title":"simple_directory_meta","text":""},{"location":"reference/mecfs_bio/build_system/meta/simple_directory_meta/#mecfs_bio.build_system.meta.simple_directory_meta","title":"mecfs_bio.build_system.meta.simple_directory_meta","text":"<p>Metadata describing a miscellaneous directory.</p> <p>Classes:</p> <ul> <li> <code>SimpleDirectoryMeta</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/simple_directory_meta/#mecfs_bio.build_system.meta.simple_directory_meta.SimpleDirectoryMeta","title":"SimpleDirectoryMeta","text":"<p>               Bases: <code>DirMeta</code></p> <p>Attributes:</p> <ul> <li> <code>asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>id</code>               (<code>AssetId</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/simple_directory_meta/#mecfs_bio.build_system.meta.simple_directory_meta.SimpleDirectoryMeta.asset_id","title":"asset_id  <code>property</code>","text":"<pre><code>asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/simple_directory_meta/#mecfs_bio.build_system.meta.simple_directory_meta.SimpleDirectoryMeta.id","title":"id  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>id: AssetId = field(converter=AssetId)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/simple_file_meta/","title":"simple_file_meta","text":""},{"location":"reference/mecfs_bio/build_system/meta/simple_file_meta/#mecfs_bio.build_system.meta.simple_file_meta","title":"mecfs_bio.build_system.meta.simple_file_meta","text":"<p>Metadata describing a miscellaneous file.</p> <p>Classes:</p> <ul> <li> <code>SimpleFileMeta</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/simple_file_meta/#mecfs_bio.build_system.meta.simple_file_meta.SimpleFileMeta","title":"SimpleFileMeta","text":"<p>               Bases: <code>FileMeta</code></p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>read_spec</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>id</code>               (<code>AssetId</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/meta/simple_file_meta/#mecfs_bio.build_system.meta.simple_file_meta.SimpleFileMeta.asset_id","title":"asset_id  <code>property</code>","text":"<pre><code>asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/simple_file_meta/#mecfs_bio.build_system.meta.simple_file_meta.SimpleFileMeta.id","title":"id  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>id: AssetId = field(converter=AssetId)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/simple_file_meta/#mecfs_bio.build_system.meta.simple_file_meta.SimpleFileMeta.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(asset_id: str)\n</code></pre> Source code in <code>mecfs_bio/build_system/meta/simple_file_meta.py</code> <pre><code>@classmethod\ndef create(cls, asset_id: str):\n    return cls(\n        id=AssetId(asset_id),\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/meta/simple_file_meta/#mecfs_bio.build_system.meta.simple_file_meta.SimpleFileMeta.read_spec","title":"read_spec","text":"<pre><code>read_spec() -&gt; ReadSpec | None\n</code></pre> Source code in <code>mecfs_bio/build_system/meta/simple_file_meta.py</code> <pre><code>def read_spec(self) -&gt; ReadSpec | None:\n    return self._read_spec\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/","title":"rebuilder","text":""},{"location":"reference/mecfs_bio/build_system/rebuilder/#mecfs_bio.build_system.rebuilder","title":"mecfs_bio.build_system.rebuilder","text":"<p>A rebuilder performs the following key operations: A) Decide whether a given asset is up-to-date using the info-store. B) If the asset is up-to-date, return it together with the info-store. C) If the asset is not up-to-date, bring it up-to-date, update the info-store, and return the new values of both.</p> <p>Modules:</p> <ul> <li> <code>base_rebuilder</code>           \u2013            <p>Abstract base class for Rebuilders.  See Andrey Mokhov, Neil Mitchell, and Simon Peyton Jones. Build systems \u00e0 la carte.</p> </li> <li> <code>fetch</code>           \u2013            </li> <li> <code>metadata_to_path</code>           \u2013            </li> <li> <code>sandboxed_execute</code>           \u2013            </li> <li> <code>tracking_sandboxed_execute</code>           \u2013            </li> <li> <code>verifying_trace_rebuilder</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/base_rebuilder/","title":"base_rebuilder","text":""},{"location":"reference/mecfs_bio/build_system/rebuilder/base_rebuilder/#mecfs_bio.build_system.rebuilder.base_rebuilder","title":"mecfs_bio.build_system.rebuilder.base_rebuilder","text":"<p>Abstract base class for Rebuilders.  See Andrey Mokhov, Neil Mitchell, and Simon Peyton Jones. Build systems \u00e0 la carte.</p> <p>Classes:</p> <ul> <li> <code>Rebuilder</code>           \u2013            <p>Key Operations:</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/base_rebuilder/#mecfs_bio.build_system.rebuilder.base_rebuilder.Rebuilder","title":"Rebuilder","text":"<p>               Bases: <code>ABC</code></p> <p>Key Operations: - Decide whether a given asset is up-to-date using information from Info. - If the asset is up-to-date, return it together with Info. - If the asset is not up-to-date, bring it up-to-date, update Info, and return the new values of both.</p> <p>Methods:</p> <ul> <li> <code>rebuild</code>             \u2013              </li> <li> <code>save_info</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/base_rebuilder/#mecfs_bio.build_system.rebuilder.base_rebuilder.Rebuilder.rebuild","title":"rebuild  <code>abstractmethod</code>","text":"<pre><code>rebuild(\n    task: Task,\n    asset: Asset | None,\n    fetch: Fetch,\n    wf: WF,\n    info: Info,\n    meta_to_path: MetaToPath,\n) -&gt; tuple[Asset, Info]\n</code></pre> Source code in <code>mecfs_bio/build_system/rebuilder/base_rebuilder.py</code> <pre><code>@abstractmethod\ndef rebuild(\n    self,\n    task: Task,\n    asset: Asset | None,\n    fetch: Fetch,\n    wf: WF,\n    info: Info,\n    meta_to_path: MetaToPath,\n) -&gt; tuple[Asset, Info]:\n    pass\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/base_rebuilder/#mecfs_bio.build_system.rebuilder.base_rebuilder.Rebuilder.save_info","title":"save_info  <code>abstractmethod</code> <code>classmethod</code>","text":"<pre><code>save_info(info: Info, path: Path)\n</code></pre> Source code in <code>mecfs_bio/build_system/rebuilder/base_rebuilder.py</code> <pre><code>@classmethod\n@abstractmethod\ndef save_info(cls, info: Info, path: Path):\n    pass\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/fetch/","title":"fetch","text":""},{"location":"reference/mecfs_bio/build_system/rebuilder/fetch/#mecfs_bio.build_system.rebuilder.fetch","title":"mecfs_bio.build_system.rebuilder.fetch","text":"<p>Modules:</p> <ul> <li> <code>base_fetch</code>           \u2013            </li> <li> <code>restricted_fetch</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/fetch/base_fetch/","title":"base_fetch","text":""},{"location":"reference/mecfs_bio/build_system/rebuilder/fetch/base_fetch/#mecfs_bio.build_system.rebuilder.fetch.base_fetch","title":"mecfs_bio.build_system.rebuilder.fetch.base_fetch","text":"<p>Classes:</p> <ul> <li> <code>Fetch</code>           \u2013            <p>An interface for materializing or retrieving assets, given their ids.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/fetch/base_fetch/#mecfs_bio.build_system.rebuilder.fetch.base_fetch.Fetch","title":"Fetch","text":"<p>               Bases: <code>Protocol</code></p> <p>An interface for materializing or retrieving assets, given their ids.</p>"},{"location":"reference/mecfs_bio/build_system/rebuilder/fetch/restricted_fetch/","title":"restricted_fetch","text":""},{"location":"reference/mecfs_bio/build_system/rebuilder/fetch/restricted_fetch/#mecfs_bio.build_system.rebuilder.fetch.restricted_fetch","title":"mecfs_bio.build_system.rebuilder.fetch.restricted_fetch","text":"<p>Classes:</p> <ul> <li> <code>RestrictedFetch</code>           \u2013            <p>A Fetch the prevents the retrieval of assets except those on a given list.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/fetch/restricted_fetch/#mecfs_bio.build_system.rebuilder.fetch.restricted_fetch.RestrictedFetch","title":"RestrictedFetch","text":"<p>               Bases: <code>Fetch</code></p> <p>A Fetch the prevents the retrieval of assets except those on a given list. Used to ensure the declared dependencies of a task are accurate.</p> <p>Methods:</p> <ul> <li> <code>from_task</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>inner</code>               (<code>Fetch</code>)           \u2013            </li> <li> <code>meta_deps</code>               (<code>frozenset[AssetId]</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/fetch/restricted_fetch/#mecfs_bio.build_system.rebuilder.fetch.restricted_fetch.RestrictedFetch.inner","title":"inner  <code>instance-attribute</code>","text":"<pre><code>inner: Fetch\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/fetch/restricted_fetch/#mecfs_bio.build_system.rebuilder.fetch.restricted_fetch.RestrictedFetch.meta_deps","title":"meta_deps  <code>instance-attribute</code>","text":"<pre><code>meta_deps: frozenset[AssetId]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/fetch/restricted_fetch/#mecfs_bio.build_system.rebuilder.fetch.restricted_fetch.RestrictedFetch.from_task","title":"from_task  <code>classmethod</code>","text":"<pre><code>from_task(fetch: Fetch, task: Task)\n</code></pre> Source code in <code>mecfs_bio/build_system/rebuilder/fetch/restricted_fetch.py</code> <pre><code>@classmethod\ndef from_task(cls, fetch: Fetch, task: Task):\n    return cls(fetch, frozenset({dep.meta.asset_id for dep in task.deps}))\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/metadata_to_path/","title":"metadata_to_path","text":""},{"location":"reference/mecfs_bio/build_system/rebuilder/metadata_to_path/#mecfs_bio.build_system.rebuilder.metadata_to_path","title":"mecfs_bio.build_system.rebuilder.metadata_to_path","text":"<p>Modules:</p> <ul> <li> <code>base_meta_to_path</code>           \u2013            </li> <li> <code>simple_meta_to_path</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/metadata_to_path/base_meta_to_path/","title":"base_meta_to_path","text":""},{"location":"reference/mecfs_bio/build_system/rebuilder/metadata_to_path/base_meta_to_path/#mecfs_bio.build_system.rebuilder.metadata_to_path.base_meta_to_path","title":"mecfs_bio.build_system.rebuilder.metadata_to_path.base_meta_to_path","text":"<p>Classes:</p> <ul> <li> <code>MetaToPath</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/metadata_to_path/base_meta_to_path/#mecfs_bio.build_system.rebuilder.metadata_to_path.base_meta_to_path.MetaToPath","title":"MetaToPath","text":"<p>               Bases: <code>ABC</code></p>"},{"location":"reference/mecfs_bio/build_system/rebuilder/metadata_to_path/simple_meta_to_path/","title":"simple_meta_to_path","text":""},{"location":"reference/mecfs_bio/build_system/rebuilder/metadata_to_path/simple_meta_to_path/#mecfs_bio.build_system.rebuilder.metadata_to_path.simple_meta_to_path","title":"mecfs_bio.build_system.rebuilder.metadata_to_path.simple_meta_to_path","text":"<p>Classes:</p> <ul> <li> <code>SimpleMetaToPath</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/metadata_to_path/simple_meta_to_path/#mecfs_bio.build_system.rebuilder.metadata_to_path.simple_meta_to_path.SimpleMetaToPath","title":"SimpleMetaToPath","text":"<p>               Bases: <code>MetaToPath</code></p> <p>Attributes:</p> <ul> <li> <code>root</code>               (<code>Path</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/metadata_to_path/simple_meta_to_path/#mecfs_bio.build_system.rebuilder.metadata_to_path.simple_meta_to_path.SimpleMetaToPath.root","title":"root  <code>instance-attribute</code>","text":"<pre><code>root: Path\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/sandboxed_execute/","title":"sandboxed_execute","text":""},{"location":"reference/mecfs_bio/build_system/rebuilder/sandboxed_execute/#mecfs_bio.build_system.rebuilder.sandboxed_execute","title":"mecfs_bio.build_system.rebuilder.sandboxed_execute","text":"<p>Functions:</p> <ul> <li> <code>sandboxed_execute</code>             \u2013              <p>Execute a task in a temporary directory, then move its result to the final location</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/sandboxed_execute/#mecfs_bio.build_system.rebuilder.sandboxed_execute.sandboxed_execute","title":"sandboxed_execute","text":"<pre><code>sandboxed_execute(\n    task: Task,\n    meta_to_path: MetaToPath,\n    wf: WF,\n    fetch: Fetch,\n) -&gt; Asset\n</code></pre> <p>Execute a task in a temporary directory, then move its result to the final location determined by the task's metadata.</p> Source code in <code>mecfs_bio/build_system/rebuilder/sandboxed_execute.py</code> <pre><code>def sandboxed_execute(\n    task: Task,\n    meta_to_path: MetaToPath,\n    wf: WF,\n    fetch: Fetch,\n) -&gt; Asset:\n    \"\"\"\n    Execute a task in a temporary directory, then move its result to the final location\n    determined by the task's metadata.\n    \"\"\"\n    meta = task.meta\n    target_path = meta_to_path(meta)\n    with tempfile.TemporaryDirectory() as temp_dir:\n        temp_path = Path(temp_dir) / \"temp\"\n        temp_path.mkdir(parents=True, exist_ok=True)\n        result = task.execute(scratch_dir=temp_path, fetch=fetch, wf=wf)\n        target_path.parent.mkdir(exist_ok=True, parents=True)\n        result = _move_asset(result, target_path)\n        logger.debug(f\"Saved asset {task.asset_id} to {target_path}.\")\n    return result\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/tracking_sandboxed_execute/","title":"tracking_sandboxed_execute","text":""},{"location":"reference/mecfs_bio/build_system/rebuilder/tracking_sandboxed_execute/#mecfs_bio.build_system.rebuilder.tracking_sandboxed_execute","title":"mecfs_bio.build_system.rebuilder.tracking_sandboxed_execute","text":"<p>Functions:</p> <ul> <li> <code>tracking_sandboxed_execute</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/tracking_sandboxed_execute/#mecfs_bio.build_system.rebuilder.tracking_sandboxed_execute.tracking_sandboxed_execute","title":"tracking_sandboxed_execute","text":"<pre><code>tracking_sandboxed_execute(\n    task: Task,\n    meta_to_path: MetaToPath,\n    wf: WF,\n    fetch: Fetch,\n) -&gt; tuple[Asset, list[tuple[AssetId, Asset]]]\n</code></pre> Source code in <code>mecfs_bio/build_system/rebuilder/tracking_sandboxed_execute.py</code> <pre><code>def tracking_sandboxed_execute(\n    task: Task,\n    meta_to_path: MetaToPath,\n    wf: WF,\n    fetch: Fetch,\n) -&gt; tuple[Asset, list[tuple[AssetId, Asset]]]:\n    deps: list[tuple[AssetId, Asset]] = []\n\n    class TrackingFetch(Fetch):\n        def __call__(self, asset_id: AssetId) -&gt; Asset:\n            a = fetch(asset_id)\n            deps.append((asset_id, a))\n            return a\n\n    result = sandboxed_execute(\n        task=task, meta_to_path=meta_to_path, wf=wf, fetch=TrackingFetch()\n    )\n    return result, deps\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/","title":"verifying_trace_rebuilder","text":""},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder","title":"mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder","text":"<p>Modules:</p> <ul> <li> <code>tracer</code>           \u2013            </li> <li> <code>verifying_trace_info</code>           \u2013            </li> <li> <code>verifying_trace_rebuilder_core</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/","title":"tracer","text":""},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.tracer","title":"mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.tracer","text":"<p>Modules:</p> <ul> <li> <code>base_tracer</code>           \u2013            </li> <li> <code>imohash</code>           \u2013            </li> <li> <code>simple_hasher</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/base_tracer/","title":"base_tracer","text":""},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/base_tracer/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.tracer.base_tracer","title":"mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.tracer.base_tracer","text":"<p>Classes:</p> <ul> <li> <code>Tracer</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/base_tracer/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.tracer.base_tracer.Tracer","title":"Tracer","text":"<p>               Bases: <code>ABC</code></p>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/imohash/","title":"imohash","text":""},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/imohash/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.tracer.imohash","title":"mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.tracer.imohash","text":"<p>Classes:</p> <ul> <li> <code>ImoHasher</code>           \u2013            <p>Based on : https://github.com/kalafut/py-imohash/blob/master/imohash/imohash.py</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/imohash/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.tracer.imohash.ImoHasher","title":"ImoHasher","text":"<p>               Bases: <code>Tracer</code></p> <p>Based on : https://github.com/kalafut/py-imohash/blob/master/imohash/imohash.py Quick approximate hash that subsamples large files</p> <p>Methods:</p> <ul> <li> <code>with_xxhash_128</code>             \u2013              </li> <li> <code>with_xxhash_32</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>hash_constructor</code>               (<code>HashConstructor</code>)           \u2013            </li> <li> <code>hash_name</code>               (<code>str</code>)           \u2013            </li> <li> <code>sample_size</code>               (<code>int</code>)           \u2013            </li> <li> <code>sample_threshold</code>               (<code>int</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/imohash/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.tracer.imohash.ImoHasher.hash_constructor","title":"hash_constructor  <code>instance-attribute</code>","text":"<pre><code>hash_constructor: HashConstructor\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/imohash/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.tracer.imohash.ImoHasher.hash_name","title":"hash_name  <code>instance-attribute</code>","text":"<pre><code>hash_name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/imohash/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.tracer.imohash.ImoHasher.sample_size","title":"sample_size  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>sample_size: int = 16 * 1024\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/imohash/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.tracer.imohash.ImoHasher.sample_threshold","title":"sample_threshold  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>sample_threshold: int = 128 * 1024\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/imohash/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.tracer.imohash.ImoHasher.with_xxhash_128","title":"with_xxhash_128  <code>classmethod</code>","text":"<pre><code>with_xxhash_128()\n</code></pre> Source code in <code>mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/imohash.py</code> <pre><code>@classmethod\ndef with_xxhash_128(cls):\n    return cls(hash_constructor=xxhash.xxh3_128, hash_name=\"xxh3_128\")\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/imohash/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.tracer.imohash.ImoHasher.with_xxhash_32","title":"with_xxhash_32  <code>classmethod</code>","text":"<pre><code>with_xxhash_32()\n</code></pre> Source code in <code>mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/imohash.py</code> <pre><code>@classmethod\ndef with_xxhash_32(cls):\n    return cls(hash_constructor=xxhash.xxh32, hash_name=\"xxh32\")\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/simple_hasher/","title":"simple_hasher","text":""},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/simple_hasher/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.tracer.simple_hasher","title":"mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.tracer.simple_hasher","text":"<p>Classes:</p> <ul> <li> <code>SimpleHasher</code>           \u2013            </li> </ul> <p>Attributes:</p> <ul> <li> <code>HashConstructor</code>           \u2013            </li> <li> <code>HashObject</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/simple_hasher/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.tracer.simple_hasher.HashConstructor","title":"HashConstructor  <code>module-attribute</code>","text":"<pre><code>HashConstructor = Callable[[], HashObject]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/simple_hasher/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.tracer.simple_hasher.HashObject","title":"HashObject  <code>module-attribute</code>","text":"<pre><code>HashObject = Any\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/simple_hasher/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.tracer.simple_hasher.SimpleHasher","title":"SimpleHasher","text":"<p>               Bases: <code>Tracer</code></p> <p>Methods:</p> <ul> <li> <code>md5_hasher</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>chunk_size</code>               (<code>int</code>)           \u2013            </li> <li> <code>hash_constructor</code>               (<code>HashConstructor</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/simple_hasher/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.tracer.simple_hasher.SimpleHasher.chunk_size","title":"chunk_size  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>chunk_size: int = 8192\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/simple_hasher/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.tracer.simple_hasher.SimpleHasher.hash_constructor","title":"hash_constructor  <code>instance-attribute</code>","text":"<pre><code>hash_constructor: HashConstructor\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/simple_hasher/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.tracer.simple_hasher.SimpleHasher.md5_hasher","title":"md5_hasher  <code>classmethod</code>","text":"<pre><code>md5_hasher() -&gt; SimpleHasher\n</code></pre> Source code in <code>mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/tracer/simple_hasher.py</code> <pre><code>@classmethod\ndef md5_hasher(cls) -&gt; \"SimpleHasher\":\n    return cls(hashlib.md5)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_info/","title":"verifying_trace_info","text":""},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_info/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.verifying_trace_info","title":"mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.verifying_trace_info","text":"<p>Classes:</p> <ul> <li> <code>VerifyingTraceInfo</code>           \u2013            <p>Stores persistent data relevant to the verifying trace rebuilder</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>update_verifying_trace_info_in_place</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>TraceRecord</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_info/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.verifying_trace_info.TraceRecord","title":"TraceRecord  <code>module-attribute</code>","text":"<pre><code>TraceRecord = tuple[str, list[tuple[AssetId, str]]]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_info/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.verifying_trace_info.VerifyingTraceInfo","title":"VerifyingTraceInfo","text":"<p>Stores persistent data relevant to the verifying trace rebuilder Note that this is mutable trace_store: A map associating asset ids with:    - The traces of their corresponding assets    -  A list of the asset ids of the dependencies of these assets, together with the traces of these dependencies trace_store is used to decide when an asset needs to be regenerated.  An asset is regenerated when its trace, or the traces of its dependencies have changed</p> <p>Methods:</p> <ul> <li> <code>deserialize</code>             \u2013              </li> <li> <code>empty</code>             \u2013              </li> <li> <code>serialize</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>must_rebuild</code>               (<code>set[AssetId]</code>)           \u2013            </li> <li> <code>trace_store</code>               (<code>dict[AssetId, TraceRecord]</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_info/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.verifying_trace_info.VerifyingTraceInfo.must_rebuild","title":"must_rebuild  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>must_rebuild: set[AssetId] = field(factory=set)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_info/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.verifying_trace_info.VerifyingTraceInfo.trace_store","title":"trace_store  <code>instance-attribute</code>","text":"<pre><code>trace_store: dict[AssetId, TraceRecord]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_info/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.verifying_trace_info.VerifyingTraceInfo.deserialize","title":"deserialize  <code>classmethod</code>","text":"<pre><code>deserialize(path: Path) -&gt; VerifyingTraceInfo\n</code></pre> Source code in <code>mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_info.py</code> <pre><code>@classmethod\ndef deserialize(cls, path: Path) -&gt; \"VerifyingTraceInfo\":\n    conv = CONVERTER_FOR_SERIALIZATION\n    with open(path) as infile:\n        unstructured = yaml.load(infile, Loader=yaml.FullLoader)\n\n    trace_store = conv.structure(unstructured, dict[AssetId, TraceRecord])\n\n    return cls(trace_store=trace_store, must_rebuild=set())\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_info/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.verifying_trace_info.VerifyingTraceInfo.empty","title":"empty  <code>classmethod</code>","text":"<pre><code>empty() -&gt; VerifyingTraceInfo\n</code></pre> Source code in <code>mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_info.py</code> <pre><code>@classmethod\ndef empty(cls) -&gt; \"VerifyingTraceInfo\":\n    return cls(\n        trace_store={},\n        must_rebuild=set(),\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_info/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.verifying_trace_info.VerifyingTraceInfo.serialize","title":"serialize","text":"<pre><code>serialize(path: Path) -&gt; None\n</code></pre> Source code in <code>mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_info.py</code> <pre><code>def serialize(self, path: Path) -&gt; None:\n    conv = CONVERTER_FOR_SERIALIZATION\n    path.parent.mkdir(parents=True, exist_ok=True)\n    unstructured = conv.unstructure(self.trace_store)\n    atomic_write_yaml(path=path, data=unstructured)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_info/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.verifying_trace_info.update_verifying_trace_info_in_place","title":"update_verifying_trace_info_in_place","text":"<pre><code>update_verifying_trace_info_in_place(\n    verifying_trace_info: VerifyingTraceInfo,\n    meta: Meta,\n    new_value_trace: str,\n    deps_traced: list[tuple[AssetId, str]],\n) -&gt; None\n</code></pre> Source code in <code>mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_info.py</code> <pre><code>def update_verifying_trace_info_in_place(\n    verifying_trace_info: VerifyingTraceInfo,\n    meta: Meta,\n    new_value_trace: str,\n    deps_traced: list[tuple[AssetId, str]],\n) -&gt; None:\n    new_rebuild_set = set(verifying_trace_info.must_rebuild) - {meta.asset_id}\n    new_trace_store = dict(verifying_trace_info.trace_store)\n    new_trace_store[meta.asset_id] = new_value_trace, deps_traced\n    verifying_trace_info.must_rebuild = new_rebuild_set\n    verifying_trace_info.trace_store = new_trace_store\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_rebuilder_core/","title":"verifying_trace_rebuilder_core","text":""},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_rebuilder_core/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.verifying_trace_rebuilder_core","title":"mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.verifying_trace_rebuilder_core","text":"<p>Classes:</p> <ul> <li> <code>VerifyingTraceRebuilder</code>           \u2013            <p>A rebuilder that calculates traces for the assets it manages, and uses these traces</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>verify_trace</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_rebuilder_core/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.verifying_trace_rebuilder_core.VerifyingTraceRebuilder","title":"VerifyingTraceRebuilder","text":"<p>               Bases: <code>Rebuilder[VerifyingTraceInfo]</code></p> <p>A rebuilder that calculates traces for the assets it manages, and uses these traces to decide when to rebuild. Based on: Mokhov, Andrey, Neil Mitchell, and Simon Peyton Jones. \"Build systems \u00e0 la carte: Theory and practice.\" Journal of Functional Programming 30 (2020): e11.</p> <p>Methods:</p> <ul> <li> <code>rebuild</code>             \u2013              </li> <li> <code>save_info</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>tracer</code>               (<code>Tracer</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_rebuilder_core/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.verifying_trace_rebuilder_core.VerifyingTraceRebuilder.tracer","title":"tracer  <code>instance-attribute</code>","text":"<pre><code>tracer: Tracer\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_rebuilder_core/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.verifying_trace_rebuilder_core.VerifyingTraceRebuilder.rebuild","title":"rebuild","text":"<pre><code>rebuild(\n    task: Task,\n    asset: Asset | None,\n    fetch: Fetch,\n    wf: WF,\n    info: VerifyingTraceInfo,\n    meta_to_path: MetaToPath,\n) -&gt; tuple[Asset, VerifyingTraceInfo]\n</code></pre> Source code in <code>mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_rebuilder_core.py</code> <pre><code>def rebuild(\n    self,\n    task: Task,\n    asset: Asset | None,\n    fetch: Fetch,\n    wf: WF,\n    info: VerifyingTraceInfo,\n    meta_to_path: MetaToPath,\n) -&gt; tuple[Asset, VerifyingTraceInfo]:\n    must_rebuild = task.asset_id in info.must_rebuild\n\n    def fetch_trace(asset_id: AssetId) -&gt; str:\n        return self.tracer(fetch(asset_id))\n\n    if not must_rebuild and asset is not None:\n        logger.debug(f\"Attempting to verify the trace of asset {task.asset_id}...\")\n        old_value_trace = self.tracer(asset)\n        if verify_trace(\n            asset_id=task.asset_id,\n            value_trace=old_value_trace,\n            fetch_trace=fetch_trace,\n            info=info,\n        ):\n            logger.debug(\n                f\"Successfully verified the trace of asset {task.asset_id}.\"\n            )\n            return asset, info\n        logger.debug(f\"Failed to verify the trace of asset {task.asset_id}.\")\n    logger.debug(f\"Materializing asset {task.asset_id}....\")\n    new_value, deps = tracking_sandboxed_execute(\n        task=task,\n        meta_to_path=meta_to_path,\n        wf=wf,\n        fetch=RestrictedFetch.from_task(fetch=fetch, task=task),\n    )\n    deps_traced = [(k, self.tracer(v)) for k, v in deps]\n    new_trace = self.tracer(new_value)\n    logger.debug(f\"Trace of asset {task.asset_id} is:\\n {new_trace}\")\n    update_verifying_trace_info_in_place(\n        verifying_trace_info=info,\n        meta=task.meta,\n        new_value_trace=new_trace,\n        deps_traced=deps_traced,\n    )\n    return new_value, info\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_rebuilder_core/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.verifying_trace_rebuilder_core.VerifyingTraceRebuilder.save_info","title":"save_info  <code>classmethod</code>","text":"<pre><code>save_info(info: VerifyingTraceInfo, path: Path)\n</code></pre> Source code in <code>mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_rebuilder_core.py</code> <pre><code>@classmethod\ndef save_info(cls, info: VerifyingTraceInfo, path: Path):\n    info.serialize(path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_rebuilder_core/#mecfs_bio.build_system.rebuilder.verifying_trace_rebuilder.verifying_trace_rebuilder_core.verify_trace","title":"verify_trace","text":"<pre><code>verify_trace(\n    asset_id: AssetId,\n    value_trace: str,\n    fetch_trace: Callable[[AssetId], str],\n    info: VerifyingTraceInfo,\n) -&gt; bool\n</code></pre> Source code in <code>mecfs_bio/build_system/rebuilder/verifying_trace_rebuilder/verifying_trace_rebuilder_core.py</code> <pre><code>def verify_trace(\n    asset_id: AssetId,\n    value_trace: str,\n    fetch_trace: Callable[[AssetId], str],\n    info: VerifyingTraceInfo,\n) -&gt; bool:\n    if asset_id not in info.trace_store:\n        return False\n    recorded_trace, recorded_deps = info.trace_store[asset_id]\n    if recorded_trace != value_trace:\n        return False\n    for dep, dep_hash in recorded_deps:\n        if fetch_trace(dep) != dep_hash:\n            return False\n    return True\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/reference/","title":"reference","text":""},{"location":"reference/mecfs_bio/build_system/reference/#mecfs_bio.build_system.reference","title":"mecfs_bio.build_system.reference","text":"<p>Vendored reference data.</p> <p>Modules:</p> <ul> <li> <code>nc_chrom_mapping</code>           \u2013            <p>Mapping from chromosome names found in dbsnp vcf file to standard chromosome names</p> </li> <li> <code>schemas</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/reference/nc_chrom_mapping/","title":"nc_chrom_mapping","text":""},{"location":"reference/mecfs_bio/build_system/reference/nc_chrom_mapping/#mecfs_bio.build_system.reference.nc_chrom_mapping","title":"mecfs_bio.build_system.reference.nc_chrom_mapping","text":"<p>Mapping from chromosome names found in dbsnp vcf file to standard chromosome names</p> <p>Attributes:</p> <ul> <li> <code>NC_CHROM_MAPPING</code>           \u2013            </li> <li> <code>NC_CHROM_TABLE</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/reference/nc_chrom_mapping/#mecfs_bio.build_system.reference.nc_chrom_mapping.NC_CHROM_MAPPING","title":"NC_CHROM_MAPPING  <code>module-attribute</code>","text":"<pre><code>NC_CHROM_MAPPING = {\n    \"NC_000001.10\": 1,\n    \"NC_000002.11\": 2,\n    \"NC_000003.10\": 3,\n    \"NC_000004.11\": 4,\n    \"NC_000005.9\": 5,\n    \"NC_000006.11\": 6,\n    \"NC_000007.13\": 7,\n    \"NC_000008.10\": 8,\n    \"NC_000009.11\": 9,\n    \"NC_000010.10\": 10,\n    \"NC_000011.9\": 11,\n    \"NC_000012.11\": 12,\n    \"NC_000013.10\": 13,\n    \"NC_000014.8\": 14,\n    \"NC_000015.9\": 15,\n    \"NC_000016.9\": 16,\n    \"NC_000017.10\": 17,\n    \"NC_000018.9\": 18,\n    \"NC_000019.9\": 19,\n    \"NC_000020.10\": 20,\n    \"NC_000021.8\": 21,\n    \"NC_000022.10\": 22,\n    \"NC_000023.10\": 23,\n    \"NC_000024.9\": 24,\n    \"NC_012920.1\": 25,\n}\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/reference/nc_chrom_mapping/#mecfs_bio.build_system.reference.nc_chrom_mapping.NC_CHROM_TABLE","title":"NC_CHROM_TABLE  <code>module-attribute</code>","text":"<pre><code>NC_CHROM_TABLE = DataFrame(\n    {\"nc_chrom\": keys(), \"int_chrom\": values()}\n)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/reference/schemas/","title":"schemas","text":""},{"location":"reference/mecfs_bio/build_system/reference/schemas/#mecfs_bio.build_system.reference.schemas","title":"mecfs_bio.build_system.reference.schemas","text":"<p>Modules:</p> <ul> <li> <code>chrom_rename_rules</code>           \u2013            </li> <li> <code>hg19_sn151_schema</code>           \u2013            <p>https://hgw2.soe.ucsc.edu/cgi-bin/hgTables?hgsid=2912494930_cRufLdpdc1ynRc2sCM3g1WGAWAgH&amp;hgta_doSchemaDb=hg19&amp;hgta_doSchemaTable=snp151Flagged</p> </li> <li> <code>hg19_snp151_schema_valid_choms</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/reference/schemas/chrom_rename_rules/","title":"chrom_rename_rules","text":""},{"location":"reference/mecfs_bio/build_system/reference/schemas/chrom_rename_rules/#mecfs_bio.build_system.reference.schemas.chrom_rename_rules","title":"mecfs_bio.build_system.reference.schemas.chrom_rename_rules","text":"<p>Attributes:</p> <ul> <li> <code>CHROM_RENAME_DF_NUMERIC_X_Y_M</code>           \u2013            </li> <li> <code>CHROM_RENAME_RULES</code>           \u2013            </li> <li> <code>CHROM_RENAME_RULES_NUMERIC_X_Y_M</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/reference/schemas/chrom_rename_rules/#mecfs_bio.build_system.reference.schemas.chrom_rename_rules.CHROM_RENAME_DF_NUMERIC_X_Y_M","title":"CHROM_RENAME_DF_NUMERIC_X_Y_M  <code>module-attribute</code>","text":"<pre><code>CHROM_RENAME_DF_NUMERIC_X_Y_M = DataFrame(\n    {\"CHROM\": keys(), \"int_chrom\": values()}\n)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/reference/schemas/chrom_rename_rules/#mecfs_bio.build_system.reference.schemas.chrom_rename_rules.CHROM_RENAME_RULES","title":"CHROM_RENAME_RULES  <code>module-attribute</code>","text":"<pre><code>CHROM_RENAME_RULES = {\n    \"chrX\": 23,\n    \"chrY\": 24,\n    \"chrM\": 25,\n} | {f\"chr{i}\": i for i in (range(1, 25))}\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/reference/schemas/chrom_rename_rules/#mecfs_bio.build_system.reference.schemas.chrom_rename_rules.CHROM_RENAME_RULES_NUMERIC_X_Y_M","title":"CHROM_RENAME_RULES_NUMERIC_X_Y_M  <code>module-attribute</code>","text":"<pre><code>CHROM_RENAME_RULES_NUMERIC_X_Y_M = {\n    \"X\": 23,\n    \"Y\": 24,\n    \"M\": 25,\n} | {(str(i)): i for i in (range(1, 25))}\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/reference/schemas/hg19_sn151_schema/","title":"hg19_sn151_schema","text":""},{"location":"reference/mecfs_bio/build_system/reference/schemas/hg19_sn151_schema/#mecfs_bio.build_system.reference.schemas.hg19_sn151_schema","title":"mecfs_bio.build_system.reference.schemas.hg19_sn151_schema","text":"<p>https://hgw2.soe.ucsc.edu/cgi-bin/hgTables?hgsid=2912494930_cRufLdpdc1ynRc2sCM3g1WGAWAgH&amp;hgta_doSchemaDb=hg19&amp;hgta_doSchemaTable=snp151Flagged</p> <p>Attributes:</p> <ul> <li> <code>HG19_SNP151_SCHEMA</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/reference/schemas/hg19_sn151_schema/#mecfs_bio.build_system.reference.schemas.hg19_sn151_schema.HG19_SNP151_SCHEMA","title":"HG19_SNP151_SCHEMA  <code>module-attribute</code>","text":"<pre><code>HG19_SNP151_SCHEMA = [\n    \"bin\",\n    \"chrom\",\n    \"chromStart_zero_based\",\n    \"chromEnd_zero_based\",\n    \"name\",\n    \"score\",\n    \"strand\",\n    \"refNCBI\",\n    \"refUCSC\",\n    \"observed\",\n    \"molType\",\n    \"class\",\n    \"valid\",\n    \"avHet\",\n    \"avHetSE\",\n    \"func\",\n    \"locType\",\n    \"weight\",\n    \"exceptions\",\n    \"submitterCount\",\n    \"submitters\",\n    \"alleleFreqCount\",\n    \"alleles\",\n    \"alleleNs\",\n    \"alleleFreqs\",\n    \"bitfields\",\n]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/reference/schemas/hg19_snp151_schema_valid_choms/","title":"hg19_snp151_schema_valid_choms","text":""},{"location":"reference/mecfs_bio/build_system/reference/schemas/hg19_snp151_schema_valid_choms/#mecfs_bio.build_system.reference.schemas.hg19_snp151_schema_valid_choms","title":"mecfs_bio.build_system.reference.schemas.hg19_snp151_schema_valid_choms","text":"<p>Attributes:</p> <ul> <li> <code>HG19_SNP151_VALID_CHROMS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/reference/schemas/hg19_snp151_schema_valid_choms/#mecfs_bio.build_system.reference.schemas.hg19_snp151_schema_valid_choms.HG19_SNP151_VALID_CHROMS","title":"HG19_SNP151_VALID_CHROMS  <code>module-attribute</code>","text":"<pre><code>HG19_SNP151_VALID_CHROMS = [\n    \"chr2\",\n    \"chr1\",\n    \"chr3\",\n    \"chr4\",\n    \"chr5\",\n    \"chr6\",\n    \"chr7\",\n    \"chr8\",\n    \"chr11\",\n    \"chr12\",\n    \"chr10\",\n    \"chr9\",\n    \"chrX\",\n    \"chr13\",\n    \"chr16\",\n    \"chr14\",\n    \"chr15\",\n    \"chr17\",\n    \"chr18\",\n    \"chr19\",\n    \"chr20\",\n    \"chr22\",\n    \"chr21\",\n    \"chrY\",\n    \"chrM\",\n]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/runner/","title":"runner","text":""},{"location":"reference/mecfs_bio/build_system/runner/#mecfs_bio.build_system.runner","title":"mecfs_bio.build_system.runner","text":"<p>Runners are convenience objects that bundle a scheduler with a rebuilder to create a complete build system.</p> <p>Modules:</p> <ul> <li> <code>simple_runner</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/runner/simple_runner/","title":"simple_runner","text":""},{"location":"reference/mecfs_bio/build_system/runner/simple_runner/#mecfs_bio.build_system.runner.simple_runner","title":"mecfs_bio.build_system.runner.simple_runner","text":"<p>Classes:</p> <ul> <li> <code>SimpleRunner</code>           \u2013            <p>Simple wrapper class that orchestrates</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/runner/simple_runner/#mecfs_bio.build_system.runner.simple_runner.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/runner/simple_runner/#mecfs_bio.build_system.runner.simple_runner.SimpleRunner","title":"SimpleRunner","text":"<p>Simple wrapper class that orchestrates an execution of the workflow build system with a topological scheduler and verifying trace rebuilder</p> <p>info_store: path at which to store persistent cash for build-system internal information asset_root: root under which to create the asset store tracer: algorithm uses to calculate verifying traces of assets.  An example would be a hashing algorithm.  changing this forces all assets to be rebuilt</p> <p>Methods:</p> <ul> <li> <code>run</code>             \u2013              <p>Targets: the ultimate targets we aim to produce.  All transitive dependencies of these targets will either be rebuilt, or fetched (determined according to that status of their trace)</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>asset_root</code>               (<code>Path</code>)           \u2013            </li> <li> <code>info_store</code>               (<code>Path</code>)           \u2013            </li> <li> <code>meta_to_path</code>               (<code>SimpleMetaToPath</code>)           \u2013            </li> <li> <code>tracer</code>               (<code>Tracer</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/runner/simple_runner/#mecfs_bio.build_system.runner.simple_runner.SimpleRunner.asset_root","title":"asset_root  <code>instance-attribute</code>","text":"<pre><code>asset_root: Path\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/runner/simple_runner/#mecfs_bio.build_system.runner.simple_runner.SimpleRunner.info_store","title":"info_store  <code>instance-attribute</code>","text":"<pre><code>info_store: Path\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/runner/simple_runner/#mecfs_bio.build_system.runner.simple_runner.SimpleRunner.meta_to_path","title":"meta_to_path  <code>property</code>","text":"<pre><code>meta_to_path: SimpleMetaToPath\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/runner/simple_runner/#mecfs_bio.build_system.runner.simple_runner.SimpleRunner.tracer","title":"tracer  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>tracer: Tracer = md5_hasher()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/runner/simple_runner/#mecfs_bio.build_system.runner.simple_runner.SimpleRunner.run","title":"run","text":"<pre><code>run(\n    targets: list[Task],\n    must_rebuild_transitive: Sequence[Task] = tuple(),\n    incremental_save: bool = False,\n) -&gt; Mapping[AssetId, Asset]\n</code></pre> <p>Targets: the ultimate targets we aim to produce.  All transitive dependencies of these targets will either be rebuilt, or fetched (determined according to that status of their trace) must_rebuild_transitive: list of tasks that the rebuilder will be forced to rebuild, regardless of the status of their trace.    - This is particularly useful when you have changed the code that generates and asset, and so want it and its dependees to be regenerated. returns: mapping from asset id to file system information for all assets that were built or retrieved as part of the execution of the scheduler</p> Source code in <code>mecfs_bio/build_system/runner/simple_runner.py</code> <pre><code>def run(\n    self,\n    targets: list[Task],\n    must_rebuild_transitive: Sequence[Task] = tuple(),\n    incremental_save: bool = False,\n) -&gt; Mapping[AssetId, Asset]:\n    \"\"\"\n    Targets: the ultimate targets we aim to produce.  All transitive dependencies of these targets will either be rebuilt, or fetched (determined according to that status of their trace)\n    must_rebuild_transitive: list of tasks that the rebuilder will be forced to rebuild, regardless of the status of their trace.\n       - This is particularly useful when you have changed the code that generates and asset, and so want it and its dependees to be regenerated.\n    returns:\n    mapping from asset id to file system information for all assets that were built or retrieved as part of the execution of the scheduler\n    \"\"\"\n    if self.info_store.is_file():\n        info = VerifyingTraceInfo.deserialize(self.info_store)\n    else:\n        info = VerifyingTraceInfo.empty()\n    if incremental_save:\n        logger.debug(\"incremental save is enabled\")\n    rebuilder = VerifyingTraceRebuilder(self.tracer)\n    wf = RobustDownloadWF()\n    # wf= SimpleWF()\n    meta_to_path = self.meta_to_path\n    tasks = find_tasks(targets)\n    must_rebuild_graph = dependees_of_targets_from_tasks(\n        tasks=tasks,\n        targets=[task.asset_id for task in must_rebuild_transitive],\n    )\n    info = attrs.evolve(info, must_rebuild=set(must_rebuild_graph.nodes))\n    incremental_save_path = self.info_store if incremental_save else None\n    store, info = topological(\n        rebuilder=rebuilder,\n        tasks=tasks,\n        info=info,\n        wf=wf,\n        meta_to_path=meta_to_path,\n        targets=[target.asset_id for target in targets],\n        incremental_save_path=incremental_save_path,\n    )\n    info.serialize(self.info_store)\n    _print_target_locs(store, targets=targets)\n    return store\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/scheduler/","title":"scheduler","text":""},{"location":"reference/mecfs_bio/build_system/scheduler/#mecfs_bio.build_system.scheduler","title":"mecfs_bio.build_system.scheduler","text":"<p>Given target assets, the scheduler is responsible for traversing the dependency graph to reach those target assets.</p> <p>Delegates the actual work of materializing an individual asset up to date to the rebuilder.</p> <p>Modules:</p> <ul> <li> <code>asset_retrieval</code>           \u2013            </li> <li> <code>topological_scheduler</code>           \u2013            <p>A scheduler that builds a dependency graph of tasks, and executes them in topological order</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/scheduler/asset_retrieval/","title":"asset_retrieval","text":""},{"location":"reference/mecfs_bio/build_system/scheduler/asset_retrieval/#mecfs_bio.build_system.scheduler.asset_retrieval","title":"mecfs_bio.build_system.scheduler.asset_retrieval","text":"<p>Functions:</p> <ul> <li> <code>get_asset_if_exists</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/scheduler/asset_retrieval/#mecfs_bio.build_system.scheduler.asset_retrieval.get_asset_if_exists","title":"get_asset_if_exists","text":"<pre><code>get_asset_if_exists(\n    meta: Meta, meta_to_path: MetaToPath\n) -&gt; Asset | None\n</code></pre> Source code in <code>mecfs_bio/build_system/scheduler/asset_retrieval.py</code> <pre><code>def get_asset_if_exists(\n    meta: Meta,\n    meta_to_path: MetaToPath,\n) -&gt; Asset | None:\n    # asset_type = meta.asset_type\n    # if asset_type == FileAsset:\n    if _isinstance(meta, FileMeta):\n        path = meta_to_path(meta)\n        if path.is_file():\n            return FileAsset(path)\n        return None\n    if _isinstance(meta, DirMeta):\n        path = meta_to_path(meta)\n        if path.is_dir():\n            return DirectoryAsset(path)\n        return None\n    raise ValueError(\"Unknown asset type\")\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/scheduler/topological_scheduler/","title":"topological_scheduler","text":""},{"location":"reference/mecfs_bio/build_system/scheduler/topological_scheduler/#mecfs_bio.build_system.scheduler.topological_scheduler","title":"mecfs_bio.build_system.scheduler.topological_scheduler","text":"<p>A scheduler that builds a dependency graph of tasks, and executes them in topological order</p> <p>Functions:</p> <ul> <li> <code>dependees_of_targets</code>             \u2013              <p>Given a dependency graph of assets, find the transitive dependees of given targets</p> </li> <li> <code>dependees_of_targets_from_tasks</code>             \u2013              <p>Given a set of tasks, and a list of targets, build a minimal dependency graph containing the targets</p> </li> <li> <code>dependencies_of_targets</code>             \u2013              <p>Given a dependency graph of assets, find the transitive dependencies of given targets</p> </li> <li> <code>dependencies_of_targets_from_tasks</code>             \u2013              <p>Given a set of tasks, and a list of targets, build a minimal dependency graph containing the targets</p> </li> <li> <code>get_dependency_graph_from_tasks</code>             \u2013              </li> <li> <code>topological</code>             \u2013              <p>A scheduler that builds a dependency graph of tasks, and executes them in topological order.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/scheduler/topological_scheduler/#mecfs_bio.build_system.scheduler.topological_scheduler.dependees_of_targets","title":"dependees_of_targets","text":"<pre><code>dependees_of_targets(\n    G: DiGraph, targets: Sequence[AssetId]\n) -&gt; nx.DiGraph\n</code></pre> <p>Given a dependency graph of assets, find the transitive dependees of given targets</p> Source code in <code>mecfs_bio/build_system/scheduler/topological_scheduler.py</code> <pre><code>def dependees_of_targets(G: nx.DiGraph, targets: Sequence[AssetId]) -&gt; nx.DiGraph:\n    \"\"\"\n    Given a dependency graph of assets, find the transitive dependees of given targets\n    \"\"\"\n    reachable = set(targets)\n    for target in targets:\n        reachable = nx.descendants(G, target) | reachable\n    subgraph = nx.DiGraph(G.subgraph(reachable))\n    return subgraph\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/scheduler/topological_scheduler/#mecfs_bio.build_system.scheduler.topological_scheduler.dependees_of_targets_from_tasks","title":"dependees_of_targets_from_tasks","text":"<pre><code>dependees_of_targets_from_tasks(\n    tasks: Tasks, targets: Sequence[AssetId]\n) -&gt; nx.DiGraph\n</code></pre> <p>Given a set of tasks, and a list of targets, build a minimal dependency graph containing the targets and all their transitive dependees.</p> Source code in <code>mecfs_bio/build_system/scheduler/topological_scheduler.py</code> <pre><code>def dependees_of_targets_from_tasks(\n    tasks: Tasks, targets: Sequence[AssetId]\n) -&gt; nx.DiGraph:\n    \"\"\"\n    Given a set of tasks, and a list of targets, build a minimal dependency graph containing the targets\n    and all their transitive dependees.\n    \"\"\"\n    G = get_dependency_graph_from_tasks(tasks)\n    return dependees_of_targets(G, targets)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/scheduler/topological_scheduler/#mecfs_bio.build_system.scheduler.topological_scheduler.dependencies_of_targets","title":"dependencies_of_targets","text":"<pre><code>dependencies_of_targets(\n    G: DiGraph, targets: Sequence[AssetId]\n) -&gt; nx.DiGraph\n</code></pre> <p>Given a dependency graph of assets, find the transitive dependencies of given targets</p> Source code in <code>mecfs_bio/build_system/scheduler/topological_scheduler.py</code> <pre><code>def dependencies_of_targets(G: nx.DiGraph, targets: Sequence[AssetId]) -&gt; nx.DiGraph:\n    \"\"\"\n    Given a dependency graph of assets, find the transitive dependencies of given targets\n    \"\"\"\n    reachable = set(targets)\n    for target in targets:\n        reachable = nx.ancestors(G, target) | reachable\n    subgraph = nx.DiGraph(G.subgraph(reachable))\n    return subgraph\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/scheduler/topological_scheduler/#mecfs_bio.build_system.scheduler.topological_scheduler.dependencies_of_targets_from_tasks","title":"dependencies_of_targets_from_tasks","text":"<pre><code>dependencies_of_targets_from_tasks(\n    tasks: Tasks, targets: Sequence[AssetId]\n) -&gt; nx.DiGraph\n</code></pre> <p>Given a set of tasks, and a list of targets, build a minimal dependency graph containing the targets and all their transitive dependencies.</p> Source code in <code>mecfs_bio/build_system/scheduler/topological_scheduler.py</code> <pre><code>def dependencies_of_targets_from_tasks(\n    tasks: Tasks, targets: Sequence[AssetId]\n) -&gt; nx.DiGraph:\n    \"\"\"\n    Given a set of tasks, and a list of targets, build a minimal dependency graph containing the targets\n    and all their transitive dependencies.\n    \"\"\"\n    G = get_dependency_graph_from_tasks(tasks)\n    return dependencies_of_targets(G, targets)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/scheduler/topological_scheduler/#mecfs_bio.build_system.scheduler.topological_scheduler.get_dependency_graph_from_tasks","title":"get_dependency_graph_from_tasks","text":"<pre><code>get_dependency_graph_from_tasks(tasks: Tasks) -&gt; nx.DiGraph\n</code></pre> Source code in <code>mecfs_bio/build_system/scheduler/topological_scheduler.py</code> <pre><code>def get_dependency_graph_from_tasks(tasks: Tasks) -&gt; nx.DiGraph:\n    G: nx.DiGraph = nx.DiGraph()\n    for asset_id, task in tasks.items():\n        G.add_node(asset_id)\n        for dep in task.deps:\n            G.add_edge(dep.asset_id, asset_id)\n    return G\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/scheduler/topological_scheduler/#mecfs_bio.build_system.scheduler.topological_scheduler.topological","title":"topological","text":"<pre><code>topological(\n    rebuilder: Rebuilder[Info],\n    tasks: Tasks,\n    targets: Sequence[AssetId],\n    wf: WF,\n    info: Info,\n    meta_to_path: MetaToPath,\n    incremental_save_path: Path | None = None,\n) -&gt; tuple[Mapping[AssetId, Asset], Info]\n</code></pre> <p>A scheduler that builds a dependency graph of tasks, and executes them in topological order. Based on Mokhov, Andrey, Neil Mitchell, and Simon Peyton Jones. \"Build systems \u00e0 la carte: Theory and practice.\" Journal of Functional Programming 30 (2020): e11.</p> Source code in <code>mecfs_bio/build_system/scheduler/topological_scheduler.py</code> <pre><code>def topological[\n    Info,\n](\n    rebuilder: Rebuilder[Info],\n    tasks: Tasks,\n    targets: Sequence[AssetId],\n    wf: WF,\n    info: Info,\n    meta_to_path: MetaToPath,\n    incremental_save_path: Path | None = None,\n) -&gt; tuple[Mapping[AssetId, Asset], Info]:\n    \"\"\"\n    A scheduler that builds a dependency graph of tasks, and executes them in topological order.\n    Based on\n    Mokhov, Andrey, Neil Mitchell, and Simon Peyton Jones.\n    \"Build systems \u00e0 la carte: Theory and practice.\" Journal of Functional Programming 30 (2020): e11.\n    \"\"\"\n    G = dependencies_of_targets_from_tasks(tasks, targets)\n    todo: list[AssetId] = list(nx.topological_sort(G))\n    done: set[AssetId] = set()\n    store: dict[AssetId, Asset] = {}\n    frontier = _get_initial_frontier(G)\n    while len(G) &gt; 0:\n        logger.info(_get_progress_list(todo=todo, done=done))\n        node = frontier[0]\n        task = tasks[node]\n        maybe_asset = get_asset_if_exists(\n            meta=task.meta,\n            meta_to_path=meta_to_path,\n        )\n\n        class SimpleFetch(Fetch):\n            def __call__(self, asset_id: AssetId) -&gt; Asset:\n                return store[asset_id]\n\n        new_asset, info = rebuilder.rebuild(\n            task=task,\n            asset=maybe_asset,\n            fetch=SimpleFetch(),\n            wf=wf,\n            info=info,\n            meta_to_path=meta_to_path,\n        )\n        if incremental_save_path is not None:\n            rebuilder.save_info(info, incremental_save_path)\n        store[node] = new_asset\n        frontier, G = _update_frontier_and_G(G=G, completed=node, frontier=frontier)\n        done.add(node)\n    logger.info(_get_progress_list(todo=todo, done=done))\n    return store, info\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/serialization/","title":"serialization","text":""},{"location":"reference/mecfs_bio/build_system/serialization/#mecfs_bio.build_system.serialization","title":"mecfs_bio.build_system.serialization","text":"<p>Utilities for serializing the state of the build system.</p> <p>Modules:</p> <ul> <li> <code>converter</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/serialization/converter/","title":"converter","text":""},{"location":"reference/mecfs_bio/build_system/serialization/converter/#mecfs_bio.build_system.serialization.converter","title":"mecfs_bio.build_system.serialization.converter","text":"<p>Attributes:</p> <ul> <li> <code>CONVERTER_FOR_SERIALIZATION</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/serialization/converter/#mecfs_bio.build_system.serialization.converter.CONVERTER_FOR_SERIALIZATION","title":"CONVERTER_FOR_SERIALIZATION  <code>module-attribute</code>","text":"<pre><code>CONVERTER_FOR_SERIALIZATION = GenConverter()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/","title":"task","text":""},{"location":"reference/mecfs_bio/build_system/task/#mecfs_bio.build_system.task","title":"mecfs_bio.build_system.task","text":"<p>Task objects are where the \"real work\" of the build system is encapsulated. A Task encodes instructions for how to materialize a given asset. These instructions may include requesting that the build system materialize any dependencies the asset has.</p> <p>Modules:</p> <ul> <li> <code>assign_rsids_via_snp151_task</code>           \u2013            <p>Assign RSIDs to variants via joining a database file.  Only works for single-nucleotide variations.</p> </li> <li> <code>base_task</code>           \u2013            <p>Instructions for materializing an asset.</p> </li> <li> <code>combine_gene_lists_task</code>           \u2013            <p>Task to combine gene lists from multiple sources</p> </li> <li> <code>compressed_csv_to_parquet_task</code>           \u2013            <p>Enable efficient SQL operations by converting CSV to parquet.</p> </li> <li> <code>concat_frames_in_dir_task</code>           \u2013            <p>Concatenate dataframes in a DirectoryAsset to create a single FileAsset.</p> </li> <li> <code>concat_frames_task</code>           \u2013            <p>Task to combine the results of multiple Tasks, each of which produces a dataframe.</p> </li> <li> <code>convert_dataframe_to_markdown_task</code>           \u2013            <p>Prepare results for presentation by converting a dataframe to markdown format.</p> </li> <li> <code>copy_file_from_directory_task</code>           \u2013            <p>Copy a file within a DirectoryAsset to create a FileAsset.  Useful when downstream tasks require FileAssets.</p> </li> <li> <code>copy_task</code>           \u2013            <p>Copy a single file.  Mainly used for testing.</p> </li> <li> <code>counting_task</code>           \u2013            <p>For testing purposes, recording the number of times that a wrapped task has been executed.</p> </li> <li> <code>discard_deps_task_wrapper</code>           \u2013            <p>Save disk space materializing dependencies of the wrapped task in a temporary directory.</p> </li> <li> <code>download_file_task</code>           \u2013            <p>Download a file, possibly verifying it using a hash.</p> </li> <li> <code>download_files_into_directory_task</code>           \u2013            <p>Task to download one or more files into a directory, then run command line programs on them,</p> </li> <li> <code>download_from_google_drive_task</code>           \u2013            <p>Some GWAS summary statistics are stored on Google Drive.  Use this task to access them.</p> </li> <li> <code>external_directory_copy_task</code>           \u2013            <p>Copies a directory from an external source.</p> </li> <li> <code>external_file_copy_task</code>           \u2013            <p>Task to copy a file from an external source.  Used to testing.</p> </li> <li> <code>extract_all_from_zip_task</code>           \u2013            <p>Task to extract the entire contents of a zip archive</p> </li> <li> <code>extract_dataframe_from_rdata_task</code>           \u2013            </li> <li> <code>extract_gzip_task</code>           \u2013            <p>Task to extract a file from a gzip.</p> </li> <li> <code>extract_sheet_from_excel_file_task</code>           \u2013            <p>Task to extract sheet from excel file.</p> </li> <li> <code>extract_tar_gzip_task</code>           \u2013            </li> <li> <code>extraction_one_file_from_zip_task</code>           \u2013            </li> <li> <code>failing_task</code>           \u2013            <p>A task that always fails, which can be used for testing.</p> </li> <li> <code>fake_task</code>           \u2013            <p>A Task that does nothing, which can be used for testing.</p> </li> <li> <code>fetch_gget_info_task</code>           \u2013            <p>Task to use gget to annotate gene lists with annotations from genetics databases.</p> </li> <li> <code>filter_snps_task</code>           \u2013            <p>Task to filter SNPs in a GWAS according to another table of SNPs passing quality control.</p> </li> <li> <code>gene_tissue_expression_clustermap_task</code>           \u2013            <p>Task to make a heatmap plot with genes as rows and tissue/cell types as columns</p> </li> <li> <code>genetic_correlation_clustermap_task</code>           \u2013            <p>Task to create a heatmap plot illustrating the genetic correlation structure of a collection of traits</p> </li> <li> <code>get_file_from_synapse_task</code>           \u2013            <p>Task to get a file from synapse.org, a scientific data repository.</p> </li> <li> <code>get_uniprot_reference_data_task</code>           \u2013            <p>Task to download reference data about proteins from UniProt</p> </li> <li> <code>gwaslab</code>           \u2013            <p>Tasks using to GWASLab (https://github.com/Cloufield/gwaslab), a Python toolkit for GWAS summary statistics.</p> </li> <li> <code>harmonize_gwas_with_reference_table_via_chrom_pos_alleles</code>           \u2013            <p>Given a table of reference genetic variants, harmonize gwas data with that table of reference variants</p> </li> <li> <code>harmonize_gwas_with_reference_table_via_rsid</code>           \u2013            <p>Given a table of reference genetic variants, harmonize gwas data with that table of reference variants</p> </li> <li> <code>join_dataframes_task</code>           \u2013            <p>Task to perform a SQL-style join.</p> </li> <li> <code>magma</code>           \u2013            <p>Tasks that are part of the workflow of GWAS-tool MAGMA (Multi-marker Analysis of GenoMic Annotation).</p> </li> <li> <code>make_executable_wrapper_task</code>           \u2013            <p>Task to make a file executable by editing unix file permissions (a la chmod).</p> </li> <li> <code>multiple_testing_table_task</code>           \u2013            <p>Task to compute a multiple testing correction of a table of p values.</p> </li> <li> <code>osf_retrieve_task</code>           \u2013            <p>A task that fetches GWAS data from the Open Science data store</p> </li> <li> <code>pipe_dataframe_task</code>           \u2013            <p>Task to transform a dataframe asset using a DataProcessingPipes.</p> </li> <li> <code>pipes</code>           \u2013            <p>Pipes are simple, composable DataFrame transformations.</p> </li> <li> <code>plot_mr_effect_measure_task</code>           \u2013            <p>Create an effect measure plot using zepid</p> </li> <li> <code>r_tasks</code>           \u2013            <p>Tasks that call R libraries.</p> </li> <li> <code>specificity_cepo_task</code>           \u2013            </li> <li> <code>specificity_frac_task</code>           \u2013            </li> <li> <code>susie_stacked_plot_task</code>           \u2013            <p>A Task and associated helper methods to plot the results and context of SUSIE fine mapping using stacked panels.</p> </li> <li> <code>two_sample_mr_task</code>           \u2013            <p>Task to apply two sample mendelian randomization to GWAS data, together with associated axillary functions.</p> </li> <li> <code>upset_plot_task</code>           \u2013            <p>Create an upset plot to describe the intersection of sets represented as dataframe columns</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/assign_rsids_via_snp151_task/","title":"assign_rsids_via_snp151_task","text":""},{"location":"reference/mecfs_bio/build_system/task/assign_rsids_via_snp151_task/#mecfs_bio.build_system.task.assign_rsids_via_snp151_task","title":"mecfs_bio.build_system.task.assign_rsids_via_snp151_task","text":"<p>Assign RSIDs to variants via joining a database file.  Only works for single-nucleotide variations.</p> <p>Classes:</p> <ul> <li> <code>AssignRSIDSToSNPsViaSNP151Task</code>           \u2013            <p>Assigns RSIDS to the SNP genetic variants in a file of Gwas summary statistics</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>create_new_meta</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/assign_rsids_via_snp151_task/#mecfs_bio.build_system.task.assign_rsids_via_snp151_task.AssignRSIDSToSNPsViaSNP151Task","title":"AssignRSIDSToSNPsViaSNP151Task","text":"<p>               Bases: <code>Task</code></p> <p>Assigns RSIDS to the SNP genetic variants in a file of Gwas summary statistics Uses SNP151 database file Assumes the GWASLAB naming conventions are used in the summary statistics file Assumes that both input files are in parquet format</p> <p>Note that non-SNP variations (e.g. insertions or deletions) are excluded. This operates exclusively on SNPs</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>chrom_replace_rules</code>               (<code>Mapping[str, int]</code>)           \u2013            </li> <li> <code>database_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>database_meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>raw_snp_data_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>snp151_database_file_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>snp_data_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>snp_data_meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>valid_chroms</code>               (<code>list[str]</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/assign_rsids_via_snp151_task/#mecfs_bio.build_system.task.assign_rsids_via_snp151_task.AssignRSIDSToSNPsViaSNP151Task.chrom_replace_rules","title":"chrom_replace_rules  <code>instance-attribute</code>","text":"<pre><code>chrom_replace_rules: Mapping[str, int]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/assign_rsids_via_snp151_task/#mecfs_bio.build_system.task.assign_rsids_via_snp151_task.AssignRSIDSToSNPsViaSNP151Task.database_id","title":"database_id  <code>property</code>","text":"<pre><code>database_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/assign_rsids_via_snp151_task/#mecfs_bio.build_system.task.assign_rsids_via_snp151_task.AssignRSIDSToSNPsViaSNP151Task.database_meta","title":"database_meta  <code>property</code>","text":"<pre><code>database_meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/assign_rsids_via_snp151_task/#mecfs_bio.build_system.task.assign_rsids_via_snp151_task.AssignRSIDSToSNPsViaSNP151Task.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/assign_rsids_via_snp151_task/#mecfs_bio.build_system.task.assign_rsids_via_snp151_task.AssignRSIDSToSNPsViaSNP151Task.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/assign_rsids_via_snp151_task/#mecfs_bio.build_system.task.assign_rsids_via_snp151_task.AssignRSIDSToSNPsViaSNP151Task.raw_snp_data_task","title":"raw_snp_data_task  <code>instance-attribute</code>","text":"<pre><code>raw_snp_data_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/assign_rsids_via_snp151_task/#mecfs_bio.build_system.task.assign_rsids_via_snp151_task.AssignRSIDSToSNPsViaSNP151Task.snp151_database_file_task","title":"snp151_database_file_task  <code>instance-attribute</code>","text":"<pre><code>snp151_database_file_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/assign_rsids_via_snp151_task/#mecfs_bio.build_system.task.assign_rsids_via_snp151_task.AssignRSIDSToSNPsViaSNP151Task.snp_data_id","title":"snp_data_id  <code>property</code>","text":"<pre><code>snp_data_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/assign_rsids_via_snp151_task/#mecfs_bio.build_system.task.assign_rsids_via_snp151_task.AssignRSIDSToSNPsViaSNP151Task.snp_data_meta","title":"snp_data_meta  <code>property</code>","text":"<pre><code>snp_data_meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/assign_rsids_via_snp151_task/#mecfs_bio.build_system.task.assign_rsids_via_snp151_task.AssignRSIDSToSNPsViaSNP151Task.valid_chroms","title":"valid_chroms  <code>instance-attribute</code>","text":"<pre><code>valid_chroms: list[str]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/assign_rsids_via_snp151_task/#mecfs_bio.build_system.task.assign_rsids_via_snp151_task.AssignRSIDSToSNPsViaSNP151Task.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    snp151_database_file_task: Task,\n    raw_snp_data_task: Task,\n    asset_id: str,\n    valid_chroms: list[str],\n    chrom_replace_rules: Mapping[str, int],\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/assign_rsids_via_snp151_task.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    snp151_database_file_task: Task,\n    raw_snp_data_task: Task,\n    asset_id: str,\n    valid_chroms: list[str],\n    chrom_replace_rules: Mapping[str, int],\n):\n    source_meta = raw_snp_data_task.meta\n    meta = create_new_meta(source_meta, asset_id=asset_id)\n    return cls(\n        meta=meta,\n        snp151_database_file_task=snp151_database_file_task,\n        raw_snp_data_task=raw_snp_data_task,\n        valid_chroms=valid_chroms,\n        chrom_replace_rules=chrom_replace_rules,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/assign_rsids_via_snp151_task/#mecfs_bio.build_system.task.assign_rsids_via_snp151_task.AssignRSIDSToSNPsViaSNP151Task.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/assign_rsids_via_snp151_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    rename_frame = nw.from_native(\n        ibis.memtable(\n            {\n                \"chrom\": list(self.chrom_replace_rules.keys()),\n                GWASLAB_CHROM_COL: list(self.chrom_replace_rules.values()),\n            }\n        )\n    )\n    source_data_asset = fetch(self.snp_data_id)\n    source_data_lf = scan_dataframe_asset(\n        source_data_asset, meta=self.snp_data_meta, parquet_backend=\"ibis\"\n    )\n    # filter for single nucleotide changes only\n    source_data_lf = source_data_lf.filter(\n        nw.col(GWASLAB_NON_EFFECT_ALLELE_COL).str.len_chars() == 1\n    ).filter(nw.col(GWASLAB_EFFECT_ALLELE_COL).str.len_chars() == 1)\n    database_asset = fetch(self.database_id)\n    database_lf = scan_dataframe_asset(\n        database_asset, meta=self.database_meta, parquet_backend=\"ibis\"\n    )\n    processed_database_lf = database_lf.filter(nw.col(\"class\") == \"single\").filter(\n        nw.col(\"chrom\").is_in(self.valid_chroms)\n    )\n    processed_database_lf = processed_database_lf.join(rename_frame, on=\"chrom\")\n    processed_database_lf = processed_database_lf.with_columns(\n        (nw.col(\"chromStart_zero_based\") + 1).alias(GWASLAB_POS_COL),\n        (nw.col(\"name\")).alias(GWASLAB_RSID_COL),\n    ).select(\n        GWASLAB_CHROM_COL,\n        GWASLAB_POS_COL,\n        GWASLAB_RSID_COL,\n    )\n    result: nw.LazyFrame = source_data_lf.join(\n        processed_database_lf, on=[GWASLAB_POS_COL, GWASLAB_CHROM_COL]\n    )\n    out_path = scratch_dir / \"snps_with_rsids.parquet\"\n    result.sink_parquet(\n        out_path,\n    )\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/assign_rsids_via_snp151_task/#mecfs_bio.build_system.task.assign_rsids_via_snp151_task.create_new_meta","title":"create_new_meta","text":"<pre><code>create_new_meta(\n    source_meta: Meta,\n    asset_id: str,\n    format: DataFrameFormat = DataFrameParquetFormat(),\n    extension=\".parquet\",\n) -&gt; Meta\n</code></pre> Source code in <code>mecfs_bio/build_system/task/assign_rsids_via_snp151_task.py</code> <pre><code>def create_new_meta(\n    source_meta: Meta,\n    asset_id: str,\n    format: DataFrameFormat = DataFrameParquetFormat(),\n    extension=\".parquet\",\n) -&gt; Meta:\n    meta: Meta\n    if isinstance(source_meta, SimpleFileMeta):\n        meta = SimpleFileMeta(\n            id=AssetId(asset_id),\n            read_spec=DataFrameReadSpec(format=format),\n        )\n    elif isinstance(source_meta, FilteredGWASDataMeta):\n        meta = FilteredGWASDataMeta(\n            id=AssetId(asset_id),\n            project=source_meta.project,\n            trait=source_meta.trait,\n            sub_dir=source_meta.sub_dir,\n            read_spec=DataFrameReadSpec(format=format),\n            extension=extension,\n        )\n    else:\n        raise ValueError(\"unknown source meta\")\n    return meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/base_task/","title":"base_task","text":""},{"location":"reference/mecfs_bio/build_system/task/base_task/#mecfs_bio.build_system.task.base_task","title":"mecfs_bio.build_system.task.base_task","text":"<p>Instructions for materializing an asset.</p> <p>Classes:</p> <ul> <li> <code>GeneratingTask</code>           \u2013            <p>Instructions for materializing an asset.</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>Task</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/base_task/#mecfs_bio.build_system.task.base_task.Task","title":"Task  <code>module-attribute</code>","text":"<pre><code>Task = GeneratingTask\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/base_task/#mecfs_bio.build_system.task.base_task.GeneratingTask","title":"GeneratingTask","text":"<p>               Bases: <code>ABC</code></p> <p>Instructions for materializing an asset.</p> <p>Methods:</p> <ul> <li> <code>execute</code>             \u2013              <p>Materialize the target asset, using the 'fetch' callback to access asset dependencies.</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            <p>List of tasks whose assets are needed to produce the target asset.</p> </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            <p>Metadata describing the target asset.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/base_task/#mecfs_bio.build_system.task.base_task.GeneratingTask.asset_id","title":"asset_id  <code>property</code>","text":"<pre><code>asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/base_task/#mecfs_bio.build_system.task.base_task.GeneratingTask.deps","title":"deps  <code>abstractmethod</code> <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre> <p>List of tasks whose assets are needed to produce the target asset.</p>"},{"location":"reference/mecfs_bio/build_system/task/base_task/#mecfs_bio.build_system.task.base_task.GeneratingTask.meta","title":"meta  <code>abstractmethod</code> <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre> <p>Metadata describing the target asset.</p>"},{"location":"reference/mecfs_bio/build_system/task/base_task/#mecfs_bio.build_system.task.base_task.GeneratingTask.execute","title":"execute  <code>abstractmethod</code>","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> <p>Materialize the target asset, using the 'fetch' callback to access asset dependencies.</p> Source code in <code>mecfs_bio/build_system/task/base_task.py</code> <pre><code>@abstractmethod\ndef execute(\n    self,\n    scratch_dir: Path,\n    fetch: Fetch,\n    wf: WF,\n) -&gt; Asset:\n    \"\"\"\n    Materialize the target asset, using the 'fetch' callback to access asset dependencies.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/combine_gene_lists_task/","title":"combine_gene_lists_task","text":""},{"location":"reference/mecfs_bio/build_system/task/combine_gene_lists_task/#mecfs_bio.build_system.task.combine_gene_lists_task","title":"mecfs_bio.build_system.task.combine_gene_lists_task","text":"<p>Task to combine gene lists from multiple sources</p> <p>Classes:</p> <ul> <li> <code>CombineGeneListsTask</code>           \u2013            <p>Task to aggregate gene lists from multiple sources</p> </li> <li> <code>SrcGeneList</code>           \u2013            </li> </ul> <p>Attributes:</p> <ul> <li> <code>ENSEMBL_ID_LABEL</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/combine_gene_lists_task/#mecfs_bio.build_system.task.combine_gene_lists_task.ENSEMBL_ID_LABEL","title":"ENSEMBL_ID_LABEL  <code>module-attribute</code>","text":"<pre><code>ENSEMBL_ID_LABEL = 'Ensembl ID'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/combine_gene_lists_task/#mecfs_bio.build_system.task.combine_gene_lists_task.CombineGeneListsTask","title":"CombineGeneListsTask","text":"<p>               Bases: <code>Task</code></p> <p>Task to aggregate gene lists from multiple sources</p> <p>Example use case: I have one gene list from MAGMA and another from Gwaslab, and I want to combine them to create master gene list for the trait of interest.</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>out_format</code>               (<code>OutFormat</code>)           \u2013            </li> <li> <code>out_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>src_gene_lists</code>               (<code>Sequence[SrcGeneList]</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/combine_gene_lists_task/#mecfs_bio.build_system.task.combine_gene_lists_task.CombineGeneListsTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/combine_gene_lists_task/#mecfs_bio.build_system.task.combine_gene_lists_task.CombineGeneListsTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/combine_gene_lists_task/#mecfs_bio.build_system.task.combine_gene_lists_task.CombineGeneListsTask.out_format","title":"out_format  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>out_format: OutFormat = CSVOutFormat(sep=',')\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/combine_gene_lists_task/#mecfs_bio.build_system.task.combine_gene_lists_task.CombineGeneListsTask.out_pipe","title":"out_pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>out_pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/combine_gene_lists_task/#mecfs_bio.build_system.task.combine_gene_lists_task.CombineGeneListsTask.src_gene_lists","title":"src_gene_lists  <code>instance-attribute</code>","text":"<pre><code>src_gene_lists: Sequence[SrcGeneList]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/combine_gene_lists_task/#mecfs_bio.build_system.task.combine_gene_lists_task.CombineGeneListsTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    src_gene_lists: Sequence[SrcGeneList],\n    out_format: OutFormat,\n    out_pipe: DataProcessingPipe = IdentityPipe(),\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/combine_gene_lists_task.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    src_gene_lists: Sequence[SrcGeneList],\n    out_format: OutFormat,\n    out_pipe: DataProcessingPipe = IdentityPipe(),\n):\n    assert len(src_gene_lists) &gt; 0\n    first_gene_list = src_gene_lists[0]\n    src_meta = first_gene_list.task.meta\n    extension, read_spec = get_extension_and_read_spec_from_format(out_format)\n    assert isinstance(src_meta, ResultTableMeta)\n    meta = ResultTableMeta(\n        id=AssetId(asset_id),\n        trait=src_meta.trait,\n        project=src_meta.project,\n        extension=extension,\n        read_spec=read_spec,\n    )\n    return cls(\n        src_gene_lists=src_gene_lists,\n        meta=meta,\n        out_format=out_format,\n        out_pipe=out_pipe,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/combine_gene_lists_task/#mecfs_bio.build_system.task.combine_gene_lists_task.CombineGeneListsTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/combine_gene_lists_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    gene_dict: dict[str, list[str]] = {}\n    for gl in self.src_gene_lists:\n        asset = fetch(gl.task.asset_id)\n        df = (\n            scan_dataframe_asset(\n                asset,\n                gl.task.meta,\n            )\n            .collect()\n            .to_pandas()\n        )\n        gene_dict = _combine_gene_dicts(\n            gene_dict,\n            _get_gene_dict_from_df(\n                df, name_col=gl.ensemble_id_column, method_name=gl.name\n            ),\n        )\n    result_df = pd.DataFrame(\n        {ENSEMBL_ID_LABEL: gene_dict.keys(), \"sources\": gene_dict.values()}\n    )\n    result_df = (\n        self.out_pipe.process(narwhals.from_native(result_df).lazy())\n        .collect()\n        .to_pandas()\n    )\n    out_path = scratch_dir / (self._meta.asset_id + \".csv\")\n    if isinstance(self.out_format, CSVOutFormat):\n        result_df.to_csv(out_path, index=False, sep=self.out_format.sep)\n    elif isinstance(self.out_format, ParquetOutFormat):\n        result_df.to_parquet(out_path)\n    else:\n        raise ValueError(f\"Unsupported output format: {self.out_format}\")\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/combine_gene_lists_task/#mecfs_bio.build_system.task.combine_gene_lists_task.SrcGeneList","title":"SrcGeneList","text":"<p>Attributes:</p> <ul> <li> <code>ensemble_id_column</code>               (<code>str</code>)           \u2013            </li> <li> <code>name</code>               (<code>str</code>)           \u2013            </li> <li> <code>pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>task</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/combine_gene_lists_task/#mecfs_bio.build_system.task.combine_gene_lists_task.SrcGeneList.ensemble_id_column","title":"ensemble_id_column  <code>instance-attribute</code>","text":"<pre><code>ensemble_id_column: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/combine_gene_lists_task/#mecfs_bio.build_system.task.combine_gene_lists_task.SrcGeneList.name","title":"name  <code>instance-attribute</code>","text":"<pre><code>name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/combine_gene_lists_task/#mecfs_bio.build_system.task.combine_gene_lists_task.SrcGeneList.pipe","title":"pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/combine_gene_lists_task/#mecfs_bio.build_system.task.combine_gene_lists_task.SrcGeneList.task","title":"task  <code>instance-attribute</code>","text":"<pre><code>task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/compressed_csv_to_parquet_task/","title":"compressed_csv_to_parquet_task","text":""},{"location":"reference/mecfs_bio/build_system/task/compressed_csv_to_parquet_task/#mecfs_bio.build_system.task.compressed_csv_to_parquet_task","title":"mecfs_bio.build_system.task.compressed_csv_to_parquet_task","text":"<p>Enable efficient SQL operations by converting CSV to parquet.</p> <p>Classes:</p> <ul> <li> <code>CompressedCSVToParquetTask</code>           \u2013            <p>Task for converting a gzipped CSV-type file to a parquet file</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/compressed_csv_to_parquet_task/#mecfs_bio.build_system.task.compressed_csv_to_parquet_task.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/compressed_csv_to_parquet_task/#mecfs_bio.build_system.task.compressed_csv_to_parquet_task.CompressedCSVToParquetTask","title":"CompressedCSVToParquetTask","text":"<p>               Bases: <code>Task</code></p> <p>Task for converting a gzipped CSV-type file to a parquet file Main use is for processing the SNP151 SNP database files</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>csv_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>select_list</code>               (<code>list[str] | None</code>)           \u2013            </li> <li> <code>source_compression</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>target_compression</code>               (<code>str</code>)           \u2013            </li> <li> <code>type_dict</code>               (<code>Mapping[str, str] | None</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/compressed_csv_to_parquet_task/#mecfs_bio.build_system.task.compressed_csv_to_parquet_task.CompressedCSVToParquetTask.csv_task","title":"csv_task  <code>instance-attribute</code>","text":"<pre><code>csv_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/compressed_csv_to_parquet_task/#mecfs_bio.build_system.task.compressed_csv_to_parquet_task.CompressedCSVToParquetTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/compressed_csv_to_parquet_task/#mecfs_bio.build_system.task.compressed_csv_to_parquet_task.CompressedCSVToParquetTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/compressed_csv_to_parquet_task/#mecfs_bio.build_system.task.compressed_csv_to_parquet_task.CompressedCSVToParquetTask.select_list","title":"select_list  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>select_list: list[str] | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/compressed_csv_to_parquet_task/#mecfs_bio.build_system.task.compressed_csv_to_parquet_task.CompressedCSVToParquetTask.source_compression","title":"source_compression  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>source_compression: str | None = 'gzip'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/compressed_csv_to_parquet_task/#mecfs_bio.build_system.task.compressed_csv_to_parquet_task.CompressedCSVToParquetTask.target_compression","title":"target_compression  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>target_compression: str = 'zstd'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/compressed_csv_to_parquet_task/#mecfs_bio.build_system.task.compressed_csv_to_parquet_task.CompressedCSVToParquetTask.type_dict","title":"type_dict  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>type_dict: Mapping[str, str] | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/compressed_csv_to_parquet_task/#mecfs_bio.build_system.task.compressed_csv_to_parquet_task.CompressedCSVToParquetTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    csv_task: Task,\n    asset_id: str,\n    target_compression: str = \"zstd\",\n    source_compression: str | None = \"gzip\",\n    select_list: list[str] | None = None,\n    type_dict: Mapping[str, str] | None = None,\n) -&gt; CompressedCSVToParquetTask\n</code></pre> Source code in <code>mecfs_bio/build_system/task/compressed_csv_to_parquet_task.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    csv_task: Task,\n    asset_id: str,\n    target_compression: str = \"zstd\",\n    source_compression: str | None = \"gzip\",\n    select_list: list[str] | None = None,\n    type_dict: Mapping[str, str] | None = None,\n) -&gt; \"CompressedCSVToParquetTask\":\n    source_meta = csv_task.meta\n    if isinstance(source_meta, ReferenceFileMeta):\n        meta = ReferenceFileMeta(\n            group=source_meta.group,\n            sub_group=source_meta.sub_group,\n            sub_folder=source_meta.sub_folder,\n            id=AssetId(asset_id),\n            extension=f\".parquet.{target_compression}\",\n            read_spec=DataFrameReadSpec(format=DataFrameParquetFormat()),\n        )\n        return cls(\n            meta=meta,\n            csv_task=csv_task,\n            target_compression=target_compression,\n            source_compression=source_compression,\n            select_list=select_list,\n            type_dict=type_dict,\n        )\n    raise ValueError(\"Unknown Meta\")\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/compressed_csv_to_parquet_task/#mecfs_bio.build_system.task.compressed_csv_to_parquet_task.CompressedCSVToParquetTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/compressed_csv_to_parquet_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    source_asset = fetch(self._source_id)\n    assert isinstance(source_asset, FileAsset)\n    source_path = source_asset.path\n    read_spec = self._source_meta.read_spec()\n    format = _get_format(read_spec)\n    assert format.null_values is None\n    delim = _get_sep(format)\n    col_names = _get_column_names(format)\n    out_path = scratch_dir / \"output_file.parquet\"\n    name_list_str = \"[\"\n    for nm in col_names:\n        name_list_str += f\"'{nm}',\"\n    name_list_str += \"]\"\n    select_list = \"*\" if self.select_list is None else \",\".join(self.select_list)\n    sql_command = f\"\"\"\n                COPY (SELECT {select_list}\n    \t        FROM read_csv('{source_path}',\n    \t        AUTO_DETECT=TRUE, \n    \t        HEADER={format.has_header}, \n    \t        NAMES = {name_list_str}, \n    \t        delim = '{delim}'\"\"\"\n    if format.comment_char is not None:\n        sql_command += f\"\"\",\n                        comment = '{format.comment_char}'\"\"\"\n    if self.source_compression is not None:\n        sql_command += f\"\"\",\n                      compression={self.source_compression} \"\"\"\n    if self.type_dict is not None:\n        sql_command += f\"\"\",\n        types={self.type_dict}\"\"\"\n\n    sql_command += \"))\"\n    sql_command += f\"\"\"\n                TO '{out_path}' (FORMAT 'PARQUET', CODEC '{self.target_compression}');\n                \"\"\"\n\n    logger.info(f\"running sql command:\\n {sql_command}\")\n    duckdb.sql(sql_command)\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/concat_frames_in_dir_task/","title":"concat_frames_in_dir_task","text":""},{"location":"reference/mecfs_bio/build_system/task/concat_frames_in_dir_task/#mecfs_bio.build_system.task.concat_frames_in_dir_task","title":"mecfs_bio.build_system.task.concat_frames_in_dir_task","text":"<p>Concatenate dataframes in a DirectoryAsset to create a single FileAsset.</p> <p>Classes:</p> <ul> <li> <code>ConcatFramesInDirTask</code>           \u2013            <p>Task to concatenate dataframes in a directory matching a glob pattern</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/concat_frames_in_dir_task/#mecfs_bio.build_system.task.concat_frames_in_dir_task.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = getLogger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/concat_frames_in_dir_task/#mecfs_bio.build_system.task.concat_frames_in_dir_task.ConcatFramesInDirTask","title":"ConcatFramesInDirTask","text":"<p>               Bases: <code>Task</code></p> <p>Task to concatenate dataframes in a directory matching a glob pattern</p> <p>Example use case: when GWAS summary statistics are split over multiple files.</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>path_glob</code>               (<code>str</code>)           \u2013            </li> <li> <code>read_spec_for_frames</code>               (<code>DataFrameReadSpec</code>)           \u2013            </li> <li> <code>source_dir_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>src_id</code>               (<code>AssetId</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/concat_frames_in_dir_task/#mecfs_bio.build_system.task.concat_frames_in_dir_task.ConcatFramesInDirTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/concat_frames_in_dir_task/#mecfs_bio.build_system.task.concat_frames_in_dir_task.ConcatFramesInDirTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/concat_frames_in_dir_task/#mecfs_bio.build_system.task.concat_frames_in_dir_task.ConcatFramesInDirTask.path_glob","title":"path_glob  <code>instance-attribute</code>","text":"<pre><code>path_glob: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/concat_frames_in_dir_task/#mecfs_bio.build_system.task.concat_frames_in_dir_task.ConcatFramesInDirTask.read_spec_for_frames","title":"read_spec_for_frames  <code>instance-attribute</code>","text":"<pre><code>read_spec_for_frames: DataFrameReadSpec\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/concat_frames_in_dir_task/#mecfs_bio.build_system.task.concat_frames_in_dir_task.ConcatFramesInDirTask.source_dir_task","title":"source_dir_task  <code>instance-attribute</code>","text":"<pre><code>source_dir_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/concat_frames_in_dir_task/#mecfs_bio.build_system.task.concat_frames_in_dir_task.ConcatFramesInDirTask.src_id","title":"src_id  <code>property</code>","text":"<pre><code>src_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/concat_frames_in_dir_task/#mecfs_bio.build_system.task.concat_frames_in_dir_task.ConcatFramesInDirTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    source_dir_task: Task,\n    path_glob: str,\n    read_spec_for_frames: DataFrameReadSpec,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/concat_frames_in_dir_task.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    source_dir_task: Task,\n    path_glob: str,\n    read_spec_for_frames: DataFrameReadSpec,\n):\n    meta: Meta\n    source_meta: Meta = source_dir_task.meta\n    if isinstance(source_meta, ReferenceDataDirectoryMeta):\n        meta = ReferenceFileMeta(\n            group=source_meta.group,\n            sub_group=source_meta.sub_group,\n            sub_folder=source_meta.sub_folder,\n            id=AssetId(asset_id),\n            extension=\".parquet\",\n            read_spec=DataFrameReadSpec(DataFrameParquetFormat()),\n        )\n    elif isinstance(source_meta, ProcessedGwasDataDirectoryMeta):\n        meta = FilteredGWASDataMeta(\n            id=AssetId(asset_id),\n            trait=source_meta.trait,\n            project=source_meta.project,\n            sub_dir=PurePath(\"processed\"),\n            read_spec=DataFrameReadSpec(DataFrameParquetFormat()),\n        )\n    else:\n        raise NotImplementedError(\n            f\"Handlers for meta {source_meta} are not implemented\"\n        )\n    return cls(\n        meta=meta,\n        source_dir_task=source_dir_task,\n        path_glob=path_glob,\n        read_spec_for_frames=read_spec_for_frames,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/concat_frames_in_dir_task/#mecfs_bio.build_system.task.concat_frames_in_dir_task.ConcatFramesInDirTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/concat_frames_in_dir_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    dir_asset = fetch(self.src_id)\n    assert isinstance(dir_asset, DirectoryAsset)\n    file_paths = sorted(dir_asset.path.rglob(self.path_glob))\n    assert len(file_paths) &gt; 0\n    frames = []\n    for pth in file_paths:\n        frames.append(\n            scan_dataframe(path=pth, spec=self.read_spec_for_frames)\n            .collect()\n            .to_pandas()\n        )\n        logger.debug(f\"loaded frame from {pth}. shape: {frames[-1].shape}\")\n    result: pd.DataFrame = pd.concat(frames, axis=0)\n    out_path = scratch_dir / \"combined_dataframe.parquet\"\n    result.to_parquet(out_path)\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/concat_frames_task/","title":"concat_frames_task","text":""},{"location":"reference/mecfs_bio/build_system/task/concat_frames_task/#mecfs_bio.build_system.task.concat_frames_task","title":"mecfs_bio.build_system.task.concat_frames_task","text":"<p>Task to combine the results of multiple Tasks, each of which produces a dataframe.</p> <p>Classes:</p> <ul> <li> <code>ConcatFramesTask</code>           \u2013            <p>Task to concatenate multiple DataFrames, each produces by a separate task.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/concat_frames_task/#mecfs_bio.build_system.task.concat_frames_task.ConcatFramesTask","title":"ConcatFramesTask","text":"<p>               Bases: <code>Task</code></p> <p>Task to concatenate multiple DataFrames, each produces by a separate task.</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>frames_tasks</code>               (<code>Sequence[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>out_format</code>               (<code>OutFormat</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/concat_frames_task/#mecfs_bio.build_system.task.concat_frames_task.ConcatFramesTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/concat_frames_task/#mecfs_bio.build_system.task.concat_frames_task.ConcatFramesTask.frames_tasks","title":"frames_tasks  <code>instance-attribute</code>","text":"<pre><code>frames_tasks: Sequence[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/concat_frames_task/#mecfs_bio.build_system.task.concat_frames_task.ConcatFramesTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/concat_frames_task/#mecfs_bio.build_system.task.concat_frames_task.ConcatFramesTask.out_format","title":"out_format  <code>instance-attribute</code>","text":"<pre><code>out_format: OutFormat\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/concat_frames_task/#mecfs_bio.build_system.task.concat_frames_task.ConcatFramesTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    frames_tasks: Sequence[Task],\n    out_format: OutFormat,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/concat_frames_task.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    frames_tasks: Sequence[Task],\n    out_format: OutFormat,\n):\n    extension, spec = get_extension_and_read_spec_from_format(out_format)\n    assert len(frames_tasks) &gt; 0\n    source_meta = frames_tasks[0].meta\n    if isinstance(source_meta, ResultTableMeta):\n        meta = ResultTableMeta(\n            id=AssetId(asset_id),\n            trait=source_meta.trait,\n            project=source_meta.project,\n            extension=extension,\n            read_spec=spec,\n            sub_dir=source_meta.sub_dir,\n        )\n    else:\n        raise ValueError(f\"Unknown meta: {source_meta}\")\n\n    return cls(\n        meta=meta,\n        frames_tasks=frames_tasks,\n        out_format=out_format,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/concat_frames_task/#mecfs_bio.build_system.task.concat_frames_task.ConcatFramesTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/concat_frames_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    frames = []\n    for task in self.frames_tasks:\n        asset = fetch(task.asset_id)\n        frames.append(scan_dataframe_asset(asset, meta=task.meta))\n    result = narwhals.concat(frames, how=\"vertical\")\n    out_path = scratch_dir / f\"{self.meta.asset_id}\"\n    if isinstance(self.out_format, CSVOutFormat):\n        result.collect().to_pandas().to_csv(\n            out_path, index=False, sep=self.out_format.sep\n        )\n    elif isinstance(self.out_format, ParquetOutFormat):\n        result.sink_parquet(out_path)\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/convert_dataframe_to_markdown_task/","title":"convert_dataframe_to_markdown_task","text":""},{"location":"reference/mecfs_bio/build_system/task/convert_dataframe_to_markdown_task/#mecfs_bio.build_system.task.convert_dataframe_to_markdown_task","title":"mecfs_bio.build_system.task.convert_dataframe_to_markdown_task","text":"<p>Prepare results for presentation by converting a dataframe to markdown format.</p> <p>Classes:</p> <ul> <li> <code>ConvertDataFrameToMarkdownTask</code>           \u2013            <p>Task to convert a dataframe to markdown format.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/convert_dataframe_to_markdown_task/#mecfs_bio.build_system.task.convert_dataframe_to_markdown_task.ConvertDataFrameToMarkdownTask","title":"ConvertDataFrameToMarkdownTask","text":"<p>               Bases: <code>Task</code></p> <p>Task to convert a dataframe to markdown format. Useful for writing up results</p> <p>Methods:</p> <ul> <li> <code>create_from_result_table_task</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/convert_dataframe_to_markdown_task/#mecfs_bio.build_system.task.convert_dataframe_to_markdown_task.ConvertDataFrameToMarkdownTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/convert_dataframe_to_markdown_task/#mecfs_bio.build_system.task.convert_dataframe_to_markdown_task.ConvertDataFrameToMarkdownTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/convert_dataframe_to_markdown_task/#mecfs_bio.build_system.task.convert_dataframe_to_markdown_task.ConvertDataFrameToMarkdownTask.pipe","title":"pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/convert_dataframe_to_markdown_task/#mecfs_bio.build_system.task.convert_dataframe_to_markdown_task.ConvertDataFrameToMarkdownTask.create_from_result_table_task","title":"create_from_result_table_task  <code>classmethod</code>","text":"<pre><code>create_from_result_table_task(\n    source_task: Task,\n    asset_id: str,\n    pipe: DataProcessingPipe = IdentityPipe(),\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/convert_dataframe_to_markdown_task.py</code> <pre><code>@classmethod\ndef create_from_result_table_task(\n    cls, source_task: Task, asset_id: str, pipe: DataProcessingPipe = IdentityPipe()\n):\n    source_meta = source_task.meta\n    assert isinstance(source_meta, ResultTableMeta)\n    meta = FilteredGWASDataMeta(\n        id=AssetId(asset_id),\n        trait=source_meta.trait,\n        project=source_meta.project,\n        sub_dir=source_meta.sub_dir,\n        extension=\".md\",\n    )\n    return cls(meta=meta, df_task=source_task, pipe=pipe)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/convert_dataframe_to_markdown_task/#mecfs_bio.build_system.task.convert_dataframe_to_markdown_task.ConvertDataFrameToMarkdownTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/convert_dataframe_to_markdown_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    source_asset = fetch(self._source_id)\n    nw_df = self.pipe.process(\n        scan_dataframe_asset(asset=source_asset, meta=self._source_meta)\n    )\n\n    df = nw_df.collect().to_pandas()\n    df = _array_to_list(df)\n    out_path = scratch_dir / \"output.md\"\n    markdown_str = df.to_markdown(index=False)\n    with open(out_path, \"w\") as f:\n        f.write(markdown_str)\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/copy_file_from_directory_task/","title":"copy_file_from_directory_task","text":""},{"location":"reference/mecfs_bio/build_system/task/copy_file_from_directory_task/#mecfs_bio.build_system.task.copy_file_from_directory_task","title":"mecfs_bio.build_system.task.copy_file_from_directory_task","text":"<p>Copy a file within a DirectoryAsset to create a FileAsset.  Useful when downstream tasks require FileAssets.</p> <p>Classes:</p> <ul> <li> <code>CopyFileFromDirectoryTask</code>           \u2013            <p>Copy a file within a DirectoryAsset to create a FileAsset.  Useful when downstream tasks require FileAssets.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/copy_file_from_directory_task/#mecfs_bio.build_system.task.copy_file_from_directory_task.CopyFileFromDirectoryTask","title":"CopyFileFromDirectoryTask","text":"<p>               Bases: <code>Task</code></p> <p>Copy a file within a DirectoryAsset to create a FileAsset.  Useful when downstream tasks require FileAssets.</p> <p>Methods:</p> <ul> <li> <code>create_result_table</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>path_inside_directory</code>               (<code>PurePath</code>)           \u2013            </li> <li> <code>source_directory_task</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/copy_file_from_directory_task/#mecfs_bio.build_system.task.copy_file_from_directory_task.CopyFileFromDirectoryTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/copy_file_from_directory_task/#mecfs_bio.build_system.task.copy_file_from_directory_task.CopyFileFromDirectoryTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/copy_file_from_directory_task/#mecfs_bio.build_system.task.copy_file_from_directory_task.CopyFileFromDirectoryTask.path_inside_directory","title":"path_inside_directory  <code>instance-attribute</code>","text":"<pre><code>path_inside_directory: PurePath\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/copy_file_from_directory_task/#mecfs_bio.build_system.task.copy_file_from_directory_task.CopyFileFromDirectoryTask.source_directory_task","title":"source_directory_task  <code>instance-attribute</code>","text":"<pre><code>source_directory_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/copy_file_from_directory_task/#mecfs_bio.build_system.task.copy_file_from_directory_task.CopyFileFromDirectoryTask.create_result_table","title":"create_result_table  <code>classmethod</code>","text":"<pre><code>create_result_table(\n    asset_id: str,\n    source_directory_task: Task,\n    path_inside_directory: PurePath,\n    extension: str,\n    read_spec: DataFrameReadSpec | None,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/copy_file_from_directory_task.py</code> <pre><code>@classmethod\ndef create_result_table(\n    cls,\n    asset_id: str,\n    source_directory_task: Task,\n    path_inside_directory: PurePath,\n    extension: str,\n    read_spec: DataFrameReadSpec | None,\n):\n    source_meta: Meta = source_directory_task.meta\n    meta: Meta\n    if isinstance(source_meta, ProcessedGwasDataDirectoryMeta):\n        meta = ResultTableMeta(\n            id=AssetId(asset_id),\n            trait=source_meta.trait,\n            project=source_meta.project,\n            extension=extension,\n            read_spec=read_spec,\n        )\n    elif isinstance(source_meta, ResultDirectoryMeta):\n        meta = ResultTableMeta(\n            id=AssetId(asset_id),\n            trait=source_meta.trait,\n            project=source_meta.project,\n            extension=extension,\n            read_spec=read_spec,\n        )\n    elif isinstance(source_meta, GWASPlotDirectoryMeta):\n        meta = GWASPlotFileMeta(\n            trait=source_meta.trait,\n            project=source_meta.project,\n            extension=extension,\n            id=AssetId(asset_id),\n        )\n    else:\n        raise ValueError(\"Unknown source meta\")\n    return cls(\n        meta=meta,\n        source_directory_task=source_directory_task,\n        path_inside_directory=path_inside_directory,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/copy_file_from_directory_task/#mecfs_bio.build_system.task.copy_file_from_directory_task.CopyFileFromDirectoryTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/copy_file_from_directory_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    dir_asset = fetch(self.source_directory_task.asset_id)\n    assert isinstance(dir_asset, DirectoryAsset)\n    src_path = dir_asset.path / self.path_inside_directory\n    out_path = scratch_dir / self.meta.asset_id\n    shutil.copyfile(src_path, out_path)\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/copy_task/","title":"copy_task","text":""},{"location":"reference/mecfs_bio/build_system/task/copy_task/#mecfs_bio.build_system.task.copy_task","title":"mecfs_bio.build_system.task.copy_task","text":"<p>Copy a single file.  Mainly used for testing.</p> <p>Classes:</p> <ul> <li> <code>CopyTask</code>           \u2013            <p>Copies a file from a dependency</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/copy_task/#mecfs_bio.build_system.task.copy_task.CopyTask","title":"CopyTask","text":"<p>               Bases: <code>GeneratingTask</code></p> <p>Copies a file from a dependency Used for testing</p> <p>Methods:</p> <ul> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>dep_file_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/copy_task/#mecfs_bio.build_system.task.copy_task.CopyTask.dep_file_task","title":"dep_file_task  <code>instance-attribute</code>","text":"<pre><code>dep_file_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/copy_task/#mecfs_bio.build_system.task.copy_task.CopyTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/copy_task/#mecfs_bio.build_system.task.copy_task.CopyTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/copy_task/#mecfs_bio.build_system.task.copy_task.CopyTask.execute","title":"execute","text":"<pre><code>execute(\n    scratch_dir: Path, fetch: Fetch, wf: WF\n) -&gt; FileAsset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/copy_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; FileAsset:\n    dep_asset = fetch(self.dep_file_task.asset_id)\n    temp_dst = scratch_dir / \"temp_dst\"\n    assert isinstance(dep_asset, FileAsset)\n    shutil.copyfile(dep_asset.path, temp_dst)\n    return FileAsset(temp_dst)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/counting_task/","title":"counting_task","text":""},{"location":"reference/mecfs_bio/build_system/task/counting_task/#mecfs_bio.build_system.task.counting_task","title":"mecfs_bio.build_system.task.counting_task","text":"<p>For testing purposes, recording the number of times that a wrapped task has been executed.</p> <p>Classes:</p> <ul> <li> <code>CountingTask</code>           \u2013            <p>For testing.  Records the number of times a task has been executed</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/counting_task/#mecfs_bio.build_system.task.counting_task.CountingTask","title":"CountingTask","text":"<p>               Bases: <code>GeneratingTask</code></p> <p>For testing.  Records the number of times a task has been executed</p> <p>Methods:</p> <ul> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>run_count</code>               (<code>int</code>)           \u2013            </li> <li> <code>wrapped</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/counting_task/#mecfs_bio.build_system.task.counting_task.CountingTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/counting_task/#mecfs_bio.build_system.task.counting_task.CountingTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/counting_task/#mecfs_bio.build_system.task.counting_task.CountingTask.run_count","title":"run_count  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>run_count: int = 0\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/counting_task/#mecfs_bio.build_system.task.counting_task.CountingTask.wrapped","title":"wrapped  <code>instance-attribute</code>","text":"<pre><code>wrapped: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/counting_task/#mecfs_bio.build_system.task.counting_task.CountingTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/counting_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    self.run_count += 1\n    return self.wrapped.execute(scratch_dir, fetch, wf)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/discard_deps_task_wrapper/","title":"discard_deps_task_wrapper","text":""},{"location":"reference/mecfs_bio/build_system/task/discard_deps_task_wrapper/#mecfs_bio.build_system.task.discard_deps_task_wrapper","title":"mecfs_bio.build_system.task.discard_deps_task_wrapper","text":"<p>Save disk space materializing dependencies of the wrapped task in a temporary directory.</p> <p>Classes:</p> <ul> <li> <code>DiscardDepsWrapper</code>           \u2013            <p>Save disk space materializing dependencies of the wrapped task in a temporary directory.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/discard_deps_task_wrapper/#mecfs_bio.build_system.task.discard_deps_task_wrapper.DiscardDepsWrapper","title":"DiscardDepsWrapper","text":"<p>               Bases: <code>Task</code></p> <p>Save disk space materializing dependencies of the wrapped task in a temporary directory.</p> <p>Methods:</p> <ul> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/discard_deps_task_wrapper/#mecfs_bio.build_system.task.discard_deps_task_wrapper.DiscardDepsWrapper.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/discard_deps_task_wrapper/#mecfs_bio.build_system.task.discard_deps_task_wrapper.DiscardDepsWrapper.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/discard_deps_task_wrapper/#mecfs_bio.build_system.task.discard_deps_task_wrapper.DiscardDepsWrapper.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/discard_deps_task_wrapper.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    out_path = scratch_dir / \"out\"\n    with tempfile.TemporaryDirectory() as temp_dir:\n        temp_path = Path(temp_dir)\n        info_store = temp_path / \"info_store.yaml\"\n\n        asset_root = temp_path / \"asset_store\"\n        runner = SimpleRunner(\n            tracer=ImoHasher.with_xxhash_128(),\n            info_store=info_store,\n            asset_root=asset_root,\n        )\n        result = runner.run([self._inner])\n        result_asset = result[self._inner.asset_id]\n        if isinstance(result_asset, FileAsset):\n            is_file = True\n        else:\n            is_file = False\n            assert isinstance(result_asset, DirectoryAsset)\n        result_path = result_asset.path\n        result_path.rename(out_path)\n    if is_file:\n        return FileAsset(out_path)\n    return DirectoryAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/download_file_task/","title":"download_file_task","text":""},{"location":"reference/mecfs_bio/build_system/task/download_file_task/#mecfs_bio.build_system.task.download_file_task","title":"mecfs_bio.build_system.task.download_file_task","text":"<p>Download a file, possibly verifying it using a hash.</p> <p>This Task is the main way GWAS summary statistics are added to the build system.</p> <p>Classes:</p> <ul> <li> <code>DownloadFileTask</code>           \u2013            </li> </ul> <p>Attributes:</p> <ul> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/download_file_task/#mecfs_bio.build_system.task.download_file_task.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/download_file_task/#mecfs_bio.build_system.task.download_file_task.DownloadFileTask","title":"DownloadFileTask","text":"<p>               Bases: <code>Task</code></p> <p>Methods:</p> <ul> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/download_file_task/#mecfs_bio.build_system.task.download_file_task.DownloadFileTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/download_file_task/#mecfs_bio.build_system.task.download_file_task.DownloadFileTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/download_file_task/#mecfs_bio.build_system.task.download_file_task.DownloadFileTask.execute","title":"execute","text":"<pre><code>execute(\n    scratch_dir: Path, fetch: Fetch, wf: WF\n) -&gt; FileAsset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/download_file_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; FileAsset:\n    target = scratch_dir / self.meta.asset_id\n    wf.download_from_url(url=self._url, local_path=target, md5_hash=self._md5_hash)\n    return FileAsset(target)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/download_files_into_directory_task/","title":"download_files_into_directory_task","text":""},{"location":"reference/mecfs_bio/build_system/task/download_files_into_directory_task/#mecfs_bio.build_system.task.download_files_into_directory_task","title":"mecfs_bio.build_system.task.download_files_into_directory_task","text":"<p>Task to download one or more files into a directory, then run command line programs on them,</p> <p>Classes:</p> <ul> <li> <code>DownloadEntry</code>           \u2013            <p>A file to download into the directory,</p> </li> <li> <code>DownloadFilesIntoDirectoryTask</code>           \u2013            <p>A directory consisting of one or more downloaded files</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/download_files_into_directory_task/#mecfs_bio.build_system.task.download_files_into_directory_task.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/download_files_into_directory_task/#mecfs_bio.build_system.task.download_files_into_directory_task.DownloadEntry","title":"DownloadEntry","text":"<p>A file to download into the directory, possibly including a command line operation to call on the downloaded file</p> <p>Methods:</p> <ul> <li> <code>create_with_bcftools_index</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>filename</code>               (<code>str</code>)           \u2013            </li> <li> <code>md5hash</code>               (<code>str</code>)           \u2013            </li> <li> <code>post_download_command</code>               (<code>Callable[[Path], list[str]] | None</code>)           \u2013            </li> <li> <code>url</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/download_files_into_directory_task/#mecfs_bio.build_system.task.download_files_into_directory_task.DownloadEntry.filename","title":"filename  <code>instance-attribute</code>","text":"<pre><code>filename: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/download_files_into_directory_task/#mecfs_bio.build_system.task.download_files_into_directory_task.DownloadEntry.md5hash","title":"md5hash  <code>instance-attribute</code>","text":"<pre><code>md5hash: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/download_files_into_directory_task/#mecfs_bio.build_system.task.download_files_into_directory_task.DownloadEntry.post_download_command","title":"post_download_command  <code>instance-attribute</code>","text":"<pre><code>post_download_command: Callable[[Path], list[str]] | None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/download_files_into_directory_task/#mecfs_bio.build_system.task.download_files_into_directory_task.DownloadEntry.url","title":"url  <code>instance-attribute</code>","text":"<pre><code>url: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/download_files_into_directory_task/#mecfs_bio.build_system.task.download_files_into_directory_task.DownloadEntry.create_with_bcftools_index","title":"create_with_bcftools_index  <code>classmethod</code>","text":"<pre><code>create_with_bcftools_index(\n    url: str, filename: str, md5hash: str\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/download_files_into_directory_task.py</code> <pre><code>@classmethod\ndef create_with_bcftools_index(cls, url: str, filename: str, md5hash: str):\n    return cls(\n        url=url,\n        filename=filename,\n        md5hash=md5hash,\n        post_download_command=build_bcftools_index_command,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/download_files_into_directory_task/#mecfs_bio.build_system.task.download_files_into_directory_task.DownloadFilesIntoDirectoryTask","title":"DownloadFilesIntoDirectoryTask","text":"<p>               Bases: <code>Task</code></p> <p>A directory consisting of one or more downloaded files</p> <p>Methods:</p> <ul> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>entries</code>               (<code>Sequence[DownloadEntry]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/download_files_into_directory_task/#mecfs_bio.build_system.task.download_files_into_directory_task.DownloadFilesIntoDirectoryTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/download_files_into_directory_task/#mecfs_bio.build_system.task.download_files_into_directory_task.DownloadFilesIntoDirectoryTask.entries","title":"entries  <code>instance-attribute</code>","text":"<pre><code>entries: Sequence[DownloadEntry]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/download_files_into_directory_task/#mecfs_bio.build_system.task.download_files_into_directory_task.DownloadFilesIntoDirectoryTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/download_files_into_directory_task/#mecfs_bio.build_system.task.download_files_into_directory_task.DownloadFilesIntoDirectoryTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/download_files_into_directory_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    for entry in self.entries:\n        target = scratch_dir / entry.filename\n        logger.debug(f\"Downloading {entry}\")\n        wf.download_from_url(entry.url, target, md5_hash=entry.md5hash)\n        if entry.post_download_command is not None:\n            post_download_command = entry.post_download_command(target)\n            logger.debug(\n                f\"Running post_download_command: {' '.join(post_download_command)} \\n\"\n            )\n            execute_command(post_download_command)\n    return DirectoryAsset(scratch_dir)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/download_from_google_drive_task/","title":"download_from_google_drive_task","text":""},{"location":"reference/mecfs_bio/build_system/task/download_from_google_drive_task/#mecfs_bio.build_system.task.download_from_google_drive_task","title":"mecfs_bio.build_system.task.download_from_google_drive_task","text":"<p>Some GWAS summary statistics are stored on Google Drive.  Use this task to access them.</p> <p>Classes:</p> <ul> <li> <code>DownloadFromGoogleDriveTask</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/download_from_google_drive_task/#mecfs_bio.build_system.task.download_from_google_drive_task.DownloadFromGoogleDriveTask","title":"DownloadFromGoogleDriveTask","text":"<p>               Bases: <code>Task</code></p> <p>Methods:</p> <ul> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>file_id</code>               (<code>str</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/download_from_google_drive_task/#mecfs_bio.build_system.task.download_from_google_drive_task.DownloadFromGoogleDriveTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/download_from_google_drive_task/#mecfs_bio.build_system.task.download_from_google_drive_task.DownloadFromGoogleDriveTask.file_id","title":"file_id  <code>instance-attribute</code>","text":"<pre><code>file_id: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/download_from_google_drive_task/#mecfs_bio.build_system.task.download_from_google_drive_task.DownloadFromGoogleDriveTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/download_from_google_drive_task/#mecfs_bio.build_system.task.download_from_google_drive_task.DownloadFromGoogleDriveTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/download_from_google_drive_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    out_path = scratch_dir / self.file_id\n    gdown.download(id=self.file_id, output=str(out_path))\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/external_directory_copy_task/","title":"external_directory_copy_task","text":""},{"location":"reference/mecfs_bio/build_system/task/external_directory_copy_task/#mecfs_bio.build_system.task.external_directory_copy_task","title":"mecfs_bio.build_system.task.external_directory_copy_task","text":"<p>Copies a directory from an external source.</p> <p>Classes:</p> <ul> <li> <code>ExternalDirectoryCopyTask</code>           \u2013            <p>Copies a directory from an external source.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/external_directory_copy_task/#mecfs_bio.build_system.task.external_directory_copy_task.ExternalDirectoryCopyTask","title":"ExternalDirectoryCopyTask","text":"<p>               Bases: <code>GeneratingTask</code></p> <p>Copies a directory from an external source. Used for testing.</p> <p>Methods:</p> <ul> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>external_path</code>               (<code>Path</code>)           \u2013            </li> <li> <code>meta</code>               (<code>SimpleDirectoryMeta</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/external_directory_copy_task/#mecfs_bio.build_system.task.external_directory_copy_task.ExternalDirectoryCopyTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/external_directory_copy_task/#mecfs_bio.build_system.task.external_directory_copy_task.ExternalDirectoryCopyTask.external_path","title":"external_path  <code>instance-attribute</code>","text":"<pre><code>external_path: Path\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/external_directory_copy_task/#mecfs_bio.build_system.task.external_directory_copy_task.ExternalDirectoryCopyTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: SimpleDirectoryMeta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/external_directory_copy_task/#mecfs_bio.build_system.task.external_directory_copy_task.ExternalDirectoryCopyTask.execute","title":"execute","text":"<pre><code>execute(\n    scratch_dir: Path, fetch: Fetch, wf: WF\n) -&gt; DirectoryAsset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/external_directory_copy_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; DirectoryAsset:\n    target_path = scratch_dir / \"target\"\n    shutil.copytree(str(self.external_path), str(target_path))\n    return DirectoryAsset(target_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/external_file_copy_task/","title":"external_file_copy_task","text":""},{"location":"reference/mecfs_bio/build_system/task/external_file_copy_task/#mecfs_bio.build_system.task.external_file_copy_task","title":"mecfs_bio.build_system.task.external_file_copy_task","text":"<p>Task to copy a file from an external source.  Used to testing.</p> <p>Classes:</p> <ul> <li> <code>ExternalFileCopyTask</code>           \u2013            <p>Copies a file from an external source.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/external_file_copy_task/#mecfs_bio.build_system.task.external_file_copy_task.ExternalFileCopyTask","title":"ExternalFileCopyTask","text":"<p>               Bases: <code>GeneratingTask</code></p> <p>Copies a file from an external source. Used for testing</p> <p>Methods:</p> <ul> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>external_path</code>               (<code>Path</code>)           \u2013            </li> <li> <code>meta</code>               (<code>SimpleFileMeta</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/external_file_copy_task/#mecfs_bio.build_system.task.external_file_copy_task.ExternalFileCopyTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/external_file_copy_task/#mecfs_bio.build_system.task.external_file_copy_task.ExternalFileCopyTask.external_path","title":"external_path  <code>instance-attribute</code>","text":"<pre><code>external_path: Path\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/external_file_copy_task/#mecfs_bio.build_system.task.external_file_copy_task.ExternalFileCopyTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: SimpleFileMeta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/external_file_copy_task/#mecfs_bio.build_system.task.external_file_copy_task.ExternalFileCopyTask.execute","title":"execute","text":"<pre><code>execute(\n    scratch_dir: Path, fetch: Fetch, wf: WF\n) -&gt; FileAsset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/external_file_copy_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; FileAsset:\n    target_path = scratch_dir / \"target\"\n    shutil.copy(str(self.external_path), str(target_path))\n    return FileAsset(target_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_all_from_zip_task/","title":"extract_all_from_zip_task","text":""},{"location":"reference/mecfs_bio/build_system/task/extract_all_from_zip_task/#mecfs_bio.build_system.task.extract_all_from_zip_task","title":"mecfs_bio.build_system.task.extract_all_from_zip_task","text":"<p>Task to extract the entire contents of a zip archive</p> <p>Classes:</p> <ul> <li> <code>ExtractAllFromZipTask</code>           \u2013            <p>Task to extract the entire contents of a zip archive</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/extract_all_from_zip_task/#mecfs_bio.build_system.task.extract_all_from_zip_task.ExtractAllFromZipTask","title":"ExtractAllFromZipTask","text":"<p>               Bases: <code>Task</code></p> <p>Task to extract the entire contents of a zip archive</p> <p>Methods:</p> <ul> <li> <code>create_from_zipped_reference_file</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>source_file_task</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/extract_all_from_zip_task/#mecfs_bio.build_system.task.extract_all_from_zip_task.ExtractAllFromZipTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_all_from_zip_task/#mecfs_bio.build_system.task.extract_all_from_zip_task.ExtractAllFromZipTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_all_from_zip_task/#mecfs_bio.build_system.task.extract_all_from_zip_task.ExtractAllFromZipTask.source_file_task","title":"source_file_task  <code>instance-attribute</code>","text":"<pre><code>source_file_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_all_from_zip_task/#mecfs_bio.build_system.task.extract_all_from_zip_task.ExtractAllFromZipTask.create_from_zipped_reference_file","title":"create_from_zipped_reference_file  <code>classmethod</code>","text":"<pre><code>create_from_zipped_reference_file(\n    source_task: Task, asset_id: str\n) -&gt; Task\n</code></pre> Source code in <code>mecfs_bio/build_system/task/extract_all_from_zip_task.py</code> <pre><code>@classmethod\ndef create_from_zipped_reference_file(\n    cls, source_task: Task, asset_id: str\n) -&gt; Task:\n    src_meta = source_task.meta\n    assert isinstance(src_meta, ReferenceFileMeta)\n    meta = ReferenceDataDirectoryMeta(\n        group=src_meta.group,\n        sub_group=src_meta.sub_group,\n        sub_folder=PurePath(\"extracted\"),\n        id=AssetId(asset_id),\n        dirname=src_meta.filename,\n    )\n    return cls(\n        meta=meta,\n        source_file_task=source_task,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_all_from_zip_task/#mecfs_bio.build_system.task.extract_all_from_zip_task.ExtractAllFromZipTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/extract_all_from_zip_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    source_asset = fetch(self._source_id)\n    assert isinstance(source_asset, FileAsset)\n    target_dir = scratch_dir / \"extracted\"\n    target_dir.mkdir(parents=True, exist_ok=True)\n    with ZipFile(source_asset.path, \"r\") as zip_file:\n        zip_file.extractall(\n            target_dir,\n        )\n    return DirectoryAsset(target_dir)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_dataframe_from_rdata_task/","title":"extract_dataframe_from_rdata_task","text":""},{"location":"reference/mecfs_bio/build_system/task/extract_dataframe_from_rdata_task/#mecfs_bio.build_system.task.extract_dataframe_from_rdata_task","title":"mecfs_bio.build_system.task.extract_dataframe_from_rdata_task","text":"<p>Classes:</p> <ul> <li> <code>ExtractDataFrameFromRDataTask</code>           \u2013            <p>RData files can bundle together many R objects.  This is a Task to extract a single dataframe from such a file.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/extract_dataframe_from_rdata_task/#mecfs_bio.build_system.task.extract_dataframe_from_rdata_task.ExtractDataFrameFromRDataTask","title":"ExtractDataFrameFromRDataTask","text":"<p>               Bases: <code>Task</code></p> <p>RData files can bundle together many R objects.  This is a Task to extract a single dataframe from such a file.</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>r_dataframe_name</code>               (<code>str</code>)           \u2013            </li> <li> <code>r_package_list</code>               (<code>Sequence[str]</code>)           \u2013            </li> <li> <code>rdata_file_task</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/extract_dataframe_from_rdata_task/#mecfs_bio.build_system.task.extract_dataframe_from_rdata_task.ExtractDataFrameFromRDataTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_dataframe_from_rdata_task/#mecfs_bio.build_system.task.extract_dataframe_from_rdata_task.ExtractDataFrameFromRDataTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_dataframe_from_rdata_task/#mecfs_bio.build_system.task.extract_dataframe_from_rdata_task.ExtractDataFrameFromRDataTask.r_dataframe_name","title":"r_dataframe_name  <code>instance-attribute</code>","text":"<pre><code>r_dataframe_name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_dataframe_from_rdata_task/#mecfs_bio.build_system.task.extract_dataframe_from_rdata_task.ExtractDataFrameFromRDataTask.r_package_list","title":"r_package_list  <code>instance-attribute</code>","text":"<pre><code>r_package_list: Sequence[str]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_dataframe_from_rdata_task/#mecfs_bio.build_system.task.extract_dataframe_from_rdata_task.ExtractDataFrameFromRDataTask.rdata_file_task","title":"rdata_file_task  <code>instance-attribute</code>","text":"<pre><code>rdata_file_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_dataframe_from_rdata_task/#mecfs_bio.build_system.task.extract_dataframe_from_rdata_task.ExtractDataFrameFromRDataTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    rdata_file_task: Task,\n    r_dataframe_name: str,\n    r_package_list: Sequence[str],\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/extract_dataframe_from_rdata_task.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    rdata_file_task: Task,\n    r_dataframe_name: str,\n    r_package_list: Sequence[str],\n):\n    source_meta = rdata_file_task.meta\n    if isinstance(source_meta, ReferenceFileMeta):\n        meta = ReferenceFileMeta(\n            group=source_meta.group,\n            sub_group=source_meta.sub_group,\n            sub_folder=PurePath(\"processed\"),\n            id=AssetId(asset_id),\n            extension=\".parquet\",\n            read_spec=DataFrameReadSpec(DataFrameParquetFormat()),\n        )\n    else:\n        raise ValueError(f\"Unknown meta: {source_meta}\")\n\n    return cls(\n        meta=meta,\n        rdata_file_task=rdata_file_task,\n        r_dataframe_name=r_dataframe_name,\n        r_package_list=r_package_list,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_dataframe_from_rdata_task/#mecfs_bio.build_system.task.extract_dataframe_from_rdata_task.ExtractDataFrameFromRDataTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/extract_dataframe_from_rdata_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    for package in self.r_package_list:\n        importr(package)\n    conv = ro.default_converter + pandas2ri.converter + numpy2ri.converter\n    rdata_asset = fetch(self.rdata_file_task.asset_id)\n    assert isinstance(rdata_asset, FileAsset)\n    pth = rdata_asset.path\n    load: Any = robjects.r[\"load\"]\n    load(str(pth))\n    r_dataframe = robjects.r[self.r_dataframe_name]\n    with localconverter(conv):\n        py_dataframe: pd.DataFrame = ro.conversion.get_conversion().rpy2py(\n            r_dataframe\n        )\n    out_path = scratch_dir / \"df.parquet\"\n    py_dataframe.to_parquet(out_path)\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_gzip_task/","title":"extract_gzip_task","text":""},{"location":"reference/mecfs_bio/build_system/task/extract_gzip_task/#mecfs_bio.build_system.task.extract_gzip_task","title":"mecfs_bio.build_system.task.extract_gzip_task","text":"<p>Task to extract a file from a gzip.</p> <p>Classes:</p> <ul> <li> <code>ExtractGzipTextFileTask</code>           \u2013            </li> </ul> <p>Functions:</p> <ul> <li> <code>apply_gzip</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/extract_gzip_task/#mecfs_bio.build_system.task.extract_gzip_task.ExtractGzipTextFileTask","title":"ExtractGzipTextFileTask","text":"<p>               Bases: <code>Task</code></p> <p>Methods:</p> <ul> <li> <code>create_for_gwas_file</code>             \u2013              </li> <li> <code>create_for_reference_file</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/extract_gzip_task/#mecfs_bio.build_system.task.extract_gzip_task.ExtractGzipTextFileTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_gzip_task/#mecfs_bio.build_system.task.extract_gzip_task.ExtractGzipTextFileTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_gzip_task/#mecfs_bio.build_system.task.extract_gzip_task.ExtractGzipTextFileTask.create_for_gwas_file","title":"create_for_gwas_file  <code>classmethod</code>","text":"<pre><code>create_for_gwas_file(\n    source_file_task: Task,\n    asset_id: str,\n    readspec: DataFrameReadSpec | None = None,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/extract_gzip_task.py</code> <pre><code>@classmethod\ndef create_for_gwas_file(\n    cls,\n    source_file_task: Task,\n    asset_id: str,\n    readspec: DataFrameReadSpec | None = None,\n):\n    src_meta = source_file_task.meta\n    assert isinstance(src_meta, GWASSummaryDataFileMeta)\n    if readspec is None:\n        readspec = src_meta.read_spec()\n    meta = GWASSummaryDataFileMeta(\n        id=AssetId(asset_id),\n        trait=src_meta.trait,\n        project=src_meta.project,\n        sub_dir=src_meta.sub_dir,\n        project_path=None,\n        read_spec=readspec,\n    )\n\n    return cls(\n        meta=meta,\n        source_file_task=source_file_task,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_gzip_task/#mecfs_bio.build_system.task.extract_gzip_task.ExtractGzipTextFileTask.create_for_reference_file","title":"create_for_reference_file  <code>classmethod</code>","text":"<pre><code>create_for_reference_file(\n    source_file_task: Task, asset_id: str\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/extract_gzip_task.py</code> <pre><code>@classmethod\ndef create_for_reference_file(cls, source_file_task: Task, asset_id: str):\n    src_meta = source_file_task.meta\n    assert isinstance(src_meta, ReferenceFileMeta)\n    meta = ReferenceFileMeta(\n        group=src_meta.group,\n        sub_group=src_meta.sub_group,\n        sub_folder=PurePath(\"extracted\"),\n        id=AssetId(asset_id),\n        filename=src_meta.filename,\n        extension=\"\",\n    )\n    return cls(\n        meta=meta,\n        source_file_task=source_file_task,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_gzip_task/#mecfs_bio.build_system.task.extract_gzip_task.ExtractGzipTextFileTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/extract_gzip_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    out_path = scratch_dir / \"extracted_file\"\n    src_asset = fetch(self._source_file_id)\n    src_path = read_file_asset_path(src_asset)\n    apply_gzip(src_path, out_path)\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_gzip_task/#mecfs_bio.build_system.task.extract_gzip_task.apply_gzip","title":"apply_gzip","text":"<pre><code>apply_gzip(src: Path, dst: Path)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/extract_gzip_task.py</code> <pre><code>def apply_gzip(src: Path, dst: Path):\n    with gzip.open(src, \"rb\") as f_in:\n        with open(dst, \"wb\") as f_out:\n            shutil.copyfileobj(f_in, f_out)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_sheet_from_excel_file_task/","title":"extract_sheet_from_excel_file_task","text":""},{"location":"reference/mecfs_bio/build_system/task/extract_sheet_from_excel_file_task/#mecfs_bio.build_system.task.extract_sheet_from_excel_file_task","title":"mecfs_bio.build_system.task.extract_sheet_from_excel_file_task","text":"<p>Task to extract sheet from excel file.</p> <p>Classes:</p> <ul> <li> <code>ExtractSheetFromExelFileTask</code>           \u2013            <p>Task for extracting a sheet from an excel file</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/extract_sheet_from_excel_file_task/#mecfs_bio.build_system.task.extract_sheet_from_excel_file_task.ExtractSheetFromExelFileTask","title":"ExtractSheetFromExelFileTask","text":"<p>               Bases: <code>Task</code></p> <p>Task for extracting a sheet from an excel file Useful for working with supplementary material to research papers, which is often in excel format</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>col_type_mapping</code>               (<code>Mapping[str, type] | None</code>)           \u2013            </li> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>excel_file_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>out_format</code>               (<code>OutFormat</code>)           \u2013            </li> <li> <code>post_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>sheet_name</code>               (<code>str</code>)           \u2013            </li> <li> <code>skiprows</code>               (<code>int | None</code>)           \u2013            </li> <li> <code>source_asset_id</code>               (<code>AssetId</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/extract_sheet_from_excel_file_task/#mecfs_bio.build_system.task.extract_sheet_from_excel_file_task.ExtractSheetFromExelFileTask.col_type_mapping","title":"col_type_mapping  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>col_type_mapping: Mapping[str, type] | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_sheet_from_excel_file_task/#mecfs_bio.build_system.task.extract_sheet_from_excel_file_task.ExtractSheetFromExelFileTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_sheet_from_excel_file_task/#mecfs_bio.build_system.task.extract_sheet_from_excel_file_task.ExtractSheetFromExelFileTask.excel_file_task","title":"excel_file_task  <code>instance-attribute</code>","text":"<pre><code>excel_file_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_sheet_from_excel_file_task/#mecfs_bio.build_system.task.extract_sheet_from_excel_file_task.ExtractSheetFromExelFileTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_sheet_from_excel_file_task/#mecfs_bio.build_system.task.extract_sheet_from_excel_file_task.ExtractSheetFromExelFileTask.out_format","title":"out_format  <code>instance-attribute</code>","text":"<pre><code>out_format: OutFormat\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_sheet_from_excel_file_task/#mecfs_bio.build_system.task.extract_sheet_from_excel_file_task.ExtractSheetFromExelFileTask.post_pipe","title":"post_pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>post_pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_sheet_from_excel_file_task/#mecfs_bio.build_system.task.extract_sheet_from_excel_file_task.ExtractSheetFromExelFileTask.sheet_name","title":"sheet_name  <code>instance-attribute</code>","text":"<pre><code>sheet_name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_sheet_from_excel_file_task/#mecfs_bio.build_system.task.extract_sheet_from_excel_file_task.ExtractSheetFromExelFileTask.skiprows","title":"skiprows  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>skiprows: int | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_sheet_from_excel_file_task/#mecfs_bio.build_system.task.extract_sheet_from_excel_file_task.ExtractSheetFromExelFileTask.source_asset_id","title":"source_asset_id  <code>property</code>","text":"<pre><code>source_asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_sheet_from_excel_file_task/#mecfs_bio.build_system.task.extract_sheet_from_excel_file_task.ExtractSheetFromExelFileTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    source_excel_file_task: Task,\n    sheet_name: str,\n    out_format: OutFormat,\n    skiprows: int | None = None,\n    col_type_mapping: Mapping[str, type] | None = None,\n    post_pipe: DataProcessingPipe = IdentityPipe(),\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/extract_sheet_from_excel_file_task.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    source_excel_file_task: Task,\n    sheet_name: str,\n    out_format: OutFormat,\n    skiprows: int | None = None,\n    col_type_mapping: Mapping[str, type] | None = None,\n    post_pipe: DataProcessingPipe = IdentityPipe(),\n):\n    extension, read_spec = get_extension_and_read_spec_from_format(\n        out_format=out_format\n    )\n    source_meta = source_excel_file_task.meta\n\n    if isinstance(source_meta, ReferenceFileMeta):\n        meta = ReferenceFileMeta(\n            group=source_meta.group,\n            sub_group=source_meta.sub_group,\n            sub_folder=PurePath(\"processed\"),\n            id=AssetId(asset_id),\n            filename=asset_id,\n            extension=extension,\n            read_spec=read_spec,\n        )\n    else:\n        raise ValueError(\"Unknown source meta\")\n\n    return cls(\n        meta=meta,\n        excel_file_task=source_excel_file_task,\n        sheet_name=sheet_name,\n        out_format=out_format,\n        skiprows=skiprows,\n        col_type_mapping=col_type_mapping,\n        post_pipe=post_pipe,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_sheet_from_excel_file_task/#mecfs_bio.build_system.task.extract_sheet_from_excel_file_task.ExtractSheetFromExelFileTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/extract_sheet_from_excel_file_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    excel_asset = fetch(self.source_asset_id)\n    assert isinstance(excel_asset, FileAsset)\n    out_path = scratch_dir / self.asset_id\n    df = pd.read_excel(\n        excel_asset.path, sheet_name=self.sheet_name, skiprows=self.skiprows\n    )\n    if self.col_type_mapping is not None:\n        for col in self.col_type_mapping.keys():\n            df[col] = df[col].astype(self.col_type_mapping[col])\n\n    df = self.post_pipe.process_pandas(df)\n    if isinstance(self.out_format, CSVOutFormat):\n        df.to_csv(out_path, index=False, sep=self.out_format.sep)\n    elif isinstance(self.out_format, ParquetOutFormat):\n        df.to_parquet(out_path)\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_tar_gzip_task/","title":"extract_tar_gzip_task","text":""},{"location":"reference/mecfs_bio/build_system/task/extract_tar_gzip_task/#mecfs_bio.build_system.task.extract_tar_gzip_task","title":"mecfs_bio.build_system.task.extract_tar_gzip_task","text":"<p>Classes:</p> <ul> <li> <code>ExtractTarGzipTask</code>           \u2013            <p>Task to extract the contents of a (possibly gzipped) tar file to a target directory</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>ReadMode</code>           \u2013            </li> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/extract_tar_gzip_task/#mecfs_bio.build_system.task.extract_tar_gzip_task.ReadMode","title":"ReadMode  <code>module-attribute</code>","text":"<pre><code>ReadMode = Literal['r', 'r:gz']\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_tar_gzip_task/#mecfs_bio.build_system.task.extract_tar_gzip_task.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_tar_gzip_task/#mecfs_bio.build_system.task.extract_tar_gzip_task.ExtractTarGzipTask","title":"ExtractTarGzipTask","text":"<p>               Bases: <code>Task</code></p> <p>Task to extract the contents of a (possibly gzipped) tar file to a target directory Set subdir_name to extract only the contents of one subfolder within the tar file</p> <p>read_mode: use r to only untar, and not ungzip.</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/extract_tar_gzip_task/#mecfs_bio.build_system.task.extract_tar_gzip_task.ExtractTarGzipTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_tar_gzip_task/#mecfs_bio.build_system.task.extract_tar_gzip_task.ExtractTarGzipTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_tar_gzip_task/#mecfs_bio.build_system.task.extract_tar_gzip_task.ExtractTarGzipTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    source_task: Task,\n    sub_folder: PurePath = PurePath(\"extracted\"),\n    sub_folder_name_inside_tar: str | None = None,\n    read_mode: ReadMode = \"r:gz\",\n) -&gt; ExtractTarGzipTask\n</code></pre> Source code in <code>mecfs_bio/build_system/task/extract_tar_gzip_task.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    source_task: Task,\n    sub_folder: PurePath = PurePath(\"extracted\"),\n    sub_folder_name_inside_tar: str | None = None,\n    read_mode: ReadMode = \"r:gz\",\n) -&gt; \"ExtractTarGzipTask\":\n    source_meta = source_task.meta\n    if isinstance(source_meta, ReferenceFileMeta):\n        return cls(\n            meta=ReferenceDataDirectoryMeta(\n                group=source_meta.group,\n                sub_group=source_meta.sub_group,\n                sub_folder=sub_folder,\n                id=AssetId(asset_id),\n            ),\n            source_file_task=source_task,\n            subdir_name=sub_folder_name_inside_tar,\n            read_mode=read_mode,\n        )\n    if isinstance(source_meta, GWASSummaryDataFileMeta):\n        return cls(\n            meta=ProcessedGwasDataDirectoryMeta(\n                id=AssetId(asset_id),\n                trait=source_meta.trait,\n                project=source_meta.project,\n                sub_dir=sub_folder,\n            ),\n            source_file_task=source_task,\n            subdir_name=sub_folder_name_inside_tar,\n            read_mode=read_mode,\n        )\n    raise NotImplementedError(f\"Handler for meta {source_meta} not implemented\")\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extract_tar_gzip_task/#mecfs_bio.build_system.task.extract_tar_gzip_task.ExtractTarGzipTask.execute","title":"execute","text":"<pre><code>execute(\n    scratch_dir: Path, fetch: Fetch, wf: WF\n) -&gt; DirectoryAsset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/extract_tar_gzip_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; DirectoryAsset:\n    source_asset = fetch(self._source_asset_id)\n    assert isinstance(source_asset, FileAsset)\n    src_path = source_asset.path\n\n    logger.debug(f\"Extracting from tar/gzip file : {self._source_asset_id}...\")\n    with tarfile.open(src_path, self._read_mode) as tar_object:\n        if self._subdir_name is None:\n            tar_object.extractall(scratch_dir)\n        else:\n            with tempfile.TemporaryDirectory() as tmpdir_name:\n                tmpdir_path = Path(tmpdir_name)\n                for member in tar_object.getmembers():\n                    if member.name.startswith(self._subdir_name):\n                        tar_object.extract(member=member, path=tmpdir_path)\n                (tmpdir_path / self._subdir_name).rename(scratch_dir)\n    logger.debug(\"Extraction complete.\")\n    return DirectoryAsset(scratch_dir)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extraction_one_file_from_zip_task/","title":"extraction_one_file_from_zip_task","text":""},{"location":"reference/mecfs_bio/build_system/task/extraction_one_file_from_zip_task/#mecfs_bio.build_system.task.extraction_one_file_from_zip_task","title":"mecfs_bio.build_system.task.extraction_one_file_from_zip_task","text":"<p>Classes:</p> <ul> <li> <code>ExtractFromZipTask</code>           \u2013            <p>Task to extract a single file from a zip archive</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>extract_single_file_from_zip</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/extraction_one_file_from_zip_task/#mecfs_bio.build_system.task.extraction_one_file_from_zip_task.ExtractFromZipTask","title":"ExtractFromZipTask","text":"<p>               Bases: <code>Task</code></p> <p>Task to extract a single file from a zip archive</p> <p>Methods:</p> <ul> <li> <code>create_from_zipped_executable</code>             \u2013              </li> <li> <code>create_from_zipped_gwas_data</code>             \u2013              </li> <li> <code>create_from_zipped_reference_file</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/extraction_one_file_from_zip_task/#mecfs_bio.build_system.task.extraction_one_file_from_zip_task.ExtractFromZipTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extraction_one_file_from_zip_task/#mecfs_bio.build_system.task.extraction_one_file_from_zip_task.ExtractFromZipTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extraction_one_file_from_zip_task/#mecfs_bio.build_system.task.extraction_one_file_from_zip_task.ExtractFromZipTask.create_from_zipped_executable","title":"create_from_zipped_executable  <code>classmethod</code>","text":"<pre><code>create_from_zipped_executable(\n    source_task: Task, asset_id: str, file_to_extract: str\n) -&gt; Task\n</code></pre> Source code in <code>mecfs_bio/build_system/task/extraction_one_file_from_zip_task.py</code> <pre><code>@classmethod\ndef create_from_zipped_executable(\n    cls, source_task: Task, asset_id: str, file_to_extract: str\n) -&gt; Task:\n    src_meta = source_task.meta\n    assert isinstance(src_meta, ExecutableMeta)\n    return MakeExecutableWrapperTask(\n        cls(\n            meta=ExecutableMeta.create(\n                group=src_meta.group,\n                sub_folder=PurePath(\"extracted\"),\n                asset_id=asset_id,\n                filename=src_meta.filename,\n                extension=None,\n            ),\n            source_file_task=source_task,\n            file_to_extract=file_to_extract,\n        )\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extraction_one_file_from_zip_task/#mecfs_bio.build_system.task.extraction_one_file_from_zip_task.ExtractFromZipTask.create_from_zipped_gwas_data","title":"create_from_zipped_gwas_data  <code>classmethod</code>","text":"<pre><code>create_from_zipped_gwas_data(\n    source_task: Task,\n    asset_id: str,\n    file_to_extract: str,\n    sub_dir: str,\n    read_spec: DataFrameReadSpec,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/extraction_one_file_from_zip_task.py</code> <pre><code>@classmethod\ndef create_from_zipped_gwas_data(\n    cls,\n    source_task: Task,\n    asset_id: str,\n    file_to_extract: str,\n    sub_dir: str,\n    read_spec: DataFrameReadSpec,\n):\n    src_meta = source_task.meta\n    assert isinstance(src_meta, GWASSummaryDataFileMeta)\n    return cls(\n        meta=GWASSummaryDataFileMeta(\n            id=AssetId(asset_id),\n            trait=src_meta.trait,\n            project=src_meta.project,\n            sub_dir=sub_dir,\n            read_spec=read_spec,\n            project_path=PurePath(file_to_extract),\n        ),\n        source_file_task=source_task,\n        file_to_extract=file_to_extract,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extraction_one_file_from_zip_task/#mecfs_bio.build_system.task.extraction_one_file_from_zip_task.ExtractFromZipTask.create_from_zipped_reference_file","title":"create_from_zipped_reference_file  <code>classmethod</code>","text":"<pre><code>create_from_zipped_reference_file(\n    source_task: Task,\n    asset_id: str,\n    file_to_extract: str,\n    extension: str,\n) -&gt; Task\n</code></pre> Source code in <code>mecfs_bio/build_system/task/extraction_one_file_from_zip_task.py</code> <pre><code>@classmethod\ndef create_from_zipped_reference_file(\n    cls, source_task: Task, asset_id: str, file_to_extract: str, extension: str\n) -&gt; Task:\n    src_meta = source_task.meta\n    assert isinstance(src_meta, ReferenceFileMeta)\n    return cls(\n        meta=ReferenceFileMeta(\n            group=src_meta.group,\n            sub_folder=PurePath(\"extracted\"),\n            id=AssetId(asset_id),\n            filename=file_to_extract,\n            sub_group=src_meta.sub_group,\n            extension=extension,\n        ),\n        source_file_task=source_task,\n        file_to_extract=file_to_extract,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extraction_one_file_from_zip_task/#mecfs_bio.build_system.task.extraction_one_file_from_zip_task.ExtractFromZipTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/extraction_one_file_from_zip_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    asset = fetch(self._source_file_task.asset_id)\n    assert isinstance(asset, FileAsset)\n    extract_single_file_from_zip(\n        zip_path=asset.path,\n        file_to_extract=self._file_to_extract,\n        destination_dir=scratch_dir,\n    )\n    result_path = scratch_dir / self._file_to_extract\n    return FileAsset(result_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/extraction_one_file_from_zip_task/#mecfs_bio.build_system.task.extraction_one_file_from_zip_task.extract_single_file_from_zip","title":"extract_single_file_from_zip","text":"<pre><code>extract_single_file_from_zip(\n    zip_path: Path,\n    file_to_extract: str,\n    destination_dir: Path,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/extraction_one_file_from_zip_task.py</code> <pre><code>def extract_single_file_from_zip(\n    zip_path: Path, file_to_extract: str, destination_dir: Path\n):\n    destination_dir.mkdir(parents=True, exist_ok=True)\n    with zipfile.ZipFile(zip_path, \"r\") as zip_ref:\n        if file_to_extract in zip_ref.namelist():\n            zip_ref.extract(file_to_extract, destination_dir)\n            print(f\"Successfully extracted '{file_to_extract}' to '{destination_dir}'\")\n        else:\n            raise ValueError(f\"File '{file_to_extract}' not found in '{zip_path}'\")\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/failing_task/","title":"failing_task","text":""},{"location":"reference/mecfs_bio/build_system/task/failing_task/#mecfs_bio.build_system.task.failing_task","title":"mecfs_bio.build_system.task.failing_task","text":"<p>A task that always fails, which can be used for testing.</p> <p>Classes:</p> <ul> <li> <code>FailingTask</code>           \u2013            <p>A task that always fails.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/failing_task/#mecfs_bio.build_system.task.failing_task.FailingTask","title":"FailingTask","text":"<p>               Bases: <code>Task</code></p> <p>A task that always fails. Intended to be used for testing.`</p> <p>Methods:</p> <ul> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/failing_task/#mecfs_bio.build_system.task.failing_task.FailingTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/failing_task/#mecfs_bio.build_system.task.failing_task.FailingTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/failing_task/#mecfs_bio.build_system.task.failing_task.FailingTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/failing_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    raise ValueError(\"Task intentionally failed.\")\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/fake_task/","title":"fake_task","text":""},{"location":"reference/mecfs_bio/build_system/task/fake_task/#mecfs_bio.build_system.task.fake_task","title":"mecfs_bio.build_system.task.fake_task","text":"<p>A Task that does nothing, which can be used for testing.</p> <p>Classes:</p> <ul> <li> <code>FakeTask</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/fake_task/#mecfs_bio.build_system.task.fake_task.FakeTask","title":"FakeTask","text":"<p>               Bases: <code>Task</code></p> <p>Methods:</p> <ul> <li> <code>create_with_filemeta</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/fake_task/#mecfs_bio.build_system.task.fake_task.FakeTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/fake_task/#mecfs_bio.build_system.task.fake_task.FakeTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/fake_task/#mecfs_bio.build_system.task.fake_task.FakeTask.create_with_filemeta","title":"create_with_filemeta  <code>classmethod</code>","text":"<pre><code>create_with_filemeta(asset_id: str)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/fake_task.py</code> <pre><code>@classmethod\ndef create_with_filemeta(cls, asset_id: str):\n    return cls(SimpleFileMeta(AssetId(asset_id)))\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/fake_task/#mecfs_bio.build_system.task.fake_task.FakeTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/fake_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    raise NotImplementedError()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/fetch_gget_info_task/","title":"fetch_gget_info_task","text":""},{"location":"reference/mecfs_bio/build_system/task/fetch_gget_info_task/#mecfs_bio.build_system.task.fetch_gget_info_task","title":"mecfs_bio.build_system.task.fetch_gget_info_task","text":"<p>Task to use gget to annotate gene lists with annotations from genetics databases.</p> <p>Classes:</p> <ul> <li> <code>FetchGGetInfoTask</code>           \u2013            <p>Task to use gget (https://github.com/pachterlab/gget) to retrieve database information about a list of genes from a dataframe</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>PRIMARY_GENE_NAME</code>           \u2013            </li> <li> <code>PROTEIN_NAMES_COL</code>           \u2013            </li> <li> <code>SUBCELLULAR_LOCALISATION_COL</code>           \u2013            </li> <li> <code>UNIPROT_DESCRIPTION</code>           \u2013            </li> <li> <code>UNIPROT_ID_COL</code>           \u2013            </li> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/fetch_gget_info_task/#mecfs_bio.build_system.task.fetch_gget_info_task.PRIMARY_GENE_NAME","title":"PRIMARY_GENE_NAME  <code>module-attribute</code>","text":"<pre><code>PRIMARY_GENE_NAME = 'primary_gene_name'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/fetch_gget_info_task/#mecfs_bio.build_system.task.fetch_gget_info_task.PROTEIN_NAMES_COL","title":"PROTEIN_NAMES_COL  <code>module-attribute</code>","text":"<pre><code>PROTEIN_NAMES_COL = 'protein_names'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/fetch_gget_info_task/#mecfs_bio.build_system.task.fetch_gget_info_task.SUBCELLULAR_LOCALISATION_COL","title":"SUBCELLULAR_LOCALISATION_COL  <code>module-attribute</code>","text":"<pre><code>SUBCELLULAR_LOCALISATION_COL = 'subcellular_localisation'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/fetch_gget_info_task/#mecfs_bio.build_system.task.fetch_gget_info_task.UNIPROT_DESCRIPTION","title":"UNIPROT_DESCRIPTION  <code>module-attribute</code>","text":"<pre><code>UNIPROT_DESCRIPTION = 'uniprot_description'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/fetch_gget_info_task/#mecfs_bio.build_system.task.fetch_gget_info_task.UNIPROT_ID_COL","title":"UNIPROT_ID_COL  <code>module-attribute</code>","text":"<pre><code>UNIPROT_ID_COL = 'uniprot_id'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/fetch_gget_info_task/#mecfs_bio.build_system.task.fetch_gget_info_task.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = getLogger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/fetch_gget_info_task/#mecfs_bio.build_system.task.fetch_gget_info_task.FetchGGetInfoTask","title":"FetchGGetInfoTask","text":"<p>               Bases: <code>Task</code></p> <p>Task to use gget (https://github.com/pachterlab/gget) to retrieve database information about a list of genes from a dataframe Useful for analyzing GWAS results.</p> <p>Listen to an interview with the primary developer of gget here: https://podcasts.apple.com/nz/podcast/99-laura-luebbert-gget-hunting-viruses-and/id1534473511?i=1000664104787</p> <p>Sometimes gget returns dataframes with inconsistent formatting. e.g.: some columns are partly lists, and partly singleton values. Thus this file also contains functionality to munge the output of gget into a more consistent format.</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>ensembl_id_col</code>               (<code>str</code>)           \u2013            </li> <li> <code>genes_to_use</code>               (<code>int | None</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>out_format</code>               (<code>OutFormat</code>)           \u2013            </li> <li> <code>post_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>source_df_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>source_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>source_meta</code>               (<code>Meta</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/fetch_gget_info_task/#mecfs_bio.build_system.task.fetch_gget_info_task.FetchGGetInfoTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/fetch_gget_info_task/#mecfs_bio.build_system.task.fetch_gget_info_task.FetchGGetInfoTask.ensembl_id_col","title":"ensembl_id_col  <code>instance-attribute</code>","text":"<pre><code>ensembl_id_col: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/fetch_gget_info_task/#mecfs_bio.build_system.task.fetch_gget_info_task.FetchGGetInfoTask.genes_to_use","title":"genes_to_use  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>genes_to_use: int | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/fetch_gget_info_task/#mecfs_bio.build_system.task.fetch_gget_info_task.FetchGGetInfoTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/fetch_gget_info_task/#mecfs_bio.build_system.task.fetch_gget_info_task.FetchGGetInfoTask.out_format","title":"out_format  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>out_format: OutFormat = CSVOutFormat(',')\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/fetch_gget_info_task/#mecfs_bio.build_system.task.fetch_gget_info_task.FetchGGetInfoTask.post_pipe","title":"post_pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>post_pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/fetch_gget_info_task/#mecfs_bio.build_system.task.fetch_gget_info_task.FetchGGetInfoTask.source_df_task","title":"source_df_task  <code>instance-attribute</code>","text":"<pre><code>source_df_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/fetch_gget_info_task/#mecfs_bio.build_system.task.fetch_gget_info_task.FetchGGetInfoTask.source_id","title":"source_id  <code>property</code>","text":"<pre><code>source_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/fetch_gget_info_task/#mecfs_bio.build_system.task.fetch_gget_info_task.FetchGGetInfoTask.source_meta","title":"source_meta  <code>property</code>","text":"<pre><code>source_meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/fetch_gget_info_task/#mecfs_bio.build_system.task.fetch_gget_info_task.FetchGGetInfoTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    source_df_task: Task,\n    ensembl_id_col: str,\n    genes_to_use: int | None = None,\n    post_pipe: DataProcessingPipe = IdentityPipe(),\n    out_format: OutFormat = CSVOutFormat(\",\"),\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/fetch_gget_info_task.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    source_df_task: Task,\n    ensembl_id_col: str,\n    genes_to_use: int | None = None,\n    post_pipe: DataProcessingPipe = IdentityPipe(),\n    out_format: OutFormat = CSVOutFormat(\",\"),\n):\n    source_meta = source_df_task.meta\n    meta: Meta\n    extension, read_spec = get_extension_and_read_spec_from_format(out_format)\n    if isinstance(source_meta, ResultTableMeta):\n        meta = ResultTableMeta(\n            id=asset_id,\n            trait=source_meta.trait,\n            project=source_meta.project,\n            extension=extension,\n            read_spec=read_spec,\n        )\n    elif isinstance(source_meta, ReferenceFileMeta):\n        meta = ReferenceFileMeta(\n            id=AssetId(asset_id),\n            group=source_meta.group,\n            sub_group=source_meta.sub_group,\n            extension=extension,\n            read_spec=read_spec,\n            sub_folder=source_meta.sub_folder,\n        )\n    else:\n        raise ValueError(\"unknown source meta type\")\n\n    return cls(\n        source_df_task=source_df_task,\n        ensembl_id_col=ensembl_id_col,\n        meta=meta,\n        genes_to_use=genes_to_use,\n        post_pipe=post_pipe,\n        out_format=out_format,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/fetch_gget_info_task/#mecfs_bio.build_system.task.fetch_gget_info_task.FetchGGetInfoTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/fetch_gget_info_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    source_asset = fetch(self.source_id)\n    df = (\n        scan_dataframe_asset(source_asset, meta=self.source_meta)\n        .collect()\n        .to_pandas()\n    )\n    genes = [item for item in df[self.ensembl_id_col].tolist() if item is not None]\n    if self.genes_to_use is not None:\n        genes = genes[: self.genes_to_use]\n    logger.debug(f\"Using gget to retrieve info on {len(genes)} genes\")\n    logger.debug(f\"Genes are: {genes}\")\n    gget_result = gget.info(genes)\n    if isinstance(gget_result, pd.DataFrame):\n        gene_info = gget_result\n    else:\n        gene_info = _dummy_gget_result\n    result_df = pd.merge(\n        df, gene_info, left_on=self.ensembl_id_col, right_index=True, how=\"left\"\n    )\n    out_path = scratch_dir / f\"{self.source_id}.csv\"\n    result_df = (\n        self.post_pipe.process(narwhals.from_native(result_df).lazy())\n        .collect()\n        .to_pandas()\n    )\n    result_df = _preprocess_columns(result_df)\n    if isinstance(self.out_format, CSVOutFormat):\n        result_df.to_csv(out_path, index=False, sep=self.out_format.sep)\n    elif isinstance(self.out_format, ParquetOutFormat):\n        result_df.to_parquet(\n            out_path,\n        )\n    else:\n        raise ValueError(f\"Unsupported output format: {self.out_format}\")\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/filter_snps_task/","title":"filter_snps_task","text":""},{"location":"reference/mecfs_bio/build_system/task/filter_snps_task/#mecfs_bio.build_system.task.filter_snps_task","title":"mecfs_bio.build_system.task.filter_snps_task","text":"<p>Task to filter SNPs in a GWAS according to another table of SNPs passing quality control. Implemented as a DataFrame join.</p> <p>Classes:</p> <ul> <li> <code>FilterSNPsTask</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/filter_snps_task/#mecfs_bio.build_system.task.filter_snps_task.FilterSNPsTask","title":"FilterSNPsTask","text":"<p>               Bases: <code>Task</code></p> <p>Methods:</p> <ul> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/filter_snps_task/#mecfs_bio.build_system.task.filter_snps_task.FilterSNPsTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/filter_snps_task/#mecfs_bio.build_system.task.filter_snps_task.FilterSNPsTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/filter_snps_task/#mecfs_bio.build_system.task.filter_snps_task.FilterSNPsTask.execute","title":"execute","text":"<pre><code>execute(\n    scratch_dir: Path, fetch: Fetch, wf: WF\n) -&gt; FileAsset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/filter_snps_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; FileAsset:\n    df_1 = scan_dataframe_asset(\n        asset=fetch(self._raw_gwas_task.asset_id), meta=self._raw_gwas_task.meta\n    )\n    df_2 = scan_dataframe_asset(\n        asset=fetch(self._snp_list_task.asset_id), meta=self._snp_list_task.meta\n    )\n    result = df_1.join(\n        df_2, left_on=self._col_in_raw_data, right_on=self._col_in_filter_data\n    )\n    target_path = scratch_dir / \"tmp.parqet\"\n    result.sink_parquet(target_path)\n    return FileAsset(target_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gene_tissue_expression_clustermap_task/","title":"gene_tissue_expression_clustermap_task","text":""},{"location":"reference/mecfs_bio/build_system/task/gene_tissue_expression_clustermap_task/#mecfs_bio.build_system.task.gene_tissue_expression_clustermap_task","title":"mecfs_bio.build_system.task.gene_tissue_expression_clustermap_task","text":"<p>Task to make a heatmap plot with genes as rows and tissue/cell types as columns</p> <p>Classes:</p> <ul> <li> <code>ExpressionMatrixClusterMapTaskV2</code>           \u2013            <p>Task to make a heatmap plot with genes as rows and tissue/cell types as columns</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gene_tissue_expression_clustermap_task/#mecfs_bio.build_system.task.gene_tissue_expression_clustermap_task.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gene_tissue_expression_clustermap_task/#mecfs_bio.build_system.task.gene_tissue_expression_clustermap_task.ExpressionMatrixClusterMapTaskV2","title":"ExpressionMatrixClusterMapTaskV2","text":"<p>               Bases: <code>Task</code></p> <p>Task to make a heatmap plot with genes as rows and tissue/cell types as columns Goal is to show the specificity of genes for tissue/cell types</p> <p>Methods:</p> <ul> <li> <code>create_standard_gene_magma_heatmap</code>             \u2013              <p>Make a heatmap in which genes are selected according to their MAGMA significance.</p> </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>gene_info_sources</code>               (<code>Sequence[GeneInfoSource]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>plot_spec</code>               (<code>XRHeatmapPlotSpec</code>)           \u2013            </li> <li> <code>specificity_matrix_source</code>               (<code>SpecificityMatrixSource</code>)           \u2013            </li> <li> <code>tissue_info_sources</code>               (<code>Sequence[TissueInfoSource]</code>)           \u2013            </li> <li> <code>xr_pipe</code>               (<code>XRDataPipe</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gene_tissue_expression_clustermap_task/#mecfs_bio.build_system.task.gene_tissue_expression_clustermap_task.ExpressionMatrixClusterMapTaskV2.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gene_tissue_expression_clustermap_task/#mecfs_bio.build_system.task.gene_tissue_expression_clustermap_task.ExpressionMatrixClusterMapTaskV2.gene_info_sources","title":"gene_info_sources  <code>instance-attribute</code>","text":"<pre><code>gene_info_sources: Sequence[GeneInfoSource]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gene_tissue_expression_clustermap_task/#mecfs_bio.build_system.task.gene_tissue_expression_clustermap_task.ExpressionMatrixClusterMapTaskV2.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gene_tissue_expression_clustermap_task/#mecfs_bio.build_system.task.gene_tissue_expression_clustermap_task.ExpressionMatrixClusterMapTaskV2.plot_spec","title":"plot_spec  <code>instance-attribute</code>","text":"<pre><code>plot_spec: XRHeatmapPlotSpec\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gene_tissue_expression_clustermap_task/#mecfs_bio.build_system.task.gene_tissue_expression_clustermap_task.ExpressionMatrixClusterMapTaskV2.specificity_matrix_source","title":"specificity_matrix_source  <code>instance-attribute</code>","text":"<pre><code>specificity_matrix_source: SpecificityMatrixSource\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gene_tissue_expression_clustermap_task/#mecfs_bio.build_system.task.gene_tissue_expression_clustermap_task.ExpressionMatrixClusterMapTaskV2.tissue_info_sources","title":"tissue_info_sources  <code>instance-attribute</code>","text":"<pre><code>tissue_info_sources: Sequence[TissueInfoSource]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gene_tissue_expression_clustermap_task/#mecfs_bio.build_system.task.gene_tissue_expression_clustermap_task.ExpressionMatrixClusterMapTaskV2.xr_pipe","title":"xr_pipe  <code>instance-attribute</code>","text":"<pre><code>xr_pipe: XRDataPipe\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gene_tissue_expression_clustermap_task/#mecfs_bio.build_system.task.gene_tissue_expression_clustermap_task.ExpressionMatrixClusterMapTaskV2.create_standard_gene_magma_heatmap","title":"create_standard_gene_magma_heatmap  <code>classmethod</code>","text":"<pre><code>create_standard_gene_magma_heatmap(\n    asset_id: str,\n    extracted_magma_gene_results_source: GeneInfoSource,\n    gene_specificity_matrix_source: SpecificityMatrixSource,\n    gene_thesaurus_source: GeneInfoSource,\n    num_genes_to_keep: int = 300,\n)\n</code></pre> <p>Make a heatmap in which genes are selected according to their MAGMA significance. Useful for delving deeper into MAGMA results .</p> Source code in <code>mecfs_bio/build_system/task/gene_tissue_expression_clustermap_task.py</code> <pre><code>@classmethod\ndef create_standard_gene_magma_heatmap(\n    cls,\n    asset_id: str,\n    extracted_magma_gene_results_source: GeneInfoSource,\n    gene_specificity_matrix_source: SpecificityMatrixSource,\n    gene_thesaurus_source: GeneInfoSource,\n    num_genes_to_keep: int = 300,\n):\n    \"\"\"\n    Make a heatmap in which genes are selected according to their MAGMA significance.\n    Useful for delving deeper into MAGMA results .\n    \"\"\"\n    source_meta = extracted_magma_gene_results_source.task.meta\n    assert isinstance(source_meta, ResultTableMeta)\n    meta = GWASPlotDirectoryMeta(\n        id=AssetId(asset_id),\n        trait=source_meta.trait,\n        project=source_meta.project,\n    )\n    seaborn_palette = sns.color_palette(\"vlag\", n_colors=100)\n    plotly_colorscale = [\n        f\"rgb({int(c[0] * 255)}, {int(c[1] * 255)}, {int(c[2] * 255)})\"\n        for c in seaborn_palette\n    ]\n    return cls(\n        meta=meta,\n        specificity_matrix_source=gene_specificity_matrix_source,\n        gene_info_sources=[\n            extracted_magma_gene_results_source,\n            gene_thesaurus_source,\n        ],\n        tissue_info_sources=[],\n        xr_pipe=XRCompositePipe(\n            [\n                XRCluster(\n                    array_name=XR_SPECIFICITY_MATRIX,\n                    dim=XR_TISSUE_DIMENSION,\n                ),\n                XRSignificanceFilter(\n                    p_threshold=0.01,\n                    p_da=MAGMA_P_COLUMN,\n                    z_da=MAGMA_Z_COLUMN,\n                ),\n                XRMostSignificant(\n                    ordering_da=MAGMA_P_COLUMN,\n                    num_to_keep=num_genes_to_keep,\n                ),\n                XRCluster(\n                    array_name=XR_SPECIFICITY_MATRIX,\n                    dim=XR_GENE_DIMENSION,\n                ),\n            ]\n        ),\n        plot_spec=XRHeatmapPlotSpec(\n            GeneNormalizedPlotMode(max_multiple=5),\n            y_array=\"Gene name\",\n            color_scale=plotly_colorscale,\n        ),\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gene_tissue_expression_clustermap_task/#mecfs_bio.build_system.task.gene_tissue_expression_clustermap_task.ExpressionMatrixClusterMapTaskV2.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gene_tissue_expression_clustermap_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    ds = load_xr_gene_tissue_dataset(\n        gt_specificity_matrix_source=self.specificity_matrix_source,\n        gene_info_sources=self.gene_info_sources,\n        tissue_info_sources=self.tissue_info_sources,\n        fetch=fetch,\n    )\n    ds = self.xr_pipe.process(ds)\n    fig = xr_make_gene_spec_heatmap(\n        ds=ds,\n        plot_spec=self.plot_spec,\n    )\n    write_plots_to_dir(scratch_dir, {\"gene_tissue_heatmap\": fig})\n    return DirectoryAsset(scratch_dir)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/","title":"genetic_correlation_clustermap_task","text":""},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task","title":"mecfs_bio.build_system.task.genetic_correlation_clustermap_task","text":"<p>Task to create a heatmap plot illustrating the genetic correlation structure of a collection of traits</p> <p>Based on fig 2 from</p> <p>Bulik-Sullivan, Brendan, et al. \"An atlas of genetic correlations across human diseases and traits.\" Nature genetics 47.11 (2015): 1236-1241.</p> <p>Classes:</p> <ul> <li> <code>BonferoniSig</code>           \u2013            </li> <li> <code>GeneticCorrSource</code>           \u2013            <p>Describe a dataframe from which to load genetic correlation data</p> </li> <li> <code>GeneticCorrelationClustermapTask</code>           \u2013            <p>Task to generate a heatmap of genetic correlation</p> </li> <li> <code>RGHideNonSig</code>           \u2013            </li> <li> <code>RGWithAsterisk</code>           \u2013            </li> </ul> <p>Functions:</p> <ul> <li> <code>fill_out_corr_df</code>             \u2013              <p>Full out the upper triangle and diagonal of the correlation matrix</p> </li> <li> <code>get_sig</code>             \u2013              <p>Get a binary array indicating which elements of the correlation matrix are significance</p> </li> <li> <code>load_xr_corr_dataset</code>             \u2013              <p>Retrieve the correlation data.  Return in the form of an xarray dataset.</p> </li> <li> <code>rg_plot</code>             \u2013              <p>Produce a plotly heatmap figure showing genetic correlation</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>GeneticCorrPlotMode</code>           \u2013            </li> <li> <code>NUM_PAIRS</code>           \u2013            </li> <li> <code>SigMode</code>           \u2013            </li> <li> <code>XR_GENETIC_CORR_ARRAY</code>           \u2013            </li> <li> <code>XR_GENETIC_CORR_P_VALUE_ARRAY</code>           \u2013            </li> <li> <code>XR_TRAIT_1_DIM</code>           \u2013            </li> <li> <code>XR_TRAIT_2_DIM</code>           \u2013            </li> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.GeneticCorrPlotMode","title":"GeneticCorrPlotMode  <code>module-attribute</code>","text":"<pre><code>GeneticCorrPlotMode = RGWithAsterisk | RGHideNonSig\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.NUM_PAIRS","title":"NUM_PAIRS  <code>module-attribute</code>","text":"<pre><code>NUM_PAIRS = 'num_pairs'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.SigMode","title":"SigMode  <code>module-attribute</code>","text":"<pre><code>SigMode = BonferoniSig\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.XR_GENETIC_CORR_ARRAY","title":"XR_GENETIC_CORR_ARRAY  <code>module-attribute</code>","text":"<pre><code>XR_GENETIC_CORR_ARRAY = 'genetic_correlation'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.XR_GENETIC_CORR_P_VALUE_ARRAY","title":"XR_GENETIC_CORR_P_VALUE_ARRAY  <code>module-attribute</code>","text":"<pre><code>XR_GENETIC_CORR_P_VALUE_ARRAY = (\n    \"genetic_correlation_p_value\"\n)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.XR_TRAIT_1_DIM","title":"XR_TRAIT_1_DIM  <code>module-attribute</code>","text":"<pre><code>XR_TRAIT_1_DIM = 'trait_1'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.XR_TRAIT_2_DIM","title":"XR_TRAIT_2_DIM  <code>module-attribute</code>","text":"<pre><code>XR_TRAIT_2_DIM = 'trait_2'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.BonferoniSig","title":"BonferoniSig","text":"<p>Attributes:</p> <ul> <li> <code>alpha</code>               (<code>float</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.BonferoniSig.alpha","title":"alpha  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>alpha: float = 0.05\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.GeneticCorrSource","title":"GeneticCorrSource","text":"<p>Describe a dataframe from which to load genetic correlation data</p> <p>Attributes:</p> <ul> <li> <code>df_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>p_col</code>               (<code>str</code>)           \u2013            </li> <li> <code>rg_col</code>               (<code>str</code>)           \u2013            </li> <li> <code>task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>trait_1_col</code>               (<code>str</code>)           \u2013            </li> <li> <code>trait_2_col</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.GeneticCorrSource.df_pipe","title":"df_pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>df_pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.GeneticCorrSource.p_col","title":"p_col  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>p_col: str = 'p'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.GeneticCorrSource.rg_col","title":"rg_col  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>rg_col: str = 'rg'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.GeneticCorrSource.task","title":"task  <code>instance-attribute</code>","text":"<pre><code>task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.GeneticCorrSource.trait_1_col","title":"trait_1_col  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>trait_1_col: str = 'p1'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.GeneticCorrSource.trait_2_col","title":"trait_2_col  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>trait_2_col: str = 'p2'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.GeneticCorrelationClustermapTask","title":"GeneticCorrelationClustermapTask","text":"<p>               Bases: <code>Task</code></p> <p>Task to generate a heatmap of genetic correlation</p> <p>Methods:</p> <ul> <li> <code>create_std_with_clustering</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>genetic_corr_source</code>               (<code>GeneticCorrSource</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>plot_options</code>               (<code>GeneticCorrPlotMode</code>)           \u2013            </li> <li> <code>save_mode</code>               (<code>bool | str</code>)           \u2013            </li> <li> <code>xr_pipe</code>               (<code>XRDataPipe</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.GeneticCorrelationClustermapTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.GeneticCorrelationClustermapTask.genetic_corr_source","title":"genetic_corr_source  <code>instance-attribute</code>","text":"<pre><code>genetic_corr_source: GeneticCorrSource\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.GeneticCorrelationClustermapTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.GeneticCorrelationClustermapTask.plot_options","title":"plot_options  <code>instance-attribute</code>","text":"<pre><code>plot_options: GeneticCorrPlotMode\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.GeneticCorrelationClustermapTask.save_mode","title":"save_mode  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>save_mode: bool | str = 'cdn'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.GeneticCorrelationClustermapTask.xr_pipe","title":"xr_pipe  <code>instance-attribute</code>","text":"<pre><code>xr_pipe: XRDataPipe\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.GeneticCorrelationClustermapTask.create_std_with_clustering","title":"create_std_with_clustering  <code>classmethod</code>","text":"<pre><code>create_std_with_clustering(\n    asset_id: str,\n    genetic_corr_source: GeneticCorrSource,\n    plot_options: GeneticCorrPlotMode,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/genetic_correlation_clustermap_task.py</code> <pre><code>@classmethod\ndef create_std_with_clustering(\n    cls,\n    asset_id: str,\n    genetic_corr_source: GeneticCorrSource,\n    plot_options: GeneticCorrPlotMode,\n):\n    src_meta = genetic_corr_source.task.meta\n    assert isinstance(src_meta, ResultTableMeta)\n    meta = GWASPlotFileMeta(\n        trait=src_meta.trait,\n        project=src_meta.project,\n        extension=\".html\",\n        id=AssetId(asset_id),\n    )\n    xr_pipe = XRCompositePipe(\n        [\n            XRCluster(\n                array_name=XR_GENETIC_CORR_ARRAY,\n                dim=XR_TRAIT_1_DIM,\n                metric=\"euclidean\",\n            ),\n            XRCluster(\n                array_name=XR_GENETIC_CORR_ARRAY,\n                dim=XR_TRAIT_2_DIM,\n                metric=\"euclidean\",\n            ),\n        ]\n    )\n    return cls(\n        meta=meta,\n        xr_pipe=xr_pipe,\n        genetic_corr_source=genetic_corr_source,\n        plot_options=plot_options,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.GeneticCorrelationClustermapTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/genetic_correlation_clustermap_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    ds = load_xr_corr_dataset(\n        src=self.genetic_corr_source,\n        fetch=fetch,\n    )\n    ds = self.xr_pipe.process(ds)\n    fig = rg_plot(\n        ds=ds,\n        plot_mode=self.plot_options,\n    )\n    out_path = scratch_dir / \"result.html\"\n    fig.write_html(out_path, include_plotlyjs=self.save_mode)\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.RGHideNonSig","title":"RGHideNonSig","text":""},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.RGWithAsterisk","title":"RGWithAsterisk","text":"<p>Attributes:</p> <ul> <li> <code>color_scale</code>               (<code>str</code>)           \u2013            </li> <li> <code>sig_mode</code>               (<code>SigMode</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.RGWithAsterisk.color_scale","title":"color_scale  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>color_scale: str = 'RdBu_r'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.RGWithAsterisk.sig_mode","title":"sig_mode  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>sig_mode: SigMode = BonferoniSig()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.fill_out_corr_df","title":"fill_out_corr_df","text":"<pre><code>fill_out_corr_df(\n    df_nw: DataFrame, src: GeneticCorrSource\n) -&gt; narwhals.DataFrame\n</code></pre> <p>Full out the upper triangle and diagonal of the correlation matrix</p> Source code in <code>mecfs_bio/build_system/task/genetic_correlation_clustermap_task.py</code> <pre><code>def fill_out_corr_df(\n    df_nw: narwhals.DataFrame,\n    src: GeneticCorrSource,\n) -&gt; narwhals.DataFrame:\n    \"\"\"\n    Full out the upper triangle and diagonal of the correlation matrix\n    \"\"\"\n    df_2_nw = df_nw.with_columns(\n        narwhals.col(src.trait_1_col).alias(src.trait_2_col),\n        narwhals.col(src.trait_2_col).alias(\n            src.trait_1_col\n        ),  # fill out upper triangle of correlation matrix\n    )\n    df_nw = narwhals.concat([df_nw, df_2_nw], how=\"vertical\").unique(keep=\"first\")\n    df_diag = (\n        df_nw.select(src.trait_1_col)\n        .unique()\n        .with_columns(\n            narwhals.col(src.trait_1_col).alias(src.trait_2_col),\n            narwhals.lit(1.0).alias(src.rg_col),\n            narwhals.lit(float(\"nan\")).alias(src.p_col),\n        )\n    )  # fill out diagonal of correlation matrix\n    df_nw = narwhals.concat([df_nw, df_diag], how=\"vertical\").unique()\n    return df_nw\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.get_sig","title":"get_sig","text":"<pre><code>get_sig(\n    p_value_matrix: ndarray,\n    num_pairs: int,\n    sig_mode: SigMode,\n) -&gt; np.ndarray\n</code></pre> <p>Get a binary array indicating which elements of the correlation matrix are significance</p> Source code in <code>mecfs_bio/build_system/task/genetic_correlation_clustermap_task.py</code> <pre><code>def get_sig(\n    p_value_matrix: np.ndarray,\n    num_pairs: int,\n    sig_mode: SigMode,\n) -&gt; np.ndarray:\n    \"\"\"\n    Get a binary array indicating which elements of the correlation matrix are significance\n    \"\"\"\n    if isinstance(sig_mode, BonferoniSig):\n        thresh = sig_mode.alpha / num_pairs\n        logger.debug(\n            f\"Bonferoni significance threshold when alpha={sig_mode.alpha} and there are {num_pairs} tests is {thresh}\"\n        )\n        return p_value_matrix &lt;= thresh\n    raise ValueError(f\"Invalid mode {sig_mode}\")\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.load_xr_corr_dataset","title":"load_xr_corr_dataset","text":"<pre><code>load_xr_corr_dataset(\n    src: GeneticCorrSource, fetch: Fetch\n) -&gt; xr.Dataset\n</code></pre> <p>Retrieve the correlation data.  Return in the form of an xarray dataset.</p> Source code in <code>mecfs_bio/build_system/task/genetic_correlation_clustermap_task.py</code> <pre><code>def load_xr_corr_dataset(\n    src: GeneticCorrSource,\n    fetch: Fetch,\n) -&gt; xr.Dataset:\n    \"\"\"\n    Retrieve the correlation data.  Return in the form of an xarray dataset.\n    \"\"\"\n    asset = fetch(src.task.asset_id)\n    df_nw = (\n        src.df_pipe.process(\n            scan_dataframe_asset(\n                asset,\n                meta=src.task.meta,\n            )\n        )\n        .select(\n            src.trait_1_col,\n            src.trait_2_col,\n            src.rg_col,\n            src.p_col,\n        )\n        .collect()\n    )\n    df_nw_stacked = fill_out_corr_df(df_nw, src)\n    num_pairs = _count_unique_pairs(df_nw_stacked, src.trait_1_col, src.trait_2_col)\n    df = df_nw_stacked.to_pandas()\n\n    pivoted_rg = df.pivot(\n        index=src.trait_1_col,\n        columns=src.trait_2_col,\n        values=src.rg_col,\n    )\n    pivoted_p = df.pivot(\n        index=src.trait_1_col,\n        columns=src.trait_2_col,\n        values=src.p_col,\n    )\n    rg_da = xr.DataArray(pivoted_rg, dims=(XR_TRAIT_1_DIM, XR_TRAIT_2_DIM))\n    p_da = xr.DataArray(pivoted_p, dims=(XR_TRAIT_1_DIM, XR_TRAIT_2_DIM))\n    ds = xr.Dataset({XR_GENETIC_CORR_ARRAY: rg_da, XR_GENETIC_CORR_P_VALUE_ARRAY: p_da})\n    ds[NUM_PAIRS] = num_pairs\n    return ds\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/genetic_correlation_clustermap_task/#mecfs_bio.build_system.task.genetic_correlation_clustermap_task.rg_plot","title":"rg_plot","text":"<pre><code>rg_plot(\n    ds: Dataset, plot_mode: GeneticCorrPlotMode\n) -&gt; Figure\n</code></pre> <p>Produce a plotly heatmap figure showing genetic correlation</p> Source code in <code>mecfs_bio/build_system/task/genetic_correlation_clustermap_task.py</code> <pre><code>def rg_plot(ds: xr.Dataset, plot_mode: GeneticCorrPlotMode) -&gt; Figure:\n    \"\"\"\n    Produce a plotly heatmap figure showing genetic correlation\n    \"\"\"\n    if isinstance(plot_mode, RGWithAsterisk):\n        corr_df = ds[XR_GENETIC_CORR_ARRAY].to_pandas()\n        sig = get_sig(\n            p_value_matrix=ds[XR_GENETIC_CORR_P_VALUE_ARRAY].values,\n            num_pairs=ds[NUM_PAIRS].values.item(),\n            sig_mode=plot_mode.sig_mode,\n        )\n        asterisk_matrix = np.where(sig, \"\u2605\", \"\")\n\n        fig = go.Figure(\n            data=go.Heatmap(\n                z=corr_df,\n                x=corr_df.columns,\n                y=corr_df.index,\n                text=asterisk_matrix,\n                texttemplate=\"%{text}\",\n                textfont={\"size\": 20, \"color\": \"black\"},\n                colorscale=plot_mode.color_scale,\n                zmin=-1,\n                zmax=1,\n                customdata=ds[XR_GENETIC_CORR_P_VALUE_ARRAY].values.tolist(),\n                hovertemplate=\"Trait 1: %{y}&lt;br&gt;\"\n                + \"Trait 2: %{x}&lt;br&gt;\"\n                + \"Genetic Correlation: %{z}&lt;br&gt;\"\n                + \"p value: %{customdata}&lt;br&gt;\"\n                + \"&lt;extra&gt;&lt;/extra&gt;\",\n                showscale=True,\n                hovertemplatefallback=\"None\",\n            )\n        )\n        fig.update_layout(\n            xaxis=dict(side=\"top\"),\n        )\n        fig.update_yaxes(autorange=\"reversed\")  # want the origin in top left corner\n        return fig\n    raise NotImplementedError()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/get_file_from_synapse_task/","title":"get_file_from_synapse_task","text":""},{"location":"reference/mecfs_bio/build_system/task/get_file_from_synapse_task/#mecfs_bio.build_system.task.get_file_from_synapse_task","title":"mecfs_bio.build_system.task.get_file_from_synapse_task","text":"<p>Task to get a file from synapse.org, a scientific data repository.</p> <p>Classes:</p> <ul> <li> <code>GetFileFromSynapseTask</code>           \u2013            <p>Task to get a file from synapse.org (see: https://docs.synapse.org/synapse-docs/faq)</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/get_file_from_synapse_task/#mecfs_bio.build_system.task.get_file_from_synapse_task.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = getLogger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/get_file_from_synapse_task/#mecfs_bio.build_system.task.get_file_from_synapse_task.GetFileFromSynapseTask","title":"GetFileFromSynapseTask","text":"<p>               Bases: <code>Task</code></p> <p>Task to get a file from synapse.org (see: https://docs.synapse.org/synapse-docs/faq) May require authentication.  See Getting Started.</p> <p>Methods:</p> <ul> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>expected_filename</code>               (<code>str</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>synid</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/get_file_from_synapse_task/#mecfs_bio.build_system.task.get_file_from_synapse_task.GetFileFromSynapseTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/get_file_from_synapse_task/#mecfs_bio.build_system.task.get_file_from_synapse_task.GetFileFromSynapseTask.expected_filename","title":"expected_filename  <code>instance-attribute</code>","text":"<pre><code>expected_filename: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/get_file_from_synapse_task/#mecfs_bio.build_system.task.get_file_from_synapse_task.GetFileFromSynapseTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/get_file_from_synapse_task/#mecfs_bio.build_system.task.get_file_from_synapse_task.GetFileFromSynapseTask.synid","title":"synid  <code>instance-attribute</code>","text":"<pre><code>synid: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/get_file_from_synapse_task/#mecfs_bio.build_system.task.get_file_from_synapse_task.GetFileFromSynapseTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/get_file_from_synapse_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    syn = synapseclient.login()\n    files = synapseutils.syncFromSynapse(syn, self.synid, path=str(scratch_dir))\n    logger.debug(f\"downloaded: {files}\")\n    assert len(files) == 1\n    assert files[0].name == self.expected_filename\n    return FileAsset(Path(files[0].path))\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/get_uniprot_reference_data_task/","title":"get_uniprot_reference_data_task","text":""},{"location":"reference/mecfs_bio/build_system/task/get_uniprot_reference_data_task/#mecfs_bio.build_system.task.get_uniprot_reference_data_task","title":"mecfs_bio.build_system.task.get_uniprot_reference_data_task","text":"<p>Task to download reference data about proteins from UniProt</p> <p>Classes:</p> <ul> <li> <code>GetUniProtReferenceDataTask</code>           \u2013            <p>Task to download reference data about proteins from UniProt</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>DEFAULT_FIELDS</code>           \u2013            </li> <li> <code>protkb</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/get_uniprot_reference_data_task/#mecfs_bio.build_system.task.get_uniprot_reference_data_task.DEFAULT_FIELDS","title":"DEFAULT_FIELDS  <code>module-attribute</code>","text":"<pre><code>DEFAULT_FIELDS = [\n    \"accession\",\n    \"id\",\n    \"gene_names\",\n    \"protein_name\",\n    \"organism_name\",\n    \"organism_id\",\n    \"go_id\",\n    \"go_p\",\n    \"go_c\",\n    \"go_f\",\n    \"cc_subcellular_location\",\n    \"cc_function\",\n    \"xref_ensembl\",\n    \"xref_reactome\",\n]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/get_uniprot_reference_data_task/#mecfs_bio.build_system.task.get_uniprot_reference_data_task.protkb","title":"protkb  <code>module-attribute</code>","text":"<pre><code>protkb = ProtKB()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/get_uniprot_reference_data_task/#mecfs_bio.build_system.task.get_uniprot_reference_data_task.GetUniProtReferenceDataTask","title":"GetUniProtReferenceDataTask","text":"<p>               Bases: <code>Task</code></p> <p>Task to download reference data about proteins from UniProt</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>field_list</code>               (<code>list[str]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/get_uniprot_reference_data_task/#mecfs_bio.build_system.task.get_uniprot_reference_data_task.GetUniProtReferenceDataTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/get_uniprot_reference_data_task/#mecfs_bio.build_system.task.get_uniprot_reference_data_task.GetUniProtReferenceDataTask.field_list","title":"field_list  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>field_list: list[str] = DEFAULT_FIELDS\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/get_uniprot_reference_data_task/#mecfs_bio.build_system.task.get_uniprot_reference_data_task.GetUniProtReferenceDataTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/get_uniprot_reference_data_task/#mecfs_bio.build_system.task.get_uniprot_reference_data_task.GetUniProtReferenceDataTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(asset_id: str)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/get_uniprot_reference_data_task.py</code> <pre><code>@classmethod\ndef create(cls, asset_id: str):\n    meta = ReferenceFileMeta(\n        group=\"protein_lookup\",\n        sub_group=\"uniprot\",\n        sub_folder=PurePath(\"raw\"),\n        id=AssetId(asset_id),\n        extension=\".parquet\",\n        read_spec=DataFrameReadSpec(DataFrameParquetFormat()),\n    )\n    return cls(meta)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/get_uniprot_reference_data_task/#mecfs_bio.build_system.task.get_uniprot_reference_data_task.GetUniProtReferenceDataTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/get_uniprot_reference_data_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    query = reviewed(True) &amp; organism_name(\"human\")\n    result = protkb.get(query, fields=self.field_list)\n    out_path = scratch_dir / \"uniprot.parquet\"\n    result.to_parquet(out_path)\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/","title":"gwaslab","text":""},{"location":"reference/mecfs_bio/build_system/task/gwaslab/#mecfs_bio.build_system.task.gwaslab","title":"mecfs_bio.build_system.task.gwaslab","text":"<p>Tasks using to GWASLab (https://github.com/Cloufield/gwaslab), a Python toolkit for GWAS summary statistics.</p> <p>Modules:</p> <ul> <li> <code>gwaslab_cell_analysis_by_sldsc</code>           \u2013            <p>This task uses LDSC's wrapper around  the original LDSC to implement cell-type specific analysis</p> </li> <li> <code>gwaslab_create_sumstats_task</code>           \u2013            <p>Task to read in a dataframe from disk and process it using the GWASLAB pipeline.</p> </li> <li> <code>gwaslab_genetic_corr_by_ct_ldsc_task</code>           \u2013            <p>This task uses GWASLAB's wrapper around the original LDSC code to estimate genetic correlation by cross-trait</p> </li> <li> <code>gwaslab_lead_variants_task</code>           \u2013            </li> <li> <code>gwaslab_manhattan_and_qq_plot_task</code>           \u2013            </li> <li> <code>gwaslab_region_plot_task_arbitrary_locus</code>           \u2013            </li> <li> <code>gwaslab_region_plots_task</code>           \u2013            </li> <li> <code>gwaslab_snp_heritability_by_ldsc_task</code>           \u2013            <p>This task uses GWASLAB's wrapper around the original LDSC code to estimate compute heritability</p> </li> <li> <code>gwaslab_sumstats_to_table_task</code>           \u2013            </li> <li> <code>gwaslab_transform_sumstats</code>           \u2013            <p>Contains a task for transforming gwaslab Sumstats objefts.</p> </li> <li> <code>gwaslab_util</code>           \u2013            </li> <li> <code>sldsc_scatter_plot_task</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/","title":"gwaslab_cell_analysis_by_sldsc","text":""},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc","title":"mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc","text":"<p>This task uses LDSC's wrapper around  the original LDSC to implement cell-type specific analysis via Stratified LDSC as described in \"Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types\"</p> <p>See https://github.com/bulik/ldsc/wiki/Cell-type-specific-analyses</p> <p>and also</p> <p>https://cloufield.github.io/gwaslab/LDSCinGWASLab/</p> <p>Classes:</p> <ul> <li> <code>CellAnalysisByLDSCTask</code>           \u2013            <pre><code>Task to run cell specific analysis using stratified LDSC\n</code></pre> </li> <li> <code>LDCTSFileEntry</code>           \u2013            </li> </ul> <p>Functions:</p> <ul> <li> <code>ldcts_processed_to_raw</code>             \u2013              </li> <li> <code>ldcts_raw_to_processed</code>             \u2013              </li> <li> <code>prepend_path_to_ldcts_file</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.CellAnalysisByLDSCTask","title":"CellAnalysisByLDSCTask","text":"<p>               Bases: <code>Task</code></p> <pre><code>Task to run cell specific analysis using stratified LDSC\nas described in\n</code></pre> <p>\"Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types\"</p> <pre><code>ref_ld_chr_cts_task: task to generate a directory of cell- or tissue-specific LD scores\nref_ld_chr_cts_filename:  filename of index into LD scores in directory created by task above\n The official site describes this file as follows:\n \"This file has two columns. The first column has a label, for example the name of the cell type in question. The second column has a comma delimited list of LD scores to include when doing the regression for that cell type. For example, in Cahoy.ldcts there are three lines, corresponding to three brain cell types. Each line has two sets of LD scores to include: one is the set of LD scores corresponding to the specifically expressed genes in the cell type, while the second one is a \"control\" gene set of all genes. The result that will be reported will be the regression coefficient for the first set of LD scores in the list.\n \"\nref_ld_chr_task: task to generate a directory of reference LD scores for the 'baseline' genome annotations.\nref_ld_chr_inner_pattern: string pattern appended to the path to the above directory to select all chromosome files.  Should be in a special glob format, where the @ character is replaced by chromosome number\nw_ld_chr_task: File containing un-partitioned regression weights for the regression SNPS.  these are typically the hapmap3 variants excluding the HLA/MHC region\n</code></pre> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>pre_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>ref_ld_chr_cts_index_filename</code>               (<code>str</code>)           \u2013            </li> <li> <code>ref_ld_chr_cts_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>ref_ld_chr_inner_pattern</code>               (<code>str</code>)           \u2013            </li> <li> <code>ref_ld_chr_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>source_sumstats_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>w_ld_chr_inner_pattern</code>               (<code>str</code>)           \u2013            </li> <li> <code>w_ld_chr_task</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.CellAnalysisByLDSCTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.CellAnalysisByLDSCTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.CellAnalysisByLDSCTask.pre_pipe","title":"pre_pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>pre_pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.CellAnalysisByLDSCTask.ref_ld_chr_cts_index_filename","title":"ref_ld_chr_cts_index_filename  <code>instance-attribute</code>","text":"<pre><code>ref_ld_chr_cts_index_filename: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.CellAnalysisByLDSCTask.ref_ld_chr_cts_task","title":"ref_ld_chr_cts_task  <code>instance-attribute</code>","text":"<pre><code>ref_ld_chr_cts_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.CellAnalysisByLDSCTask.ref_ld_chr_inner_pattern","title":"ref_ld_chr_inner_pattern  <code>instance-attribute</code>","text":"<pre><code>ref_ld_chr_inner_pattern: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.CellAnalysisByLDSCTask.ref_ld_chr_task","title":"ref_ld_chr_task  <code>instance-attribute</code>","text":"<pre><code>ref_ld_chr_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.CellAnalysisByLDSCTask.source_sumstats_task","title":"source_sumstats_task  <code>instance-attribute</code>","text":"<pre><code>source_sumstats_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.CellAnalysisByLDSCTask.w_ld_chr_inner_pattern","title":"w_ld_chr_inner_pattern  <code>instance-attribute</code>","text":"<pre><code>w_ld_chr_inner_pattern: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.CellAnalysisByLDSCTask.w_ld_chr_task","title":"w_ld_chr_task  <code>instance-attribute</code>","text":"<pre><code>w_ld_chr_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.CellAnalysisByLDSCTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    source_sumstats_task: Task,\n    ref_ld_chr_cts_task: Task,\n    ref_ld_chr_cts_filename: str,\n    ref_ld_chr_task: Task,\n    ref_ld_chr_inner_dirname: str,\n    w_ld_chr_task: Task,\n    w_ld_chr_inner_dirname: str,\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    source_sumstats_task: Task,\n    ref_ld_chr_cts_task: Task,\n    ref_ld_chr_cts_filename: str,\n    ref_ld_chr_task: Task,\n    ref_ld_chr_inner_dirname: str,\n    w_ld_chr_task: Task,\n    w_ld_chr_inner_dirname: str,\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n):\n    sumstats_meta = source_sumstats_task.meta\n    assert isinstance(sumstats_meta, GWASLabSumStatsMeta)\n    meta = ResultTableMeta(\n        id=asset_id,\n        trait=sumstats_meta.trait,\n        project=sumstats_meta.project,\n        sub_dir=PurePath(\"analysis\"),\n        extension=\".csv\",\n        read_spec=DataFrameReadSpec(DataFrameTextFormat(separator=\",\")),\n    )\n    return cls(\n        meta=meta,\n        source_sumstats_task=source_sumstats_task,\n        ref_ld_chr_cts_task=ref_ld_chr_cts_task,\n        ref_ld_chr_cts_index_filename=ref_ld_chr_cts_filename,\n        ref_ld_chr_task=ref_ld_chr_task,\n        ref_ld_chr_inner_pattern=ref_ld_chr_inner_dirname,\n        w_ld_chr_task=w_ld_chr_task,\n        w_ld_chr_inner_pattern=w_ld_chr_inner_dirname,\n        pre_pipe=pre_pipe,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.CellAnalysisByLDSCTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    sumstats_asset = fetch(self._source_sumstats_id)\n    sumstats = read_sumstats(sumstats_asset)\n    sumstats.data = (\n        self.pre_pipe.process(narwhals.from_native(sumstats.data).lazy())\n        .collect()\n        .to_pandas()\n    )\n    ref_ld_chr_cts_asset = fetch(self._ref_ld_chr_cts_id)\n    assert isinstance(ref_ld_chr_cts_asset, DirectoryAsset)\n    ref_ld_chr_cts_index_path = (\n        ref_ld_chr_cts_asset.path / self.ref_ld_chr_cts_index_filename\n    )\n    assert ref_ld_chr_cts_index_path.is_file()\n    with TemporaryDirectory() as tmpdir:\n        tmp_path = Path(tmpdir)\n        new_loc_chr_cts = tmp_path / \"temp_ld_chr_cts\"\n        shutil.copytree(ref_ld_chr_cts_asset.path, new_loc_chr_cts)\n        new_loc_chr_cts_index_path = (\n            new_loc_chr_cts / self.ref_ld_chr_cts_index_filename\n        )\n        assert new_loc_chr_cts_index_path.is_file()\n        # there is something of a bug in the index format:\n        # the ldsc code assumes that it is\n        # being run from within the chr_cts directory, and so treats the paths in the index file\n        # as paths relative to the current working directory\n        # to run ldsc when the chr_cts directory is not the current directory,\n        # we need to prepend a path to all paths in the index file\n        prepend_path_to_ldcts_file(\n            new_loc_chr_cts_index_path,\n            prefix_path=new_loc_chr_cts,\n            output_path=new_loc_chr_cts_index_path,\n        )\n\n        ref_ld_chr_asset = fetch(self._ref_ld_chr_id)\n        assert isinstance(ref_ld_chr_asset, DirectoryAsset)\n        ref_ld_chr_full_pattern = (\n            ref_ld_chr_asset.path / self.ref_ld_chr_inner_pattern\n        )\n        # assert ref_ld_chr_full_pattern.is_dir()\n        w_ld_chr_asset = fetch(self._w_ld_chr_id)\n        assert isinstance(w_ld_chr_asset, DirectoryAsset)\n        w_ld_chr_full_pattern = w_ld_chr_asset.path / self.w_ld_chr_inner_pattern\n        # assert  w_ld_chr_full_pattern.is_dir()\n        sumstats.estimate_h2_cts_by_ldsc(\n            ref_ld_chr=str(ref_ld_chr_full_pattern),\n            ref_ld_chr_cts=str(new_loc_chr_cts_index_path),\n            w_ld_chr=str(w_ld_chr_full_pattern),\n        )\n        ldsc_h2_cts: pd.DataFrame = sumstats.ldsc_h2_cts\n        logger.debug(f\"cell type specific s-LDSC results: \\n \\n {ldsc_h2_cts}\\n\")\n\n        out_path = scratch_dir / \"ldsc_h2_cts.csv\"\n        ldsc_h2_cts.to_csv(out_path, index=False)\n        return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.LDCTSFileEntry","title":"LDCTSFileEntry","text":"<p>Methods:</p> <ul> <li> <code>from_text</code>             \u2013              </li> <li> <code>prepend_to_paths</code>             \u2013              </li> <li> <code>to_text</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>control_gene_data_path</code>               (<code>Path</code>)           \u2013            </li> <li> <code>label</code>               (<code>str</code>)           \u2013            </li> <li> <code>target_gene_data_path</code>               (<code>Path</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.LDCTSFileEntry.control_gene_data_path","title":"control_gene_data_path  <code>instance-attribute</code>","text":"<pre><code>control_gene_data_path: Path\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.LDCTSFileEntry.label","title":"label  <code>instance-attribute</code>","text":"<pre><code>label: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.LDCTSFileEntry.target_gene_data_path","title":"target_gene_data_path  <code>instance-attribute</code>","text":"<pre><code>target_gene_data_path: Path\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.LDCTSFileEntry.from_text","title":"from_text  <code>classmethod</code>","text":"<pre><code>from_text(text: str) -&gt; LDCTSFileEntry\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc.py</code> <pre><code>@classmethod\ndef from_text(cls, text: str) -&gt; \"LDCTSFileEntry\":\n    label, rest = text.split(\"\\t\", maxsplit=1)\n    target, control = rest.split(\",\", maxsplit=1)\n    return cls(\n        label=label,\n        target_gene_data_path=Path(target),\n        control_gene_data_path=Path(control),\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.LDCTSFileEntry.prepend_to_paths","title":"prepend_to_paths","text":"<pre><code>prepend_to_paths(prefix: Path) -&gt; LDCTSFileEntry\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc.py</code> <pre><code>def prepend_to_paths(self, prefix: Path) -&gt; \"LDCTSFileEntry\":\n    return LDCTSFileEntry(\n        label=self.label,\n        target_gene_data_path=prefix / self.target_gene_data_path,\n        control_gene_data_path=prefix / self.control_gene_data_path,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.LDCTSFileEntry.to_text","title":"to_text","text":"<pre><code>to_text() -&gt; str\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc.py</code> <pre><code>def to_text(self) -&gt; str:\n    return (\n        f\"{self.label}\\t{self.target_gene_data_path},{self.control_gene_data_path}\"\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.ldcts_processed_to_raw","title":"ldcts_processed_to_raw","text":"<pre><code>ldcts_processed_to_raw(\n    processed: list[LDCTSFileEntry],\n) -&gt; str\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc.py</code> <pre><code>def ldcts_processed_to_raw(processed: list[LDCTSFileEntry]) -&gt; str:\n    return \"\\n\".join([item.to_text() for item in processed])\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.ldcts_raw_to_processed","title":"ldcts_raw_to_processed","text":"<pre><code>ldcts_raw_to_processed(\n    contents: str,\n) -&gt; list[LDCTSFileEntry]\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc.py</code> <pre><code>def ldcts_raw_to_processed(contents: str) -&gt; list[LDCTSFileEntry]:\n    return [LDCTSFileEntry.from_text(line) for line in contents.splitlines()]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc/#mecfs_bio.build_system.task.gwaslab.gwaslab_cell_analysis_by_sldsc.prepend_path_to_ldcts_file","title":"prepend_path_to_ldcts_file","text":"<pre><code>prepend_path_to_ldcts_file(\n    input_path: Path, prefix_path: Path, output_path: Path\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_cell_analysis_by_sldsc.py</code> <pre><code>def prepend_path_to_ldcts_file(input_path: Path, prefix_path: Path, output_path: Path):\n    with open(input_path) as f:\n        contents = f.read()\n    structured_contents = ldcts_raw_to_processed(contents)\n    prefixed = [item.prepend_to_paths(prefix_path) for item in structured_contents]\n    with open(output_path, \"w\") as f:\n        f.write(ldcts_processed_to_raw(prefixed))\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/","title":"gwaslab_create_sumstats_task","text":""},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task","title":"mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task","text":"<p>Task to read in a dataframe from disk and process it using the GWASLAB pipeline.</p> <p>Classes:</p> <ul> <li> <code>GWASLabColumnSpecifiers</code>           \u2013            </li> <li> <code>GWASLabCreateSumstatsTask</code>           \u2013            <p>Task that processes a DataFrame of GWAS summary statistics using the GWASLab pipeline.</p> </li> <li> <code>GWASLabVCFRef</code>           \u2013            </li> <li> <code>GwasLabTransformSpec</code>           \u2013            </li> <li> <code>HarmonizationOptions</code>           \u2013            <p>Options for the call to GWASLab's harmonize function.</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>transform_gwaslab_sumstats</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>GenomeBuild</code>           \u2013            </li> <li> <code>GenomeBuildMode</code>           \u2013            </li> <li> <code>ValidGwaslabFormat</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GenomeBuild","title":"GenomeBuild  <code>module-attribute</code>","text":"<pre><code>GenomeBuild = Literal['19', '38']\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GenomeBuildMode","title":"GenomeBuildMode  <code>module-attribute</code>","text":"<pre><code>GenomeBuildMode = Literal['infer', '19', '38']\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.ValidGwaslabFormat","title":"ValidGwaslabFormat  <code>module-attribute</code>","text":"<pre><code>ValidGwaslabFormat = (\n    GwaslabKnownFormat | GWASLabColumnSpecifiers\n)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabColumnSpecifiers","title":"GWASLabColumnSpecifiers","text":"<p>Methods:</p> <ul> <li> <code>get_selection_pipe</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>OR</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>beta</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>chi_sq</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>chrom</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>ea</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>eaf</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>info</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>mlog10p</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>n</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>ncase</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>ncontrol</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>nea</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>neaf</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>neff</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>or_95l</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>or_95u</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>p</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>pos</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>rsid</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>se</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>snpid</code>               (<code>str | None</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabColumnSpecifiers.OR","title":"OR  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>OR: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabColumnSpecifiers.beta","title":"beta  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>beta: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabColumnSpecifiers.chi_sq","title":"chi_sq  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>chi_sq: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabColumnSpecifiers.chrom","title":"chrom  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>chrom: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabColumnSpecifiers.ea","title":"ea  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>ea: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabColumnSpecifiers.eaf","title":"eaf  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>eaf: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabColumnSpecifiers.info","title":"info  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>info: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabColumnSpecifiers.mlog10p","title":"mlog10p  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>mlog10p: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabColumnSpecifiers.n","title":"n  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>n: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabColumnSpecifiers.ncase","title":"ncase  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>ncase: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabColumnSpecifiers.ncontrol","title":"ncontrol  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>ncontrol: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabColumnSpecifiers.nea","title":"nea  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>nea: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabColumnSpecifiers.neaf","title":"neaf  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>neaf: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabColumnSpecifiers.neff","title":"neff  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>neff: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabColumnSpecifiers.or_95l","title":"or_95l  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>or_95l: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabColumnSpecifiers.or_95u","title":"or_95u  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>or_95u: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabColumnSpecifiers.p","title":"p  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>p: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabColumnSpecifiers.pos","title":"pos  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>pos: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabColumnSpecifiers.rsid","title":"rsid  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>rsid: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabColumnSpecifiers.se","title":"se  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>se: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabColumnSpecifiers.snpid","title":"snpid  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>snpid: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabColumnSpecifiers.get_selection_pipe","title":"get_selection_pipe","text":"<pre><code>get_selection_pipe() -&gt; SelectColPipe\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task.py</code> <pre><code>def get_selection_pipe(self) -&gt; SelectColPipe:\n    fields = attrs.asdict(self)\n    cols = []\n    for v in fields.values():\n        if v is not None:\n            cols.append(v)\n    return SelectColPipe(cols)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabCreateSumstatsTask","title":"GWASLabCreateSumstatsTask","text":"<p>               Bases: <code>Task</code></p> <p>Task that processes a DataFrame of GWAS summary statistics using the GWASLab pipeline. see: https://cloufield.github.io/gwaslab/SumstatsObject/</p> <p>Methods:</p> <ul> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>basic_check</code>               (<code>bool</code>)           \u2013            </li> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>drop_col_list</code>               (<code>Sequence[str]</code>)           \u2013            </li> <li> <code>exclude_hla</code>               (<code>bool</code>)           \u2013            </li> <li> <code>exclude_sexchr</code>               (<code>bool</code>)           \u2013            </li> <li> <code>filter_hapmap3</code>               (<code>bool</code>)           \u2013            </li> <li> <code>filter_indels</code>               (<code>bool</code>)           \u2013            </li> <li> <code>filter_palindromic</code>               (<code>bool</code>)           \u2013            </li> <li> <code>fmt</code>               (<code>GwaslabKnownFormat | GWASLabColumnSpecifiers</code>)           \u2013            </li> <li> <code>genome_build</code>               (<code>GenomeBuildMode</code>)           \u2013            </li> <li> <code>harmonize_options</code>               (<code>HarmonizationOptions | None</code>)           \u2013            </li> <li> <code>liftover_to</code>               (<code>GenomeBuild | None</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>pre_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabCreateSumstatsTask.basic_check","title":"basic_check  <code>instance-attribute</code>","text":"<pre><code>basic_check: bool\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabCreateSumstatsTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabCreateSumstatsTask.drop_col_list","title":"drop_col_list  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>drop_col_list: Sequence[str] = tuple()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabCreateSumstatsTask.exclude_hla","title":"exclude_hla  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>exclude_hla: bool = False\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabCreateSumstatsTask.exclude_sexchr","title":"exclude_sexchr  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>exclude_sexchr: bool = False\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabCreateSumstatsTask.filter_hapmap3","title":"filter_hapmap3  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>filter_hapmap3: bool = False\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabCreateSumstatsTask.filter_indels","title":"filter_indels  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>filter_indels: bool = False\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabCreateSumstatsTask.filter_palindromic","title":"filter_palindromic  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>filter_palindromic: bool = False\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabCreateSumstatsTask.fmt","title":"fmt  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>fmt: GwaslabKnownFormat | GWASLabColumnSpecifiers = (\n    \"regenie\"\n)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabCreateSumstatsTask.genome_build","title":"genome_build  <code>instance-attribute</code>","text":"<pre><code>genome_build: GenomeBuildMode\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabCreateSumstatsTask.harmonize_options","title":"harmonize_options  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>harmonize_options: HarmonizationOptions | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabCreateSumstatsTask.liftover_to","title":"liftover_to  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>liftover_to: GenomeBuild | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabCreateSumstatsTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabCreateSumstatsTask.pre_pipe","title":"pre_pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>pre_pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabCreateSumstatsTask.execute","title":"execute","text":"<pre><code>execute(\n    scratch_dir: Path, fetch: Fetch, wf: WF\n) -&gt; FileAsset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; FileAsset:\n    df = scan_dataframe_asset(asset=fetch(self._source_id), meta=self._source_meta)\n    logger.debug(\"Applying pre-pipe\")\n    df = self.pre_pipe.process(df)\n    logger.debug(\"Fetching source dataframe asset...\")\n    sumstats = _get_sumstats(df, self.fmt, drop_cols=self.drop_col_list)\n    transform_spec = GwasLabTransformSpec(\n        basic_check=self.basic_check,\n        genome_build=self.genome_build,\n        filter_hapmap3=self.filter_hapmap3,\n        filter_indels=self.filter_indels,\n        filter_palindromic=self.filter_palindromic,\n        exclude_hla=self.exclude_hla,\n        exclude_sexchr=self.exclude_sexchr,\n        harmonize_options=self.harmonize_options,\n        liftover_to=self.liftover_to,\n    )\n    sumstats = transform_gwaslab_sumstats(sumstats, spec=transform_spec)\n    out_path = scratch_dir / \"pickled_sumstats.pickle\"\n    gl.dump_pickle(sumstats, path=out_path)\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabVCFRef","title":"GWASLabVCFRef","text":"<p>Attributes:</p> <ul> <li> <code>extra_downloads</code>               (<code>Sequence[str]</code>)           \u2013            </li> <li> <code>name</code>               (<code>str</code>)           \u2013            </li> <li> <code>ref_alt_freq</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabVCFRef.extra_downloads","title":"extra_downloads  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>extra_downloads: Sequence[str] = tuple()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabVCFRef.name","title":"name  <code>instance-attribute</code>","text":"<pre><code>name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GWASLabVCFRef.ref_alt_freq","title":"ref_alt_freq  <code>instance-attribute</code>","text":"<pre><code>ref_alt_freq: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GwasLabTransformSpec","title":"GwasLabTransformSpec","text":"<p>Attributes:</p> <ul> <li> <code>basic_check</code>               (<code>bool</code>)           \u2013            </li> <li> <code>exclude_hla</code>               (<code>bool</code>)           \u2013            </li> <li> <code>exclude_sexchr</code>               (<code>bool</code>)           \u2013            </li> <li> <code>filter_hapmap3</code>               (<code>bool</code>)           \u2013            </li> <li> <code>filter_indels</code>               (<code>bool</code>)           \u2013            </li> <li> <code>filter_palindromic</code>               (<code>bool</code>)           \u2013            </li> <li> <code>genome_build</code>               (<code>GenomeBuildMode</code>)           \u2013            </li> <li> <code>harmonize_options</code>               (<code>HarmonizationOptions | None</code>)           \u2013            </li> <li> <code>liftover_to</code>               (<code>GenomeBuild | None</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GwasLabTransformSpec.basic_check","title":"basic_check  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>basic_check: bool = True\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GwasLabTransformSpec.exclude_hla","title":"exclude_hla  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>exclude_hla: bool = False\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GwasLabTransformSpec.exclude_sexchr","title":"exclude_sexchr  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>exclude_sexchr: bool = False\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GwasLabTransformSpec.filter_hapmap3","title":"filter_hapmap3  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>filter_hapmap3: bool = False\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GwasLabTransformSpec.filter_indels","title":"filter_indels  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>filter_indels: bool = False\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GwasLabTransformSpec.filter_palindromic","title":"filter_palindromic  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>filter_palindromic: bool = False\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GwasLabTransformSpec.genome_build","title":"genome_build  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>genome_build: GenomeBuildMode = 'infer'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GwasLabTransformSpec.harmonize_options","title":"harmonize_options  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>harmonize_options: HarmonizationOptions | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.GwasLabTransformSpec.liftover_to","title":"liftover_to  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>liftover_to: GenomeBuild | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.HarmonizationOptions","title":"HarmonizationOptions","text":"<p>Options for the call to GWASLab's harmonize function.</p> <p>gwaslab's harmonization function changes the status codes in the STATUS column. These status codes are described here: https://cloufield.github.io/gwaslab/StatusCode/</p> <p>Below I explain some points that were initially not clear to me from the gwaslab documentation.</p> <p>Two reference files are used in harmonization:</p> <ul> <li>A VCF file (ref_infer).  This is basically a table of genetic variants.</li> </ul> <p>In some cases, this table is in dbSNP VCF format.  In this case, each row describes a given genetic variant.    Sometimes this description includes allele frequency.</p> <p>In other cases, (such as when using a thousand genomes reference data) this table is in genotype VCF format.    In this case, the rows of the VCF file correspond to variants, and the columns correspond to individuals (from the    thousand genomes project, for example).  For each individual and each variant, the table tells us whether that individual has that variant.    Variant frequency information can be calculated from this individual-level genome data.</p> <ul> <li> <p>A FASTA file (ref_seq).  This is a consensus human genome sequence.  Here is an example of some rows from the hg19 FASTA file:</p> <p>TAAGTTTTGTCTGGTAATAAAGGTATATTTTCAAAAGAGAGGTAAATAGA TCCACATACTGTGGAGGGAATAAAATACTTTTTGAAAAACAAACAACAAG TTGGATTTTTAGACACATAGAAATTGAATATGTACATTTATAAATATTTT TGGATTGAACTATTTCAAAATTATACCATAAAATAACTTGTAAAAATGTA GGCAAAATGTATATAATTATGGCATGAGGTATGCAACTTTAGGCAAGGAA GCAAAAGCAGAAACCATGAAAAAAGTCTAAATTTTACCATATTGAATTTA AATTTTCAAAAACAAAAATAAAGACAAAGTGGGAAAAATATGTATGCTTC ATGTGTGACAAGCCACTGATACCTATTAAATATGAAGAATATTATAAATC ATATCAATAACCACAACATTCAAGCTGTCAGTTTGAATAGACaatgtaaa tgacaaaactacatactcaacaagataacagcaaaccagcttcgacagca cgttaaaggggtcatacaacataatcgagtagaatttatctctgagatgc aagaatggttcaaaatatggaaaccaataaatgtgatatgccacactaac agaataaaaaataaaaatcatattatcatctcaatagatgcagaaaaagc attaacaaaagtaaacattctttcataataagacatcagataaaacaaat taggaatagaaggaatgtaccgcaacacaataaaggccatatataacaag cccacagctaacatcataatagtaaaatcatcacactggtaaaaaaaatg</p> </li> </ul> <p>gwaslab uses these two reference files to harmonize summary statistics. These two reference files each affect a different digit of the gwaslab STATUS code column.</p> <ul> <li>Digit 7 of the status code is determined by the ability of gwaslab to find the variant in the reference VCF (ref_infer) :   see here: https://github.com/Cloufield/gwaslab/blob/d639b67c5264b1ac7ec89e284e638f2c8454ac48/src/gwaslab/hm/hm_harmonize_sumstats.py#L1521-L1530   Values of 7 or 8 here mean that the variant is palindromic, and the database could not be used to disambiguate the strand of the variant, or the variant was not found in the database</li> <li>Digit 6 of the status code is instead determined by the ability of the gwaslab to find the variant in the reference genome build FASTA file (ref_seq)   see here: https://github.com/Cloufield/gwaslab/blob/d639b67c5264b1ac7ec89e284e638f2c8454ac48/src/gwaslab/hm/hm_harmonize_sumstats.py#L968-L975   a value of 8 means a failure to find the variant in the FASTA file.</li> </ul> <p>Set drop_missing_from_ref_seq to drop based on digit 6. Set drop_missing_from_ref_infer to drop based on digit 7.</p> <p>Attributes:</p> <ul> <li> <code>check_ref_files</code>               (<code>bool</code>)           \u2013            </li> <li> <code>cores</code>               (<code>int</code>)           \u2013            </li> <li> <code>drop_missing_from_ref_infer_or_ambiguous</code>               (<code>bool</code>)           \u2013            </li> <li> <code>drop_missing_from_ref_seq</code>               (<code>bool</code>)           \u2013            </li> <li> <code>ref_infer</code>               (<code>GWASLabVCFRef</code>)           \u2013            </li> <li> <code>ref_seq</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.HarmonizationOptions.check_ref_files","title":"check_ref_files  <code>instance-attribute</code>","text":"<pre><code>check_ref_files: bool\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.HarmonizationOptions.cores","title":"cores  <code>instance-attribute</code>","text":"<pre><code>cores: int\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.HarmonizationOptions.drop_missing_from_ref_infer_or_ambiguous","title":"drop_missing_from_ref_infer_or_ambiguous  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>drop_missing_from_ref_infer_or_ambiguous: bool = True\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.HarmonizationOptions.drop_missing_from_ref_seq","title":"drop_missing_from_ref_seq  <code>instance-attribute</code>","text":"<pre><code>drop_missing_from_ref_seq: bool\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.HarmonizationOptions.ref_infer","title":"ref_infer  <code>instance-attribute</code>","text":"<pre><code>ref_infer: GWASLabVCFRef\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.HarmonizationOptions.ref_seq","title":"ref_seq  <code>instance-attribute</code>","text":"<pre><code>ref_seq: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_create_sumstats_task.transform_gwaslab_sumstats","title":"transform_gwaslab_sumstats","text":"<pre><code>transform_gwaslab_sumstats(\n    sumstats: Sumstats, spec: GwasLabTransformSpec\n) -&gt; gl.Sumstats\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_create_sumstats_task.py</code> <pre><code>def transform_gwaslab_sumstats(\n    sumstats: gl.Sumstats,\n    spec: GwasLabTransformSpec,\n) -&gt; gl.Sumstats:\n    logger.debug(\"Running gwas summary statistics through gwaslab pipelines...\")\n    logger.debug(f\"Initial sumstats has shape {sumstats.data.shape}\")\n    if spec.basic_check:\n        sumstats.basic_check()\n    if spec.genome_build == \"infer\":\n        sumstats.fix_chr()\n        sumstats.infer_build()\n        build = sumstats.meta[\"gwaslab\"][\"genome_build\"]\n        forced_build = None\n        print(f\"Build is {build}\")\n    else:\n        build = spec.genome_build\n        forced_build = build\n\n    if spec.liftover_to is not None and (build != spec.liftover_to):\n        sumstats.liftover(to_build=spec.liftover_to, from_build=forced_build)\n    if spec.filter_hapmap3:\n        sumstats.filter_hapmap3(inplace=True, build=forced_build)\n    if spec.filter_indels:\n        sumstats.filter_indel(inplace=True, mode=\"out\")\n    if spec.filter_palindromic:\n        sumstats.filter_palindromic(inplace=True, mode=\"out\")\n    if spec.exclude_hla:\n        sumstats.exclude_hla(inplace=True)\n    if spec.exclude_sexchr:\n        sumstats = _exclude_sexchr(sumstats)\n    if spec.harmonize_options is not None:\n        _do_harmonization(\n            sumstats,\n            basic_check=(not spec.basic_check),\n            options=spec.harmonize_options,\n        )\n\n    _sumstats_raise_on_error(sumstats)\n    logger.debug(f\"Finished gwaslab pipe.  Data has shape {sumstats.data.shape}\")\n    return sumstats\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/","title":"gwaslab_genetic_corr_by_ct_ldsc_task","text":""},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task","title":"mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task","text":"<p>This task uses GWASLAB's wrapper around the original LDSC code to estimate genetic correlation by cross-trait ld-score regression.</p> <p>While LDSC is a useful and powerful technique, its results should be taken with a grain of salt.</p> <p>Here is a discussion (which covers both single and cross-trait analysis) from chapter 23 of the Handbook of Statistical Genomics: Balding, David J., Ida Moltke, and John Marioni, eds. Handbook of statistical genomics. John Wiley &amp; Sons, 2019. Chapter authors are S. Burgess, C.N. Foley and V. Zuber</p> <p>\" A criticism of LD score regression is that every analysis for each pair of traits uses the same LD scores as the dependent variable in the regression model (and as LD scores have been precomputed by its proponents, literally the same LD scores are used in the majority of applied analyses). This means that any influential points in the regression will affect not only one LD score regression analysis, but all such analyses. LD scores are also likely to be a \u2018weak instrument\u2019 in the language of Mendelian randomization, as they will only explain a small proportion of variance in the dependent variable. Additionally, due to the scale of the data, it is not possible to provide a visual representation of an LD score regression analysis. Standard regression diagnostics are rarely, if ever, performed. Finally, results from LD score regression are not always consistent with known causal relationships; for example, the method did not find evidence for a genetic correlation between LDL cholesterol and CHD risk that survived a multiple testing correction (Bulik-Sullivan et al., 2015). The method has utility in mapping the genetic distance between related phenotypes, such as determining how closely related different psychiatric disorders are in terms of their genetic predictors (Cross-Disorder Group of the Psychiatric Genomics Consortium, 2013). However, the reliance of the method on numerous linearity and independence assumptions, incorrect weighting in the linear regression model (correct weights would require computation of the Cholesky decomposition of a matrix with dimension equal to the number of genetic variants in the model \u2013 misspecified weights are recommended for use in practice), and lack of validation against known causal relationships mean that results from the method should not be treated too seriously as an assessment of causality. \"</p> <p>Classes:</p> <ul> <li> <code>BinaryPhenotypeSampleInfo</code>           \u2013            <p>For binary phenotypes, sample prevalence and population prevalence are required to convert heritability from the observed scale to the liability scale.</p> </li> <li> <code>FilterSettings</code>           \u2013            <p>Options for SNP filtering for CT-LDSC</p> </li> <li> <code>GeneticCorrelationByCTLDSCTask</code>           \u2013            <p>Estimate genetic correlation by cross-trait linkage disequilibrium score regression.</p> </li> <li> <code>QuantPhenotype</code>           \u2013            <p>Marker class to indicate that a phenotype is quantitative, not binary, and so does not need to be converted to the liability scale.</p> </li> <li> <code>SumstatsSource</code>           \u2013            <p>A source of GWASlab sumstats to use for computing genetic correlation</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>filter_sumstats</code>             \u2013              <p>Performing filtering roughly consistent with the procedure described in the methods section of Bulik-Sullivan et al.</p> </li> <li> <code>get_compatible_snps_polars</code>             \u2013              <p>Get a DataFrame of rsIDs corresponding to SNPs for which both dataframes have matching alleles.</p> </li> <li> <code>get_prev_options</code>             \u2013              <p>Get prevalence-related options to pass to CT-LDSC</p> </li> <li> <code>load_and_preprocess_sumstats</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>PhenotypeInfo</code>           \u2013            </li> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.PhenotypeInfo","title":"PhenotypeInfo  <code>module-attribute</code>","text":"<pre><code>PhenotypeInfo = BinaryPhenotypeSampleInfo | QuantPhenotype\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.BinaryPhenotypeSampleInfo","title":"BinaryPhenotypeSampleInfo","text":"<p>For binary phenotypes, sample prevalence and population prevalence are required to convert heritability from the observed scale to the liability scale. Only the liability scale is biologically meaningful.</p> <p>Attributes:</p> <ul> <li> <code>estimated_population_prevalence</code>               (<code>float</code>)           \u2013            </li> <li> <code>sample_prevalence</code>               (<code>float</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.BinaryPhenotypeSampleInfo.estimated_population_prevalence","title":"estimated_population_prevalence  <code>instance-attribute</code>","text":"<pre><code>estimated_population_prevalence: float\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.BinaryPhenotypeSampleInfo.sample_prevalence","title":"sample_prevalence  <code>instance-attribute</code>","text":"<pre><code>sample_prevalence: float\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.FilterSettings","title":"FilterSettings","text":"<p>Options for SNP filtering for CT-LDSC</p> <p>Attributes:</p> <ul> <li> <code>keep_only_hapmap</code>               (<code>bool</code>)           \u2013            </li> <li> <code>remove_hla</code>               (<code>bool</code>)           \u2013            </li> <li> <code>remove_indels</code>               (<code>bool</code>)           \u2013            </li> <li> <code>remove_palindromic</code>               (<code>bool</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.FilterSettings.keep_only_hapmap","title":"keep_only_hapmap  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>keep_only_hapmap: bool = True\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.FilterSettings.remove_hla","title":"remove_hla  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>remove_hla: bool = True\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.FilterSettings.remove_indels","title":"remove_indels  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>remove_indels: bool = True\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.FilterSettings.remove_palindromic","title":"remove_palindromic  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>remove_palindromic: bool = True\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.GeneticCorrelationByCTLDSCTask","title":"GeneticCorrelationByCTLDSCTask","text":"<p>               Bases: <code>Task</code></p> <p>Estimate genetic correlation by cross-trait linkage disequilibrium score regression. See: Bulik-Sullivan, Brendan, et al. \"An atlas of genetic correlations across human diseases and traits.\" Nature genetics 47.11 (2015): 1236-1241.</p> <p>NOTE:  When CT-LDSC runs, in it addition to computing genetic correlations, it will also compute  heritabilities. For binary traits, observed scale heritability is not directly meaningful, and must be converted to liability scale. To get liability scale heritabilities, pass it  appropriate PhenotypeInfo objects.</p> <p>However, as Bulik-Sulivan et al. says: \"there is no distinction between observed and liability scale genetic correlation for case/control traits, so we can define and estimate genetic correlation between a case/control trait and a quantitative trait and genetic correlation between pairs of case/control traits without the need to specify a scale\" i.e. when we only care about genetic correlation, we do not need to worry about observed vs liability scale.</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>build</code>               (<code>GenomeBuild</code>)           \u2013            </li> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>filter_settings</code>               (<code>FilterSettings</code>)           \u2013            </li> <li> <code>ld_file_filename_pattern</code>               (<code>str</code>)           \u2013            </li> <li> <code>ld_ref_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>source_sumstats_tasks</code>               (<code>Sequence[SumstatsSource]</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.GeneticCorrelationByCTLDSCTask.build","title":"build  <code>instance-attribute</code>","text":"<pre><code>build: GenomeBuild\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.GeneticCorrelationByCTLDSCTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.GeneticCorrelationByCTLDSCTask.filter_settings","title":"filter_settings  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>filter_settings: FilterSettings = FilterSettings()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.GeneticCorrelationByCTLDSCTask.ld_file_filename_pattern","title":"ld_file_filename_pattern  <code>instance-attribute</code>","text":"<pre><code>ld_file_filename_pattern: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.GeneticCorrelationByCTLDSCTask.ld_ref_task","title":"ld_ref_task  <code>instance-attribute</code>","text":"<pre><code>ld_ref_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.GeneticCorrelationByCTLDSCTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.GeneticCorrelationByCTLDSCTask.source_sumstats_tasks","title":"source_sumstats_tasks  <code>instance-attribute</code>","text":"<pre><code>source_sumstats_tasks: Sequence[SumstatsSource]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.GeneticCorrelationByCTLDSCTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    sources: Sequence[SumstatsSource],\n    ld_ref_task: Task,\n    build: GenomeBuild,\n    ld_file_filename_pattern: str = \"/LDscore.@\",\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    sources: Sequence[SumstatsSource],\n    ld_ref_task: Task,\n    build: GenomeBuild,\n    ld_file_filename_pattern: str = \"/LDscore.@\",\n):\n    assert len(sources) &gt; 1\n    sumstats_meta = sources[0].task.meta\n    assert isinstance(sumstats_meta, GWASLabSumStatsMeta)\n    meta = ResultTableMeta(\n        id=asset_id,\n        trait=\"multi_trait\",\n        project=\"genetic_correlation\",\n        sub_dir=PurePath(\"ct_ldsc\"),\n        extension=\".csv\",\n        read_spec=DataFrameReadSpec(DataFrameTextFormat(\",\")),\n    )\n    return cls(\n        meta=meta,\n        ld_ref_task=ld_ref_task,\n        ld_file_filename_pattern=ld_file_filename_pattern,\n        source_sumstats_tasks=sources,\n        build=build,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.GeneticCorrelationByCTLDSCTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    ref_id = self._ld_ref_id\n    ref_asset = fetch(ref_id)\n    assert isinstance(ref_asset, DirectoryAsset)\n    results = []\n    for i in range(len(self.source_sumstats_tasks) - 1):\n        i_sumstats, i_name, i_sample_info = load_and_preprocess_sumstats(\n            source=self.source_sumstats_tasks[i],\n            fetch=fetch,\n            settings=self.filter_settings,\n            build=self.build,\n        )\n        for j in range(i + 1, len(self.source_sumstats_tasks)):\n            j_sumstats, j_name, j_sample_info = load_and_preprocess_sumstats(\n                source=self.source_sumstats_tasks[j],\n                fetch=fetch,\n                settings=self.filter_settings,\n                build=self.build,\n            )\n            compatible_rsids = get_compatible_snps_polars(\n                i_sumstats.data, j_sumstats.data\n            )\n            j_sumstats.data = j_sumstats.data.loc[\n                j_sumstats.data[GWASLAB_RSID_COL].isin(\n                    compatible_rsids[GWASLAB_RSID_COL]\n                )\n            ]\n            options = get_prev_options(\n                trait_1_prev=i_sample_info, trait_2_prev=j_sample_info\n            )\n            i_sumstats.estimate_rg_by_ldsc(\n                other_traits=[j_sumstats],\n                rg=f\"{i_name},{j_name}\",\n                ref_ld_chr=str(ref_asset.path) + self.ld_file_filename_pattern,\n                w_ld_chr=str(ref_asset.path) + self.ld_file_filename_pattern,\n                build=self.build,\n                **options,\n            )\n        results.append(i_sumstats.ldsc_rg)\n\n    out_df: pd.DataFrame = pd.concat(results, ignore_index=True)\n    logger.debug(\n        f\"rg_ldsc_results:\\n{out_df}\",\n    )\n    out_path = scratch_dir / \"ldsc_rg.csv\"\n    out_df.to_csv(out_path, index=False)\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.QuantPhenotype","title":"QuantPhenotype","text":"<p>Marker class to indicate that a phenotype is quantitative, not binary, and so does not need to be converted to the liability scale.</p>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.SumstatsSource","title":"SumstatsSource","text":"<p>A source of GWASlab sumstats to use for computing genetic correlation</p> <p>Attributes:</p> <ul> <li> <code>alias</code>               (<code>str</code>)           \u2013            </li> <li> <code>asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>sample_info</code>               (<code>PhenotypeInfo | None</code>)           \u2013            </li> <li> <code>task</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.SumstatsSource.alias","title":"alias  <code>instance-attribute</code>","text":"<pre><code>alias: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.SumstatsSource.asset_id","title":"asset_id  <code>property</code>","text":"<pre><code>asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.SumstatsSource.pipe","title":"pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.SumstatsSource.sample_info","title":"sample_info  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>sample_info: PhenotypeInfo | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.SumstatsSource.task","title":"task  <code>instance-attribute</code>","text":"<pre><code>task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.filter_sumstats","title":"filter_sumstats","text":"<pre><code>filter_sumstats(\n    sumstats: Sumstats, settings: FilterSettings, build: str\n)\n</code></pre> <p>Performing filtering roughly consistent with the procedure described in the methods section of Bulik-Sullivan et al.</p> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task.py</code> <pre><code>def filter_sumstats(sumstats: gwaslab.Sumstats, settings: FilterSettings, build: str):\n    \"\"\"\n    Performing filtering roughly consistent with the procedure described in the methods section of Bulik-Sullivan et al.\n    \"\"\"\n    if settings.remove_indels:\n        logger.debug(\"filtering indels\")\n        sumstats.filter_indel(inplace=True, mode=\"out\")\n    if settings.remove_palindromic:\n        logger.debug(\"filtering palindromes\")\n        sumstats.filter_palindromic(inplace=True, mode=\"out\")\n    if settings.remove_hla:\n        logger.debug(\"filtering hla region\")\n        sumstats.exclude_hla(inplace=True)\n    if settings.keep_only_hapmap:\n        sumstats.filter_hapmap3(inplace=True, build=build)\n    logger.debug(\"dropping duplicate rsids\")\n    len_before = len(sumstats.data)\n    sumstats.data = sumstats.data.drop_duplicates(subset=[GWASLAB_RSID_COL], keep=False)\n    len_after = len(sumstats.data)\n    logger.debug(f\"dropped {len_before - len_after} variants with identical rsids\")\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.get_compatible_snps_polars","title":"get_compatible_snps_polars","text":"<pre><code>get_compatible_snps_polars(\n    df_i: DataFrame, df_j: DataFrame\n) -&gt; pd.DataFrame\n</code></pre> <p>Get a DataFrame of rsIDs corresponding to SNPs for which both dataframes have matching alleles. This is necessary because certain dbSNP rsIDs actually correspond to multiple different allele pairs.</p> <p>pandas joins on string columns can very slow, so this operation uses polars instead.</p> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task.py</code> <pre><code>def get_compatible_snps_polars(df_i: pd.DataFrame, df_j: pd.DataFrame) -&gt; pd.DataFrame:\n    \"\"\"\n    Get a DataFrame of rsIDs corresponding to SNPs for which both dataframes have matching alleles.\n    This is necessary because certain dbSNP rsIDs actually correspond to multiple different allele pairs.\n\n    pandas joins on string columns can very slow, so this operation uses polars instead.\n    \"\"\"\n    pl_i = pl.from_pandas(\n        df_i[\n            [GWASLAB_RSID_COL, GWASLAB_EFFECT_ALLELE_COL, GWASLAB_NON_EFFECT_ALLELE_COL]\n        ]\n    ).with_columns(\n        pl.col(GWASLAB_RSID_COL).cast(pl.String()).alias(\"i_rsid\"),\n        pl.col(GWASLAB_EFFECT_ALLELE_COL).cast(pl.String()).alias(\"i_ea\"),\n        pl.col(GWASLAB_NON_EFFECT_ALLELE_COL).cast(pl.String()).alias(\"i_nea\"),\n    )\n    pl_j = pl.from_pandas(\n        df_j[\n            [GWASLAB_RSID_COL, GWASLAB_EFFECT_ALLELE_COL, GWASLAB_NON_EFFECT_ALLELE_COL]\n        ]\n    ).with_columns(\n        pl.col(GWASLAB_RSID_COL).cast(pl.String()).alias(\"j_rsid\"),\n        pl.col(GWASLAB_EFFECT_ALLELE_COL).cast(pl.String()).alias(\"j_ea\"),\n        pl.col(GWASLAB_NON_EFFECT_ALLELE_COL).cast(pl.String()).alias(\"j_nea\"),\n    )\n    pl_j = pl_j.with_columns(\n        complement_reverse_expr(\"j_ea\").alias(\"j_ea_other_strand\"),\n        complement_reverse_expr(\"j_nea\").alias(\"j_nea_other_strand\"),\n    )\n    joined = pl_i.join(pl_j, left_on=\"i_rsid\", right_on=\"j_rsid\")\n    joined = joined.with_columns(\n        (\n            match_reference_expr(\n                ea_col=\"i_ea\",\n                nea_col=\"i_nea\",\n                ref_ea_col=\"j_ea\",\n                ref_nea_col=\"j_nea\",\n            )\n            | match_flipped_reference_expr(\n                ea_col=\"i_ea\",\n                nea_col=\"i_nea\",\n                ref_ea_col=\"j_ea\",\n                ref_nea_col=\"j_nea\",\n            )\n            | match_reference_expr(\n                ea_col=\"i_ea\",\n                nea_col=\"i_nea\",\n                ref_ea_col=\"j_ea_other_strand\",\n                ref_nea_col=\"j_nea_other_strand\",\n            )\n            | match_flipped_reference_expr(\n                ea_col=\"i_ea\",\n                nea_col=\"i_nea\",\n                ref_ea_col=\"j_ea_other_strand\",\n                ref_nea_col=\"j_nea_other_strand\",\n            )\n        ).alias(\"match\")\n    )\n    logger.debug(\n        f\"Out of {len(joined)} matching rsids, {joined['match'].sum()} had matching alleles\"\n    )\n    result = joined.filter(pl.col(\"match\")).select(GWASLAB_RSID_COL).to_pandas()\n    return result\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.get_prev_options","title":"get_prev_options","text":"<pre><code>get_prev_options(\n    trait_1_prev: PhenotypeInfo | None,\n    trait_2_prev: PhenotypeInfo | None,\n) -&gt; dict\n</code></pre> <p>Get prevalence-related options to pass to CT-LDSC</p> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task.py</code> <pre><code>def get_prev_options(\n    trait_1_prev: PhenotypeInfo | None, trait_2_prev: PhenotypeInfo | None\n) -&gt; dict:\n    \"\"\"\n    Get prevalence-related options to pass to CT-LDSC\n    \"\"\"\n    t1_sp = (\n        trait_1_prev.sample_prevalence\n        if isinstance(trait_1_prev, BinaryPhenotypeSampleInfo)\n        else \"nan\"\n    )\n    t2_sp = (\n        trait_2_prev.sample_prevalence\n        if isinstance(trait_2_prev, BinaryPhenotypeSampleInfo)\n        else \"nan\"\n    )\n    t1_pp = (\n        trait_1_prev.estimated_population_prevalence\n        if isinstance(trait_1_prev, BinaryPhenotypeSampleInfo)\n        else \"nan\"\n    )\n    t2_pp = (\n        trait_2_prev.estimated_population_prevalence\n        if isinstance(trait_2_prev, BinaryPhenotypeSampleInfo)\n        else \"nan\"\n    )\n    options = {\n        \"samp_prev\": f\"{t1_sp},{t2_sp}\",\n        \"pop_prev\": f\"{t1_pp},{t2_pp}\",\n    }\n    logger.debug(f\"Prevalance Options: {options}\")\n    return options\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_genetic_corr_by_ct_ldsc_task.load_and_preprocess_sumstats","title":"load_and_preprocess_sumstats","text":"<pre><code>load_and_preprocess_sumstats(\n    source: SumstatsSource,\n    fetch: Fetch,\n    settings: FilterSettings,\n    build: GenomeBuild,\n) -&gt; tuple[gwaslab.Sumstats, str, PhenotypeInfo | None]\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_genetic_corr_by_ct_ldsc_task.py</code> <pre><code>def load_and_preprocess_sumstats(\n    source: SumstatsSource, fetch: Fetch, settings: FilterSettings, build: GenomeBuild\n) -&gt; tuple[gwaslab.Sumstats, str, PhenotypeInfo | None]:\n    name = source.alias\n    sumstats_asset = fetch(source.asset_id)\n    logger.debug(f\"reading sumstats for {name}\")\n    sumstats = read_sumstats(sumstats_asset)\n    assert GWASLAB_RSID_COL in sumstats.data.columns\n    sumstats.data = source.pipe.process_pandas(sumstats.data)\n    filter_sumstats(sumstats, settings, build=build)\n    return sumstats, name, source.sample_info\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_lead_variants_task/","title":"gwaslab_lead_variants_task","text":""},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_lead_variants_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_lead_variants_task","title":"mecfs_bio.build_system.task.gwaslab.gwaslab_lead_variants_task","text":"<p>Classes:</p> <ul> <li> <code>GwasLabLeadVariantsTask</code>           \u2013            <p>A task to generate a list of lead variants from summary statistics.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_lead_variants_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_lead_variants_task.GwasLabLeadVariantsTask","title":"GwasLabLeadVariantsTask","text":"<p>               Bases: <code>Task</code></p> <p>A task to generate a list of lead variants from summary statistics. Uses Gwaslab. see: https://cloufield.github.io/gwaslab/utility_get_lead_novel/</p> <p>Methods:</p> <ul> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>GWASLabLeadVariantsMeta</code>)           \u2013            </li> <li> <code>short_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>sig_level</code>               (<code>float</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_lead_variants_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_lead_variants_task.GwasLabLeadVariantsTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_lead_variants_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_lead_variants_task.GwasLabLeadVariantsTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: GWASLabLeadVariantsMeta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_lead_variants_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_lead_variants_task.GwasLabLeadVariantsTask.short_id","title":"short_id  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>short_id: AssetId = field(converter=AssetId)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_lead_variants_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_lead_variants_task.GwasLabLeadVariantsTask.sig_level","title":"sig_level  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>sig_level: float = 5e-08\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_lead_variants_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_lead_variants_task.GwasLabLeadVariantsTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_lead_variants_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    sumstats_asset = fetch(self._input_asset_id)\n    sumstats: gl.Sumstats = read_sumstats(sumstats_asset)\n    variant_df = sumstats.get_lead(anno=True, sig_level=self.sig_level)\n\n    \"\"\"\n    GWASLab (sumstats.get_lead()) does not add the GENE column if no significant variants are found.\n    See: https://github.com/Cloufield/gwaslab/blob/eb4daf636f6e171d74a80c16723293734e851ee2/src/gwaslab/util/util_in_get_sig.py#L164-L177. \n    However, the GENE column is required by downstream tasks.\n    \"\"\"\n    if not \"GENE\" in variant_df.columns:\n        variant_df[\"GENE\"] = None\n\n    out_path = scratch_dir / \"lead_variants.csv\"\n    variant_df.to_csv(out_path, index=False)\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_manhattan_and_qq_plot_task/","title":"gwaslab_manhattan_and_qq_plot_task","text":""},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_manhattan_and_qq_plot_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_manhattan_and_qq_plot_task","title":"mecfs_bio.build_system.task.gwaslab.gwaslab_manhattan_and_qq_plot_task","text":"<p>Classes:</p> <ul> <li> <code>GWASLabManhattanAndQQPlotTask</code>           \u2013            <p>A task to generate a manhattan plot and/or a qq plot.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_manhattan_and_qq_plot_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_manhattan_and_qq_plot_task.GWASLabManhattanAndQQPlotTask","title":"GWASLabManhattanAndQQPlotTask","text":"<p>               Bases: <code>Task</code></p> <p>A task to generate a manhattan plot and/or a qq plot. Uses Gwaslab. see: https://cloufield.github.io/gwaslab/Visualization/</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>GWASLabManhattanQQPlotMeta</code>)           \u2013            </li> <li> <code>plot_setting</code>               (<code>str</code>)           \u2013            </li> <li> <code>sig_level</code>               (<code>float</code>)           \u2013            </li> <li> <code>top_cut</code>               (<code>int</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_manhattan_and_qq_plot_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_manhattan_and_qq_plot_task.GWASLabManhattanAndQQPlotTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_manhattan_and_qq_plot_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_manhattan_and_qq_plot_task.GWASLabManhattanAndQQPlotTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: GWASLabManhattanQQPlotMeta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_manhattan_and_qq_plot_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_manhattan_and_qq_plot_task.GWASLabManhattanAndQQPlotTask.plot_setting","title":"plot_setting  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>plot_setting: str = 'mqq'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_manhattan_and_qq_plot_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_manhattan_and_qq_plot_task.GWASLabManhattanAndQQPlotTask.sig_level","title":"sig_level  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>sig_level: float = 5e-08\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_manhattan_and_qq_plot_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_manhattan_and_qq_plot_task.GWASLabManhattanAndQQPlotTask.top_cut","title":"top_cut  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>top_cut: int = 12\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_manhattan_and_qq_plot_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_manhattan_and_qq_plot_task.GWASLabManhattanAndQQPlotTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    sumstats_task: GWASLabCreateSumstatsTask,\n    asset_id: str,\n    sig_level: float = 5e-08,\n    plot_setting: str = \"mqq\",\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_manhattan_and_qq_plot_task.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    sumstats_task: GWASLabCreateSumstatsTask,\n    asset_id: str,\n    sig_level: float = 5e-8,\n    plot_setting: str = \"mqq\",\n):\n    input_meta = sumstats_task.meta\n    assert isinstance(input_meta, GWASLabSumStatsMeta)\n    meta = GWASLabManhattanQQPlotMeta(\n        trait=input_meta.trait,\n        project=input_meta.project,\n        id=AssetId(asset_id),\n    )\n    return cls(\n        sumstats_task=sumstats_task,\n        meta=meta,\n        sig_level=sig_level,\n        plot_setting=plot_setting,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_manhattan_and_qq_plot_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_manhattan_and_qq_plot_task.GWASLabManhattanAndQQPlotTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_manhattan_and_qq_plot_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    sumstats_asset = fetch(self._input_asset_id)\n    sumstats: gl.Sumstats = read_sumstats(sumstats_asset)\n    if self.plot_setting == \"mqq\":\n        fig, (ax1, ax2) = plt.subplots(figsize=(12, 14), ncols=2, nrows=1)\n        figax = [fig, ax1, ax2]\n    else:\n        fig, ax1 = plt.subplots(figsize=(12, 14), ncols=1, nrows=1)\n        figax = [\n            fig,\n            ax1,\n        ]\n\n    figs = {}\n    plot_name = \"mqq\"\n    sumstats.plot_mqq(\n        figax=figax,\n        skip=2,\n        cut=self.top_cut,\n        mode=self.plot_setting,\n        scaled=True,\n        anno=\"GENENAME\",\n        sig_level_lead=self.sig_level,\n    )\n    figs[plot_name] = fig\n    write_plots_to_dir(scratch_dir, figs)\n    return FileAsset(scratch_dir / str(plot_name + \".png\"))\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plot_task_arbitrary_locus/","title":"gwaslab_region_plot_task_arbitrary_locus","text":""},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plot_task_arbitrary_locus/#mecfs_bio.build_system.task.gwaslab.gwaslab_region_plot_task_arbitrary_locus","title":"mecfs_bio.build_system.task.gwaslab.gwaslab_region_plot_task_arbitrary_locus","text":"<p>Classes:</p> <ul> <li> <code>GwasLabRegionPlotTargetLocusTask</code>           \u2013            <p>A task to generate region plots around arbitrary locus in genome.</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plot_task_arbitrary_locus/#mecfs_bio.build_system.task.gwaslab.gwaslab_region_plot_task_arbitrary_locus.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plot_task_arbitrary_locus/#mecfs_bio.build_system.task.gwaslab.gwaslab_region_plot_task_arbitrary_locus.GwasLabRegionPlotTargetLocusTask","title":"GwasLabRegionPlotTargetLocusTask","text":"<p>               Bases: <code>Task</code></p> <p>A task to generate region plots around arbitrary locus in genome.</p> <p>Useful for visualizing the local significance structure  see https://cloufield.github.io/gwaslab/tutorial_3.4/#quick-regional-plot-without-ld-information Gwaslab can also use a vcf reference file to plot the linkage disequilibrium structure around the lead variants (vcf_name_for_lead_variants).  Doing this at a reasonable speed requires the installation of the \"tabix\" binary.</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>buffer</code>               (<code>int</code>)           \u2013            </li> <li> <code>chrom</code>               (<code>int</code>)           \u2013            </li> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>pos</code>               (<code>int</code>)           \u2013            </li> <li> <code>vcf_name_for_ld</code>               (<code>GWASLabVCFRefFile | None</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plot_task_arbitrary_locus/#mecfs_bio.build_system.task.gwaslab.gwaslab_region_plot_task_arbitrary_locus.GwasLabRegionPlotTargetLocusTask.buffer","title":"buffer  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>buffer: int = 500000\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plot_task_arbitrary_locus/#mecfs_bio.build_system.task.gwaslab.gwaslab_region_plot_task_arbitrary_locus.GwasLabRegionPlotTargetLocusTask.chrom","title":"chrom  <code>instance-attribute</code>","text":"<pre><code>chrom: int\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plot_task_arbitrary_locus/#mecfs_bio.build_system.task.gwaslab.gwaslab_region_plot_task_arbitrary_locus.GwasLabRegionPlotTargetLocusTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plot_task_arbitrary_locus/#mecfs_bio.build_system.task.gwaslab.gwaslab_region_plot_task_arbitrary_locus.GwasLabRegionPlotTargetLocusTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plot_task_arbitrary_locus/#mecfs_bio.build_system.task.gwaslab.gwaslab_region_plot_task_arbitrary_locus.GwasLabRegionPlotTargetLocusTask.pos","title":"pos  <code>instance-attribute</code>","text":"<pre><code>pos: int\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plot_task_arbitrary_locus/#mecfs_bio.build_system.task.gwaslab.gwaslab_region_plot_task_arbitrary_locus.GwasLabRegionPlotTargetLocusTask.vcf_name_for_ld","title":"vcf_name_for_ld  <code>instance-attribute</code>","text":"<pre><code>vcf_name_for_ld: GWASLabVCFRefFile | None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plot_task_arbitrary_locus/#mecfs_bio.build_system.task.gwaslab.gwaslab_region_plot_task_arbitrary_locus.GwasLabRegionPlotTargetLocusTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    sumstats_task: GWASLabCreateSumstatsTask,\n    vcf_name_for_ld: GWASLabVCFRefFile | None,\n    chrom: int,\n    pos: int,\n    buffer: int = 500000,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_region_plot_task_arbitrary_locus.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    sumstats_task: GWASLabCreateSumstatsTask,\n    vcf_name_for_ld: GWASLabVCFRefFile | None,\n    chrom: int,\n    pos: int,\n    buffer: int = 500_000,\n):\n    reference_meta = sumstats_task.meta\n    assert isinstance(reference_meta, GWASLabSumStatsMeta)\n    meta = GWASLabRegionPlotsMeta(\n        trait=reference_meta.trait,\n        project=reference_meta.project,\n        id=AssetId(asset_id),\n        sub_dir=PurePath(\"analysis\") / \"region_plots\",\n    )\n    return cls(\n        meta=meta,\n        sumstats_task=sumstats_task,\n        vcf_name_for_ld=vcf_name_for_ld,\n        chrom=chrom,\n        pos=pos,\n        buffer=buffer,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plot_task_arbitrary_locus/#mecfs_bio.build_system.task.gwaslab.gwaslab_region_plot_task_arbitrary_locus.GwasLabRegionPlotTargetLocusTask.execute","title":"execute","text":"<pre><code>execute(\n    scratch_dir: Path, fetch: Fetch, wf: WF\n) -&gt; DirectoryAsset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_region_plot_task_arbitrary_locus.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; DirectoryAsset:\n    target_path = scratch_dir / \"plot_dir\"\n    target_path.mkdir(parents=True, exist_ok=True)\n    sumstats = read_sumstats(fetch(self._sumstats_id))\n\n    plot_region_around_variant(\n        sumstats=sumstats,\n        vcf_name_for_ld=self.vcf_name_for_ld,\n        chrom=self.chrom,\n        pos=self.pos,\n        buffer=self.buffer,\n        output_path=target_path / \"region_plot.png\",\n    )\n    return DirectoryAsset(\n        path=target_path,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plots_task/","title":"gwaslab_region_plots_task","text":""},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plots_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_region_plots_task","title":"mecfs_bio.build_system.task.gwaslab.gwaslab_region_plots_task","text":"<p>Classes:</p> <ul> <li> <code>GwasLabRegionPlotsFromLeadVariantsTask</code>           \u2013            <p>A task to generate region plots near the lead variants described by GWAS summary statistics</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>get_top_var_df</code>             \u2013              </li> <li> <code>plot_region_around_variant</code>             \u2013              </li> <li> <code>plot_region_around_variants</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plots_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_region_plots_task.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plots_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_region_plots_task.GwasLabRegionPlotsFromLeadVariantsTask","title":"GwasLabRegionPlotsFromLeadVariantsTask","text":"<p>               Bases: <code>Task</code></p> <p>A task to generate region plots near the lead variants described by GWAS summary statistics Useful for visualizing the local significance structure around lead variants, and their nearby genes.  see https://cloufield.github.io/gwaslab/tutorial_3.4/#quick-regional-plot-without-ld-information Gwaslab can also use a vcf reference file to plot the linkage disequilibrium structure around the lead variants (vcf_name_for_lead_variants).  Doing this at a reasonable speed requires the installation of the \"tabix\" binary.</p> <p>Methods:</p> <ul> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>GWASLabRegionPlotsMeta</code>)           \u2013            </li> <li> <code>plot_top</code>               (<code>int | None</code>)           \u2013            </li> <li> <code>short_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>vcf_name_for_ld</code>               (<code>GWASLabVCFRefFile | None</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plots_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_region_plots_task.GwasLabRegionPlotsFromLeadVariantsTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plots_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_region_plots_task.GwasLabRegionPlotsFromLeadVariantsTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: GWASLabRegionPlotsMeta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plots_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_region_plots_task.GwasLabRegionPlotsFromLeadVariantsTask.plot_top","title":"plot_top  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>plot_top: int | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plots_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_region_plots_task.GwasLabRegionPlotsFromLeadVariantsTask.short_id","title":"short_id  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>short_id: AssetId = field(converter=AssetId)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plots_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_region_plots_task.GwasLabRegionPlotsFromLeadVariantsTask.vcf_name_for_ld","title":"vcf_name_for_ld  <code>instance-attribute</code>","text":"<pre><code>vcf_name_for_ld: GWASLabVCFRefFile | None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plots_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_region_plots_task.GwasLabRegionPlotsFromLeadVariantsTask.execute","title":"execute","text":"<pre><code>execute(\n    scratch_dir: Path, fetch: Fetch, wf: WF\n) -&gt; DirectoryAsset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_region_plots_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; DirectoryAsset:\n    target_path = scratch_dir / \"plot_dir\"\n    target_path.mkdir(parents=True, exist_ok=True)\n    sumstats = read_sumstats(fetch(self._sumstats_id))\n    variant_df = (\n        scan_dataframe_asset(\n            asset=fetch(self._lead_variants_id), meta=self._lead_variants_task_meta\n        )\n        .collect()\n        .to_pandas()\n    )\n    variant_df = get_top_var_df(variant_df, plot_top=self.plot_top)\n    variants = df_to_variants(variant_df)\n    plot_region_around_variants(\n        sumstats=sumstats,\n        variants=variants,\n        output_dir=target_path,\n        vcf_name_for_ld=self.vcf_name_for_ld,\n    )\n    return DirectoryAsset(\n        path=target_path,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plots_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_region_plots_task.get_top_var_df","title":"get_top_var_df","text":"<pre><code>get_top_var_df(\n    df: DataFrame, plot_top: int | None\n) -&gt; pd.DataFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_region_plots_task.py</code> <pre><code>def get_top_var_df(df: pd.DataFrame, plot_top: int | None) -&gt; pd.DataFrame:\n    if plot_top is None:\n        return df\n    if \"P\" in df.columns:\n        return df.sort_values(by=\"P\").iloc[:plot_top]\n    if \"MLOG10P\" in df.columns:\n        return df.sort_values(by=\"MLOG10P\", ascending=False).iloc[:plot_top]\n    raise ValueError(\n        f\"task attempted to plot top variants, but neither P nor MLOG10P was in the variant dataframe. columns were: {df.columns}\"\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plots_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_region_plots_task.plot_region_around_variant","title":"plot_region_around_variant","text":"<pre><code>plot_region_around_variant(\n    sumstats: Sumstats,\n    chrom: int,\n    pos: int,\n    buffer: int,\n    output_path: Path,\n    vcf_name_for_ld: GWASLabVCFRefFile | None,\n) -&gt; None\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_region_plots_task.py</code> <pre><code>def plot_region_around_variant(\n    sumstats: gl.Sumstats,\n    chrom: int,\n    pos: int,\n    buffer: int,\n    output_path: Path,\n    vcf_name_for_ld: GWASLabVCFRefFile | None,\n) -&gt; None:\n    output_path.parent.mkdir(parents=True, exist_ok=True)\n    if vcf_name_for_ld is not None:\n        gwaslab_download_ref_if_missing(vcf_name_for_ld)\n        vcf_path = gl.get_path(vcf_name_for_ld)\n    else:\n        vcf_path = None\n    scaled = \"MLOG10P\" in sumstats.data.columns\n    sumstats.plot_mqq(\n        mode=\"r\",\n        skip=2,\n        cut=20,\n        scaled=scaled,\n        region_grid=True,\n        region=(chrom, max(pos - buffer, 0), pos + buffer),\n        save=str(\n            output_path,\n        ),\n        save_args={\"dpi\": 400, \"facecolor\": \"white\"},\n        vcf_path=vcf_path,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_region_plots_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_region_plots_task.plot_region_around_variants","title":"plot_region_around_variants","text":"<pre><code>plot_region_around_variants(\n    sumstats: Sumstats,\n    variants: Sequence[Variant],\n    output_dir: Path,\n    vcf_name_for_ld: GWASLabVCFRefFile | None,\n    buffer: int = 500000,\n) -&gt; None\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_region_plots_task.py</code> <pre><code>def plot_region_around_variants(\n    sumstats: gl.Sumstats,\n    variants: Sequence[Variant],\n    output_dir: Path,\n    vcf_name_for_ld: GWASLabVCFRefFile | None,\n    buffer: int = 500_000,\n) -&gt; None:\n    for variant in variants:\n        logger.debug(f\"Creating region plot around variant {variant.id}\")\n        plot_region_around_variant(\n            sumstats=sumstats,\n            chrom=variant.chromosome,\n            pos=variant.position,\n            buffer=buffer,\n            output_path=output_dir / str(variant.id_normalized + \".png\"),\n            vcf_name_for_ld=vcf_name_for_ld,\n        )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_snp_heritability_by_ldsc_task/","title":"gwaslab_snp_heritability_by_ldsc_task","text":""},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_snp_heritability_by_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_snp_heritability_by_ldsc_task","title":"mecfs_bio.build_system.task.gwaslab.gwaslab_snp_heritability_by_ldsc_task","text":"<p>This task uses GWASLAB's wrapper around the original LDSC code to estimate compute heritability by ld-score regression.</p> <p>While LDSC is a useful and powerful technique, its results should be taken with a grain of salt.</p> <p>Here is a discussion (which covers both single and cross-trait analysis) from chapter 23 of the Handbook of Statistical Genomics: Balding, David J., Ida Moltke, and John Marioni, eds. Handbook of statistical genomics. John Wiley &amp; Sons, 2019. Chapter authors are S. Burgess, C.N. Foley and V. Zuber</p> <p>\" A criticism of LD score regression is that every analysis for each pair of traits uses the same LD scores as the dependent variable in the regression model (and as LD scores have been precomputed by its proponents, literally the same LD scores are used in the majority of applied analyses). This means that any influential points in the regression will affect not only one LD score regression analysis, but all such analyses. LD scores are also likely to be a \u2018weak instrument\u2019 in the language of Mendelian randomization, as they will only explain a small proportion of variance in the dependent variable. Additionally, due to the scale of the data, it is not possible to provide a visual representation of an LD score regression analysis. Standard regression diagnostics are rarely, if ever, performed. Finally, results from LD score regression are not always consistent with known causal relationships; for example, the method did not find evidence for a genetic correlation between LDL cholesterol and CHD risk that survived a multiple testing correction (Bulik-Sullivan et al., 2015). The method has utility in mapping the genetic distance between related phenotypes, such as determining how closely related different psychiatric disorders are in terms of their genetic predictors (Cross-Disorder Group of the Psychiatric Genomics Consortium, 2013). However, the reliance of the method on numerous linearity and independence assumptions, incorrect weighting in the linear regression model (correct weights would require computation of the Cholesky decomposition of a matrix with dimension equal to the number of genetic variants in the model \u2013 misspecified weights are recommended for use in practice), and lack of validation against known causal relationships mean that results from the method should not be treated too seriously as an assessment of causality. \"</p> <p>Classes:</p> <ul> <li> <code>SNPHeritabilityByLDSCTask</code>           \u2013            </li> </ul> <p>Attributes:</p> <ul> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_snp_heritability_by_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_snp_heritability_by_ldsc_task.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_snp_heritability_by_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_snp_heritability_by_ldsc_task.SNPHeritabilityByLDSCTask","title":"SNPHeritabilityByLDSCTask","text":"<p>               Bases: <code>Task</code></p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>ld_file_filename_pattern</code>               (<code>str</code>)           \u2013            </li> <li> <code>ld_ref_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>set_N</code>               (<code>int | None</code>)           \u2013            </li> <li> <code>source_sumstats_task</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_snp_heritability_by_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_snp_heritability_by_ldsc_task.SNPHeritabilityByLDSCTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_snp_heritability_by_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_snp_heritability_by_ldsc_task.SNPHeritabilityByLDSCTask.ld_file_filename_pattern","title":"ld_file_filename_pattern  <code>instance-attribute</code>","text":"<pre><code>ld_file_filename_pattern: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_snp_heritability_by_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_snp_heritability_by_ldsc_task.SNPHeritabilityByLDSCTask.ld_ref_task","title":"ld_ref_task  <code>instance-attribute</code>","text":"<pre><code>ld_ref_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_snp_heritability_by_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_snp_heritability_by_ldsc_task.SNPHeritabilityByLDSCTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_snp_heritability_by_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_snp_heritability_by_ldsc_task.SNPHeritabilityByLDSCTask.set_N","title":"set_N  <code>instance-attribute</code>","text":"<pre><code>set_N: int | None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_snp_heritability_by_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_snp_heritability_by_ldsc_task.SNPHeritabilityByLDSCTask.source_sumstats_task","title":"source_sumstats_task  <code>instance-attribute</code>","text":"<pre><code>source_sumstats_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_snp_heritability_by_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_snp_heritability_by_ldsc_task.SNPHeritabilityByLDSCTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    source_sumstats_task: Task,\n    ld_ref_task: Task,\n    set_sample_size: int | None = None,\n    ld_file_filename_pattern: str = \"/LDscore.@\",\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_snp_heritability_by_ldsc_task.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    source_sumstats_task: Task,\n    ld_ref_task: Task,\n    set_sample_size: int | None = None,\n    ld_file_filename_pattern: str = \"/LDscore.@\",\n):\n    sumstats_meta = source_sumstats_task.meta\n    assert isinstance(sumstats_meta, GWASLabSumStatsMeta)\n    meta = ResultTableMeta(\n        id=asset_id,\n        trait=sumstats_meta.trait,\n        project=sumstats_meta.project,\n        sub_dir=PurePath(\"analysis\"),\n        extension=\".csv\",\n    )\n    return cls(\n        meta=meta,\n        source_sumstats_task=source_sumstats_task,\n        ld_ref_task=ld_ref_task,\n        ld_file_filename_pattern=ld_file_filename_pattern,\n        set_N=set_sample_size,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_snp_heritability_by_ldsc_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_snp_heritability_by_ldsc_task.SNPHeritabilityByLDSCTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_snp_heritability_by_ldsc_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    sumstats_asset = fetch(self._source_sumstats_id)\n    sumstats = read_sumstats(sumstats_asset)\n    ref_id = self._ld_ref_id()\n    ref_asset = fetch(ref_id)\n    assert isinstance(ref_asset, DirectoryAsset)\n    if self.set_N is not None:\n        sumstats.data[GWASLAB_SAMPLE_SIZE_COLUMN] = self.set_N\n    sumstats.estimate_h2_by_ldsc(\n        ref_ld_chr=str(ref_asset.path) + self.ld_file_filename_pattern,\n        w_ld_chr=str(ref_asset.path) + self.ld_file_filename_pattern,\n    )\n    out_df: pd.DataFrame = sumstats.ldsc_h2\n    logger.debug(\n        f\"ldsc_h2_results:\\n{out_df}\",\n    )\n    out_path = scratch_dir / \"ldsc_h2.csv\"\n    out_df.to_csv(out_path, index=False)\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_sumstats_to_table_task/","title":"gwaslab_sumstats_to_table_task","text":""},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_sumstats_to_table_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_sumstats_to_table_task","title":"mecfs_bio.build_system.task.gwaslab.gwaslab_sumstats_to_table_task","text":"<p>Classes:</p> <ul> <li> <code>GwasLabSumstatsToTableTask</code>           \u2013            <p>Task to write a sumstats object to a plain table for further processing.</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_sumstats_to_table_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_sumstats_to_table_task.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_sumstats_to_table_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_sumstats_to_table_task.GwasLabSumstatsToTableTask","title":"GwasLabSumstatsToTableTask","text":"<p>               Bases: <code>Task</code></p> <p>Task to write a sumstats object to a plain table for further processing.</p> <p>Methods:</p> <ul> <li> <code>create_from_source_task</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>source_asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>source_meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>source_sumstats_task</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_sumstats_to_table_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_sumstats_to_table_task.GwasLabSumstatsToTableTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_sumstats_to_table_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_sumstats_to_table_task.GwasLabSumstatsToTableTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_sumstats_to_table_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_sumstats_to_table_task.GwasLabSumstatsToTableTask.pipe","title":"pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_sumstats_to_table_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_sumstats_to_table_task.GwasLabSumstatsToTableTask.source_asset_id","title":"source_asset_id  <code>property</code>","text":"<pre><code>source_asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_sumstats_to_table_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_sumstats_to_table_task.GwasLabSumstatsToTableTask.source_meta","title":"source_meta  <code>property</code>","text":"<pre><code>source_meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_sumstats_to_table_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_sumstats_to_table_task.GwasLabSumstatsToTableTask.source_sumstats_task","title":"source_sumstats_task  <code>instance-attribute</code>","text":"<pre><code>source_sumstats_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_sumstats_to_table_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_sumstats_to_table_task.GwasLabSumstatsToTableTask.create_from_source_task","title":"create_from_source_task  <code>classmethod</code>","text":"<pre><code>create_from_source_task(\n    source_tsk: Task,\n    asset_id: str,\n    sub_dir: str,\n    pipe: DataProcessingPipe = IdentityPipe(),\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_sumstats_to_table_task.py</code> <pre><code>@classmethod\ndef create_from_source_task(\n    cls,\n    source_tsk: Task,\n    asset_id: str,\n    sub_dir: str,\n    pipe: DataProcessingPipe = IdentityPipe(),\n):\n    source_meta = source_tsk.meta\n    assert isinstance(source_meta, GWASLabSumStatsMeta)\n    meta = FilteredGWASDataMeta(\n        id=AssetId(asset_id),\n        trait=source_meta.trait,\n        project=source_meta.project,\n        sub_dir=sub_dir,\n        read_spec=DataFrameReadSpec(format=DataFrameParquetFormat()),\n    )\n    return cls(meta=meta, source_sumstats_task=source_tsk, pipe=pipe)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_sumstats_to_table_task/#mecfs_bio.build_system.task.gwaslab.gwaslab_sumstats_to_table_task.GwasLabSumstatsToTableTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_sumstats_to_table_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    asset = fetch(self.source_asset_id)\n    sumstats = read_sumstats(asset)\n    df: pd.DataFrame = sumstats.data\n    logger.debug(f\"Post sumstats df has shape {df.shape}\")\n    n_df = narwhals.from_native(df).lazy()\n    df = self.pipe.process(n_df).collect().to_pandas()\n    logger.debug(f\"Post pipe df has shape {df.shape}\")\n    out_loc = scratch_dir / \"data.parquet\"\n    df.to_parquet(out_loc, index=False)\n    return FileAsset(path=out_loc)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_transform_sumstats/","title":"gwaslab_transform_sumstats","text":""},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_transform_sumstats/#mecfs_bio.build_system.task.gwaslab.gwaslab_transform_sumstats","title":"mecfs_bio.build_system.task.gwaslab.gwaslab_transform_sumstats","text":"<p>Contains a task for transforming gwaslab Sumstats objefts.</p> <p>Classes:</p> <ul> <li> <code>GWASLabTransformSumstatsTask</code>           \u2013            <p>Task to read a pickled GWASlab sumstats object, apply transformations to it, write it out as a new GWASLab sumstats object.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_transform_sumstats/#mecfs_bio.build_system.task.gwaslab.gwaslab_transform_sumstats.GWASLabTransformSumstatsTask","title":"GWASLabTransformSumstatsTask","text":"<p>               Bases: <code>Task</code></p> <p>Task to read a pickled GWASlab sumstats object, apply transformations to it, write it out as a new GWASLab sumstats object.</p> <p>Methods:</p> <ul> <li> <code>create_from_source_task</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>post_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>source_asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>source_meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>source_sumstats_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>transform_spec</code>               (<code>GwasLabTransformSpec</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_transform_sumstats/#mecfs_bio.build_system.task.gwaslab.gwaslab_transform_sumstats.GWASLabTransformSumstatsTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_transform_sumstats/#mecfs_bio.build_system.task.gwaslab.gwaslab_transform_sumstats.GWASLabTransformSumstatsTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_transform_sumstats/#mecfs_bio.build_system.task.gwaslab.gwaslab_transform_sumstats.GWASLabTransformSumstatsTask.post_pipe","title":"post_pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>post_pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_transform_sumstats/#mecfs_bio.build_system.task.gwaslab.gwaslab_transform_sumstats.GWASLabTransformSumstatsTask.source_asset_id","title":"source_asset_id  <code>property</code>","text":"<pre><code>source_asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_transform_sumstats/#mecfs_bio.build_system.task.gwaslab.gwaslab_transform_sumstats.GWASLabTransformSumstatsTask.source_meta","title":"source_meta  <code>property</code>","text":"<pre><code>source_meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_transform_sumstats/#mecfs_bio.build_system.task.gwaslab.gwaslab_transform_sumstats.GWASLabTransformSumstatsTask.source_sumstats_task","title":"source_sumstats_task  <code>instance-attribute</code>","text":"<pre><code>source_sumstats_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_transform_sumstats/#mecfs_bio.build_system.task.gwaslab.gwaslab_transform_sumstats.GWASLabTransformSumstatsTask.transform_spec","title":"transform_spec  <code>instance-attribute</code>","text":"<pre><code>transform_spec: GwasLabTransformSpec\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_transform_sumstats/#mecfs_bio.build_system.task.gwaslab.gwaslab_transform_sumstats.GWASLabTransformSumstatsTask.create_from_source_task","title":"create_from_source_task  <code>classmethod</code>","text":"<pre><code>create_from_source_task(\n    source_tsk: Task,\n    asset_id: str,\n    spec: GwasLabTransformSpec,\n    post_pipe: DataProcessingPipe = IdentityPipe(),\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_transform_sumstats.py</code> <pre><code>@classmethod\ndef create_from_source_task(\n    cls,\n    source_tsk: Task,\n    asset_id: str,\n    spec: GwasLabTransformSpec,\n    post_pipe: DataProcessingPipe = IdentityPipe(),\n):\n    source_meta = source_tsk.meta\n    assert isinstance(source_meta, GWASLabSumStatsMeta)\n    meta = GWASLabSumStatsMeta(\n        id=AssetId(asset_id),\n        trait=source_meta.trait,\n        project=source_meta.project,\n        sub_dir=source_meta.sub_dir,\n    )\n    return cls(\n        meta=meta,\n        source_sumstats_task=source_tsk,\n        transform_spec=spec,\n        post_pipe=post_pipe,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_transform_sumstats/#mecfs_bio.build_system.task.gwaslab.gwaslab_transform_sumstats.GWASLabTransformSumstatsTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_transform_sumstats.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    asset = fetch(self.source_asset_id)\n    sumstats = read_sumstats(asset)\n    sumstats = transform_gwaslab_sumstats(\n        sumstats,\n        spec=self.transform_spec,\n    )\n    sumstats.data = self.post_pipe.process_pandas(sumstats.data)\n    out_path = scratch_dir / \"pickled_sumstats.pickle\"\n    gl.dump_pickle(sumstats, path=out_path)\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_util/","title":"gwaslab_util","text":""},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_util/#mecfs_bio.build_system.task.gwaslab.gwaslab_util","title":"mecfs_bio.build_system.task.gwaslab.gwaslab_util","text":"<p>Classes:</p> <ul> <li> <code>Variant</code>           \u2013            <p>Represents a genetic variant.</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>df_to_variants</code>             \u2013              </li> <li> <code>gwaslab_download_ref_if_missing</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_util/#mecfs_bio.build_system.task.gwaslab.gwaslab_util.Variant","title":"Variant","text":"<p>Represents a genetic variant.</p> <p>Attributes:</p> <ul> <li> <code>chromosome</code>               (<code>int</code>)           \u2013            </li> <li> <code>effect_allele</code>               (<code>str</code>)           \u2013            </li> <li> <code>id</code>               (<code>str</code>)           \u2013            </li> <li> <code>id_normalized</code>               (<code>str</code>)           \u2013            </li> <li> <code>non_effect_allele</code>               (<code>str</code>)           \u2013            </li> <li> <code>position</code>               (<code>int</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_util/#mecfs_bio.build_system.task.gwaslab.gwaslab_util.Variant.chromosome","title":"chromosome  <code>instance-attribute</code>","text":"<pre><code>chromosome: int\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_util/#mecfs_bio.build_system.task.gwaslab.gwaslab_util.Variant.effect_allele","title":"effect_allele  <code>instance-attribute</code>","text":"<pre><code>effect_allele: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_util/#mecfs_bio.build_system.task.gwaslab.gwaslab_util.Variant.id","title":"id  <code>property</code>","text":"<pre><code>id: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_util/#mecfs_bio.build_system.task.gwaslab.gwaslab_util.Variant.id_normalized","title":"id_normalized  <code>property</code>","text":"<pre><code>id_normalized: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_util/#mecfs_bio.build_system.task.gwaslab.gwaslab_util.Variant.non_effect_allele","title":"non_effect_allele  <code>instance-attribute</code>","text":"<pre><code>non_effect_allele: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_util/#mecfs_bio.build_system.task.gwaslab.gwaslab_util.Variant.position","title":"position  <code>instance-attribute</code>","text":"<pre><code>position: int\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_util/#mecfs_bio.build_system.task.gwaslab.gwaslab_util.df_to_variants","title":"df_to_variants","text":"<pre><code>df_to_variants(df: DataFrame) -&gt; list[Variant]\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_util.py</code> <pre><code>def df_to_variants(df: pd.DataFrame) -&gt; list[Variant]:\n    return [\n        Variant(\n            chromosome=df[GWASLAB_CHROM_COL].iloc[i],\n            position=df[GWASLAB_POS_COL].iloc[i],\n            effect_allele=df[GWASLAB_EFFECT_ALLELE_COL].iloc[i],\n            non_effect_allele=df[GWASLAB_NON_EFFECT_ALLELE_COL].iloc[i],\n        )\n        for i in range(len(df))\n    ]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/gwaslab_util/#mecfs_bio.build_system.task.gwaslab.gwaslab_util.gwaslab_download_ref_if_missing","title":"gwaslab_download_ref_if_missing","text":"<pre><code>gwaslab_download_ref_if_missing(ref: str) -&gt; Path\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/gwaslab_util.py</code> <pre><code>def gwaslab_download_ref_if_missing(ref: str) -&gt; Path:\n    result = gl.get_path(ref)\n    if not result:\n        gl.download_ref(ref)\n        result = gl.get_path(ref)\n    return result\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/sldsc_scatter_plot_task/","title":"sldsc_scatter_plot_task","text":""},{"location":"reference/mecfs_bio/build_system/task/gwaslab/sldsc_scatter_plot_task/#mecfs_bio.build_system.task.gwaslab.sldsc_scatter_plot_task","title":"mecfs_bio.build_system.task.gwaslab.sldsc_scatter_plot_task","text":"<p>Classes:</p> <ul> <li> <code>SLDSCScatterPlotTask</code>           \u2013            <p>Generate a plot from the resulting of applying S-LDSC to GWAS summary statistics</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/sldsc_scatter_plot_task/#mecfs_bio.build_system.task.gwaslab.sldsc_scatter_plot_task.SLDSCScatterPlotTask","title":"SLDSCScatterPlotTask","text":"<p>               Bases: <code>Task</code></p> <p>Generate a plot from the resulting of applying S-LDSC to GWAS summary statistics using GTEx and Franke lab reference data.</p> <p>Intended to mimic the appearance of the plots in Finucane, Hilary K., et al. \"Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types.\" Nature genetics 50.4 (2018): 621-629.</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>df_source_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/sldsc_scatter_plot_task/#mecfs_bio.build_system.task.gwaslab.sldsc_scatter_plot_task.SLDSCScatterPlotTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/sldsc_scatter_plot_task/#mecfs_bio.build_system.task.gwaslab.sldsc_scatter_plot_task.SLDSCScatterPlotTask.df_source_task","title":"df_source_task  <code>instance-attribute</code>","text":"<pre><code>df_source_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/sldsc_scatter_plot_task/#mecfs_bio.build_system.task.gwaslab.sldsc_scatter_plot_task.SLDSCScatterPlotTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/sldsc_scatter_plot_task/#mecfs_bio.build_system.task.gwaslab.sldsc_scatter_plot_task.SLDSCScatterPlotTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(asset_id: str, source_task: Task)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/sldsc_scatter_plot_task.py</code> <pre><code>@classmethod\ndef create(cls, asset_id: str, source_task: Task):\n    source_meta = source_task.meta\n    assert isinstance(source_meta, ResultTableMeta)\n    meta = GWASPlotDirectoryMeta(\n        trait=source_meta.trait,\n        project=source_meta.project,\n        id=AssetId(asset_id),\n    )\n    return cls(\n        meta=meta,\n        df_source_task=source_task,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/gwaslab/sldsc_scatter_plot_task/#mecfs_bio.build_system.task.gwaslab.sldsc_scatter_plot_task.SLDSCScatterPlotTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/gwaslab/sldsc_scatter_plot_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    df_asset = fetch(self._source_id)\n    df = (\n        scan_dataframe_asset(df_asset, meta=self._source_meta).collect().to_pandas()\n    )\n    df = df.sort_values(by=[\"Category\", \"Name\"])\n    df[\"mlog10p\"] = -np.log10(df[\"Coefficient_P_value\"])\n    df[\"tissue_or_cell\"] = np.arange(len(df))\n    df[\"Category\"] = df[\"Category\"].str.title()\n    df[\"Category\"] = df[\"Category\"].str.replace(\"Cns\", \"CNS\")\n    df[\"marker_size\"] = 4.5 * df[REJECT_NULL_LABEL] + 0.5\n    fig = px.scatter(\n        df,\n        x=\"tissue_or_cell\",\n        y=\"mlog10p\",\n        color=\"Category\",\n        hover_name=\"Name\",\n        size=\"marker_size\",\n        hover_data={\n            \"Name\": True,\n            \"Category\": True,\n            \"mlog10p\": True,\n            \"marker_size\": False,\n            \"tissue_or_cell\": False,\n        },\n        template=\"plotly_white\",\n        labels={\"mlog10p\": \"-log\\u2081\\u2080p\", \"tissue_or_cell\": \"Tissue or Cell\"},\n    )\n    fig = fig.update_layout(\n        font=dict(size=17),\n        legend=dict(\n            orientation=\"h\",\n            yanchor=\"bottom\",\n            y=0,\n            xanchor=\"center\",\n            x=0.5,\n            yref=\"container\",\n            title=dict(\n                side=\"top\",\n            ),\n        ),\n        margin=dict(l=0, r=0, t=2, b=2),\n    )\n    fig = fig.update_xaxes(showticklabels=False, showgrid=False, zeroline=False)\n    fig = fig.update_yaxes(showgrid=False)\n    figs = {}\n    figs[\"sldsc_scatter\"] = fig\n    out_dir = scratch_dir / \"scatter_plots\"\n    write_plots_to_dir(out_dir, figs)\n    return DirectoryAsset(out_dir)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles/","title":"harmonize_gwas_with_reference_table_via_chrom_pos_alleles","text":""},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_chrom_pos_alleles","title":"mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_chrom_pos_alleles","text":"<p>Given a table of reference genetic variants, harmonize gwas data with that table of reference variants using chromosome, position, alleles for matching</p> <p>Classes:</p> <ul> <li> <code>ChromRange</code>           \u2013            </li> <li> <code>HarmonizeGWASWithReferenceViaAlleles</code>           \u2013            <p>Given a table of reference genetic variants, harmonize gwas data with that table of reference variants</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_chrom_pos_alleles.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_chrom_pos_alleles.ChromRange","title":"ChromRange","text":"<p>Attributes:</p> <ul> <li> <code>chrom</code>               (<code>int</code>)           \u2013            </li> <li> <code>end</code>               (<code>int</code>)           \u2013            </li> <li> <code>start</code>               (<code>int</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_chrom_pos_alleles.ChromRange.chrom","title":"chrom  <code>instance-attribute</code>","text":"<pre><code>chrom: int\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_chrom_pos_alleles.ChromRange.end","title":"end  <code>instance-attribute</code>","text":"<pre><code>end: int\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_chrom_pos_alleles.ChromRange.start","title":"start  <code>instance-attribute</code>","text":"<pre><code>start: int\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_chrom_pos_alleles.HarmonizeGWASWithReferenceViaAlleles","title":"HarmonizeGWASWithReferenceViaAlleles","text":"<p>               Bases: <code>Task</code></p> <p>Given a table of reference genetic variants, harmonize gwas data with that table of reference variants using chromosome, position, alleles for matching</p> <p>In this context harmonization means: For non-palindromic variants:    - keep only variants where:       -- effect and non-effect allele match  or,       --effect allele matches reference non-effect allele, and vice versa.  In this case, flip beta and invert odds ratio</p> <p>For palindromic variants: - drop if we lack frequency information - Else, can try to use frequency info to resolve</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>chrom_range_filter</code>               (<code>ChromRange | None</code>)           \u2013            </li> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>gwas_data_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>gwas_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>palindrome_strategy</code>               (<code>PalindromeStrategy</code>)           \u2013            </li> <li> <code>ref_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>reference_asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>reference_meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>reference_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>source_gwas_asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>source_gwas_meta</code>               (<code>Meta</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_chrom_pos_alleles.HarmonizeGWASWithReferenceViaAlleles.chrom_range_filter","title":"chrom_range_filter  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>chrom_range_filter: ChromRange | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_chrom_pos_alleles.HarmonizeGWASWithReferenceViaAlleles.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_chrom_pos_alleles.HarmonizeGWASWithReferenceViaAlleles.gwas_data_task","title":"gwas_data_task  <code>instance-attribute</code>","text":"<pre><code>gwas_data_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_chrom_pos_alleles.HarmonizeGWASWithReferenceViaAlleles.gwas_pipe","title":"gwas_pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>gwas_pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_chrom_pos_alleles.HarmonizeGWASWithReferenceViaAlleles.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_chrom_pos_alleles.HarmonizeGWASWithReferenceViaAlleles.palindrome_strategy","title":"palindrome_strategy  <code>instance-attribute</code>","text":"<pre><code>palindrome_strategy: PalindromeStrategy\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_chrom_pos_alleles.HarmonizeGWASWithReferenceViaAlleles.ref_pipe","title":"ref_pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>ref_pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_chrom_pos_alleles.HarmonizeGWASWithReferenceViaAlleles.reference_asset_id","title":"reference_asset_id  <code>property</code>","text":"<pre><code>reference_asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_chrom_pos_alleles.HarmonizeGWASWithReferenceViaAlleles.reference_meta","title":"reference_meta  <code>property</code>","text":"<pre><code>reference_meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_chrom_pos_alleles.HarmonizeGWASWithReferenceViaAlleles.reference_task","title":"reference_task  <code>instance-attribute</code>","text":"<pre><code>reference_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_chrom_pos_alleles.HarmonizeGWASWithReferenceViaAlleles.source_gwas_asset_id","title":"source_gwas_asset_id  <code>property</code>","text":"<pre><code>source_gwas_asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_chrom_pos_alleles.HarmonizeGWASWithReferenceViaAlleles.source_gwas_meta","title":"source_gwas_meta  <code>property</code>","text":"<pre><code>source_gwas_meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_chrom_pos_alleles.HarmonizeGWASWithReferenceViaAlleles.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    gwas_data_task: Task,\n    reference_task: Task,\n    palindrome_strategy: PalindromeStrategy,\n    gwas_pipe: DataProcessingPipe = IdentityPipe(),\n    ref_pipe: DataProcessingPipe = IdentityPipe(),\n    chrom_range_filter: ChromRange | None = None,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    gwas_data_task: Task,\n    reference_task: Task,\n    palindrome_strategy: PalindromeStrategy,\n    gwas_pipe: DataProcessingPipe = IdentityPipe(),\n    ref_pipe: DataProcessingPipe = IdentityPipe(),\n    chrom_range_filter: ChromRange | None = None,\n):\n    source_meta = gwas_data_task.meta\n    read_spec = DataFrameReadSpec(DataFrameParquetFormat())\n    meta: Meta\n    if isinstance(source_meta, FilteredGWASDataMeta):\n        meta = FilteredGWASDataMeta(\n            id=AssetId(asset_id),\n            trait=source_meta.trait,\n            project=source_meta.project,\n            sub_dir=source_meta.sub_dir,\n            read_spec=read_spec,\n        )\n    elif isinstance(source_meta, GWASSummaryDataFileMeta):\n        meta = GWASSummaryDataFileMeta(\n            id=AssetId(asset_id),\n            trait=source_meta.trait,\n            project=source_meta.project,\n            sub_dir=source_meta.sub_dir,\n            project_path=None,\n            read_spec=read_spec,\n        )\n    return cls(\n        meta=meta,\n        gwas_data_task=gwas_data_task,\n        reference_task=reference_task,\n        palindrome_strategy=palindrome_strategy,\n        gwas_pipe=gwas_pipe,\n        ref_pipe=ref_pipe,\n        chrom_range_filter=chrom_range_filter,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_chrom_pos_alleles.HarmonizeGWASWithReferenceViaAlleles.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_chrom_pos_alleles.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    gwas_asset = fetch(self.source_gwas_asset_id)\n    gwas_data = (\n        self.gwas_pipe.process(\n            scan_dataframe_asset(gwas_asset, meta=self.source_gwas_meta)\n        )\n        .collect()\n        .to_polars()\n    )\n\n    reference_asset = fetch(self.reference_asset_id)\n    reference = (\n        self.ref_pipe.process(\n            scan_dataframe_asset(reference_asset, meta=self.reference_meta)\n        )\n        .collect()\n        .to_polars()\n    )\n\n    assert len(\n        gwas_data.unique(\n            subset=[\n                GWASLAB_CHROM_COL,\n                GWASLAB_POS_COL,\n                GWASLAB_EFFECT_ALLELE_COL,\n                GWASLAB_NON_EFFECT_ALLELE_COL,\n            ]\n        )\n    ) == len(gwas_data)\n\n    assert len(\n        reference.unique(\n            subset=[\n                GWASLAB_CHROM_COL,\n                GWASLAB_POS_COL,\n                GWASLAB_EFFECT_ALLELE_COL,\n                GWASLAB_NON_EFFECT_ALLELE_COL,\n            ]\n        )\n    ) == len(reference)\n\n    reference = reference.select(\n        [\n            GWASLAB_CHROM_COL,\n            GWASLAB_POS_COL,\n            GWASLAB_EFFECT_ALLELE_COL,\n            GWASLAB_NON_EFFECT_ALLELE_COL,\n        ]\n    ).rename(\n        {\n            GWASLAB_EFFECT_ALLELE_COL: REFERENCE_EFFECT_ALLELE,\n            GWASLAB_NON_EFFECT_ALLELE_COL: REFERENCE_NON_EFFECT_ALLELE,\n            GWASLAB_POS_COL: REFERENCE_POS,\n            GWASLAB_CHROM_COL: REFERENCE_CHROM,\n        }\n    )\n\n    gd = gwas_data.with_columns(\n        is_palindromic_expr(\n            GWASLAB_EFFECT_ALLELE_COL, nea_col=GWASLAB_NON_EFFECT_ALLELE_COL\n        ).alias(IS_PALINDROMIC)\n    )\n\n    if self.palindrome_strategy == \"drop\":\n        logger.debug(f\"dropping {gd[IS_PALINDROMIC].sum()} palindromic variants\")\n        gd = gd.filter(~pl.col(IS_PALINDROMIC))\n    elif self.palindrome_strategy == \"keep\":\n        logger.debug(f\"keeping {gd[IS_PALINDROMIC].sum()} palindromic variants\")\n    else:\n        raise NotImplementedError(\n            f\"mode {self.palindrome_strategy} not implemented\"\n        )\n    gd = _filter_chrom_range(gd, chrom_range=self.chrom_range_filter)\n\n    gd_match = gd.join(\n        reference,\n        left_on=[\n            GWASLAB_CHROM_COL,\n            GWASLAB_POS_COL,\n            GWASLAB_EFFECT_ALLELE_COL,\n            GWASLAB_NON_EFFECT_ALLELE_COL,\n        ],\n        right_on=[\n            REFERENCE_CHROM,\n            REFERENCE_POS,\n            REFERENCE_EFFECT_ALLELE,\n            REFERENCE_NON_EFFECT_ALLELE,\n        ],\n    ).with_columns(\n        pl.lit(False).alias(MATCH_REFERENCE_FLIPPED),\n        pl.lit(True).alias(MATCH_REFERENCE),\n    )\n    gd_reverse_match = gd.join(\n        reference,\n        left_on=[\n            GWASLAB_CHROM_COL,\n            GWASLAB_POS_COL,\n            GWASLAB_EFFECT_ALLELE_COL,\n            GWASLAB_NON_EFFECT_ALLELE_COL,\n        ],\n        right_on=[\n            REFERENCE_CHROM,\n            REFERENCE_POS,\n            REFERENCE_NON_EFFECT_ALLELE,\n            REFERENCE_EFFECT_ALLELE,\n        ],\n    ).with_columns(\n        pl.lit(True).alias(MATCH_REFERENCE_FLIPPED),\n        pl.lit(False).alias(MATCH_REFERENCE),\n    )\n    logger.debug(\n        f\"Example matching alleles:\\n {gd_match.select(GWASLAB_CHROM_COL, GWASLAB_POS_COL, GWASLAB_EFFECT_ALLELE_COL, GWASLAB_NON_EFFECT_ALLELE_COL).head()}\"\n    )\n    logger.debug(\n        f\"Example flipped alleles:\\n {gd_reverse_match.select(GWASLAB_CHROM_COL, GWASLAB_POS_COL, GWASLAB_EFFECT_ALLELE_COL, GWASLAB_NON_EFFECT_ALLELE_COL).head()}\"\n    )\n    gd = pl.concat([gd_match, gd_reverse_match], how=\"vertical\")\n    gd = handle_flipped(gd)\n    _report_matches(gd)\n    gd = gd.drop(_REF_COLS_ALLELE_MATCH)\n    out_path = scratch_dir / \"matched_to_ref.parquet\"\n    gd.write_parquet(out_path)\n\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/","title":"harmonize_gwas_with_reference_table_via_rsid","text":""},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid","title":"mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid","text":"<p>Given a table of reference genetic variants, harmonize gwas data with that table of reference variants using rsid for matching</p> <p>Classes:</p> <ul> <li> <code>HarmonizeGWASWithReferenceViaRSIDTask</code>           \u2013            <p>Given a table of reference genetic variants, harmonize gwas data with that table of reference variants using rsid for matching</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>complement_reverse_expr</code>             \u2013              </li> <li> <code>handle_flipped</code>             \u2013              </li> <li> <code>handle_mismatched_alleles</code>             \u2013              </li> <li> <code>is_palindromic_expr</code>             \u2013              <p>Check if a variant is palindromic.</p> </li> <li> <code>match_flipped_reference_expr</code>             \u2013              </li> <li> <code>match_reference_expr</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>ChromPosStrategy</code>           \u2013            </li> <li> <code>IS_PALINDROMIC</code>           \u2013            </li> <li> <code>MATCH_REFERENCE</code>           \u2013            </li> <li> <code>MATCH_REFERENCE_FLIPPED</code>           \u2013            </li> <li> <code>MismatchedAllelesStrategy</code>           \u2013            </li> <li> <code>PalindromeStrategy</code>           \u2013            </li> <li> <code>REFERENCE_CHROM</code>           \u2013            </li> <li> <code>REFERENCE_EFFECT_ALLELE</code>           \u2013            </li> <li> <code>REFERENCE_NON_EFFECT_ALLELE</code>           \u2013            </li> <li> <code>REFERENCE_POS</code>           \u2013            </li> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.ChromPosStrategy","title":"ChromPosStrategy  <code>module-attribute</code>","text":"<pre><code>ChromPosStrategy = Literal['drop', 'raise']\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.IS_PALINDROMIC","title":"IS_PALINDROMIC  <code>module-attribute</code>","text":"<pre><code>IS_PALINDROMIC = '__is_palindromic__'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.MATCH_REFERENCE","title":"MATCH_REFERENCE  <code>module-attribute</code>","text":"<pre><code>MATCH_REFERENCE = '__MATCH_REFERENCE__'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.MATCH_REFERENCE_FLIPPED","title":"MATCH_REFERENCE_FLIPPED  <code>module-attribute</code>","text":"<pre><code>MATCH_REFERENCE_FLIPPED = '__MATCH_REFERENCE_FLIPPED__'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.MismatchedAllelesStrategy","title":"MismatchedAllelesStrategy  <code>module-attribute</code>","text":"<pre><code>MismatchedAllelesStrategy = Literal['drop', 'raise']\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.PalindromeStrategy","title":"PalindromeStrategy  <code>module-attribute</code>","text":"<pre><code>PalindromeStrategy = Literal['drop', 'resolve', 'keep']\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.REFERENCE_CHROM","title":"REFERENCE_CHROM  <code>module-attribute</code>","text":"<pre><code>REFERENCE_CHROM = '__reference_chrom__'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.REFERENCE_EFFECT_ALLELE","title":"REFERENCE_EFFECT_ALLELE  <code>module-attribute</code>","text":"<pre><code>REFERENCE_EFFECT_ALLELE = '__reference_effect_allele__'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.REFERENCE_NON_EFFECT_ALLELE","title":"REFERENCE_NON_EFFECT_ALLELE  <code>module-attribute</code>","text":"<pre><code>REFERENCE_NON_EFFECT_ALLELE = (\n    \"__reference_non_effect_allele__\"\n)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.REFERENCE_POS","title":"REFERENCE_POS  <code>module-attribute</code>","text":"<pre><code>REFERENCE_POS = '__reference_pos__'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.HarmonizeGWASWithReferenceViaRSIDTask","title":"HarmonizeGWASWithReferenceViaRSIDTask","text":"<p>               Bases: <code>Task</code></p> <p>Given a table of reference genetic variants, harmonize gwas data with that table of reference variants using rsid for matching</p> <p>In this context harmonization means: For non-palindromic variants:    - keep only variants where:       -- effect and non-effect allele match the reference, or       --effect allele matches reference non-effect allele, and vice versa.  In this case, flip beta and invert odds ratio</p> <p>For palindromic variants: - drop if we lack frequency information - Else, can try to use frequency info to resolve</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>chrom_pos_strategy</code>               (<code>ChromPosStrategy</code>)           \u2013            </li> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>gwas_data_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>gwas_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>mismatched_alleles_strategy</code>               (<code>MismatchedAllelesStrategy</code>)           \u2013            </li> <li> <code>palindrome_strategy</code>               (<code>PalindromeStrategy</code>)           \u2013            </li> <li> <code>ref_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>reference_asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>reference_meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>reference_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>source_gwas_asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>source_gwas_meta</code>               (<code>Meta</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.HarmonizeGWASWithReferenceViaRSIDTask.chrom_pos_strategy","title":"chrom_pos_strategy  <code>instance-attribute</code>","text":"<pre><code>chrom_pos_strategy: ChromPosStrategy\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.HarmonizeGWASWithReferenceViaRSIDTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.HarmonizeGWASWithReferenceViaRSIDTask.gwas_data_task","title":"gwas_data_task  <code>instance-attribute</code>","text":"<pre><code>gwas_data_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.HarmonizeGWASWithReferenceViaRSIDTask.gwas_pipe","title":"gwas_pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>gwas_pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.HarmonizeGWASWithReferenceViaRSIDTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.HarmonizeGWASWithReferenceViaRSIDTask.mismatched_alleles_strategy","title":"mismatched_alleles_strategy  <code>instance-attribute</code>","text":"<pre><code>mismatched_alleles_strategy: MismatchedAllelesStrategy\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.HarmonizeGWASWithReferenceViaRSIDTask.palindrome_strategy","title":"palindrome_strategy  <code>instance-attribute</code>","text":"<pre><code>palindrome_strategy: PalindromeStrategy\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.HarmonizeGWASWithReferenceViaRSIDTask.ref_pipe","title":"ref_pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>ref_pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.HarmonizeGWASWithReferenceViaRSIDTask.reference_asset_id","title":"reference_asset_id  <code>property</code>","text":"<pre><code>reference_asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.HarmonizeGWASWithReferenceViaRSIDTask.reference_meta","title":"reference_meta  <code>property</code>","text":"<pre><code>reference_meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.HarmonizeGWASWithReferenceViaRSIDTask.reference_task","title":"reference_task  <code>instance-attribute</code>","text":"<pre><code>reference_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.HarmonizeGWASWithReferenceViaRSIDTask.source_gwas_asset_id","title":"source_gwas_asset_id  <code>property</code>","text":"<pre><code>source_gwas_asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.HarmonizeGWASWithReferenceViaRSIDTask.source_gwas_meta","title":"source_gwas_meta  <code>property</code>","text":"<pre><code>source_gwas_meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.HarmonizeGWASWithReferenceViaRSIDTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    gwas_data_task: Task,\n    reference_task: Task,\n    palindrome_strategy: PalindromeStrategy,\n    chrom_pos_strategy: ChromPosStrategy,\n    mismatched_alleles_strategy: MismatchedAllelesStrategy,\n    gwas_pipe: DataProcessingPipe = IdentityPipe(),\n    ref_pipe: DataProcessingPipe = IdentityPipe(),\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    gwas_data_task: Task,\n    reference_task: Task,\n    palindrome_strategy: PalindromeStrategy,\n    chrom_pos_strategy: ChromPosStrategy,\n    mismatched_alleles_strategy: MismatchedAllelesStrategy,\n    gwas_pipe: DataProcessingPipe = IdentityPipe(),\n    ref_pipe: DataProcessingPipe = IdentityPipe(),\n):\n    source_meta = gwas_data_task.meta\n    read_spec = DataFrameReadSpec(DataFrameParquetFormat())\n    meta: Meta\n    if isinstance(source_meta, FilteredGWASDataMeta):\n        meta = FilteredGWASDataMeta(\n            id=AssetId(asset_id),\n            trait=source_meta.trait,\n            project=source_meta.project,\n            sub_dir=source_meta.sub_dir,\n            read_spec=read_spec,\n        )\n    elif isinstance(source_meta, GWASSummaryDataFileMeta):\n        meta = GWASSummaryDataFileMeta(\n            id=AssetId(asset_id),\n            trait=source_meta.trait,\n            project=source_meta.project,\n            sub_dir=source_meta.sub_dir,\n            project_path=None,\n            read_spec=read_spec,\n        )\n    return cls(\n        meta=meta,\n        gwas_data_task=gwas_data_task,\n        reference_task=reference_task,\n        palindrome_strategy=palindrome_strategy,\n        chrom_pos_strategy=chrom_pos_strategy,\n        mismatched_alleles_strategy=mismatched_alleles_strategy,\n        gwas_pipe=gwas_pipe,\n        ref_pipe=ref_pipe,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.HarmonizeGWASWithReferenceViaRSIDTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    gwas_asset = fetch(self.source_gwas_asset_id)\n    gwas_data = (\n        self.gwas_pipe.process(\n            scan_dataframe_asset(gwas_asset, meta=self.source_gwas_meta)\n        )\n        .collect()\n        .to_polars()\n    )\n    assert GWASLAB_RSID_COL in gwas_data.columns\n\n    reference_asset = fetch(self.reference_asset_id)\n    reference = (\n        self.ref_pipe.process(\n            scan_dataframe_asset(reference_asset, meta=self.reference_meta)\n        )\n        .collect()\n        .to_polars()\n    )\n    assert GWASLAB_RSID_COL in reference.columns\n    reference = reference.rename(\n        {\n            GWASLAB_EFFECT_ALLELE_COL: REFERENCE_EFFECT_ALLELE,\n            GWASLAB_NON_EFFECT_ALLELE_COL: REFERENCE_NON_EFFECT_ALLELE,\n            GWASLAB_POS_COL: REFERENCE_POS,\n            GWASLAB_CHROM_COL: REFERENCE_CHROM,\n        }\n    )\n\n    assert (\n        reference[GWASLAB_RSID_COL].n_unique() == reference[GWASLAB_RSID_COL].len()\n    )\n    assert (\n        gwas_data[GWASLAB_RSID_COL].n_unique() == gwas_data[GWASLAB_RSID_COL].len()\n    )\n\n    gd = gwas_data.with_columns(\n        is_palindromic_expr(\n            GWASLAB_EFFECT_ALLELE_COL, nea_col=GWASLAB_NON_EFFECT_ALLELE_COL\n        ).alias(IS_PALINDROMIC)\n    )\n\n    gd = gd.join(reference, on=GWASLAB_RSID_COL)\n    if self.palindrome_strategy == \"drop\":\n        logger.debug(f\"Dropping {gd[IS_PALINDROMIC].sum()} palindromic variants\\n\")\n        gd = gd.filter(~pl.col(IS_PALINDROMIC))\n    elif self.palindrome_strategy == \"keep\":\n        logger.debug(f\"Keeping {gd[IS_PALINDROMIC].sum()} palindromic variants\\n\")\n    else:\n        raise NotImplementedError(\n            f\"mode {self.palindrome_strategy} not implemented\"\n        )\n    gd = gd.with_columns(\n        _mismatch_pos_or_chrom_expr(\n            pos_col=GWASLAB_POS_COL,\n            chrom_col=GWASLAB_CHROM_COL,\n            ref_pos_col=REFERENCE_POS,\n            ref_chrom_col=REFERENCE_CHROM,\n        ).alias(_MISMATCH_POS_CHROM),\n        match_reference_expr(\n            ea_col=GWASLAB_EFFECT_ALLELE_COL,\n            nea_col=GWASLAB_NON_EFFECT_ALLELE_COL,\n            ref_ea_col=REFERENCE_EFFECT_ALLELE,\n            ref_nea_col=REFERENCE_NON_EFFECT_ALLELE,\n        ).alias(MATCH_REFERENCE),\n        match_flipped_reference_expr(\n            ea_col=GWASLAB_EFFECT_ALLELE_COL,\n            nea_col=GWASLAB_NON_EFFECT_ALLELE_COL,\n            ref_ea_col=REFERENCE_EFFECT_ALLELE,\n            ref_nea_col=REFERENCE_NON_EFFECT_ALLELE,\n        ).alias(MATCH_REFERENCE_FLIPPED),\n    )\n\n    gd = _handle_chrom_pos(gd, self.chrom_pos_strategy)\n    gd = handle_flipped(gd)\n    _report_matches(gd)\n    gd = handle_mismatched_alleles(gd, strategy=self.mismatched_alleles_strategy)\n    gd = gd.drop(_REF_COLS)\n    logger.debug(f\"harmonized gwas has length: {len(gd)}\")\n    out_path = scratch_dir / \"matched_to_ref.parquet\"\n    gd.write_parquet(out_path)\n\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.complement_reverse_expr","title":"complement_reverse_expr","text":"<pre><code>complement_reverse_expr(col_name: str) -&gt; pl.Expr\n</code></pre> Source code in <code>mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid.py</code> <pre><code>def complement_reverse_expr(col_name: str) -&gt; pl.Expr:\n    return (\n        pl.col(col_name)\n        .str.replace_all(\"A\", \"X\")\n        .str.replace_all(\"T\", \"A\")\n        .str.replace_all(\"X\", \"T\")\n        .str.replace_all(\"C\", \"Y\")\n        .str.replace_all(\"G\", \"C\")\n        .str.replace_all(\"Y\", \"G\")\n        .str.reverse()\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.handle_flipped","title":"handle_flipped","text":"<pre><code>handle_flipped(df: DataFrame) -&gt; pl.DataFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid.py</code> <pre><code>def handle_flipped(\n    df: pl.DataFrame,\n) -&gt; pl.DataFrame:\n    df = df.with_columns(\n        pl.when(MATCH_REFERENCE_FLIPPED)\n        .then(pl.col(GWASLAB_NON_EFFECT_ALLELE_COL))\n        .otherwise(pl.col(GWASLAB_EFFECT_ALLELE_COL))\n        .alias(GWASLAB_EFFECT_ALLELE_COL),\n        pl.when(MATCH_REFERENCE_FLIPPED)\n        .then(pl.col(GWASLAB_EFFECT_ALLELE_COL))\n        .otherwise(pl.col(GWASLAB_NON_EFFECT_ALLELE_COL))\n        .alias(GWASLAB_NON_EFFECT_ALLELE_COL),\n        pl.when(MATCH_REFERENCE_FLIPPED)\n        .then(-pl.col(GWASLAB_BETA_COL))\n        .otherwise(pl.col(GWASLAB_BETA_COL))\n        .alias(GWASLAB_BETA_COL),\n    )\n    if GWASLAB_ODDS_RATIO_COL in df.columns:\n        df = df.with_columns(\n            pl.when(MATCH_REFERENCE_FLIPPED)\n            .then(\n                1 / pl.col(GWASLAB_ODDS_RATIO_COL),\n            )\n            .otherwise(pl.col(GWASLAB_ODDS_RATIO_COL))\n            .alias(GWASLAB_ODDS_RATIO_COL),\n        )\n    if GWASLAB_EFFECT_ALLELE_FREQ_COL in df.columns:\n        df = df.with_columns(\n            pl.when(MATCH_REFERENCE_FLIPPED)\n            .then(1 - pl.col(GWASLAB_EFFECT_ALLELE_FREQ_COL))\n            .otherwise(pl.col(GWASLAB_EFFECT_ALLELE_FREQ_COL))\n            .alias(GWASLAB_EFFECT_ALLELE_FREQ_COL),\n        )\n    return df\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.handle_mismatched_alleles","title":"handle_mismatched_alleles","text":"<pre><code>handle_mismatched_alleles(\n    df: DataFrame, strategy: MismatchedAllelesStrategy\n) -&gt; pl.DataFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid.py</code> <pre><code>def handle_mismatched_alleles(\n    df: pl.DataFrame, strategy: MismatchedAllelesStrategy\n) -&gt; pl.DataFrame:\n    mismatched = (~(df[MATCH_REFERENCE])) &amp; (~(df[MATCH_REFERENCE_FLIPPED]))\n    num_mismatch = (mismatched).sum()\n    msg = f\"Found {num_mismatch} variants with matching rsid but mismatched alleles\"\n    if num_mismatch &gt; 0:\n        if strategy == \"raise\":\n            raise ValueError(msg)\n        logger.debug(msg)\n        df = df.filter(~mismatched)\n    return df\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.is_palindromic_expr","title":"is_palindromic_expr","text":"<pre><code>is_palindromic_expr(ea_col: str, nea_col: str) -&gt; pl.Expr\n</code></pre> <p>Check if a variant is palindromic.</p> Source code in <code>mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid.py</code> <pre><code>def is_palindromic_expr(ea_col: str, nea_col: str) -&gt; pl.Expr:\n    \"\"\"\n    Check if a variant is palindromic.\n    \"\"\"\n    return pl.col(ea_col) == complement_reverse_expr(nea_col)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.match_flipped_reference_expr","title":"match_flipped_reference_expr","text":"<pre><code>match_flipped_reference_expr(\n    ea_col: str,\n    nea_col: str,\n    ref_ea_col: str,\n    ref_nea_col: str,\n) -&gt; pl.Expr\n</code></pre> Source code in <code>mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid.py</code> <pre><code>def match_flipped_reference_expr(\n    ea_col: str,\n    nea_col: str,\n    ref_ea_col: str,\n    ref_nea_col: str,\n) -&gt; pl.Expr:\n    return (pl.col(ea_col) == pl.col(ref_nea_col)) &amp; (\n        pl.col(nea_col) == pl.col(ref_ea_col)\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid/#mecfs_bio.build_system.task.harmonize_gwas_with_reference_table_via_rsid.match_reference_expr","title":"match_reference_expr","text":"<pre><code>match_reference_expr(\n    ea_col: str,\n    nea_col: str,\n    ref_ea_col: str,\n    ref_nea_col: str,\n) -&gt; pl.Expr\n</code></pre> Source code in <code>mecfs_bio/build_system/task/harmonize_gwas_with_reference_table_via_rsid.py</code> <pre><code>def match_reference_expr(\n    ea_col: str,\n    nea_col: str,\n    ref_ea_col: str,\n    ref_nea_col: str,\n) -&gt; pl.Expr:\n    return (pl.col(ea_col) == pl.col(ref_ea_col)) &amp; (\n        pl.col(nea_col) == pl.col(ref_nea_col)\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/join_dataframes_task/","title":"join_dataframes_task","text":""},{"location":"reference/mecfs_bio/build_system/task/join_dataframes_task/#mecfs_bio.build_system.task.join_dataframes_task","title":"mecfs_bio.build_system.task.join_dataframes_task","text":"<p>Task to perform a SQL-style join.</p> <p>Classes:</p> <ul> <li> <code>JoinDataFramesTask</code>           \u2013            <p>Task to load to dataframes, join them, and then write out the resulting dataframe.</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/join_dataframes_task/#mecfs_bio.build_system.task.join_dataframes_task.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/join_dataframes_task/#mecfs_bio.build_system.task.join_dataframes_task.JoinDataFramesTask","title":"JoinDataFramesTask","text":"<p>               Bases: <code>Task</code></p> <p>Task to load to dataframes, join them, and then write out the resulting dataframe.</p> <p>By default, writes as csv.</p> <p>Methods:</p> <ul> <li> <code>create_from_result_df</code>             \u2013              <p>Join a result dataframe to a reference dataframe.</p> </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>backend</code>               (<code>ValidBackend</code>)           \u2013            </li> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>df_1_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>df_2_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>how</code>               (<code>JoinStrategy</code>)           \u2013            </li> <li> <code>left_on</code>               (<code>Sequence[str]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>out_format</code>               (<code>OutFormat</code>)           \u2013            </li> <li> <code>out_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>right_on</code>               (<code>Sequence[str]</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/join_dataframes_task/#mecfs_bio.build_system.task.join_dataframes_task.JoinDataFramesTask.backend","title":"backend  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>backend: ValidBackend = 'polars'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/join_dataframes_task/#mecfs_bio.build_system.task.join_dataframes_task.JoinDataFramesTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/join_dataframes_task/#mecfs_bio.build_system.task.join_dataframes_task.JoinDataFramesTask.df_1_pipe","title":"df_1_pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>df_1_pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/join_dataframes_task/#mecfs_bio.build_system.task.join_dataframes_task.JoinDataFramesTask.df_2_pipe","title":"df_2_pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>df_2_pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/join_dataframes_task/#mecfs_bio.build_system.task.join_dataframes_task.JoinDataFramesTask.how","title":"how  <code>instance-attribute</code>","text":"<pre><code>how: JoinStrategy\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/join_dataframes_task/#mecfs_bio.build_system.task.join_dataframes_task.JoinDataFramesTask.left_on","title":"left_on  <code>instance-attribute</code>","text":"<pre><code>left_on: Sequence[str]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/join_dataframes_task/#mecfs_bio.build_system.task.join_dataframes_task.JoinDataFramesTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/join_dataframes_task/#mecfs_bio.build_system.task.join_dataframes_task.JoinDataFramesTask.out_format","title":"out_format  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>out_format: OutFormat = CSVOutFormat(sep=',')\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/join_dataframes_task/#mecfs_bio.build_system.task.join_dataframes_task.JoinDataFramesTask.out_pipe","title":"out_pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>out_pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/join_dataframes_task/#mecfs_bio.build_system.task.join_dataframes_task.JoinDataFramesTask.right_on","title":"right_on  <code>instance-attribute</code>","text":"<pre><code>right_on: Sequence[str]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/join_dataframes_task/#mecfs_bio.build_system.task.join_dataframes_task.JoinDataFramesTask.create_from_result_df","title":"create_from_result_df  <code>classmethod</code>","text":"<pre><code>create_from_result_df(\n    asset_id: str,\n    result_df_task: Task,\n    reference_df_task,\n    how: JoinStrategy,\n    left_on: Sequence[str],\n    right_on: Sequence[str],\n    out_format: OutFormat = CSVOutFormat(sep=\",\"),\n    df_1_pipe: DataProcessingPipe = IdentityPipe(),\n    df_2_pipe: DataProcessingPipe = IdentityPipe(),\n    out_pipe: DataProcessingPipe = IdentityPipe(),\n    backend: ValidBackend = \"polars\",\n)\n</code></pre> <p>Join a result dataframe to a reference dataframe.</p> Source code in <code>mecfs_bio/build_system/task/join_dataframes_task.py</code> <pre><code>@classmethod\ndef create_from_result_df(\n    cls,\n    asset_id: str,\n    result_df_task: Task,\n    reference_df_task,\n    how: JoinStrategy,\n    left_on: Sequence[str],\n    right_on: Sequence[str],\n    out_format: OutFormat = CSVOutFormat(sep=\",\"),\n    df_1_pipe: DataProcessingPipe = IdentityPipe(),\n    df_2_pipe: DataProcessingPipe = IdentityPipe(),\n    out_pipe: DataProcessingPipe = IdentityPipe(),\n    backend: ValidBackend = \"polars\",\n):\n    \"\"\"\n    Join a result dataframe to a reference dataframe.\n    \"\"\"\n    extension, read_spec = get_extension_and_read_spec_from_format(\n        out_format=out_format\n    )\n    source_meta = result_df_task.meta\n    meta: Meta\n    if isinstance(source_meta, ResultTableMeta):\n        meta = ResultTableMeta(\n            id=AssetId(asset_id),\n            trait=source_meta.trait,\n            project=source_meta.project,\n            extension=extension,\n            read_spec=read_spec,\n        )\n    elif isinstance(source_meta, FilteredGWASDataMeta):\n        meta = FilteredGWASDataMeta(\n            id=AssetId(asset_id),\n            trait=source_meta.trait,\n            project=source_meta.project,\n            extension=extension,\n            read_spec=read_spec,\n            sub_dir=source_meta.sub_dir,\n        )\n    elif isinstance(source_meta, GWASLabLeadVariantsMeta):\n        meta = ResultTableMeta(\n            id=AssetId(asset_id),\n            trait=source_meta.trait,\n            project=source_meta.project,\n            extension=extension,\n            read_spec=read_spec,\n            sub_dir=source_meta.sub_dir,\n        )\n    elif isinstance(source_meta, ReferenceFileMeta):\n        meta = ReferenceFileMeta(\n            id=AssetId(asset_id),\n            group=source_meta.group,\n            sub_group=source_meta.sub_group,\n            sub_folder=source_meta.sub_folder,\n            extension=extension,\n            read_spec=read_spec,\n        )\n    else:\n        raise ValueError(f\"Source meta has unknown type: {source_meta}\")\n    return cls(\n        df_1_task=result_df_task,\n        df_2_task=reference_df_task,\n        how=how,\n        left_on=left_on,\n        right_on=right_on,\n        meta=meta,\n        df_1_pipe=df_1_pipe,\n        df_2_pipe=df_2_pipe,\n        out_format=out_format,\n        backend=backend,\n        out_pipe=out_pipe,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/join_dataframes_task/#mecfs_bio.build_system.task.join_dataframes_task.JoinDataFramesTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/join_dataframes_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    result_path = scratch_dir / \"result.csv\"\n    asset_1 = fetch(self._df_1_id)\n    df_1 = scan_dataframe_asset(\n        asset_1, meta=self._df_1_meta, parquet_backend=self.backend\n    )\n    df_1 = self.df_1_pipe.process(df_1)\n    asset_2 = fetch(self._df_12_id)\n    df_2 = scan_dataframe_asset(\n        asset_2, meta=self._df_2_meta, parquet_backend=self.backend\n    )\n    df_2 = self.df_2_pipe.process(df_2)\n    joined = df_1.join(\n        df_2, how=self.how, left_on=list(self.left_on), right_on=list(self.right_on)\n    )\n    joined = self.out_pipe.process(joined)\n    if isinstance(self.out_format, CSVOutFormat):\n        result = joined.collect().to_pandas()\n        result.to_csv(result_path, index=False, sep=self.out_format.sep)\n    elif isinstance(self.out_format, ParquetOutFormat):\n        joined.sink_parquet(result_path)\n    return FileAsset(result_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/","title":"magma","text":""},{"location":"reference/mecfs_bio/build_system/task/magma/#mecfs_bio.build_system.task.magma","title":"mecfs_bio.build_system.task.magma","text":"<p>Tasks that are part of the workflow of GWAS-tool MAGMA (Multi-marker Analysis of GenoMic Annotation).</p> <p>Modules:</p> <ul> <li> <code>magma_annotate_task</code>           \u2013            </li> <li> <code>magma_forward_stepwise_select_task</code>           \u2013            </li> <li> <code>magma_gene_analysis_task</code>           \u2013            </li> <li> <code>magma_gene_set_analysis_task</code>           \u2013            </li> <li> <code>magma_plot_brain_atlas_result_with_stepwise_labels</code>           \u2013            </li> <li> <code>magma_plot_gene_set_result</code>           \u2013            </li> <li> <code>magma_snp_location_task</code>           \u2013            </li> <li> <code>magma_subset_specificity_matrix_using_top_labels</code>           \u2013            </li> <li> <code>plot_magma_brain_atlas_result</code>           \u2013            <p>Task to  plot the results of applying MAGMA using the human brain atlas as a reference.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_annotate_task/","title":"magma_annotate_task","text":""},{"location":"reference/mecfs_bio/build_system/task/magma/magma_annotate_task/#mecfs_bio.build_system.task.magma.magma_annotate_task","title":"mecfs_bio.build_system.task.magma.magma_annotate_task","text":"<p>Classes:</p> <ul> <li> <code>MagmaAnnotateTask</code>           \u2013            <p>Perform the annotate step of the MAGMA pipeline.</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_annotate_task/#mecfs_bio.build_system.task.magma.magma_annotate_task.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_annotate_task/#mecfs_bio.build_system.task.magma.magma_annotate_task.MagmaAnnotateTask","title":"MagmaAnnotateTask","text":"<p>               Bases: <code>Task</code></p> <p>Perform the annotate step of the MAGMA pipeline. This step associates SNPs with genes. See page 5 of the MAGMA manual here: https://vu.data.surfsara.nl/s/MUiv3y1SFRePnyG?dir=/&amp;editing=false&amp;openfile=true</p> <p>The window option is used to optionally associate SNPs outside the transcription region of a gene with the gene.</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>gene_loc_file_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>gene_loc_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>magma_binary_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>magma_binary_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>snp_loc_file_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>snp_loc_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>window</code>               (<code>tuple[int, int] | None</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_annotate_task/#mecfs_bio.build_system.task.magma.magma_annotate_task.MagmaAnnotateTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_annotate_task/#mecfs_bio.build_system.task.magma.magma_annotate_task.MagmaAnnotateTask.gene_loc_file_task","title":"gene_loc_file_task  <code>instance-attribute</code>","text":"<pre><code>gene_loc_file_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_annotate_task/#mecfs_bio.build_system.task.magma.magma_annotate_task.MagmaAnnotateTask.gene_loc_id","title":"gene_loc_id  <code>property</code>","text":"<pre><code>gene_loc_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_annotate_task/#mecfs_bio.build_system.task.magma.magma_annotate_task.MagmaAnnotateTask.magma_binary_id","title":"magma_binary_id  <code>property</code>","text":"<pre><code>magma_binary_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_annotate_task/#mecfs_bio.build_system.task.magma.magma_annotate_task.MagmaAnnotateTask.magma_binary_task","title":"magma_binary_task  <code>instance-attribute</code>","text":"<pre><code>magma_binary_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_annotate_task/#mecfs_bio.build_system.task.magma.magma_annotate_task.MagmaAnnotateTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_annotate_task/#mecfs_bio.build_system.task.magma.magma_annotate_task.MagmaAnnotateTask.snp_loc_file_task","title":"snp_loc_file_task  <code>instance-attribute</code>","text":"<pre><code>snp_loc_file_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_annotate_task/#mecfs_bio.build_system.task.magma.magma_annotate_task.MagmaAnnotateTask.snp_loc_id","title":"snp_loc_id  <code>property</code>","text":"<pre><code>snp_loc_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_annotate_task/#mecfs_bio.build_system.task.magma.magma_annotate_task.MagmaAnnotateTask.window","title":"window  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>window: tuple[int, int] | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_annotate_task/#mecfs_bio.build_system.task.magma.magma_annotate_task.MagmaAnnotateTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    magma_binary_task: Task,\n    snp_loc_file_task: Task,\n    gene_loc_file_task: Task,\n    window: tuple[int, int] | None = None,\n) -&gt; MagmaAnnotateTask\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_annotate_task.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    magma_binary_task: Task,\n    snp_loc_file_task: Task,\n    gene_loc_file_task: Task,\n    window: tuple[int, int] | None = None,\n) -&gt; \"MagmaAnnotateTask\":\n    snp_loc_meta = snp_loc_file_task.meta\n    assert isinstance(snp_loc_meta, FilteredGWASDataMeta)\n    meta = FilteredGWASDataMeta(\n        id=AssetId(asset_id),\n        trait=snp_loc_meta.trait,\n        project=snp_loc_meta.project,\n        sub_dir=PurePath(snp_loc_meta.sub_dir) / \"magma\",\n        extension=\".genes.annot\",\n    )\n    return cls(\n        meta=meta,\n        magma_binary_task=magma_binary_task,\n        snp_loc_file_task=snp_loc_file_task,\n        gene_loc_file_task=gene_loc_file_task,\n        window=window,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_annotate_task/#mecfs_bio.build_system.task.magma.magma_annotate_task.MagmaAnnotateTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_annotate_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    binary_asset = fetch(self.magma_binary_id)\n    snp_loc_asset = fetch(self.snp_loc_id)\n    gene_loc_asset = fetch(self.gene_loc_id)\n    assert isinstance(binary_asset, FileAsset)\n    assert isinstance(snp_loc_asset, FileAsset)\n    assert isinstance(gene_loc_asset, FileAsset)\n    binary_path = binary_asset.path\n    snp_loc_path = snp_loc_asset.path\n    gene_loc_path = gene_loc_asset.path\n    out_base_path = scratch_dir / \"out_base\"\n    cmd = [\n        str(binary_path),\n        \"--annotate\",\n    ]\n    if self.window is not None:\n        cmd.extend([f\"window={self.window[0]},{self.window[1]}\"])\n    cmd += [\n        \"--snp-loc\",\n        str(snp_loc_path),\n        \"--gene-loc\",\n        str(gene_loc_path),\n        \"--out\",\n        str(out_base_path),\n    ]\n    logger.debug(f\"Running command: {' '.join(cmd)}\")\n    result = execute_command(cmd)\n    logger.debug(f\"Command produced result: \\n\\n{result}\\n\\n\\n\")\n    out_full_path = Path(str(out_base_path) + \".genes.annot\")\n    return FileAsset(out_full_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task/","title":"magma_forward_stepwise_select_task","text":""},{"location":"reference/mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task/#mecfs_bio.build_system.task.magma.magma_forward_stepwise_select_task","title":"mecfs_bio.build_system.task.magma.magma_forward_stepwise_select_task","text":"<p>Classes:</p> <ul> <li> <code>MagmaForwardStepwiseSelectTask</code>           \u2013            <ul> <li>Since the gene expression patterns of many cell types are highly correlated, it can be difficult</li> </ul> </li> </ul> <p>Functions:</p> <ul> <li> <code>generate_mappers_from_wide_dataframe</code>             \u2013              </li> <li> <code>generate_wide_dataframe</code>             \u2013              <p>Based on https://github.com/Integrative-Mental-Health-Lab/linking_cell_types_to_brain_phenotypes/blob/675b5c9b58b8762934183a3ca61ae49ad587934a/MAGMA/5.forward_selection_condition_results.md</p> </li> <li> <code>get_retained_clusters</code>             \u2013              </li> <li> <code>independent</code>             \u2013              </li> <li> <code>pairwise_independent</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>P_COND_COLUMN</code>           \u2013            </li> <li> <code>P_MARG_COLUMN</code>           \u2013            </li> <li> <code>RETAINED_CLUSTERS_COLUMN</code>           \u2013            </li> <li> <code>VARCODE_COLUMN</code>           \u2013            </li> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task/#mecfs_bio.build_system.task.magma.magma_forward_stepwise_select_task.P_COND_COLUMN","title":"P_COND_COLUMN  <code>module-attribute</code>","text":"<pre><code>P_COND_COLUMN = 'P_COND'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task/#mecfs_bio.build_system.task.magma.magma_forward_stepwise_select_task.P_MARG_COLUMN","title":"P_MARG_COLUMN  <code>module-attribute</code>","text":"<pre><code>P_MARG_COLUMN = 'P_MARG'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task/#mecfs_bio.build_system.task.magma.magma_forward_stepwise_select_task.RETAINED_CLUSTERS_COLUMN","title":"RETAINED_CLUSTERS_COLUMN  <code>module-attribute</code>","text":"<pre><code>RETAINED_CLUSTERS_COLUMN = 'Retained_clusters'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task/#mecfs_bio.build_system.task.magma.magma_forward_stepwise_select_task.VARCODE_COLUMN","title":"VARCODE_COLUMN  <code>module-attribute</code>","text":"<pre><code>VARCODE_COLUMN = 'VARCODE'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task/#mecfs_bio.build_system.task.magma.magma_forward_stepwise_select_task.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task/#mecfs_bio.build_system.task.magma.magma_forward_stepwise_select_task.MagmaForwardStepwiseSelectTask","title":"MagmaForwardStepwiseSelectTask","text":"<p>               Bases: <code>Task</code></p> <ul> <li>Since the gene expression patterns of many cell types are highly correlated, it can be difficult  to distinguish the independent significant signals on a typical plot of MAGMA results.</li> <li>To help resolve this, this function attempts to identify a set of relatively independent significant cell types, in the sense that the p value of one does  not decline too much when conditioning on another. This is loosely based on: https://github.com/Integrative-Mental-Health-Lab/linking_cell_types_to_brain_phenotypes/blob/675b5c9b58b8762934183a3ca61ae49ad587934a/MAGMA/5.forward_selection_condition_results.md</li> </ul> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>conditional_asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>magma_conditional_output_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>magma_marginal_output_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>marginal_asset_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>min_prop_sig</code>               (<code>float</code>)           \u2013            </li> <li> <code>significance_threshold</code>               (<code>float</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task/#mecfs_bio.build_system.task.magma.magma_forward_stepwise_select_task.MagmaForwardStepwiseSelectTask.conditional_asset_id","title":"conditional_asset_id  <code>property</code>","text":"<pre><code>conditional_asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task/#mecfs_bio.build_system.task.magma.magma_forward_stepwise_select_task.MagmaForwardStepwiseSelectTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task/#mecfs_bio.build_system.task.magma.magma_forward_stepwise_select_task.MagmaForwardStepwiseSelectTask.magma_conditional_output_task","title":"magma_conditional_output_task  <code>instance-attribute</code>","text":"<pre><code>magma_conditional_output_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task/#mecfs_bio.build_system.task.magma.magma_forward_stepwise_select_task.MagmaForwardStepwiseSelectTask.magma_marginal_output_task","title":"magma_marginal_output_task  <code>instance-attribute</code>","text":"<pre><code>magma_marginal_output_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task/#mecfs_bio.build_system.task.magma.magma_forward_stepwise_select_task.MagmaForwardStepwiseSelectTask.marginal_asset_id","title":"marginal_asset_id  <code>property</code>","text":"<pre><code>marginal_asset_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task/#mecfs_bio.build_system.task.magma.magma_forward_stepwise_select_task.MagmaForwardStepwiseSelectTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task/#mecfs_bio.build_system.task.magma.magma_forward_stepwise_select_task.MagmaForwardStepwiseSelectTask.min_prop_sig","title":"min_prop_sig  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>min_prop_sig: float = 0.5\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task/#mecfs_bio.build_system.task.magma.magma_forward_stepwise_select_task.MagmaForwardStepwiseSelectTask.significance_threshold","title":"significance_threshold  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>significance_threshold: float = 0.05\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task/#mecfs_bio.build_system.task.magma.magma_forward_stepwise_select_task.MagmaForwardStepwiseSelectTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    magma_marginal_output_task: Task,\n    magma_conditional_output_task: Task,\n    min_prop_sig: float = 0.5,\n    significance_threshold=0.05,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    magma_marginal_output_task: Task,\n    magma_conditional_output_task: Task,\n    min_prop_sig: float = 0.5,\n    significance_threshold=0.05,\n):\n    source_meta = magma_marginal_output_task.meta\n    assert isinstance(source_meta, ProcessedGwasDataDirectoryMeta)\n    meta = ResultTableMeta(\n        id=AssetId(asset_id),\n        trait=source_meta.trait,\n        project=source_meta.project,\n        extension=\".csv\",\n        read_spec=DataFrameReadSpec(DataFrameTextFormat(separator=\",\")),\n    )\n    return cls(\n        meta=meta,\n        magma_marginal_output_task=magma_marginal_output_task,\n        magma_conditional_output_task=magma_conditional_output_task,\n        min_prop_sig=min_prop_sig,\n        significance_threshold=significance_threshold,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task/#mecfs_bio.build_system.task.magma.magma_forward_stepwise_select_task.MagmaForwardStepwiseSelectTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    marginal_asset = fetch(self.marginal_asset_id)\n    assert isinstance(marginal_asset, DirectoryAsset)\n    conditional_asset = fetch(self.conditional_asset_id)\n    assert isinstance(conditional_asset, DirectoryAsset)\n    marginal_path = marginal_asset.path / (\n        GENE_SET_ANALYSIS_OUTPUT_STEM_NAME + \".gsa.out\"\n    )\n    conditional_path = conditional_asset.path / (\n        GENE_SET_ANALYSIS_OUTPUT_STEM_NAME + \".gsa.out\"\n    )\n    df_marg = pd.read_csv(marginal_path, comment=\"#\", sep=r\"\\s+\")\n    df_cond = pd.read_csv(conditional_path, comment=\"#\", sep=r\"\\s+\")\n    if (len(df_marg) == 0) or (len(df_cond) == 0):\n        logger.debug(\n            f\"Marginal DF has {len(df_marg)} rows, while conditional df has {len(df_cond)} rows.  Cannot perform stepwise analysis. Skipping\"\n        )\n        retained_cluster_list: list = []\n        retained_cluster_df = pd.DataFrame(\n            {\n                RETAINED_CLUSTERS_COLUMN: retained_cluster_list,\n            }\n        )\n        out_path = scratch_dir / self.asset_id\n        retained_cluster_df.to_csv(out_path, index=False)\n        return FileAsset(out_path)\n\n    df_wide = generate_wide_dataframe(df_cond=df_cond, df_marg=df_marg)\n    p_marg_dict, prop_sig_dict = generate_mappers_from_wide_dataframe(\n        df_wide=df_wide\n    )\n\n    all_cluster_list = df_marg.sort_values(by=MAGMA_P_COLUMN)[\n        MAGMA_VARIABLE_COLUMN\n    ].tolist()\n    sig_cluster_set = set(\n        df_marg.loc[\n            df_marg[MAGMA_P_COLUMN] &lt;= (self.significance_threshold / len(df_marg))\n        ][MAGMA_VARIABLE_COLUMN].tolist()\n    )\n    sig_cluster_list = [\n        item for item in all_cluster_list if item in sig_cluster_set\n    ]\n\n    retained_cluster_list = get_retained_clusters(\n        all_cluster_list=sig_cluster_list,\n        prop_sig_dict=prop_sig_dict,\n        min_prop_sig=self.min_prop_sig,\n    )\n    logger.debug(f\"Number of retained clusters: {len(retained_cluster_list)}\")\n    retained_cluster_df = pd.DataFrame(\n        {\n            RETAINED_CLUSTERS_COLUMN: retained_cluster_list,\n        }\n    )\n    out_path = scratch_dir / self.asset_id\n    retained_cluster_df.to_csv(out_path, index=False)\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task/#mecfs_bio.build_system.task.magma.magma_forward_stepwise_select_task.generate_mappers_from_wide_dataframe","title":"generate_mappers_from_wide_dataframe","text":"<pre><code>generate_mappers_from_wide_dataframe(\n    df_wide: DataFrame,\n) -&gt; tuple[dict[str, float], dict[tuple[str, str], float]]\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task.py</code> <pre><code>def generate_mappers_from_wide_dataframe(\n    df_wide: pd.DataFrame,\n) -&gt; tuple[dict[str, float], dict[tuple[str, str], float]]:\n    p_marg_dict = {}\n    prop_sig_dict = {}\n    for i in range(len(df_wide)):\n        p_marg_dict[df_wide[\"VARIABLE_a\"].iloc[i]] = df_wide[\"P_MARG_a\"].iloc[i]\n        p_marg_dict[df_wide[\"VARIABLE_b\"].iloc[i]] = df_wide[\"P_MARG_b\"].iloc[i]\n        prop_sig_dict[\n            (df_wide[\"VARIABLE_a\"].iloc[i], df_wide[\"VARIABLE_b\"].iloc[i])\n        ] = df_wide[\"PS_a\"].iloc[i]\n        prop_sig_dict[\n            (df_wide[\"VARIABLE_b\"].iloc[i], df_wide[\"VARIABLE_a\"].iloc[i])\n        ] = df_wide[\"PS_b\"].iloc[i]\n    return p_marg_dict, prop_sig_dict\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task/#mecfs_bio.build_system.task.magma.magma_forward_stepwise_select_task.generate_wide_dataframe","title":"generate_wide_dataframe","text":"<pre><code>generate_wide_dataframe(\n    df_cond: DataFrame, df_marg: DataFrame\n) -&gt; pd.DataFrame\n</code></pre> <p>Based on https://github.com/Integrative-Mental-Health-Lab/linking_cell_types_to_brain_phenotypes/blob/675b5c9b58b8762934183a3ca61ae49ad587934a/MAGMA/5.forward_selection_condition_results.md</p> Source code in <code>mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task.py</code> <pre><code>def generate_wide_dataframe(\n    df_cond: pd.DataFrame, df_marg: pd.DataFrame\n) -&gt; pd.DataFrame:\n    \"\"\"\n    Based on https://github.com/Integrative-Mental-Health-Lab/linking_cell_types_to_brain_phenotypes/blob/675b5c9b58b8762934183a3ca61ae49ad587934a/MAGMA/5.forward_selection_condition_results.md\n    \"\"\"\n    df_cond = (\n        df_cond.copy()\n        .loc[:, [MAGMA_VARIABLE_COLUMN, MAGMA_MODEL_COLUMN, MAGMA_P_COLUMN]]\n        .rename(columns={MAGMA_P_COLUMN: P_COND_COLUMN})\n    )\n    df_marg = (\n        df_marg.copy()\n        .loc[:, [MAGMA_VARIABLE_COLUMN, MAGMA_P_COLUMN]]\n        .rename(columns={MAGMA_P_COLUMN: P_MARG_COLUMN})\n        .sort_values(by=P_MARG_COLUMN)\n    )\n    df_comb = df_cond.merge(df_marg, on=MAGMA_VARIABLE_COLUMN, how=\"left\")\n    df_comb[VARCODE_COLUMN] = (\n        df_comb.groupby(MAGMA_MODEL_COLUMN)[MAGMA_VARIABLE_COLUMN]\n        .cumcount()\n        .map({0: \"a\", 1: \"b\"})\n    )\n    df_wide: Any = df_comb.pivot(\n        index=MAGMA_MODEL_COLUMN,\n        columns=VARCODE_COLUMN,\n        values=[MAGMA_VARIABLE_COLUMN, P_COND_COLUMN, P_MARG_COLUMN],\n    )\n    df_wide.columns = [f\"{v}_{c}\" for v, c in df_wide.columns]\n    for col in [\"P_COND_a\", \"P_COND_b\", \"P_MARG_a\", \"P_MARG_b\"]:\n        df_wide[col] = df_wide[col].astype(np.float64)\n    df_wide[\"PS_a\"] = np.log10(df_wide[\"P_COND_a\"]) / np.log10(df_wide[\"P_MARG_a\"])\n    df_wide[\"PS_b\"] = np.log10(df_wide[\"P_COND_b\"]) / np.log10(df_wide[\"P_MARG_b\"])\n\n    assert (df_wide[\"P_MARG_a\"] &lt;= df_wide[\"P_MARG_b\"]).all()\n    return df_wide\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task/#mecfs_bio.build_system.task.magma.magma_forward_stepwise_select_task.get_retained_clusters","title":"get_retained_clusters","text":"<pre><code>get_retained_clusters(\n    all_cluster_list: Sequence[str],\n    prop_sig_dict: dict[tuple[str, str], float],\n    min_prop_sig: float,\n) -&gt; list[str]\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task.py</code> <pre><code>def get_retained_clusters(\n    all_cluster_list: Sequence[str],\n    prop_sig_dict: dict[tuple[str, str], float],\n    min_prop_sig: float,\n) -&gt; list[str]:\n    to_retain = []\n    to_retain.append(all_cluster_list[0])\n    for cluster in all_cluster_list[1:]:\n        if pairwise_independent(\n            cluster1=cluster,\n            clusters_to_retain=to_retain,\n            min_prop_sig=min_prop_sig,\n            prop_sig_dict=prop_sig_dict,\n        ):\n            to_retain.append(cluster)\n    return to_retain\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task/#mecfs_bio.build_system.task.magma.magma_forward_stepwise_select_task.independent","title":"independent","text":"<pre><code>independent(\n    cluster1: str,\n    cluster2: str,\n    prop_sig_dict: dict[tuple[str, str], float],\n    min_prop_sig: float,\n) -&gt; bool\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task.py</code> <pre><code>def independent(\n    cluster1: str,\n    cluster2: str,\n    prop_sig_dict: dict[tuple[str, str], float],\n    min_prop_sig: float,\n) -&gt; bool:\n    if (\n        prop_sig_dict[(cluster1, cluster2)] &gt;= min_prop_sig\n        and prop_sig_dict[(cluster2, cluster1)] &gt;= min_prop_sig\n    ):\n        return True\n    return False\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task/#mecfs_bio.build_system.task.magma.magma_forward_stepwise_select_task.pairwise_independent","title":"pairwise_independent","text":"<pre><code>pairwise_independent(\n    cluster1: str,\n    clusters_to_retain: list[str],\n    prop_sig_dict: dict[tuple[str, str], float],\n    min_prop_sig: float,\n) -&gt; bool\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_forward_stepwise_select_task.py</code> <pre><code>def pairwise_independent(\n    cluster1: str,\n    clusters_to_retain: list[str],\n    prop_sig_dict: dict[tuple[str, str], float],\n    min_prop_sig: float,\n) -&gt; bool:\n    for retained_cluster in clusters_to_retain:\n        if not independent(\n            cluster1,\n            retained_cluster,\n            prop_sig_dict=prop_sig_dict,\n            min_prop_sig=min_prop_sig,\n        ):\n            return False\n    return True\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/","title":"magma_gene_analysis_task","text":""},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task","title":"mecfs_bio.build_system.task.magma.magma_gene_analysis_task","text":"<p>Classes:</p> <ul> <li> <code>MagmaGeneAnalysisTask</code>           \u2013            </li> </ul> <p>Functions:</p> <ul> <li> <code>read_magma_gene_analysis_result</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>DuplicateMode</code>           \u2013            </li> <li> <code>GENE_ANALYSIS_OUTPUT_STEM_NAME</code>           \u2013            </li> <li> <code>SynonymMode</code>           \u2013            </li> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task.DuplicateMode","title":"DuplicateMode  <code>module-attribute</code>","text":"<pre><code>DuplicateMode = Literal['first', 'last', 'error']\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task.GENE_ANALYSIS_OUTPUT_STEM_NAME","title":"GENE_ANALYSIS_OUTPUT_STEM_NAME  <code>module-attribute</code>","text":"<pre><code>GENE_ANALYSIS_OUTPUT_STEM_NAME = 'gene_analysis_output'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task.SynonymMode","title":"SynonymMode  <code>module-attribute</code>","text":"<pre><code>SynonymMode = Literal['skip', 'drop', 'drop-dup']\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task.MagmaGeneAnalysisTask","title":"MagmaGeneAnalysisTask","text":"<p>               Bases: <code>Task</code></p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>duplicate_mode</code>               (<code>DuplicateMode | None</code>)           \u2013            </li> <li> <code>ld_ref_file_stem</code>               (<code>str</code>)           \u2013            </li> <li> <code>magma_annotation_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>magma_annotation_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>magma_binary_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>magma_binary_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>magma_ld_ref_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>magma_ld_ref_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>magma_p_value_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>p_value_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>p_value_meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>sample_size</code>               (<code>int</code>)           \u2013            </li> <li> <code>synonym_mode</code>               (<code>SynonymMode</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task.MagmaGeneAnalysisTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task.MagmaGeneAnalysisTask.duplicate_mode","title":"duplicate_mode  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>duplicate_mode: DuplicateMode | None = 'first'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task.MagmaGeneAnalysisTask.ld_ref_file_stem","title":"ld_ref_file_stem  <code>instance-attribute</code>","text":"<pre><code>ld_ref_file_stem: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task.MagmaGeneAnalysisTask.magma_annotation_id","title":"magma_annotation_id  <code>property</code>","text":"<pre><code>magma_annotation_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task.MagmaGeneAnalysisTask.magma_annotation_task","title":"magma_annotation_task  <code>instance-attribute</code>","text":"<pre><code>magma_annotation_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task.MagmaGeneAnalysisTask.magma_binary_id","title":"magma_binary_id  <code>property</code>","text":"<pre><code>magma_binary_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task.MagmaGeneAnalysisTask.magma_binary_task","title":"magma_binary_task  <code>instance-attribute</code>","text":"<pre><code>magma_binary_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task.MagmaGeneAnalysisTask.magma_ld_ref_id","title":"magma_ld_ref_id  <code>property</code>","text":"<pre><code>magma_ld_ref_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task.MagmaGeneAnalysisTask.magma_ld_ref_task","title":"magma_ld_ref_task  <code>instance-attribute</code>","text":"<pre><code>magma_ld_ref_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task.MagmaGeneAnalysisTask.magma_p_value_task","title":"magma_p_value_task  <code>instance-attribute</code>","text":"<pre><code>magma_p_value_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task.MagmaGeneAnalysisTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task.MagmaGeneAnalysisTask.p_value_id","title":"p_value_id  <code>property</code>","text":"<pre><code>p_value_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task.MagmaGeneAnalysisTask.p_value_meta","title":"p_value_meta  <code>property</code>","text":"<pre><code>p_value_meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task.MagmaGeneAnalysisTask.sample_size","title":"sample_size  <code>instance-attribute</code>","text":"<pre><code>sample_size: int\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task.MagmaGeneAnalysisTask.synonym_mode","title":"synonym_mode  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>synonym_mode: SynonymMode = 'drop-dup'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task.MagmaGeneAnalysisTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    magma_annotation_task: Task,\n    magma_p_value_task: Task,\n    magma_binary_task: Task,\n    magma_ld_ref_task: Task,\n    ld_ref_file_stem: str,\n    sample_size: int,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_gene_analysis_task.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    magma_annotation_task: Task,\n    magma_p_value_task: Task,\n    magma_binary_task: Task,\n    magma_ld_ref_task: Task,\n    ld_ref_file_stem: str,\n    sample_size: int,\n):\n    annotation_meta = magma_annotation_task.meta  # magma_p_value_task.meta\n    assert isinstance(annotation_meta, FilteredGWASDataMeta)\n    meta = ProcessedGwasDataDirectoryMeta(\n        id=AssetId(asset_id),\n        trait=annotation_meta.trait,\n        project=annotation_meta.project,\n        sub_dir=PurePath(annotation_meta.sub_dir),\n    )\n    return cls(\n        magma_annotation_task=magma_annotation_task,\n        magma_p_value_task=magma_p_value_task,\n        magma_binary_task=magma_binary_task,\n        magma_ld_ref_task=magma_ld_ref_task,\n        ld_ref_file_stem=ld_ref_file_stem,\n        sample_size=sample_size,\n        meta=meta,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task.MagmaGeneAnalysisTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_gene_analysis_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    binary_asset = fetch(self.magma_binary_id)\n    annotation_asset = fetch(self.magma_annotation_id)\n    p_value_asset = fetch(self.p_value_id)\n    ld_ref_asset = fetch(self.magma_ld_ref_id)\n    assert isinstance(binary_asset, FileAsset)\n    assert isinstance(p_value_asset, FileAsset)\n    assert isinstance(annotation_asset, FileAsset)\n    assert isinstance(ld_ref_asset, DirectoryAsset)\n    binary_path = binary_asset.path\n    annotation_path = annotation_asset.path\n    p_value_path = p_value_asset.path\n    ld_ref_dir_path = ld_ref_asset.path\n    out_dir = scratch_dir / \"gene_analysis_dir\"\n    out_dir.mkdir(parents=True, exist_ok=True)\n    out_base_path = out_dir / GENE_ANALYSIS_OUTPUT_STEM_NAME\n    cmd = [\n        str(binary_path),\n        \"--bfile\",\n        str(ld_ref_dir_path / self.ld_ref_file_stem),\n        f\"synonym-dup={self.synonym_mode}\",\n        \"--pval\",\n        str(p_value_path),\n        f\"duplicate={self.duplicate_mode}\",\n        f\"N={self.sample_size}\",\n        \"--gene-annot\",\n        str(annotation_path),\n        \"--out\",\n        str(out_base_path),\n    ]\n    logger.debug(f\"Running command: {' '.join(cmd)}\")\n    execute_command(cmd)\n\n    return DirectoryAsset(out_dir)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_analysis_task.read_magma_gene_analysis_result","title":"read_magma_gene_analysis_result","text":"<pre><code>read_magma_gene_analysis_result(\n    result_dir: Path,\n) -&gt; pd.DataFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_gene_analysis_task.py</code> <pre><code>def read_magma_gene_analysis_result(result_dir: Path) -&gt; pd.DataFrame:\n    return (\n        scan_dataframe(\n            result_dir / str(GENE_ANALYSIS_OUTPUT_STEM_NAME + \".genes.out\"),\n            spec=DataFrameReadSpec(DataFrameWhiteSpaceSepTextFormat(comment_code=\"#\")),\n        )\n        .collect()\n        .to_pandas()\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task/","title":"magma_gene_set_analysis_task","text":""},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_set_analysis_task","title":"mecfs_bio.build_system.task.magma.magma_gene_set_analysis_task","text":"<p>Classes:</p> <ul> <li> <code>DirectoryGeneSetSpec</code>           \u2013            </li> <li> <code>MagmaGeneSetAnalysisTask</code>           \u2013            <p>The final step in the canonical MAGMA pipeline.</p> </li> <li> <code>ModelParams</code>           \u2013            </li> </ul> <p>Attributes:</p> <ul> <li> <code>GENE_SET_ANALYSIS_OUTPUT_STEM_NAME</code>           \u2013            </li> <li> <code>SetOrCovar</code>           \u2013            </li> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_set_analysis_task.GENE_SET_ANALYSIS_OUTPUT_STEM_NAME","title":"GENE_SET_ANALYSIS_OUTPUT_STEM_NAME  <code>module-attribute</code>","text":"<pre><code>GENE_SET_ANALYSIS_OUTPUT_STEM_NAME = (\n    \"gene_set_analysis_output\"\n)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_set_analysis_task.SetOrCovar","title":"SetOrCovar  <code>module-attribute</code>","text":"<pre><code>SetOrCovar = Literal['set', 'covar']\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_set_analysis_task.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_set_analysis_task.DirectoryGeneSetSpec","title":"DirectoryGeneSetSpec","text":"<p>Attributes:</p> <ul> <li> <code>gene_set_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>path_in_dir</code>               (<code>PurePath</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_set_analysis_task.DirectoryGeneSetSpec.gene_set_task","title":"gene_set_task  <code>instance-attribute</code>","text":"<pre><code>gene_set_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_set_analysis_task.DirectoryGeneSetSpec.path_in_dir","title":"path_in_dir  <code>instance-attribute</code>","text":"<pre><code>path_in_dir: PurePath\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_set_analysis_task.MagmaGeneSetAnalysisTask","title":"MagmaGeneSetAnalysisTask","text":"<p>               Bases: <code>Task</code></p> <p>The final step in the canonical MAGMA pipeline. See page 18 of the manual here: https://vu.data.surfsara.nl/s/MUiv3y1SFRePnyG?dir=/&amp;editing=false&amp;openfile=true</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>gene_set_or_covar_task</code>               (<code>Task | DirectoryGeneSetSpec</code>)           \u2013            </li> <li> <code>magma_binary_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>magma_gene_analysis_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>model_params</code>               (<code>ModelParams | None</code>)           \u2013            </li> <li> <code>set_or_covar</code>               (<code>SetOrCovar</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_set_analysis_task.MagmaGeneSetAnalysisTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_set_analysis_task.MagmaGeneSetAnalysisTask.gene_set_or_covar_task","title":"gene_set_or_covar_task  <code>instance-attribute</code>","text":"<pre><code>gene_set_or_covar_task: Task | DirectoryGeneSetSpec\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_set_analysis_task.MagmaGeneSetAnalysisTask.magma_binary_task","title":"magma_binary_task  <code>instance-attribute</code>","text":"<pre><code>magma_binary_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_set_analysis_task.MagmaGeneSetAnalysisTask.magma_gene_analysis_task","title":"magma_gene_analysis_task  <code>instance-attribute</code>","text":"<pre><code>magma_gene_analysis_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_set_analysis_task.MagmaGeneSetAnalysisTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_set_analysis_task.MagmaGeneSetAnalysisTask.model_params","title":"model_params  <code>instance-attribute</code>","text":"<pre><code>model_params: ModelParams | None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_set_analysis_task.MagmaGeneSetAnalysisTask.set_or_covar","title":"set_or_covar  <code>instance-attribute</code>","text":"<pre><code>set_or_covar: SetOrCovar\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_set_analysis_task.MagmaGeneSetAnalysisTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    magma_gene_analysis_task: Task,\n    magma_binary_task: Task,\n    gene_set_task: Task | DirectoryGeneSetSpec,\n    set_or_covar: SetOrCovar,\n    model_params: ModelParams | None,\n    sub_dir: PurePath = PurePath(\"analysis_results\")\n    / \"magma\",\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    magma_gene_analysis_task: Task,\n    magma_binary_task: Task,\n    gene_set_task: Task | DirectoryGeneSetSpec,\n    set_or_covar: SetOrCovar,\n    model_params: ModelParams | None,\n    sub_dir: PurePath = PurePath(\"analysis_results\") / \"magma\",\n):\n    gene_analysis_meta = magma_gene_analysis_task.meta\n    assert isinstance(gene_analysis_meta, ProcessedGwasDataDirectoryMeta)\n    meta = ProcessedGwasDataDirectoryMeta(\n        id=AssetId(asset_id),\n        trait=gene_analysis_meta.trait,\n        project=gene_analysis_meta.project,\n        sub_dir=sub_dir,\n    )\n    return cls(\n        magma_binary_task=magma_binary_task,\n        gene_set_or_covar_task=gene_set_task,\n        magma_gene_analysis_task=magma_gene_analysis_task,\n        meta=meta,\n        set_or_covar=set_or_covar,\n        model_params=model_params,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_set_analysis_task.MagmaGeneSetAnalysisTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    out_dir = scratch_dir / \"gene_set_analysis_dir\"\n    out_dir.mkdir(parents=True, exist_ok=True)\n    gene_set_or_covar_asset = fetch(self._gene_set_or_covar_task_id)\n    if isinstance(self.gene_set_or_covar_task, Task):\n        assert isinstance(gene_set_or_covar_asset, FileAsset)\n        gene_set_or_covar_path = gene_set_or_covar_asset.path\n    else:\n        assert isinstance(self.gene_set_or_covar_task, DirectoryGeneSetSpec)\n        assert isinstance(gene_set_or_covar_asset, DirectoryAsset)\n        gene_set_or_covar_path = (\n            gene_set_or_covar_asset.path / self.gene_set_or_covar_task.path_in_dir\n        )\n    if _empty_gene_set_file(gene_set_or_covar_path, model_params=self.model_params):\n        pd.DataFrame({MAGMA_VARIABLE_COLUMN: [], MAGMA_P_COLUMN: []}).to_csv(\n            out_dir / (GENE_SET_ANALYSIS_OUTPUT_STEM_NAME + \".gsa.out\"),\n            sep=\"\\t\",\n            index=False,\n        )\n        logger.debug(\"Gene set file is empty, skipping running MAGMA\")\n        return DirectoryAsset(out_dir)\n\n    binary_asset = fetch(self._magma_binary_id)\n    gene_analysis_asset = fetch(self._magma_gene_analysis_id())\n    assert isinstance(binary_asset, FileAsset)\n    assert isinstance(gene_analysis_asset, DirectoryAsset)\n    binary_path = binary_asset.path\n    gene_analysis_path_root_path = gene_analysis_asset.path\n    gene_analysis_full_path = gene_analysis_path_root_path / (\n        GENE_ANALYSIS_OUTPUT_STEM_NAME + \".genes.raw\"\n    )\n    out_base_path = out_dir / GENE_SET_ANALYSIS_OUTPUT_STEM_NAME\n\n    set_or_covar_command = (\n        \"--set-annot\" if self.set_or_covar == \"set\" else \"--gene-covar\"\n    )\n\n    cmd = [\n        str(binary_path),\n        \"--gene-results\",\n        str(gene_analysis_full_path),\n        set_or_covar_command,  # \"--set-annot\"  or \"--gene-covar\"\n        str(gene_set_or_covar_path),\n    ]\n    if self.model_params is not None:\n        cmd.extend(self.model_params.prep_command())\n    cmd += [\n        \"--out\",\n        str(out_base_path),\n    ]\n    logger.debug(f\"Running command: {' '.join(cmd)}\")\n    execute_command(cmd)\n    return DirectoryAsset(out_dir)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_set_analysis_task.ModelParams","title":"ModelParams","text":"<p>Methods:</p> <ul> <li> <code>prep_command</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>condition_hide</code>               (<code>Sequence[str]</code>)           \u2013            </li> <li> <code>direction_covar</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>joint_pairs</code>               (<code>bool</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_set_analysis_task.ModelParams.condition_hide","title":"condition_hide  <code>instance-attribute</code>","text":"<pre><code>condition_hide: Sequence[str]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_set_analysis_task.ModelParams.direction_covar","title":"direction_covar  <code>instance-attribute</code>","text":"<pre><code>direction_covar: str | None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_set_analysis_task.ModelParams.joint_pairs","title":"joint_pairs  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>joint_pairs: bool = False\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task/#mecfs_bio.build_system.task.magma.magma_gene_set_analysis_task.ModelParams.prep_command","title":"prep_command","text":"<pre><code>prep_command() -&gt; list[str]\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_gene_set_analysis_task.py</code> <pre><code>def prep_command(self) -&gt; list[str]:\n    result = [\"--model\"]\n    if self.joint_pairs:\n        result += [\"joint-pairs\"]\n    if self.direction_covar:\n        result += [f\"direction-covar={self.direction_covar}\"]\n    if len(self.condition_hide) &gt; 0:\n        result += [\"condition-hide=\" + \",\".join(self.condition_hide)]\n\n    return result\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_brain_atlas_result_with_stepwise_labels/","title":"magma_plot_brain_atlas_result_with_stepwise_labels","text":""},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_brain_atlas_result_with_stepwise_labels/#mecfs_bio.build_system.task.magma.magma_plot_brain_atlas_result_with_stepwise_labels","title":"mecfs_bio.build_system.task.magma.magma_plot_brain_atlas_result_with_stepwise_labels","text":"<p>Classes:</p> <ul> <li> <code>HBAIndepPlotOptions</code>           \u2013            </li> <li> <code>MAGMAPlotBrainAtlasResultWithStepwiseLabels</code>           \u2013            <p>Create a plot of the results of applying MAGMA to a GWAS using HBA reference data</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_brain_atlas_result_with_stepwise_labels/#mecfs_bio.build_system.task.magma.magma_plot_brain_atlas_result_with_stepwise_labels.HBAIndepPlotOptions","title":"HBAIndepPlotOptions","text":"<p>Attributes:</p> <ul> <li> <code>annotation_text_size</code>               (<code>int</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_brain_atlas_result_with_stepwise_labels/#mecfs_bio.build_system.task.magma.magma_plot_brain_atlas_result_with_stepwise_labels.HBAIndepPlotOptions.annotation_text_size","title":"annotation_text_size  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>annotation_text_size: int = 7\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_brain_atlas_result_with_stepwise_labels/#mecfs_bio.build_system.task.magma.magma_plot_brain_atlas_result_with_stepwise_labels.MAGMAPlotBrainAtlasResultWithStepwiseLabels","title":"MAGMAPlotBrainAtlasResultWithStepwiseLabels","text":"<p>               Bases: <code>Task</code></p> <p>Create a plot of the results of applying MAGMA to a GWAS using HBA reference data</p> <ul> <li>Since the gene expression patterns of brain cell types are highly correlated, it can be difficult  to distinguish the independent significant signals on a typical plot of MAGMA results.  For this reason, this plotting a function  annotates a subset of the cell types that are relatively independent significant: i.e. the p value of one cell type  does not decline too much when conditioning on the others.</li> </ul> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>plot_options</code>               (<code>HBAIndepPlotOptions</code>)           \u2013            </li> <li> <code>result_table_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>source_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>source_meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>stepwise_cluster_list_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>stepwise_clusters_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>stepwise_met</code>               (<code>Meta</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_brain_atlas_result_with_stepwise_labels/#mecfs_bio.build_system.task.magma.magma_plot_brain_atlas_result_with_stepwise_labels.MAGMAPlotBrainAtlasResultWithStepwiseLabels.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_brain_atlas_result_with_stepwise_labels/#mecfs_bio.build_system.task.magma.magma_plot_brain_atlas_result_with_stepwise_labels.MAGMAPlotBrainAtlasResultWithStepwiseLabels.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_brain_atlas_result_with_stepwise_labels/#mecfs_bio.build_system.task.magma.magma_plot_brain_atlas_result_with_stepwise_labels.MAGMAPlotBrainAtlasResultWithStepwiseLabels.plot_options","title":"plot_options  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>plot_options: HBAIndepPlotOptions = HBAIndepPlotOptions()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_brain_atlas_result_with_stepwise_labels/#mecfs_bio.build_system.task.magma.magma_plot_brain_atlas_result_with_stepwise_labels.MAGMAPlotBrainAtlasResultWithStepwiseLabels.result_table_task","title":"result_table_task  <code>instance-attribute</code>","text":"<pre><code>result_table_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_brain_atlas_result_with_stepwise_labels/#mecfs_bio.build_system.task.magma.magma_plot_brain_atlas_result_with_stepwise_labels.MAGMAPlotBrainAtlasResultWithStepwiseLabels.source_id","title":"source_id  <code>property</code>","text":"<pre><code>source_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_brain_atlas_result_with_stepwise_labels/#mecfs_bio.build_system.task.magma.magma_plot_brain_atlas_result_with_stepwise_labels.MAGMAPlotBrainAtlasResultWithStepwiseLabels.source_meta","title":"source_meta  <code>property</code>","text":"<pre><code>source_meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_brain_atlas_result_with_stepwise_labels/#mecfs_bio.build_system.task.magma.magma_plot_brain_atlas_result_with_stepwise_labels.MAGMAPlotBrainAtlasResultWithStepwiseLabels.stepwise_cluster_list_task","title":"stepwise_cluster_list_task  <code>instance-attribute</code>","text":"<pre><code>stepwise_cluster_list_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_brain_atlas_result_with_stepwise_labels/#mecfs_bio.build_system.task.magma.magma_plot_brain_atlas_result_with_stepwise_labels.MAGMAPlotBrainAtlasResultWithStepwiseLabels.stepwise_clusters_id","title":"stepwise_clusters_id  <code>property</code>","text":"<pre><code>stepwise_clusters_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_brain_atlas_result_with_stepwise_labels/#mecfs_bio.build_system.task.magma.magma_plot_brain_atlas_result_with_stepwise_labels.MAGMAPlotBrainAtlasResultWithStepwiseLabels.stepwise_met","title":"stepwise_met  <code>property</code>","text":"<pre><code>stepwise_met: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_brain_atlas_result_with_stepwise_labels/#mecfs_bio.build_system.task.magma.magma_plot_brain_atlas_result_with_stepwise_labels.MAGMAPlotBrainAtlasResultWithStepwiseLabels.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    result_table_task: Task,\n    asset_id: str,\n    stepwise_cluster_list_task: Task,\n    plot_options: HBAIndepPlotOptions = HBAIndepPlotOptions(),\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_plot_brain_atlas_result_with_stepwise_labels.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    result_table_task: Task,\n    asset_id: str,\n    stepwise_cluster_list_task: Task,\n    plot_options: HBAIndepPlotOptions = HBAIndepPlotOptions(),\n):\n    source_meta = result_table_task.meta\n    assert isinstance(source_meta, ResultTableMeta)\n    meta = GWASPlotDirectoryMeta(\n        trait=source_meta.trait,\n        project=source_meta.project,\n        id=AssetId(asset_id),\n        sub_dir=PurePath(\"analysis/magma_plots\"),\n    )\n    return cls(\n        meta=meta,\n        result_table_task=result_table_task,\n        stepwise_cluster_list_task=stepwise_cluster_list_task,\n        plot_options=plot_options,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_brain_atlas_result_with_stepwise_labels/#mecfs_bio.build_system.task.magma.magma_plot_brain_atlas_result_with_stepwise_labels.MAGMAPlotBrainAtlasResultWithStepwiseLabels.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_plot_brain_atlas_result_with_stepwise_labels.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    source_asset = fetch(self.source_id)\n    table = (\n        scan_dataframe_asset(asset=source_asset, meta=self.source_meta)\n        .collect()\n        .to_pandas()\n    )\n    table[\"MLOG10P\"] = -np.log10(table[\"P\"])\n    table[\"CLUSTER\"] = table[\"VARIABLE\"].str.extract(r\"Cluster([0-9]+)\").astype(int)\n    table = table.sort_values(by=\"CLUSTER\")\n\n    sig_level = -math.log10(0.01 / len(table))\n\n    stepwise_clusters_asset = fetch(self.stepwise_clusters_id)\n    independent_clusters = (\n        scan_dataframe_asset(asset=stepwise_clusters_asset, meta=self.stepwise_met)\n        .collect()\n        .to_pandas()[RETAINED_CLUSTERS_COLUMN]\n        .tolist()\n    )\n\n    colormap = {\n        key.replace(\".\", \" \"): val\n        for key, val in DUNCAN_ET_AL_2025_COLORMAP.items()\n    }\n    fig, ax = plt.subplots(nrows=1, ncols=1, figsize=(16, 10))\n    sns.scatterplot(\n        table,\n        x=\"CLUSTER\",\n        y=\"MLOG10P\",\n        hue=\"Supercluster\",\n        palette=colormap,\n        ax=ax,\n        s=145,\n    )\n    plt.subplots_adjust(\n        left=0.05,\n        right=0.8,\n    )\n    sns.move_legend(ax, \"upper left\", bbox_to_anchor=(1.0, 1), fontsize=\"small\")\n    leg1 = ax.get_legend()\n    significance_line = ax.axhline(\n        y=sig_level,\n        color=\"black\",\n        linestyle=\":\",\n        linewidth=2,\n        alpha=0.7,\n        zorder=-100,\n        label=\"Significance threshold (Bonferroni)\",\n    )\n    ax.legend(handles=[significance_line], loc=\"lower right\")\n    ax.add_artist(leg1)\n\n    ax.set_xlabel(\"Cluster\", fontsize=\"x-large\")\n    ax.set_ylabel(r\"$-\\log_{10}(p)$\", fontsize=\"x-large\")\n\n    if len(independent_clusters) &gt; 0:\n        x_coords = []\n        y_cords = []\n        texts = []\n        for item in independent_clusters:\n            x_coords.append(table.loc[table[\"VARIABLE\"] == item][\"CLUSTER\"].item())\n            y_cords.append(table.loc[table[\"VARIABLE\"] == item][\"MLOG10P\"].item())\n            texts.append(\n                get_condensed_hba_cluster_label(\n                    table.loc[table[\"VARIABLE\"] == item].iloc[0, :],\n                )\n            )\n        ta.allocate(\n            ax,\n            x_coords,\n            y_cords,\n            texts,\n            x_scatter=table[\"CLUSTER\"].tolist(),\n            y_scatter=table[\"MLOG10P\"].tolist(),\n            x_lines=[[table[\"CLUSTER\"].max(), table[\"CLUSTER\"].min()]],\n            y_lines=[[sig_level, sig_level]],\n            linewidth=1,\n            avoid_crossing_label_lines=True,\n            avoid_label_lines_overlap=True,\n            linecolor=\"black\",\n            textsize=self.plot_options.annotation_text_size,\n        )\n\n    figs = {\"hba_magma_fig\": fig}\n    write_plots_to_dir(scratch_dir, figs)\n\n    return DirectoryAsset(scratch_dir)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_gene_set_result/","title":"magma_plot_gene_set_result","text":""},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_gene_set_result/#mecfs_bio.build_system.task.magma.magma_plot_gene_set_result","title":"mecfs_bio.build_system.task.magma.magma_plot_gene_set_result","text":"<p>Classes:</p> <ul> <li> <code>MAGMAPlotGeneSetResult</code>           \u2013            </li> </ul> <p>Attributes:</p> <ul> <li> <code>MAGMA_GENE_SET_PLOT_NAME</code>           \u2013            </li> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_gene_set_result/#mecfs_bio.build_system.task.magma.magma_plot_gene_set_result.MAGMA_GENE_SET_PLOT_NAME","title":"MAGMA_GENE_SET_PLOT_NAME  <code>module-attribute</code>","text":"<pre><code>MAGMA_GENE_SET_PLOT_NAME = 'magma_gene_set_plot'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_gene_set_result/#mecfs_bio.build_system.task.magma.magma_plot_gene_set_result.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_gene_set_result/#mecfs_bio.build_system.task.magma.magma_plot_gene_set_result.MAGMAPlotGeneSetResult","title":"MAGMAPlotGeneSetResult","text":"<p>               Bases: <code>Task</code></p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>gene_set_analysis_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>label_col</code>               (<code>str</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>number_of_bars</code>               (<code>int</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_gene_set_result/#mecfs_bio.build_system.task.magma.magma_plot_gene_set_result.MAGMAPlotGeneSetResult.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_gene_set_result/#mecfs_bio.build_system.task.magma.magma_plot_gene_set_result.MAGMAPlotGeneSetResult.gene_set_analysis_task","title":"gene_set_analysis_task  <code>instance-attribute</code>","text":"<pre><code>gene_set_analysis_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_gene_set_result/#mecfs_bio.build_system.task.magma.magma_plot_gene_set_result.MAGMAPlotGeneSetResult.label_col","title":"label_col  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>label_col: str = 'FULL_NAME'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_gene_set_result/#mecfs_bio.build_system.task.magma.magma_plot_gene_set_result.MAGMAPlotGeneSetResult.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_gene_set_result/#mecfs_bio.build_system.task.magma.magma_plot_gene_set_result.MAGMAPlotGeneSetResult.number_of_bars","title":"number_of_bars  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>number_of_bars: int = 20\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_gene_set_result/#mecfs_bio.build_system.task.magma.magma_plot_gene_set_result.MAGMAPlotGeneSetResult.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    gene_set_analysis_task: Task,\n    asset_id: str,\n    number_of_bars: int = 20,\n    label_col: str = \"FULL_NAME\",\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_plot_gene_set_result.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    gene_set_analysis_task: Task,\n    asset_id: str,\n    number_of_bars: int = 20,\n    label_col: str = \"FULL_NAME\",\n):\n    source_meta = gene_set_analysis_task.meta\n    assert isinstance(source_meta, ProcessedGwasDataDirectoryMeta)\n    meta = GWASPlotDirectoryMeta(\n        trait=source_meta.trait,\n        project=source_meta.project,\n        id=AssetId(asset_id),\n        sub_dir=PurePath(\"analysis/magma_plots\"),\n    )\n    return cls(\n        meta,\n        gene_set_analysis_task=gene_set_analysis_task,\n        number_of_bars=number_of_bars,\n        label_col=label_col,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_plot_gene_set_result/#mecfs_bio.build_system.task.magma.magma_plot_gene_set_result.MAGMAPlotGeneSetResult.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_plot_gene_set_result.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    gene_set_dir_asset = fetch(self._source_id)\n    assert isinstance(gene_set_dir_asset, DirectoryAsset)\n    result_path = gene_set_dir_asset.path / str(\n        GENE_SET_ANALYSIS_OUTPUT_STEM_NAME + \".gsa.out\"\n    )\n    df = pd.read_csv(result_path, comment=\"#\", sep=r\"\\s+\")\n    num_tests = len(df)\n    df[GWASLAB_MLOG10P_COL] = -np.log10(df[\"P\"])\n    logger.debug(f\"Found {num_tests} tests\")\n    thresh = 0.05 / num_tests\n    logger.debug(f\"Bonferroni thresh: {thresh}\")\n    trunc_df = df.sort_values(by=[\"P\"], ascending=True).iloc[: self.number_of_bars]\n    trunc_df[\"Significance\"] = float(\"nan\")\n    trunc_df[\"Significance\"] = \"Significant\"\n    trunc_df[\"Significance\"] = trunc_df[\"Significance\"].where(\n        trunc_df[\"P\"] &lt;= thresh, \"Not Significant\"\n    )\n    plot = px.bar(\n        trunc_df,\n        x=self.label_col,\n        y=GWASLAB_MLOG10P_COL,\n        labels={\n            self.label_col: \"Variable\",\n            GWASLAB_MLOG10P_COL: \"-log\\u2081\\u2080p\",\n        },\n        color=\"Significance\",\n        color_discrete_map={\n            \"Significant\": px.colors.qualitative.Plotly[1],\n            \"Not Significant\": px.colors.qualitative.Plotly[0],\n        },\n    )\n    plot.add_hline(\n        -np.log10(thresh),\n        line_dash=\"dot\",\n        annotation_text=\"Significance threshold (Bonferroni)\",\n        annotation_xshift=-10,\n    )\n    plots = {MAGMA_GENE_SET_PLOT_NAME: plot}\n    write_plots_to_dir(scratch_dir, plots)\n    return DirectoryAsset(scratch_dir)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_snp_location_task/","title":"magma_snp_location_task","text":""},{"location":"reference/mecfs_bio/build_system/task/magma/magma_snp_location_task/#mecfs_bio.build_system.task.magma.magma_snp_location_task","title":"mecfs_bio.build_system.task.magma.magma_snp_location_task","text":"<p>Classes:</p> <ul> <li> <code>MagmaSNPFileTask</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_snp_location_task/#mecfs_bio.build_system.task.magma.magma_snp_location_task.MagmaSNPFileTask","title":"MagmaSNPFileTask","text":"<p>               Bases: <code>Task</code></p> <p>Methods:</p> <ul> <li> <code>create_for_magma_snp_p_value_file</code>             \u2013              </li> <li> <code>create_for_magma_snp_p_value_file_compute_if_needed</code>             \u2013              </li> <li> <code>create_for_magma_snp_p_value_file_precomputed_p</code>             \u2013              <p>As above, but assume the data already contains p values.</p> </li> <li> <code>create_for_magma_snp_pos_file</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>extra_columns_to_output</code>               (<code>list[str]</code>)           \u2013            </li> <li> <code>gwas_parquet_with_rsid_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>pipes</code>               (<code>Sequence[DataProcessingPipe]</code>)           \u2013            </li> <li> <code>source_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>source_meta</code>               (<code>Meta</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_snp_location_task/#mecfs_bio.build_system.task.magma.magma_snp_location_task.MagmaSNPFileTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_snp_location_task/#mecfs_bio.build_system.task.magma.magma_snp_location_task.MagmaSNPFileTask.extra_columns_to_output","title":"extra_columns_to_output  <code>instance-attribute</code>","text":"<pre><code>extra_columns_to_output: list[str]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_snp_location_task/#mecfs_bio.build_system.task.magma.magma_snp_location_task.MagmaSNPFileTask.gwas_parquet_with_rsid_task","title":"gwas_parquet_with_rsid_task  <code>instance-attribute</code>","text":"<pre><code>gwas_parquet_with_rsid_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_snp_location_task/#mecfs_bio.build_system.task.magma.magma_snp_location_task.MagmaSNPFileTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_snp_location_task/#mecfs_bio.build_system.task.magma.magma_snp_location_task.MagmaSNPFileTask.pipes","title":"pipes  <code>instance-attribute</code>","text":"<pre><code>pipes: Sequence[DataProcessingPipe]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_snp_location_task/#mecfs_bio.build_system.task.magma.magma_snp_location_task.MagmaSNPFileTask.source_id","title":"source_id  <code>property</code>","text":"<pre><code>source_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_snp_location_task/#mecfs_bio.build_system.task.magma.magma_snp_location_task.MagmaSNPFileTask.source_meta","title":"source_meta  <code>property</code>","text":"<pre><code>source_meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_snp_location_task/#mecfs_bio.build_system.task.magma.magma_snp_location_task.MagmaSNPFileTask.create_for_magma_snp_p_value_file","title":"create_for_magma_snp_p_value_file  <code>classmethod</code>","text":"<pre><code>create_for_magma_snp_p_value_file(\n    gwas_parquet_with_rsids_task: Task,\n    asset_id: str,\n    pipes: list[DataProcessingPipe] | None = None,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_snp_location_task.py</code> <pre><code>@classmethod\ndef create_for_magma_snp_p_value_file(\n    cls,\n    gwas_parquet_with_rsids_task: Task,\n    asset_id: str,\n    pipes: list[DataProcessingPipe] | None = None,\n):\n    if pipes is None:\n        pipes = []\n    pipes.append(ComputePPipe())\n    extra_cols = [GWASLAB_P_COL]\n    source_meta = gwas_parquet_with_rsids_task.meta\n    meta = create_new_meta(\n        source_meta,\n        asset_id=asset_id,\n        format=DataFrameTextFormat(\n            separator=\" \",\n            has_header=False,\n            column_names=[GWASLAB_RSID_COL] + extra_cols,\n        ),\n        extension=\".id.p.txt\",\n    )\n    return cls(\n        meta=meta,\n        gwas_parquet_with_rsid_task=gwas_parquet_with_rsids_task,\n        extra_columns_to_output=extra_cols,\n        pipes=pipes,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_snp_location_task/#mecfs_bio.build_system.task.magma.magma_snp_location_task.MagmaSNPFileTask.create_for_magma_snp_p_value_file_compute_if_needed","title":"create_for_magma_snp_p_value_file_compute_if_needed  <code>classmethod</code>","text":"<pre><code>create_for_magma_snp_p_value_file_compute_if_needed(\n    gwas_parquet_with_rsids_task: Task,\n    asset_id: str,\n    pipes: list[DataProcessingPipe] | None = None,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_snp_location_task.py</code> <pre><code>@classmethod\ndef create_for_magma_snp_p_value_file_compute_if_needed(\n    cls,\n    gwas_parquet_with_rsids_task: Task,\n    asset_id: str,\n    pipes: list[DataProcessingPipe] | None = None,\n):\n    if pipes is None:\n        pipes = []\n    pipes.append(ComputePIfNeededPipe())\n    extra_cols = [GWASLAB_P_COL]\n    source_meta = gwas_parquet_with_rsids_task.meta\n    meta = create_new_meta(\n        source_meta,\n        asset_id=asset_id,\n        format=DataFrameTextFormat(\n            separator=\" \",\n            has_header=False,\n            column_names=[GWASLAB_RSID_COL] + extra_cols,\n        ),\n        extension=\".id.p.txt\",\n    )\n    return cls(\n        meta=meta,\n        gwas_parquet_with_rsid_task=gwas_parquet_with_rsids_task,\n        extra_columns_to_output=extra_cols,\n        pipes=pipes,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_snp_location_task/#mecfs_bio.build_system.task.magma.magma_snp_location_task.MagmaSNPFileTask.create_for_magma_snp_p_value_file_precomputed_p","title":"create_for_magma_snp_p_value_file_precomputed_p  <code>classmethod</code>","text":"<pre><code>create_for_magma_snp_p_value_file_precomputed_p(\n    gwas_parquet_with_rsids_task: Task, asset_id: str\n)\n</code></pre> <p>As above, but assume the data already contains p values.</p> Source code in <code>mecfs_bio/build_system/task/magma/magma_snp_location_task.py</code> <pre><code>@classmethod\ndef create_for_magma_snp_p_value_file_precomputed_p(\n    cls,\n    gwas_parquet_with_rsids_task: Task,\n    asset_id: str,\n):\n    \"\"\"\n    As above, but assume the data already contains p values.\n    \"\"\"\n    extra_cols = [GWASLAB_P_COL]\n    source_meta = gwas_parquet_with_rsids_task.meta\n    meta = create_new_meta(\n        source_meta,\n        asset_id=asset_id,\n        format=DataFrameTextFormat(\n            separator=\" \",\n            has_header=False,\n            column_names=[GWASLAB_RSID_COL] + extra_cols,\n        ),\n        extension=\".id.p.txt\",\n    )\n    return cls(\n        meta=meta,\n        gwas_parquet_with_rsid_task=gwas_parquet_with_rsids_task,\n        extra_columns_to_output=extra_cols,\n        pipes=[],\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_snp_location_task/#mecfs_bio.build_system.task.magma.magma_snp_location_task.MagmaSNPFileTask.create_for_magma_snp_pos_file","title":"create_for_magma_snp_pos_file  <code>classmethod</code>","text":"<pre><code>create_for_magma_snp_pos_file(\n    gwas_parquet_with_rsids_task: Task,\n    asset_id: str,\n    pipes: list[DataProcessingPipe] | None = None,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_snp_location_task.py</code> <pre><code>@classmethod\ndef create_for_magma_snp_pos_file(\n    cls,\n    gwas_parquet_with_rsids_task: Task,\n    asset_id: str,\n    pipes: list[DataProcessingPipe] | None = None,\n):\n    if pipes is None:\n        pipes = []\n    extra_cols = [GWASLAB_CHROM_COL, GWASLAB_POS_COL]\n    source_meta = gwas_parquet_with_rsids_task.meta\n    meta = create_new_meta(\n        source_meta,\n        asset_id=asset_id,\n        format=DataFrameTextFormat(\n            separator=\" \",\n            has_header=False,\n            column_names=[GWASLAB_RSID_COL] + extra_cols,\n        ),\n        extension=\".id.chr.genpos.txt\",\n    )\n    return cls(\n        meta=meta,\n        gwas_parquet_with_rsid_task=gwas_parquet_with_rsids_task,\n        extra_columns_to_output=extra_cols,\n        pipes=pipes,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_snp_location_task/#mecfs_bio.build_system.task.magma.magma_snp_location_task.MagmaSNPFileTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_snp_location_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    source_asset = fetch(self.source_id)\n    gwas_data = scan_dataframe_asset(source_asset, meta=self.source_meta)\n    for pipe in self.pipes:\n        gwas_data = pipe.process(gwas_data)\n    gwas_data = gwas_data.unique(\n        subset=GWASLAB_RSID_COL, order_by=[GWASLAB_CHROM_COL, GWASLAB_POS_COL]\n    )\n    out_path = scratch_dir / \"output\"\n    gwas_data.sort([GWASLAB_CHROM_COL, GWASLAB_POS_COL]).select(\n        GWASLAB_RSID_COL, *self.extra_columns_to_output\n    ).collect().to_polars().write_csv(out_path, include_header=False, separator=\" \")\n    return FileAsset(\n        out_path,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_subset_specificity_matrix_using_top_labels/","title":"magma_subset_specificity_matrix_using_top_labels","text":""},{"location":"reference/mecfs_bio/build_system/task/magma/magma_subset_specificity_matrix_using_top_labels/#mecfs_bio.build_system.task.magma.magma_subset_specificity_matrix_using_top_labels","title":"mecfs_bio.build_system.task.magma.magma_subset_specificity_matrix_using_top_labels","text":"<p>Classes:</p> <ul> <li> <code>MagmaSubsetSpecificityMatrixWithTopLabels</code>           \u2013            <p>Task to prune a gene specificity matrix to include only the gene-property/gene-covariates that</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>get_spec_matrix_filtered</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_subset_specificity_matrix_using_top_labels/#mecfs_bio.build_system.task.magma.magma_subset_specificity_matrix_using_top_labels.MagmaSubsetSpecificityMatrixWithTopLabels","title":"MagmaSubsetSpecificityMatrixWithTopLabels","text":"<p>               Bases: <code>Task</code></p> <p>Task to prune a gene specificity matrix to include only the gene-property/gene-covariates that are found to be significant</p> <p>Intention is to mimic the operation described here: https://github.com/Integrative-Mental-Health-Lab/linking_cell_types_to_brain_phenotypes/blob/675b5c9b58b8762934183a3ca61ae49ad587934a/MAGMA/3.create_top_results_matrix.md</p> <p>Generally, this task is used as a preprocessing step for conditional MAGMA analysis.</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>gene_covar_result_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>magma_gene_covar_analysis_task</code>               (<code>MagmaGeneSetAnalysisTask</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>nominal_sig_level</code>               (<code>float</code>)           \u2013            </li> <li> <code>spec_matrix_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>spec_matrix_meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>specificity_matrix_task</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_subset_specificity_matrix_using_top_labels/#mecfs_bio.build_system.task.magma.magma_subset_specificity_matrix_using_top_labels.MagmaSubsetSpecificityMatrixWithTopLabels.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_subset_specificity_matrix_using_top_labels/#mecfs_bio.build_system.task.magma.magma_subset_specificity_matrix_using_top_labels.MagmaSubsetSpecificityMatrixWithTopLabels.gene_covar_result_id","title":"gene_covar_result_id  <code>property</code>","text":"<pre><code>gene_covar_result_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_subset_specificity_matrix_using_top_labels/#mecfs_bio.build_system.task.magma.magma_subset_specificity_matrix_using_top_labels.MagmaSubsetSpecificityMatrixWithTopLabels.magma_gene_covar_analysis_task","title":"magma_gene_covar_analysis_task  <code>instance-attribute</code>","text":"<pre><code>magma_gene_covar_analysis_task: MagmaGeneSetAnalysisTask\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_subset_specificity_matrix_using_top_labels/#mecfs_bio.build_system.task.magma.magma_subset_specificity_matrix_using_top_labels.MagmaSubsetSpecificityMatrixWithTopLabels.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_subset_specificity_matrix_using_top_labels/#mecfs_bio.build_system.task.magma.magma_subset_specificity_matrix_using_top_labels.MagmaSubsetSpecificityMatrixWithTopLabels.nominal_sig_level","title":"nominal_sig_level  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>nominal_sig_level: float = 0.05\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_subset_specificity_matrix_using_top_labels/#mecfs_bio.build_system.task.magma.magma_subset_specificity_matrix_using_top_labels.MagmaSubsetSpecificityMatrixWithTopLabels.spec_matrix_id","title":"spec_matrix_id  <code>property</code>","text":"<pre><code>spec_matrix_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_subset_specificity_matrix_using_top_labels/#mecfs_bio.build_system.task.magma.magma_subset_specificity_matrix_using_top_labels.MagmaSubsetSpecificityMatrixWithTopLabels.spec_matrix_meta","title":"spec_matrix_meta  <code>property</code>","text":"<pre><code>spec_matrix_meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_subset_specificity_matrix_using_top_labels/#mecfs_bio.build_system.task.magma.magma_subset_specificity_matrix_using_top_labels.MagmaSubsetSpecificityMatrixWithTopLabels.specificity_matrix_task","title":"specificity_matrix_task  <code>instance-attribute</code>","text":"<pre><code>specificity_matrix_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_subset_specificity_matrix_using_top_labels/#mecfs_bio.build_system.task.magma.magma_subset_specificity_matrix_using_top_labels.MagmaSubsetSpecificityMatrixWithTopLabels.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    specificity_matrix_task: Task,\n    magma_gene_covar_analysis_task: MagmaGeneSetAnalysisTask,\n    nominal_sig_level: float = 0.05,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_subset_specificity_matrix_using_top_labels.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    specificity_matrix_task: Task,\n    magma_gene_covar_analysis_task: MagmaGeneSetAnalysisTask,\n    nominal_sig_level: float = 0.05,\n):\n    source_meta = magma_gene_covar_analysis_task.meta\n    assert isinstance(source_meta, ProcessedGwasDataDirectoryMeta)\n    meta = ResultTableMeta(\n        id=AssetId(asset_id),\n        trait=source_meta.trait,\n        project=source_meta.project,\n        extension=\".txt\",\n        read_spec=DataFrameReadSpec(DataFrameTextFormat(separator=\"\\t\")),\n    )\n    return cls(\n        meta=meta,\n        specificity_matrix_task=specificity_matrix_task,\n        magma_gene_covar_analysis_task=magma_gene_covar_analysis_task,\n        nominal_sig_level=nominal_sig_level,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_subset_specificity_matrix_using_top_labels/#mecfs_bio.build_system.task.magma.magma_subset_specificity_matrix_using_top_labels.MagmaSubsetSpecificityMatrixWithTopLabels.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_subset_specificity_matrix_using_top_labels.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    spec_matrix_asset = fetch(self.spec_matrix_id)\n    spec_matrix = (\n        scan_dataframe_asset(spec_matrix_asset, meta=self.spec_matrix_meta)\n        .collect()\n        .to_pandas()\n    )\n\n    gene_set_result_asset = fetch(self.gene_covar_result_id)\n    assert isinstance(gene_set_result_asset, DirectoryAsset)\n\n    path_to_gene_covar_result = (gene_set_result_asset.path) / (\n        GENE_SET_ANALYSIS_OUTPUT_STEM_NAME + \".gsa.out\"\n    )\n\n    covar_result = (\n        scan_dataframe(\n            path_to_gene_covar_result,\n            spec=DataFrameReadSpec(\n                DataFrameWhiteSpaceSepTextFormat(comment_code=\"#\")\n            ),\n        )\n        .collect()\n        .to_pandas()\n    )\n    spec_matrix_filtered = get_spec_matrix_filtered(\n        covar_result=covar_result,\n        spec_matrix=spec_matrix,\n        nominal_sig_level=self.nominal_sig_level,\n    )\n    out_path = scratch_dir / self.asset_id\n    spec_matrix_filtered.to_csv(out_path, index=False, sep=\"\\t\")\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/magma_subset_specificity_matrix_using_top_labels/#mecfs_bio.build_system.task.magma.magma_subset_specificity_matrix_using_top_labels.get_spec_matrix_filtered","title":"get_spec_matrix_filtered","text":"<pre><code>get_spec_matrix_filtered(\n    covar_result: DataFrame,\n    spec_matrix: DataFrame,\n    nominal_sig_level: float,\n) -&gt; pd.DataFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/magma_subset_specificity_matrix_using_top_labels.py</code> <pre><code>def get_spec_matrix_filtered(\n    covar_result: pd.DataFrame,\n    spec_matrix: pd.DataFrame,\n    nominal_sig_level: float,\n) -&gt; pd.DataFrame:\n    alpha = nominal_sig_level / len(covar_result)\n    filtered_covar_result = covar_result.loc[covar_result[\"P\"] &lt; alpha]\n    filtered_covar_result = filtered_covar_result.sort_values(by=[\"P\"])\n    sig_list = filtered_covar_result[\"VARIABLE\"].tolist()\n    cols = [\"GENE\"] + sig_list\n    spec_matrix_filtered: pd.DataFrame = spec_matrix.loc[:, cols]\n    return spec_matrix_filtered\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result/","title":"plot_magma_brain_atlas_result","text":""},{"location":"reference/mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result/#mecfs_bio.build_system.task.magma.plot_magma_brain_atlas_result","title":"mecfs_bio.build_system.task.magma.plot_magma_brain_atlas_result","text":"<p>Task to  plot the results of applying MAGMA using the human brain atlas as a reference. Attempts to match the style of the graphs from     Duncan, Laramie E., et al. \"Mapping the cellular etiology of schizophrenia and complex brain phenotypes.\" Nature Neuroscience 28.2 (2025): 248-258.</p> <p>Classes:</p> <ul> <li> <code>PlotMagmaBrainAtlasResultTask</code>           \u2013            <p>Task to create a plot of the results of applying MAGMA using the human brain atlas data as a reference</p> </li> <li> <code>PlotSettings</code>           \u2013            </li> </ul> <p>Functions:</p> <ul> <li> <code>add_cluster_column_to_metadata_df</code>             \u2013              </li> <li> <code>get_condensed_hba_cluster_label</code>             \u2013              <p>Get a short label for a cluster than can be used to annotate points on the plot</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>BRAIN_ATLAS_PLOT_NAME</code>           \u2013            </li> <li> <code>DUNCAN_ET_AL_2025_COLORMAP</code>           \u2013            </li> <li> <code>KEY_HBA_ANNOTATION_COLUMNS</code>           \u2013            </li> <li> <code>PlotMode</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result/#mecfs_bio.build_system.task.magma.plot_magma_brain_atlas_result.BRAIN_ATLAS_PLOT_NAME","title":"BRAIN_ATLAS_PLOT_NAME  <code>module-attribute</code>","text":"<pre><code>BRAIN_ATLAS_PLOT_NAME = 'human_brain_atlas_plot'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result/#mecfs_bio.build_system.task.magma.plot_magma_brain_atlas_result.DUNCAN_ET_AL_2025_COLORMAP","title":"DUNCAN_ET_AL_2025_COLORMAP  <code>module-attribute</code>","text":"<pre><code>DUNCAN_ET_AL_2025_COLORMAP = {\n    \"Miscellaneous\": \"#8D4517\",\n    \"Microglia\": \"#333333\",\n    \"Vascular\": \"#4D4D4D\",\n    \"Fibroblast\": \"#656565\",\n    \"Oligodendrocyte.precursor\": \"#727272\",\n    \"Committed.oligodendrocyte.precursor\": \"#7F7F7F\",\n    \"Oligodendrocyte\": \"#8C8C8C\",\n    \"Bergmann.glia\": \"#9A9A9A\",\n    \"Astrocyte\": \"#A8A8A8\",\n    \"Ependymal\": \"#BFBFBF\",\n    \"Choroid.plexus\": \"#D9D9D9\",\n    \"Deep-layer.near-projecting\": \"#E41A1C\",\n    \"Deep-layer.corticothalamic.and.6b\": \"#FF7F00\",\n    \"Hippocampal.CA1-3\": \"#FDBF6F\",\n    \"Upper-layer.intratelencephalic\": \"#FFFF33\",\n    \"Deep-layer.intratelencephalic\": \"#B2DF8A\",\n    \"Amygdala.excitatory\": \"#66C2A5\",\n    \"Hippocampal.CA4\": \"#33A02C\",\n    \"Hippocampal.dentate.gyrus\": \"#1B9E77\",\n    \"Medium.spiny.neuron\": \"#00CC99\",\n    \"Eccentric.medium.spiny.neuron\": \"#1CE6B3\",\n    \"Splatter\": \"#00E5FF\",\n    \"MGE.interneuron\": \"#1F78B4\",\n    \"LAMP5-LHX6.and.Chandelier\": \"#6A3D9A\",\n    \"CGE.interneuron\": \"#0000FF\",\n    \"Upper.rhombic.lip\": \"#5E3C99\",\n    \"Cerebellar.inhibitory\": \"#7B3294\",\n    \"Lower.rhombic.lip\": \"#8E0152\",\n    \"Mammillary.body\": \"#E7298A\",\n    \"Thalamic.excitatory\": \"#FF1493\",\n    \"Midbrain-derived.inhibitory\": \"#E31A1C\",\n}\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result/#mecfs_bio.build_system.task.magma.plot_magma_brain_atlas_result.KEY_HBA_ANNOTATION_COLUMNS","title":"KEY_HBA_ANNOTATION_COLUMNS  <code>module-attribute</code>","text":"<pre><code>KEY_HBA_ANNOTATION_COLUMNS = [\n    \"Supercluster\",\n    \"Class auto-annotation\",\n    \"Neurotransmitter auto-annotation\",\n    \"Neuropeptide auto-annotation\",\n    \"Subtype auto-annotation\",\n    \"Transferred MTG Label\",\n    \"Top three regions\",\n    \"Top Enriched Genes\",\n]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result/#mecfs_bio.build_system.task.magma.plot_magma_brain_atlas_result.PlotMode","title":"PlotMode  <code>module-attribute</code>","text":"<pre><code>PlotMode = Literal['plotly_white', 'plotly_dark']\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result/#mecfs_bio.build_system.task.magma.plot_magma_brain_atlas_result.PlotMagmaBrainAtlasResultTask","title":"PlotMagmaBrainAtlasResultTask","text":"<p>               Bases: <code>Task</code></p> <p>Task to create a plot of the results of applying MAGMA using the human brain atlas data as a reference</p> <p>Attempts to match the style of the graphs from: Duncan, Laramie E., et al. \"Mapping the cellular etiology of schizophrenia and complex brain phenotypes.\" Nature Neuroscience 28.2 (2025): 248-258.</p> <p>Note that \"cluster annotation task\" brings in some metadata, but this metadata is currently not used in the graph. In the future, we may use this metadata</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>annotation_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>annotation_meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>cluster_annotation_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>plot_mode</code>               (<code>PlotMode</code>)           \u2013            </li> <li> <code>result_table_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>source_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>source_meta</code>               (<code>Meta</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result/#mecfs_bio.build_system.task.magma.plot_magma_brain_atlas_result.PlotMagmaBrainAtlasResultTask.annotation_id","title":"annotation_id  <code>property</code>","text":"<pre><code>annotation_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result/#mecfs_bio.build_system.task.magma.plot_magma_brain_atlas_result.PlotMagmaBrainAtlasResultTask.annotation_meta","title":"annotation_meta  <code>property</code>","text":"<pre><code>annotation_meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result/#mecfs_bio.build_system.task.magma.plot_magma_brain_atlas_result.PlotMagmaBrainAtlasResultTask.cluster_annotation_task","title":"cluster_annotation_task  <code>instance-attribute</code>","text":"<pre><code>cluster_annotation_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result/#mecfs_bio.build_system.task.magma.plot_magma_brain_atlas_result.PlotMagmaBrainAtlasResultTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result/#mecfs_bio.build_system.task.magma.plot_magma_brain_atlas_result.PlotMagmaBrainAtlasResultTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result/#mecfs_bio.build_system.task.magma.plot_magma_brain_atlas_result.PlotMagmaBrainAtlasResultTask.plot_mode","title":"plot_mode  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>plot_mode: PlotMode = 'plotly_dark'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result/#mecfs_bio.build_system.task.magma.plot_magma_brain_atlas_result.PlotMagmaBrainAtlasResultTask.result_table_task","title":"result_table_task  <code>instance-attribute</code>","text":"<pre><code>result_table_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result/#mecfs_bio.build_system.task.magma.plot_magma_brain_atlas_result.PlotMagmaBrainAtlasResultTask.source_id","title":"source_id  <code>property</code>","text":"<pre><code>source_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result/#mecfs_bio.build_system.task.magma.plot_magma_brain_atlas_result.PlotMagmaBrainAtlasResultTask.source_meta","title":"source_meta  <code>property</code>","text":"<pre><code>source_meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result/#mecfs_bio.build_system.task.magma.plot_magma_brain_atlas_result.PlotMagmaBrainAtlasResultTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    result_table_task: Task,\n    cluster_annotation_task: Task,\n    asset_id: str,\n    plot_settings: PlotSettings = PlotSettings(),\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    result_table_task: Task,\n    cluster_annotation_task: Task,\n    asset_id: str,\n    plot_settings: PlotSettings = PlotSettings(),\n):\n    source_meta = result_table_task.meta\n    assert isinstance(source_meta, ResultTableMeta)\n    meta = GWASPlotDirectoryMeta(\n        trait=source_meta.trait,\n        project=source_meta.project,\n        id=AssetId(asset_id),\n        sub_dir=PurePath(\"analysis/magma_plots\"),\n    )\n    return cls(\n        meta=meta,\n        result_table_task=result_table_task,\n        cluster_annotation_task=cluster_annotation_task,\n        plot_mode=plot_settings.plot_mode,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result/#mecfs_bio.build_system.task.magma.plot_magma_brain_atlas_result.PlotMagmaBrainAtlasResultTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    source_asset = fetch(self.source_id)\n    annotation_asset = fetch(self.annotation_id)\n    table = (\n        scan_dataframe_asset(asset=source_asset, meta=self.source_meta)\n        .collect()\n        .to_pandas()\n    )\n    annotation_table = (\n        scan_dataframe_asset(asset=annotation_asset, meta=self.annotation_meta)\n        .collect()\n        .to_pandas()\n    )\n    table[\"MLOG10P\"] = -np.log10(table[\"P\"])\n    table[\"CLUSTER\"] = table[\"VARIABLE\"].str.extract(r\"Cluster([0-9]+)\").astype(int)\n    table = table.sort_values(by=\"CLUSTER\")\n    sorted_table = table.sort_values(by=\"P\")\n    top_cluster = sorted_table.iloc[0]\n    top_cluster_label = get_condensed_hba_cluster_label(top_cluster)\n    colormap = {\n        key.replace(\".\", \" \"): val\n        for key, val in DUNCAN_ET_AL_2025_COLORMAP.items()\n    }\n    plot = px.scatter(\n        table,\n        x=\"CLUSTER\",\n        y=\"MLOG10P\",\n        labels={\n            \"CLUSTER\": \"Cluster\",\n            \"MLOG10P\": \"-log\\u2081\\u2080p\",\n        },\n        color=\"Supercluster\",\n        color_discrete_map=colormap,\n        template=self.plot_mode,\n        hover_data={\n            \"Supercluster\": True,\n            \"Class auto-annotation\": True,\n            \"Neurotransmitter auto-annotation\": True,\n            \"Neuropeptide auto-annotation\": True,\n            \"Subtype auto-annotation\": True,\n            \"Transferred MTG Label\": True,\n            \"Top three regions\": True,\n            \"Top Enriched Genes\": True,\n        },\n        # size_max=20\n    )\n    plot = plot.update_traces(marker=dict(size=15))\n    plot.update_layout(\n        xaxis_title_font=dict(size=21),\n        yaxis_title_font=dict(size=21),\n        legend=dict(\n            orientation=\"h\",\n            yanchor=\"bottom\",\n            y=0,\n            xanchor=\"center\",\n            x=0.5,\n            yref=\"container\",\n            title=dict(\n                side=\"top\",\n            ),\n        ),\n        margin=dict(l=0, r=0, t=2, b=2),\n    )\n    plot.update_xaxes(zeroline=False)\n\n    sig_level = -math.log10(0.01 / len(table))\n    line_color = \"white\" if self.plot_mode == \"plotly_dark\" else \"black\"\n    plot = plot.add_hline(\n        y=sig_level,\n        line_color=line_color,\n        line_dash=\"dot\",\n        opacity=0.5,\n    )\n    plot = plot.add_annotation(\n        x=float(top_cluster[\"CLUSTER\"]),\n        y=float(top_cluster[\"MLOG10P\"]),\n        text=top_cluster_label,\n        font=dict(  # Customize font properties\n            size=15,\n            color=colormap[top_cluster[\"Supercluster\"]],\n        ),\n        arrowhead=2,  # Style of the arrowhead\n        arrowsize=1,  # Size of the arrowhead\n        arrowwidth=2,  # Width of the arrow line\n        arrowcolor=colormap[top_cluster[\"Supercluster\"]],\n        ay=-60,  # Y-component of the arrow tail offset (pixels from head)\n        standoff=10,\n    )\n    plots = {BRAIN_ATLAS_PLOT_NAME: plot}\n    write_plots_to_dir(scratch_dir, plots)\n    return DirectoryAsset(scratch_dir)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result/#mecfs_bio.build_system.task.magma.plot_magma_brain_atlas_result.PlotSettings","title":"PlotSettings","text":"<p>Attributes:</p> <ul> <li> <code>plot_mode</code>               (<code>PlotMode</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result/#mecfs_bio.build_system.task.magma.plot_magma_brain_atlas_result.PlotSettings.plot_mode","title":"plot_mode  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>plot_mode: PlotMode = 'plotly_dark'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result/#mecfs_bio.build_system.task.magma.plot_magma_brain_atlas_result.add_cluster_column_to_metadata_df","title":"add_cluster_column_to_metadata_df","text":"<pre><code>add_cluster_column_to_metadata_df(\n    metadata_df: DataFrame,\n) -&gt; pd.DataFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result.py</code> <pre><code>def add_cluster_column_to_metadata_df(metadata_df: pd.DataFrame) -&gt; pd.DataFrame:\n    # filter to get only clusters\n    cluster_df = metadata_df.loc[\n        metadata_df[\"cluster_annotation_term_set_name\"] == \"cluster\"\n    ]\n    cluster_df[\"CLUSTER\"] = (\n        cluster_df[\"description\"].str.extract(\"cluster ([0-9]+)\").astype(int)\n    )\n    return cluster_df\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result/#mecfs_bio.build_system.task.magma.plot_magma_brain_atlas_result.get_condensed_hba_cluster_label","title":"get_condensed_hba_cluster_label","text":"<pre><code>get_condensed_hba_cluster_label(\n    cluster_info: Series,\n) -&gt; str\n</code></pre> <p>Get a short label for a cluster than can be used to annotate points on the plot</p> Source code in <code>mecfs_bio/build_system/task/magma/plot_magma_brain_atlas_result.py</code> <pre><code>def get_condensed_hba_cluster_label(cluster_info: pd.Series) -&gt; str:\n    \"\"\"\n    Get a short label for a cluster than can be used to annotate points on the plot\n    \"\"\"\n    result = str(cluster_info[\"Supercluster\"])\n    extra_info = []\n    if cluster_info[\"Class auto-annotation\"] not in [\"0\", \"NEUR\"]:\n        extra_info.append(cluster_info[\"Class auto-annotation\"])\n    if cluster_info[\"Subtype auto-annotation\"] != \"0\":\n        extra_info.append(cluster_info[\"Subtype auto-annotation\"])\n    if cluster_info[\"Neurotransmitter auto-annotation\"] != \"0\":\n        extra_info.append(cluster_info[\"Neurotransmitter auto-annotation\"])\n    if (\n        cluster_info[\"Neuropeptide auto-annotation\"] != \"0\"\n        and len(cluster_info[\"Neuropeptide auto-annotation\"]) &lt; 6\n    ):\n        extra_info.append(cluster_info[\"Neuropeptide auto-annotation\"])\n    if len(extra_info) &gt; 0:\n        result += f\" ({', '.join(extra_info)})\"\n    return result\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/make_executable_wrapper_task/","title":"make_executable_wrapper_task","text":""},{"location":"reference/mecfs_bio/build_system/task/make_executable_wrapper_task/#mecfs_bio.build_system.task.make_executable_wrapper_task","title":"mecfs_bio.build_system.task.make_executable_wrapper_task","text":"<p>Task to make a file executable by editing unix file permissions (a la chmod).</p> <p>Classes:</p> <ul> <li> <code>MakeExecutableWrapperTask</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/make_executable_wrapper_task/#mecfs_bio.build_system.task.make_executable_wrapper_task.MakeExecutableWrapperTask","title":"MakeExecutableWrapperTask","text":"<p>               Bases: <code>Task</code></p> <p>Methods:</p> <ul> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/make_executable_wrapper_task/#mecfs_bio.build_system.task.make_executable_wrapper_task.MakeExecutableWrapperTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/make_executable_wrapper_task/#mecfs_bio.build_system.task.make_executable_wrapper_task.MakeExecutableWrapperTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/make_executable_wrapper_task/#mecfs_bio.build_system.task.make_executable_wrapper_task.MakeExecutableWrapperTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/make_executable_wrapper_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    asset = self._inner.execute(scratch_dir=scratch_dir, fetch=fetch, wf=wf)\n    assert isinstance(asset, FileAsset)\n    current_permissions = asset.path.stat().st_mode\n    new_permissions = (\n        current_permissions | stat.S_IXUSR | stat.S_IXGRP | stat.S_IXOTH\n    )\n    os.chmod(asset.path, new_permissions)\n    return asset\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/multiple_testing_table_task/","title":"multiple_testing_table_task","text":""},{"location":"reference/mecfs_bio/build_system/task/multiple_testing_table_task/#mecfs_bio.build_system.task.multiple_testing_table_task","title":"mecfs_bio.build_system.task.multiple_testing_table_task","text":"<p>Task to compute a multiple testing correction of a table of p values. Can optionally filter rows according to a threshold</p> <p>Classes:</p> <ul> <li> <code>MultipleTestingTableTask</code>           \u2013            <p>Task to read a table of statistical test results with p values,</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>CORRECTED_COL_LABEL</code>           \u2013            </li> <li> <code>Method</code>           \u2013            </li> <li> <code>REJECT_NULL_LABEL</code>           \u2013            </li> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/multiple_testing_table_task/#mecfs_bio.build_system.task.multiple_testing_table_task.CORRECTED_COL_LABEL","title":"CORRECTED_COL_LABEL  <code>module-attribute</code>","text":"<pre><code>CORRECTED_COL_LABEL = '_Corrected P Value_'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/multiple_testing_table_task/#mecfs_bio.build_system.task.multiple_testing_table_task.Method","title":"Method  <code>module-attribute</code>","text":"<pre><code>Method = Literal['fdr_bh', 'fdr_by', 'bonferroni']\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/multiple_testing_table_task/#mecfs_bio.build_system.task.multiple_testing_table_task.REJECT_NULL_LABEL","title":"REJECT_NULL_LABEL  <code>module-attribute</code>","text":"<pre><code>REJECT_NULL_LABEL = 'Reject Null'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/multiple_testing_table_task/#mecfs_bio.build_system.task.multiple_testing_table_task.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/multiple_testing_table_task/#mecfs_bio.build_system.task.multiple_testing_table_task.MultipleTestingTableTask","title":"MultipleTestingTableTask","text":"<p>               Bases: <code>Task</code></p> <p>Task to read a table of statistical test results with p values, filter it according to some multiple-test-correction procedure, and then write the filtered table.</p> <p>table_in_dir_filename/ table_in_dir_readspec: - set these when the source task provides a directory, and we need to find a results table within that directory</p> <p>For information on multiple testing procedures, see: https://www.statsmodels.org/dev/generated/statsmodels.stats.multitest.multipletests.html</p> <p>Methods:</p> <ul> <li> <code>create_from_magma_gene_analysis_task</code>             \u2013              </li> <li> <code>create_from_result_table_task</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>alpha</code>               (<code>float</code>)           \u2013            </li> <li> <code>apply_filter</code>               (<code>bool</code>)           \u2013            </li> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>method</code>               (<code>Method</code>)           \u2013            </li> <li> <code>p_value_column</code>               (<code>str</code>)           \u2013            </li> <li> <code>table_in_dir_filename</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>table_in_dir_readspec</code>               (<code>DataFrameReadSpec | None</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/multiple_testing_table_task/#mecfs_bio.build_system.task.multiple_testing_table_task.MultipleTestingTableTask.alpha","title":"alpha  <code>instance-attribute</code>","text":"<pre><code>alpha: float\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/multiple_testing_table_task/#mecfs_bio.build_system.task.multiple_testing_table_task.MultipleTestingTableTask.apply_filter","title":"apply_filter  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>apply_filter: bool = True\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/multiple_testing_table_task/#mecfs_bio.build_system.task.multiple_testing_table_task.MultipleTestingTableTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/multiple_testing_table_task/#mecfs_bio.build_system.task.multiple_testing_table_task.MultipleTestingTableTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/multiple_testing_table_task/#mecfs_bio.build_system.task.multiple_testing_table_task.MultipleTestingTableTask.method","title":"method  <code>instance-attribute</code>","text":"<pre><code>method: Method\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/multiple_testing_table_task/#mecfs_bio.build_system.task.multiple_testing_table_task.MultipleTestingTableTask.p_value_column","title":"p_value_column  <code>instance-attribute</code>","text":"<pre><code>p_value_column: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/multiple_testing_table_task/#mecfs_bio.build_system.task.multiple_testing_table_task.MultipleTestingTableTask.table_in_dir_filename","title":"table_in_dir_filename  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>table_in_dir_filename: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/multiple_testing_table_task/#mecfs_bio.build_system.task.multiple_testing_table_task.MultipleTestingTableTask.table_in_dir_readspec","title":"table_in_dir_readspec  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>table_in_dir_readspec: DataFrameReadSpec | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/multiple_testing_table_task/#mecfs_bio.build_system.task.multiple_testing_table_task.MultipleTestingTableTask.create_from_magma_gene_analysis_task","title":"create_from_magma_gene_analysis_task  <code>classmethod</code>","text":"<pre><code>create_from_magma_gene_analysis_task(\n    alpha: float,\n    method: Method,\n    asset_id: str,\n    source_task: MagmaGeneAnalysisTask,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/multiple_testing_table_task.py</code> <pre><code>@classmethod\ndef create_from_magma_gene_analysis_task(\n    cls,\n    alpha: float,\n    method: Method,\n    asset_id: str,\n    source_task: MagmaGeneAnalysisTask,\n):\n    source_meta = source_task.meta\n    assert isinstance(source_meta, ProcessedGwasDataDirectoryMeta)\n    meta = ResultTableMeta(\n        id=asset_id,\n        trait=source_meta.trait,\n        project=source_meta.project,\n        extension=\".csv\",\n        read_spec=DataFrameReadSpec(DataFrameTextFormat(separator=\",\")),\n    )\n    return cls(\n        meta=meta,\n        table_source_task=source_task,\n        p_value_column=\"P\",\n        alpha=alpha,\n        method=method,\n        table_in_dir_filename=GENE_ANALYSIS_OUTPUT_STEM_NAME + \".genes.out\",\n        table_in_dir_readspec=DataFrameReadSpec(\n            DataFrameWhiteSpaceSepTextFormat(comment_code=\"#\")\n        ),\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/multiple_testing_table_task/#mecfs_bio.build_system.task.multiple_testing_table_task.MultipleTestingTableTask.create_from_result_table_task","title":"create_from_result_table_task  <code>classmethod</code>","text":"<pre><code>create_from_result_table_task(\n    alpha: float,\n    method: Method,\n    asset_id: str,\n    p_value_column: str,\n    source_task: Task,\n    apply_filter: bool = True,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/multiple_testing_table_task.py</code> <pre><code>@classmethod\ndef create_from_result_table_task(\n    cls,\n    alpha: float,\n    method: Method,\n    asset_id: str,\n    p_value_column: str,\n    source_task: Task,\n    apply_filter: bool = True,\n):\n    source_meta = source_task.meta\n    assert isinstance(source_meta, ResultTableMeta)\n    meta = ResultTableMeta(\n        id=asset_id,\n        trait=source_meta.trait,\n        project=source_meta.project,\n        extension=\".csv\",\n        read_spec=DataFrameReadSpec(DataFrameTextFormat(separator=\",\")),\n    )\n    return cls(\n        meta=meta,\n        table_source_task=source_task,\n        p_value_column=p_value_column,\n        alpha=alpha,\n        method=method,\n        apply_filter=apply_filter,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/multiple_testing_table_task/#mecfs_bio.build_system.task.multiple_testing_table_task.MultipleTestingTableTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/multiple_testing_table_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    asset = fetch(self._table_source_id)\n    frame = self._get_frame_from_source_asset(asset)\n    p_vals = frame[self.p_value_column]\n    logger.debug(\n        f\"\\nApplying multiple testing correction method {self.method} to dataframe with alpha {self.alpha}\"\n    )\n    logger.debug(f\"Initial dataframe contains {len(frame)} rows\")\n    reject, corrected, _, _ = multipletests(\n        pvals=p_vals, alpha=self.alpha, method=self.method\n    )\n    # logger.debug(f\"Corrected p values {corrected}\")\n    frame[CORRECTED_COL_LABEL] = corrected\n    if self.apply_filter:\n        frame = frame.loc[reject]\n        assert (frame[CORRECTED_COL_LABEL] &lt;= self.alpha).all()\n    else:\n        frame[REJECT_NULL_LABEL] = reject\n    frame: pd.DataFrame = frame.sort_values(by=[self.p_value_column])\n    out_path = scratch_dir / \"filtered_frame.csv\"\n    frame.to_csv(out_path, index=False)\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/osf_retrieve_task/","title":"osf_retrieve_task","text":""},{"location":"reference/mecfs_bio/build_system/task/osf_retrieve_task/#mecfs_bio.build_system.task.osf_retrieve_task","title":"mecfs_bio.build_system.task.osf_retrieve_task","text":"<p>A task that fetches GWAS data from the Open Science data store</p> <p>Classes:</p> <ul> <li> <code>OSFRetrievalTask</code>           \u2013            <p>A task that fetches GWAS data from the Open Science data store</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/osf_retrieve_task/#mecfs_bio.build_system.task.osf_retrieve_task.OSFRetrievalTask","title":"OSFRetrievalTask","text":"<p>               Bases: <code>GeneratingTask</code></p> <p>A task that fetches GWAS data from the Open Science data store</p> <p>Methods:</p> <ul> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>md5_hash</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>meta</code>               (<code>GWASSummaryDataFileMeta</code>)           \u2013            </li> <li> <code>osf_project_id</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/osf_retrieve_task/#mecfs_bio.build_system.task.osf_retrieve_task.OSFRetrievalTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/osf_retrieve_task/#mecfs_bio.build_system.task.osf_retrieve_task.OSFRetrievalTask.md5_hash","title":"md5_hash  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>md5_hash: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/osf_retrieve_task/#mecfs_bio.build_system.task.osf_retrieve_task.OSFRetrievalTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: GWASSummaryDataFileMeta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/osf_retrieve_task/#mecfs_bio.build_system.task.osf_retrieve_task.OSFRetrievalTask.osf_project_id","title":"osf_project_id  <code>instance-attribute</code>","text":"<pre><code>osf_project_id: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/osf_retrieve_task/#mecfs_bio.build_system.task.osf_retrieve_task.OSFRetrievalTask.execute","title":"execute","text":"<pre><code>execute(\n    scratch_dir: Path, fetch: Fetch, wf: WF\n) -&gt; FileAsset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/osf_retrieve_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; FileAsset:\n    tmp_dst = scratch_dir / \"tmp\"\n\n    @invoke.task\n    def fetch_osf(c):\n        c.run(\n            f\"pixi r osf -p {self.osf_project_id} fetch {str(shlex.quote(str(self._meta.project_path)))} {str(tmp_dst)}\"\n        )\n\n    fetch_osf(invoke.Context())\n    verify_hash(tmp_dst, self.md5_hash)\n\n    return FileAsset(\n        tmp_dst,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipe_dataframe_task/","title":"pipe_dataframe_task","text":""},{"location":"reference/mecfs_bio/build_system/task/pipe_dataframe_task/#mecfs_bio.build_system.task.pipe_dataframe_task","title":"mecfs_bio.build_system.task.pipe_dataframe_task","text":"<p>Task to transform a dataframe asset using a DataProcessingPipes.</p> <p>Classes:</p> <ul> <li> <code>CSVOutFormat</code>           \u2013            </li> <li> <code>ParquetOutFormat</code>           \u2013            </li> <li> <code>PipeDataFrameTask</code>           \u2013            </li> </ul> <p>Functions:</p> <ul> <li> <code>get_extension_and_read_spec_from_format</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>OutFormat</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipe_dataframe_task/#mecfs_bio.build_system.task.pipe_dataframe_task.OutFormat","title":"OutFormat  <code>module-attribute</code>","text":"<pre><code>OutFormat = ParquetOutFormat | CSVOutFormat\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipe_dataframe_task/#mecfs_bio.build_system.task.pipe_dataframe_task.CSVOutFormat","title":"CSVOutFormat","text":"<p>Attributes:</p> <ul> <li> <code>sep</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipe_dataframe_task/#mecfs_bio.build_system.task.pipe_dataframe_task.CSVOutFormat.sep","title":"sep  <code>instance-attribute</code>","text":"<pre><code>sep: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipe_dataframe_task/#mecfs_bio.build_system.task.pipe_dataframe_task.ParquetOutFormat","title":"ParquetOutFormat","text":""},{"location":"reference/mecfs_bio/build_system/task/pipe_dataframe_task/#mecfs_bio.build_system.task.pipe_dataframe_task.PipeDataFrameTask","title":"PipeDataFrameTask","text":"<p>               Bases: <code>Task</code></p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>backend</code>               (<code>ValidBackend</code>)           \u2013            </li> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>out_format</code>               (<code>OutFormat</code>)           \u2013            </li> <li> <code>pipes</code>               (<code>Sequence[DataProcessingPipe]</code>)           \u2013            </li> <li> <code>source_data_task</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipe_dataframe_task/#mecfs_bio.build_system.task.pipe_dataframe_task.PipeDataFrameTask.backend","title":"backend  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>backend: ValidBackend = 'ibis'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipe_dataframe_task/#mecfs_bio.build_system.task.pipe_dataframe_task.PipeDataFrameTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipe_dataframe_task/#mecfs_bio.build_system.task.pipe_dataframe_task.PipeDataFrameTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipe_dataframe_task/#mecfs_bio.build_system.task.pipe_dataframe_task.PipeDataFrameTask.out_format","title":"out_format  <code>instance-attribute</code>","text":"<pre><code>out_format: OutFormat\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipe_dataframe_task/#mecfs_bio.build_system.task.pipe_dataframe_task.PipeDataFrameTask.pipes","title":"pipes  <code>instance-attribute</code>","text":"<pre><code>pipes: Sequence[DataProcessingPipe]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipe_dataframe_task/#mecfs_bio.build_system.task.pipe_dataframe_task.PipeDataFrameTask.source_data_task","title":"source_data_task  <code>instance-attribute</code>","text":"<pre><code>source_data_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipe_dataframe_task/#mecfs_bio.build_system.task.pipe_dataframe_task.PipeDataFrameTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    source_task: Task,\n    asset_id: str,\n    out_format: OutFormat,\n    pipes: Sequence[DataProcessingPipe],\n    backend: ValidBackend = \"ibis\",\n) -&gt; PipeDataFrameTask\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipe_dataframe_task.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    source_task: Task,\n    asset_id: str,\n    out_format: OutFormat,\n    pipes: Sequence[DataProcessingPipe],\n    backend: ValidBackend = \"ibis\",\n) -&gt; \"PipeDataFrameTask\":\n    source_meta = source_task.meta\n    extension, read_spec = get_extension_and_read_spec_from_format(\n        out_format=out_format\n    )\n    meta: Meta\n    if isinstance(source_meta, ReferenceFileMeta):\n        meta = ReferenceFileMeta(\n            group=source_meta.group,\n            sub_group=source_meta.sub_group,\n            sub_folder=PurePath(\"processed\"),\n            id=AssetId(asset_id),\n            extension=extension,\n            read_spec=read_spec,\n        )\n    elif isinstance(source_meta, GWASSummaryDataFileMeta):\n        meta = FilteredGWASDataMeta(\n            id=AssetId(asset_id),\n            trait=source_meta.trait,\n            project=source_meta.project,\n            sub_dir=PurePath(\"processed\"),\n            read_spec=read_spec,\n        )\n    elif isinstance(source_meta, ResultTableMeta):\n        meta = ResultTableMeta(\n            id=AssetId(asset_id),\n            trait=source_meta.trait,\n            project=source_meta.project,\n            extension=extension,\n            read_spec=read_spec,\n        )\n    elif isinstance(source_meta, FilteredGWASDataMeta):\n        meta = FilteredGWASDataMeta(\n            id=AssetId(asset_id),\n            trait=source_meta.trait,\n            project=source_meta.project,\n            sub_dir=source_meta.sub_dir,\n            read_spec=read_spec,\n        )\n    else:\n        raise ValueError(\"unknown source meta\")\n\n    return cls(\n        source_data_task=source_task,\n        pipes=list(pipes),\n        meta=meta,\n        out_format=out_format,\n        backend=backend,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipe_dataframe_task/#mecfs_bio.build_system.task.pipe_dataframe_task.PipeDataFrameTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipe_dataframe_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    asset = fetch(self._source_id)\n    df = scan_dataframe_asset(\n        asset=asset, meta=self._source_meta, parquet_backend=self.backend\n    )\n    out_path = scratch_dir / \"out_dataframe\"\n    for pipe in self.pipes:\n        df = pipe.process(df)\n    if isinstance(self.out_format, CSVOutFormat):\n        df.collect().to_pandas().to_csv(\n            out_path, index=False, sep=self.out_format.sep\n        )\n    elif isinstance(self.out_format, ParquetOutFormat):\n        df.sink_parquet(out_path)\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipe_dataframe_task/#mecfs_bio.build_system.task.pipe_dataframe_task.get_extension_and_read_spec_from_format","title":"get_extension_and_read_spec_from_format","text":"<pre><code>get_extension_and_read_spec_from_format(\n    out_format: OutFormat,\n) -&gt; tuple[str, DataFrameReadSpec]\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipe_dataframe_task.py</code> <pre><code>def get_extension_and_read_spec_from_format(\n    out_format: OutFormat,\n) -&gt; tuple[str, DataFrameReadSpec]:\n    if isinstance(out_format, CSVOutFormat):\n        read_spec = DataFrameReadSpec(DataFrameTextFormat(separator=out_format.sep))\n        if out_format.sep == \"\\t\":\n            extension = \".tsv\"\n        elif out_format.sep == \",\":\n            extension = \".csv\"\n        else:\n            raise ValueError(\"Unknown sep\")\n    elif isinstance(out_format, ParquetOutFormat):\n        read_spec = DataFrameReadSpec(DataFrameParquetFormat())\n        extension = \".parquet\"\n    else:\n        raise ValueError(f\"Unknown format {out_format}\")\n    return extension, read_spec\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/","title":"pipes","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/#mecfs_bio.build_system.task.pipes","title":"mecfs_bio.build_system.task.pipes","text":"<p>Pipes are simple, composable DataFrame transformations.</p> <p>Modules:</p> <ul> <li> <code>add_average_pipe</code>           \u2013            </li> <li> <code>cast_pipe</code>           \u2013            </li> <li> <code>composite_pipe</code>           \u2013            </li> <li> <code>compute_beta_pipe</code>           \u2013            </li> <li> <code>compute_mlog10p_pipe</code>           \u2013            </li> <li> <code>compute_p_from_beta_se</code>           \u2013            </li> <li> <code>compute_p_pipe</code>           \u2013            </li> <li> <code>compute_se_pipe</code>           \u2013            <p>Compute standard error in GWAS summary statistics.</p> </li> <li> <code>concat_str_pipe</code>           \u2013            <p>Pipe to concatenate multiple string columns</p> </li> <li> <code>data_processing_pipe</code>           \u2013            </li> <li> <code>drop_col_pipe</code>           \u2013            </li> <li> <code>drop_null_pipe</code>           \u2013            </li> <li> <code>duckdb_mem_limit_pipe</code>           \u2013            </li> <li> <code>filter_rows_by_info_score</code>           \u2013            </li> <li> <code>filter_rows_by_min</code>           \u2013            </li> <li> <code>filter_rows_by_min_in_col</code>           \u2013            </li> <li> <code>filter_rows_by_value</code>           \u2013            </li> <li> <code>head_pipe</code>           \u2013            </li> <li> <code>identity_pipe</code>           \u2013            </li> <li> <code>join_with_memory_table_pipe</code>           \u2013            </li> <li> <code>log_markdown_pipe</code>           \u2013            </li> <li> <code>max_with_constant_pipe</code>           \u2013            </li> <li> <code>move_col_to_front_pipe</code>           \u2013            </li> <li> <code>pivot_pipe</code>           \u2013            </li> <li> <code>rename_col_by_position_pipe</code>           \u2013            </li> <li> <code>rename_col_pipe</code>           \u2013            </li> <li> <code>replace_pipe</code>           \u2013            </li> <li> <code>scale_col_pipe</code>           \u2013            </li> <li> <code>select_pipe</code>           \u2013            </li> <li> <code>set_col_pipe</code>           \u2013            </li> <li> <code>shifted_log_pipe</code>           \u2013            </li> <li> <code>sort_pipe</code>           \u2013            </li> <li> <code>str_lowercase_pipe</code>           \u2013            </li> <li> <code>str_replace_pipe</code>           \u2013            </li> <li> <code>str_split_col</code>           \u2013            </li> <li> <code>str_split_exact_col</code>           \u2013            </li> <li> <code>uniquepipe</code>           \u2013            </li> <li> <code>unnest_pipe</code>           \u2013            </li> <li> <code>unpivot_pipe</code>           \u2013            <p>Pipe to convert dataframe from wide to long format.</p> </li> <li> <code>winsorize_all</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/add_average_pipe/","title":"add_average_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/add_average_pipe/#mecfs_bio.build_system.task.pipes.add_average_pipe","title":"mecfs_bio.build_system.task.pipes.add_average_pipe","text":"<p>Classes:</p> <ul> <li> <code>AddAveragePipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/add_average_pipe/#mecfs_bio.build_system.task.pipes.add_average_pipe.AddAveragePipe","title":"AddAveragePipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>avg_name</code>               (<code>str</code>)           \u2013            </li> <li> <code>cols_to_exclude</code>               (<code>Sequence[str]</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/add_average_pipe/#mecfs_bio.build_system.task.pipes.add_average_pipe.AddAveragePipe.avg_name","title":"avg_name  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>avg_name: str = 'Average'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/add_average_pipe/#mecfs_bio.build_system.task.pipes.add_average_pipe.AddAveragePipe.cols_to_exclude","title":"cols_to_exclude  <code>instance-attribute</code>","text":"<pre><code>cols_to_exclude: Sequence[str]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/add_average_pipe/#mecfs_bio.build_system.task.pipes.add_average_pipe.AddAveragePipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/add_average_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    return x.with_columns(\n        narwhals.mean_horizontal(narwhals.exclude(self.cols_to_exclude)).alias(\n            self.avg_name\n        )\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/cast_pipe/","title":"cast_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/cast_pipe/#mecfs_bio.build_system.task.pipes.cast_pipe","title":"mecfs_bio.build_system.task.pipes.cast_pipe","text":"<p>Classes:</p> <ul> <li> <code>CastPipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/cast_pipe/#mecfs_bio.build_system.task.pipes.cast_pipe.CastPipe","title":"CastPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>new_col_name</code>               (<code>str</code>)           \u2013            </li> <li> <code>target_column</code>               (<code>str</code>)           \u2013            </li> <li> <code>type</code>               (<code>DType</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/cast_pipe/#mecfs_bio.build_system.task.pipes.cast_pipe.CastPipe.new_col_name","title":"new_col_name  <code>instance-attribute</code>","text":"<pre><code>new_col_name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/cast_pipe/#mecfs_bio.build_system.task.pipes.cast_pipe.CastPipe.target_column","title":"target_column  <code>instance-attribute</code>","text":"<pre><code>target_column: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/cast_pipe/#mecfs_bio.build_system.task.pipes.cast_pipe.CastPipe.type","title":"type  <code>instance-attribute</code>","text":"<pre><code>type: DType\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/cast_pipe/#mecfs_bio.build_system.task.pipes.cast_pipe.CastPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/cast_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    return x.with_columns(\n        narwhals.col(self.target_column).cast(self.type).alias(self.new_col_name)\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/composite_pipe/","title":"composite_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/composite_pipe/#mecfs_bio.build_system.task.pipes.composite_pipe","title":"mecfs_bio.build_system.task.pipes.composite_pipe","text":"<p>Classes:</p> <ul> <li> <code>CompositePipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/composite_pipe/#mecfs_bio.build_system.task.pipes.composite_pipe.CompositePipe","title":"CompositePipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>pipes</code>               (<code>Sequence[DataProcessingPipe]</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/composite_pipe/#mecfs_bio.build_system.task.pipes.composite_pipe.CompositePipe.pipes","title":"pipes  <code>instance-attribute</code>","text":"<pre><code>pipes: Sequence[DataProcessingPipe]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/composite_pipe/#mecfs_bio.build_system.task.pipes.composite_pipe.CompositePipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/composite_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    for pipe in self.pipes:\n        x = pipe.process(x)\n    return x\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_beta_pipe/","title":"compute_beta_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_beta_pipe/#mecfs_bio.build_system.task.pipes.compute_beta_pipe","title":"mecfs_bio.build_system.task.pipes.compute_beta_pipe","text":"<p>Classes:</p> <ul> <li> <code>ComputeBetaIfNeededPipe</code>           \u2013            </li> <li> <code>ComputeBetaPipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_beta_pipe/#mecfs_bio.build_system.task.pipes.compute_beta_pipe.ComputeBetaIfNeededPipe","title":"ComputeBetaIfNeededPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_beta_pipe/#mecfs_bio.build_system.task.pipes.compute_beta_pipe.ComputeBetaIfNeededPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/compute_beta_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    schema = x.collect_schema()\n    if GWASLAB_BETA_COL not in schema.keys():\n        x = ComputeBetaPipe().process(x)\n    return x\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_beta_pipe/#mecfs_bio.build_system.task.pipes.compute_beta_pipe.ComputeBetaPipe","title":"ComputeBetaPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_beta_pipe/#mecfs_bio.build_system.task.pipes.compute_beta_pipe.ComputeBetaPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/compute_beta_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    schema = x.collect_schema()\n    assert GWASLAB_BETA_COL not in schema.keys()\n    x = x.with_columns(\n        narwhals.col(GWASLAB_ODDS_RATIO_COL).log().alias(GWASLAB_BETA_COL)\n    )\n    return x\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_mlog10p_pipe/","title":"compute_mlog10p_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_mlog10p_pipe/#mecfs_bio.build_system.task.pipes.compute_mlog10p_pipe","title":"mecfs_bio.build_system.task.pipes.compute_mlog10p_pipe","text":"<p>Classes:</p> <ul> <li> <code>ComputeMlog10pIfNeededPipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_mlog10p_pipe/#mecfs_bio.build_system.task.pipes.compute_mlog10p_pipe.ComputeMlog10pIfNeededPipe","title":"ComputeMlog10pIfNeededPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>min_p_value</code>               (<code>float</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_mlog10p_pipe/#mecfs_bio.build_system.task.pipes.compute_mlog10p_pipe.ComputeMlog10pIfNeededPipe.min_p_value","title":"min_p_value  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>min_p_value: float = 1e-250\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_mlog10p_pipe/#mecfs_bio.build_system.task.pipes.compute_mlog10p_pipe.ComputeMlog10pIfNeededPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/compute_mlog10p_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    schema = x.collect_schema()\n    if GWASLAB_MLOG10P_COL in schema:\n        return x\n    assert GWASLAB_P_COL in schema\n    result = x.with_columns(\n        (\n            -1\n            * (\n                narwhals.max_horizontal(\n                    narwhals.col(GWASLAB_P_COL),\n                    narwhals.lit(self.min_p_value),  # avoid taking the log of 0\n                ).log(\n                    base=10,\n                )\n            )\n        ).alias(GWASLAB_MLOG10P_COL)\n    )\n    return result\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_p_from_beta_se/","title":"compute_p_from_beta_se","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_p_from_beta_se/#mecfs_bio.build_system.task.pipes.compute_p_from_beta_se","title":"mecfs_bio.build_system.task.pipes.compute_p_from_beta_se","text":"<p>Classes:</p> <ul> <li> <code>ComputePFromBetaSEPipeIfNeeded</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_p_from_beta_se/#mecfs_bio.build_system.task.pipes.compute_p_from_beta_se.ComputePFromBetaSEPipeIfNeeded","title":"ComputePFromBetaSEPipeIfNeeded","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_p_from_beta_se/#mecfs_bio.build_system.task.pipes.compute_p_from_beta_se.ComputePFromBetaSEPipeIfNeeded.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/compute_p_from_beta_se.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    schema = x.collect_schema()\n    if GWASLAB_P_COL in schema:\n        return x\n    assert GWASLAB_SE_COL in schema\n    assert GWASLAB_BETA_COL in schema\n    collected = x.collect().to_pandas()\n    z = collected[GWASLAB_BETA_COL] / collected[GWASLAB_SE_COL]\n    collected[GWASLAB_P_COL] = 2 * scipy.stats.norm.sf(abs(z))\n    collected_polars = pl.from_pandas(collected)\n    return narwhals.from_native(collected_polars).lazy()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_p_pipe/","title":"compute_p_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_p_pipe/#mecfs_bio.build_system.task.pipes.compute_p_pipe","title":"mecfs_bio.build_system.task.pipes.compute_p_pipe","text":"<p>Classes:</p> <ul> <li> <code>ComputePIfNeededPipe</code>           \u2013            </li> <li> <code>ComputePPipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_p_pipe/#mecfs_bio.build_system.task.pipes.compute_p_pipe.ComputePIfNeededPipe","title":"ComputePIfNeededPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_p_pipe/#mecfs_bio.build_system.task.pipes.compute_p_pipe.ComputePIfNeededPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/compute_p_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    schema = x.collect_schema()\n    if GWASLAB_P_COL in schema:\n        return x\n    return ComputePPipe().process(x)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_p_pipe/#mecfs_bio.build_system.task.pipes.compute_p_pipe.ComputePPipe","title":"ComputePPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_p_pipe/#mecfs_bio.build_system.task.pipes.compute_p_pipe.ComputePPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/compute_p_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    schema = x.collect_schema()\n    assert GWASLAB_P_COL not in schema\n    assert GWASLAB_MLOG10P_COL in schema\n    return x.with_columns(\n        (10 ** (-1 * narwhals.col(GWASLAB_MLOG10P_COL))).alias(GWASLAB_P_COL)\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_se_pipe/","title":"compute_se_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_se_pipe/#mecfs_bio.build_system.task.pipes.compute_se_pipe","title":"mecfs_bio.build_system.task.pipes.compute_se_pipe","text":"<p>Compute standard error in GWAS summary statistics.</p> <p>Classes:</p> <ul> <li> <code>ComputeSEIfNeededPipe</code>           \u2013            </li> <li> <code>ComputeSEPipe</code>           \u2013            <p>Pipe to compute standard error in GWAS summary statistics using p-value and beta</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_se_pipe/#mecfs_bio.build_system.task.pipes.compute_se_pipe.ComputeSEIfNeededPipe","title":"ComputeSEIfNeededPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_se_pipe/#mecfs_bio.build_system.task.pipes.compute_se_pipe.ComputeSEIfNeededPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/compute_se_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    cols = x.collect_schema().keys()\n    if GWASLAB_SE_COL not in cols:\n        return ComputeSEPipe().process(x)\n    return x\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_se_pipe/#mecfs_bio.build_system.task.pipes.compute_se_pipe.ComputeSEPipe","title":"ComputeSEPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Pipe to compute standard error in GWAS summary statistics using p-value and beta</p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/compute_se_pipe/#mecfs_bio.build_system.task.pipes.compute_se_pipe.ComputeSEPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/compute_se_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    cols = x.collect_schema().keys()\n    assert GWASLAB_SE_COL not in cols\n    assert GWASLAB_P_COL in cols\n    assert GWASLAB_BETA_COL in cols\n    collected: pd.DataFrame = x.collect().to_pandas()\n    pvals: np.ndarray = collected[GWASLAB_P_COL].to_numpy()\n    z_score: np.ndarray = abs(scipy.stats.norm.ppf(1 - pvals / 2))\n    z_score_2: np.ndarray = abs(scipy.stats.norm.ppf(pvals / 2))\n    min_z_score = np.minimum(\n        z_score, z_score_2\n    )  # this is to resolve numerical issues when (1-pval) is numerically equal to 1\n    se = abs(collected[GWASLAB_BETA_COL] / min_z_score)\n    collected[GWASLAB_SE_COL] = se\n    return narwhals.from_native(collected).lazy()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/concat_str_pipe/","title":"concat_str_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/concat_str_pipe/#mecfs_bio.build_system.task.pipes.concat_str_pipe","title":"mecfs_bio.build_system.task.pipes.concat_str_pipe","text":"<p>Pipe to concatenate multiple string columns</p> <p>Classes:</p> <ul> <li> <code>ConcatStrPipe</code>           \u2013            <p>Pipe to concatenate multiple string columns</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/concat_str_pipe/#mecfs_bio.build_system.task.pipes.concat_str_pipe.ConcatStrPipe","title":"ConcatStrPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Pipe to concatenate multiple string columns</p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>ignore_nulls</code>               (<code>bool</code>)           \u2013            </li> <li> <code>new_col_name</code>               (<code>str</code>)           \u2013            </li> <li> <code>sep</code>               (<code>str</code>)           \u2013            </li> <li> <code>target_cols</code>               (<code>Sequence[str]</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/concat_str_pipe/#mecfs_bio.build_system.task.pipes.concat_str_pipe.ConcatStrPipe.ignore_nulls","title":"ignore_nulls  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>ignore_nulls: bool = True\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/concat_str_pipe/#mecfs_bio.build_system.task.pipes.concat_str_pipe.ConcatStrPipe.new_col_name","title":"new_col_name  <code>instance-attribute</code>","text":"<pre><code>new_col_name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/concat_str_pipe/#mecfs_bio.build_system.task.pipes.concat_str_pipe.ConcatStrPipe.sep","title":"sep  <code>instance-attribute</code>","text":"<pre><code>sep: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/concat_str_pipe/#mecfs_bio.build_system.task.pipes.concat_str_pipe.ConcatStrPipe.target_cols","title":"target_cols  <code>instance-attribute</code>","text":"<pre><code>target_cols: Sequence[str]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/concat_str_pipe/#mecfs_bio.build_system.task.pipes.concat_str_pipe.ConcatStrPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/concat_str_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    return x.with_columns(\n        narwhals.concat_str(\n            [narwhals.col(item) for item in self.target_cols],\n            separator=self.sep,\n            ignore_nulls=self.ignore_nulls,\n        ).alias(self.new_col_name)\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/data_processing_pipe/","title":"data_processing_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/data_processing_pipe/#mecfs_bio.build_system.task.pipes.data_processing_pipe","title":"mecfs_bio.build_system.task.pipes.data_processing_pipe","text":"<p>Classes:</p> <ul> <li> <code>DataProcessingPipe</code>           \u2013            <p>Abstract class representing a transformation of a lazy dataframe.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/data_processing_pipe/#mecfs_bio.build_system.task.pipes.data_processing_pipe.DataProcessingPipe","title":"DataProcessingPipe","text":"<p>               Bases: <code>ABC</code></p> <p>Abstract class representing a transformation of a lazy dataframe.</p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> <li> <code>process_eager_polars</code>             \u2013              </li> <li> <code>process_pandas</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/data_processing_pipe/#mecfs_bio.build_system.task.pipes.data_processing_pipe.DataProcessingPipe.process","title":"process  <code>abstractmethod</code>","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/data_processing_pipe.py</code> <pre><code>@abstractmethod\ndef process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    pass\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/data_processing_pipe/#mecfs_bio.build_system.task.pipes.data_processing_pipe.DataProcessingPipe.process_eager_polars","title":"process_eager_polars","text":"<pre><code>process_eager_polars(x: DataFrame) -&gt; pl.DataFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/data_processing_pipe.py</code> <pre><code>def process_eager_polars(self, x: pl.DataFrame) -&gt; pl.DataFrame:\n    lx = narwhals.from_native(x).lazy()\n    return self.process(lx).collect().to_polars()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/data_processing_pipe/#mecfs_bio.build_system.task.pipes.data_processing_pipe.DataProcessingPipe.process_pandas","title":"process_pandas","text":"<pre><code>process_pandas(x: DataFrame) -&gt; pd.DataFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/data_processing_pipe.py</code> <pre><code>def process_pandas(self, x: pd.DataFrame) -&gt; pd.DataFrame:\n    lx = narwhals.from_native(x).lazy()\n    return self.process(lx).collect().to_pandas()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/drop_col_pipe/","title":"drop_col_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/drop_col_pipe/#mecfs_bio.build_system.task.pipes.drop_col_pipe","title":"mecfs_bio.build_system.task.pipes.drop_col_pipe","text":"<p>Classes:</p> <ul> <li> <code>DropColPipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/drop_col_pipe/#mecfs_bio.build_system.task.pipes.drop_col_pipe.DropColPipe","title":"DropColPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>cols_to_drop</code>               (<code>list[str]</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/drop_col_pipe/#mecfs_bio.build_system.task.pipes.drop_col_pipe.DropColPipe.cols_to_drop","title":"cols_to_drop  <code>instance-attribute</code>","text":"<pre><code>cols_to_drop: list[str]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/drop_col_pipe/#mecfs_bio.build_system.task.pipes.drop_col_pipe.DropColPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/drop_col_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    y = x.drop(*self.cols_to_drop)\n    return y\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/drop_null_pipe/","title":"drop_null_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/drop_null_pipe/#mecfs_bio.build_system.task.pipes.drop_null_pipe","title":"mecfs_bio.build_system.task.pipes.drop_null_pipe","text":"<p>Classes:</p> <ul> <li> <code>DropNullsPipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/drop_null_pipe/#mecfs_bio.build_system.task.pipes.drop_null_pipe.DropNullsPipe","title":"DropNullsPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>subset</code>               (<code>None | list[str]</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/drop_null_pipe/#mecfs_bio.build_system.task.pipes.drop_null_pipe.DropNullsPipe.subset","title":"subset  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>subset: None | list[str] = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/drop_null_pipe/#mecfs_bio.build_system.task.pipes.drop_null_pipe.DropNullsPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/drop_null_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    y = x.drop_nulls(subset=self.subset)\n    return y\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/duckdb_mem_limit_pipe/","title":"duckdb_mem_limit_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/duckdb_mem_limit_pipe/#mecfs_bio.build_system.task.pipes.duckdb_mem_limit_pipe","title":"mecfs_bio.build_system.task.pipes.duckdb_mem_limit_pipe","text":"<p>Classes:</p> <ul> <li> <code>DuckdbMemLimitPipe</code>           \u2013            <p>Side-effecting pipe that sets the duckdb memory limit.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/duckdb_mem_limit_pipe/#mecfs_bio.build_system.task.pipes.duckdb_mem_limit_pipe.DuckdbMemLimitPipe","title":"DuckdbMemLimitPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Side-effecting pipe that sets the duckdb memory limit. Useful to apply prior to operations that consume a lot of memory. In these cases, counterintuitive, it often optimal to actually reduce the memory limit, as this will cause duckdb to more aggressively conserve memory.</p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>limit_gb</code>               (<code>int</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/duckdb_mem_limit_pipe/#mecfs_bio.build_system.task.pipes.duckdb_mem_limit_pipe.DuckdbMemLimitPipe.limit_gb","title":"limit_gb  <code>instance-attribute</code>","text":"<pre><code>limit_gb: int\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/duckdb_mem_limit_pipe/#mecfs_bio.build_system.task.pipes.duckdb_mem_limit_pipe.DuckdbMemLimitPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/duckdb_mem_limit_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    duckdb.sql(f\"SET memory_limit='{self.limit_gb}GB'\")\n    return x\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_info_score/","title":"filter_rows_by_info_score","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_info_score/#mecfs_bio.build_system.task.pipes.filter_rows_by_info_score","title":"mecfs_bio.build_system.task.pipes.filter_rows_by_info_score","text":"<p>Classes:</p> <ul> <li> <code>FilterRowsByInfoScorePipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_info_score/#mecfs_bio.build_system.task.pipes.filter_rows_by_info_score.FilterRowsByInfoScorePipe","title":"FilterRowsByInfoScorePipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>info_col</code>               (<code>str</code>)           \u2013            </li> <li> <code>min_score</code>               (<code>float</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_info_score/#mecfs_bio.build_system.task.pipes.filter_rows_by_info_score.FilterRowsByInfoScorePipe.info_col","title":"info_col  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>info_col: str = GWASLAB_INFO_SCORE_COL\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_info_score/#mecfs_bio.build_system.task.pipes.filter_rows_by_info_score.FilterRowsByInfoScorePipe.min_score","title":"min_score  <code>instance-attribute</code>","text":"<pre><code>min_score: float\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_info_score/#mecfs_bio.build_system.task.pipes.filter_rows_by_info_score.FilterRowsByInfoScorePipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/filter_rows_by_info_score.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    return x.filter(narwhals.col(self.info_col) &gt;= self.min_score)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_min/","title":"filter_rows_by_min","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_min/#mecfs_bio.build_system.task.pipes.filter_rows_by_min","title":"mecfs_bio.build_system.task.pipes.filter_rows_by_min","text":"<p>Classes:</p> <ul> <li> <code>FilterRowsByMin</code>           \u2013            <p>Filer rows that do not exceed min value in at least one column</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_min/#mecfs_bio.build_system.task.pipes.filter_rows_by_min.FilterRowsByMin","title":"FilterRowsByMin","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Filer rows that do not exceed min value in at least one column</p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>exclude_columns</code>               (<code>Sequence[str]</code>)           \u2013            </li> <li> <code>min_value</code>               (<code>float</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_min/#mecfs_bio.build_system.task.pipes.filter_rows_by_min.FilterRowsByMin.exclude_columns","title":"exclude_columns  <code>instance-attribute</code>","text":"<pre><code>exclude_columns: Sequence[str]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_min/#mecfs_bio.build_system.task.pipes.filter_rows_by_min.FilterRowsByMin.min_value","title":"min_value  <code>instance-attribute</code>","text":"<pre><code>min_value: float\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_min/#mecfs_bio.build_system.task.pipes.filter_rows_by_min.FilterRowsByMin.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/filter_rows_by_min.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    x_pd = x.collect().to_pandas()\n    cols = x_pd.columns\n    cols = sorted(set(cols) - set(self.exclude_columns))\n    x_pd = x_pd.loc[(x_pd[cols] &gt;= self.min_value).any(axis=1), :]\n    return narwhals.from_native(x_pd).lazy()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_min_in_col/","title":"filter_rows_by_min_in_col","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_min_in_col/#mecfs_bio.build_system.task.pipes.filter_rows_by_min_in_col","title":"mecfs_bio.build_system.task.pipes.filter_rows_by_min_in_col","text":"<p>Classes:</p> <ul> <li> <code>FilterRowsByMinInCol</code>           \u2013            <p>Filer rows that do not exceed min value in  given col</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_min_in_col/#mecfs_bio.build_system.task.pipes.filter_rows_by_min_in_col.FilterRowsByMinInCol","title":"FilterRowsByMinInCol","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Filer rows that do not exceed min value in  given col</p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>col</code>               (<code>str</code>)           \u2013            </li> <li> <code>min_value</code>               (<code>float</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_min_in_col/#mecfs_bio.build_system.task.pipes.filter_rows_by_min_in_col.FilterRowsByMinInCol.col","title":"col  <code>instance-attribute</code>","text":"<pre><code>col: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_min_in_col/#mecfs_bio.build_system.task.pipes.filter_rows_by_min_in_col.FilterRowsByMinInCol.min_value","title":"min_value  <code>instance-attribute</code>","text":"<pre><code>min_value: float\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_min_in_col/#mecfs_bio.build_system.task.pipes.filter_rows_by_min_in_col.FilterRowsByMinInCol.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/filter_rows_by_min_in_col.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    return x.filter(\n        narwhals.col(self.col) &gt;= self.min_value,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_value/","title":"filter_rows_by_value","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_value/#mecfs_bio.build_system.task.pipes.filter_rows_by_value","title":"mecfs_bio.build_system.task.pipes.filter_rows_by_value","text":"<p>Classes:</p> <ul> <li> <code>FilterRowsByValue</code>           \u2013            <p>Filer rows where column value lies in a given list</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_value/#mecfs_bio.build_system.task.pipes.filter_rows_by_value.FilterRowsByValue","title":"FilterRowsByValue","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Filer rows where column value lies in a given list</p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>target_column</code>               (<code>str</code>)           \u2013            </li> <li> <code>valid_values</code>               (<code>Sequence</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_value/#mecfs_bio.build_system.task.pipes.filter_rows_by_value.FilterRowsByValue.target_column","title":"target_column  <code>instance-attribute</code>","text":"<pre><code>target_column: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_value/#mecfs_bio.build_system.task.pipes.filter_rows_by_value.FilterRowsByValue.valid_values","title":"valid_values  <code>instance-attribute</code>","text":"<pre><code>valid_values: Sequence\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/filter_rows_by_value/#mecfs_bio.build_system.task.pipes.filter_rows_by_value.FilterRowsByValue.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/filter_rows_by_value.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    return x.filter(\n        narwhals.col(self.target_column).is_in(self.valid_values),\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/head_pipe/","title":"head_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/head_pipe/#mecfs_bio.build_system.task.pipes.head_pipe","title":"mecfs_bio.build_system.task.pipes.head_pipe","text":"<p>Classes:</p> <ul> <li> <code>HeadPipe</code>           \u2013            <p>Pipe to extract first rows of a dataframe</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/head_pipe/#mecfs_bio.build_system.task.pipes.head_pipe.HeadPipe","title":"HeadPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Pipe to extract first rows of a dataframe</p> <p>Can be useful in writing tests that operate on a subset of a large dataset.</p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>num_rows</code>               (<code>int</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/head_pipe/#mecfs_bio.build_system.task.pipes.head_pipe.HeadPipe.num_rows","title":"num_rows  <code>instance-attribute</code>","text":"<pre><code>num_rows: int\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/head_pipe/#mecfs_bio.build_system.task.pipes.head_pipe.HeadPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/head_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    return x.head(self.num_rows)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/identity_pipe/","title":"identity_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/identity_pipe/#mecfs_bio.build_system.task.pipes.identity_pipe","title":"mecfs_bio.build_system.task.pipes.identity_pipe","text":"<p>Classes:</p> <ul> <li> <code>IdentityPipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/identity_pipe/#mecfs_bio.build_system.task.pipes.identity_pipe.IdentityPipe","title":"IdentityPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/identity_pipe/#mecfs_bio.build_system.task.pipes.identity_pipe.IdentityPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/identity_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    return x\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/join_with_memory_table_pipe/","title":"join_with_memory_table_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/join_with_memory_table_pipe/#mecfs_bio.build_system.task.pipes.join_with_memory_table_pipe","title":"mecfs_bio.build_system.task.pipes.join_with_memory_table_pipe","text":"<p>Classes:</p> <ul> <li> <code>JoinWithMemTablePipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/join_with_memory_table_pipe/#mecfs_bio.build_system.task.pipes.join_with_memory_table_pipe.JoinWithMemTablePipe","title":"JoinWithMemTablePipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>backend</code>               (<code>ValidBackend</code>)           \u2013            </li> <li> <code>keys_left</code>               (<code>list[str]</code>)           \u2013            </li> <li> <code>keys_right</code>               (<code>list[str]</code>)           \u2013            </li> <li> <code>mem_table</code>               (<code>DataFrame</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/join_with_memory_table_pipe/#mecfs_bio.build_system.task.pipes.join_with_memory_table_pipe.JoinWithMemTablePipe.backend","title":"backend  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>backend: ValidBackend = 'polars'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/join_with_memory_table_pipe/#mecfs_bio.build_system.task.pipes.join_with_memory_table_pipe.JoinWithMemTablePipe.keys_left","title":"keys_left  <code>instance-attribute</code>","text":"<pre><code>keys_left: list[str]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/join_with_memory_table_pipe/#mecfs_bio.build_system.task.pipes.join_with_memory_table_pipe.JoinWithMemTablePipe.keys_right","title":"keys_right  <code>instance-attribute</code>","text":"<pre><code>keys_right: list[str]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/join_with_memory_table_pipe/#mecfs_bio.build_system.task.pipes.join_with_memory_table_pipe.JoinWithMemTablePipe.mem_table","title":"mem_table  <code>instance-attribute</code>","text":"<pre><code>mem_table: DataFrame\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/join_with_memory_table_pipe/#mecfs_bio.build_system.task.pipes.join_with_memory_table_pipe.JoinWithMemTablePipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/join_with_memory_table_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    if self.backend == \"polars\":\n        mem_table = narwhals.from_native(\n            pl.from_pandas(\n                self.mem_table,\n            )\n        )\n    elif self.backend == \"ibis\":\n        mem_table = narwhals.from_native(ibis.memtable(self.mem_table))\n\n    else:\n        raise ValueError(\"bad backend\")\n\n    return x.join(\n        mem_table.lazy(), left_on=self.keys_left, right_on=self.keys_right\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/log_markdown_pipe/","title":"log_markdown_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/log_markdown_pipe/#mecfs_bio.build_system.task.pipes.log_markdown_pipe","title":"mecfs_bio.build_system.task.pipes.log_markdown_pipe","text":"<p>Classes:</p> <ul> <li> <code>LogMarkdownPipe</code>           \u2013            <p>For debugging</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/log_markdown_pipe/#mecfs_bio.build_system.task.pipes.log_markdown_pipe.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/log_markdown_pipe/#mecfs_bio.build_system.task.pipes.log_markdown_pipe.LogMarkdownPipe","title":"LogMarkdownPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>For debugging</p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/log_markdown_pipe/#mecfs_bio.build_system.task.pipes.log_markdown_pipe.LogMarkdownPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/log_markdown_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    collected = x.collect().to_pandas()\n    logger.debug(f\"\\n DataFrame:\\n{collected.to_markdown(index=False)} \\n\")\n    return x\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/max_with_constant_pipe/","title":"max_with_constant_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/max_with_constant_pipe/#mecfs_bio.build_system.task.pipes.max_with_constant_pipe","title":"mecfs_bio.build_system.task.pipes.max_with_constant_pipe","text":"<p>Classes:</p> <ul> <li> <code>MaxWithConstantPipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/max_with_constant_pipe/#mecfs_bio.build_system.task.pipes.max_with_constant_pipe.MaxWithConstantPipe","title":"MaxWithConstantPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>col</code>               (<code>str</code>)           \u2013            </li> <li> <code>new_col_name</code>               (<code>str</code>)           \u2013            </li> <li> <code>value</code>               (<code>float</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/max_with_constant_pipe/#mecfs_bio.build_system.task.pipes.max_with_constant_pipe.MaxWithConstantPipe.col","title":"col  <code>instance-attribute</code>","text":"<pre><code>col: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/max_with_constant_pipe/#mecfs_bio.build_system.task.pipes.max_with_constant_pipe.MaxWithConstantPipe.new_col_name","title":"new_col_name  <code>instance-attribute</code>","text":"<pre><code>new_col_name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/max_with_constant_pipe/#mecfs_bio.build_system.task.pipes.max_with_constant_pipe.MaxWithConstantPipe.value","title":"value  <code>instance-attribute</code>","text":"<pre><code>value: float\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/max_with_constant_pipe/#mecfs_bio.build_system.task.pipes.max_with_constant_pipe.MaxWithConstantPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/max_with_constant_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    return x.with_columns(\n        narwhals.max_horizontal(\n            narwhals.col(self.col), narwhals.lit(self.value)\n        ).alias(self.new_col_name)\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/move_col_to_front_pipe/","title":"move_col_to_front_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/move_col_to_front_pipe/#mecfs_bio.build_system.task.pipes.move_col_to_front_pipe","title":"mecfs_bio.build_system.task.pipes.move_col_to_front_pipe","text":"<p>Classes:</p> <ul> <li> <code>MoveColToFrontPipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/move_col_to_front_pipe/#mecfs_bio.build_system.task.pipes.move_col_to_front_pipe.MoveColToFrontPipe","title":"MoveColToFrontPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>target_col</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/move_col_to_front_pipe/#mecfs_bio.build_system.task.pipes.move_col_to_front_pipe.MoveColToFrontPipe.target_col","title":"target_col  <code>instance-attribute</code>","text":"<pre><code>target_col: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/move_col_to_front_pipe/#mecfs_bio.build_system.task.pipes.move_col_to_front_pipe.MoveColToFrontPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/move_col_to_front_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    cols = set(x.collect_schema().keys()) - set([self.target_col])\n    cols = [self.target_col] + sorted(cols)\n    return x.select(*cols)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/pivot_pipe/","title":"pivot_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/pivot_pipe/#mecfs_bio.build_system.task.pipes.pivot_pipe","title":"mecfs_bio.build_system.task.pipes.pivot_pipe","text":"<p>Classes:</p> <ul> <li> <code>PivotPipe</code>           \u2013            <p>Transform a dataframe from long to wide format.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/pivot_pipe/#mecfs_bio.build_system.task.pipes.pivot_pipe.PivotPipe","title":"PivotPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Transform a dataframe from long to wide format.</p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>index</code>               (<code>str | list[str] | None</code>)           \u2013            </li> <li> <code>on</code>               (<code>str | list[str]</code>)           \u2013            </li> <li> <code>values</code>               (<code>str | list[str] | None</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/pivot_pipe/#mecfs_bio.build_system.task.pipes.pivot_pipe.PivotPipe.index","title":"index  <code>instance-attribute</code>","text":"<pre><code>index: str | list[str] | None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/pivot_pipe/#mecfs_bio.build_system.task.pipes.pivot_pipe.PivotPipe.on","title":"on  <code>instance-attribute</code>","text":"<pre><code>on: str | list[str]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/pivot_pipe/#mecfs_bio.build_system.task.pipes.pivot_pipe.PivotPipe.values","title":"values  <code>instance-attribute</code>","text":"<pre><code>values: str | list[str] | None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/pivot_pipe/#mecfs_bio.build_system.task.pipes.pivot_pipe.PivotPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/pivot_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    return (\n        x.collect()\n        .pivot(\n            on=self.on,\n            index=self.index,\n            values=self.values,\n        )\n        .lazy()\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/rename_col_by_position_pipe/","title":"rename_col_by_position_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/rename_col_by_position_pipe/#mecfs_bio.build_system.task.pipes.rename_col_by_position_pipe","title":"mecfs_bio.build_system.task.pipes.rename_col_by_position_pipe","text":"<p>Classes:</p> <ul> <li> <code>RenameColByPositionPipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/rename_col_by_position_pipe/#mecfs_bio.build_system.task.pipes.rename_col_by_position_pipe.RenameColByPositionPipe","title":"RenameColByPositionPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>col_new_name</code>               (<code>str</code>)           \u2013            </li> <li> <code>col_position</code>               (<code>int</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/rename_col_by_position_pipe/#mecfs_bio.build_system.task.pipes.rename_col_by_position_pipe.RenameColByPositionPipe.col_new_name","title":"col_new_name  <code>instance-attribute</code>","text":"<pre><code>col_new_name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/rename_col_by_position_pipe/#mecfs_bio.build_system.task.pipes.rename_col_by_position_pipe.RenameColByPositionPipe.col_position","title":"col_position  <code>instance-attribute</code>","text":"<pre><code>col_position: int\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/rename_col_by_position_pipe/#mecfs_bio.build_system.task.pipes.rename_col_by_position_pipe.RenameColByPositionPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/rename_col_by_position_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    old_col = x.columns[self.col_position]\n    return x.rename({old_col: self.col_new_name})\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/rename_col_pipe/","title":"rename_col_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/rename_col_pipe/#mecfs_bio.build_system.task.pipes.rename_col_pipe","title":"mecfs_bio.build_system.task.pipes.rename_col_pipe","text":"<p>Classes:</p> <ul> <li> <code>RenameColPipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/rename_col_pipe/#mecfs_bio.build_system.task.pipes.rename_col_pipe.RenameColPipe","title":"RenameColPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>new_name</code>               (<code>str</code>)           \u2013            </li> <li> <code>old_name</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/rename_col_pipe/#mecfs_bio.build_system.task.pipes.rename_col_pipe.RenameColPipe.new_name","title":"new_name  <code>instance-attribute</code>","text":"<pre><code>new_name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/rename_col_pipe/#mecfs_bio.build_system.task.pipes.rename_col_pipe.RenameColPipe.old_name","title":"old_name  <code>instance-attribute</code>","text":"<pre><code>old_name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/rename_col_pipe/#mecfs_bio.build_system.task.pipes.rename_col_pipe.RenameColPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/rename_col_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    return x.rename({self.old_name: self.new_name})\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/replace_pipe/","title":"replace_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/replace_pipe/#mecfs_bio.build_system.task.pipes.replace_pipe","title":"mecfs_bio.build_system.task.pipes.replace_pipe","text":"<p>Classes:</p> <ul> <li> <code>ReplaceStrictPipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/replace_pipe/#mecfs_bio.build_system.task.pipes.replace_pipe.ReplaceStrictPipe","title":"ReplaceStrictPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>new_column_name</code>               (<code>str</code>)           \u2013            </li> <li> <code>replace_mapping</code>               (<code>Mapping</code>)           \u2013            </li> <li> <code>target_column</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/replace_pipe/#mecfs_bio.build_system.task.pipes.replace_pipe.ReplaceStrictPipe.new_column_name","title":"new_column_name  <code>instance-attribute</code>","text":"<pre><code>new_column_name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/replace_pipe/#mecfs_bio.build_system.task.pipes.replace_pipe.ReplaceStrictPipe.replace_mapping","title":"replace_mapping  <code>instance-attribute</code>","text":"<pre><code>replace_mapping: Mapping\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/replace_pipe/#mecfs_bio.build_system.task.pipes.replace_pipe.ReplaceStrictPipe.target_column","title":"target_column  <code>instance-attribute</code>","text":"<pre><code>target_column: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/replace_pipe/#mecfs_bio.build_system.task.pipes.replace_pipe.ReplaceStrictPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/replace_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    return x.with_columns(\n        narwhals.col(self.target_column)\n        .replace_strict(self.replace_mapping)\n        .alias(self.new_column_name)\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/scale_col_pipe/","title":"scale_col_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/scale_col_pipe/#mecfs_bio.build_system.task.pipes.scale_col_pipe","title":"mecfs_bio.build_system.task.pipes.scale_col_pipe","text":"<p>Classes:</p> <ul> <li> <code>ScaleColPipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/scale_col_pipe/#mecfs_bio.build_system.task.pipes.scale_col_pipe.ScaleColPipe","title":"ScaleColPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>col</code>               (<code>str</code>)           \u2013            </li> <li> <code>scale_factor</code>               (<code>float</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/scale_col_pipe/#mecfs_bio.build_system.task.pipes.scale_col_pipe.ScaleColPipe.col","title":"col  <code>instance-attribute</code>","text":"<pre><code>col: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/scale_col_pipe/#mecfs_bio.build_system.task.pipes.scale_col_pipe.ScaleColPipe.scale_factor","title":"scale_factor  <code>instance-attribute</code>","text":"<pre><code>scale_factor: float\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/scale_col_pipe/#mecfs_bio.build_system.task.pipes.scale_col_pipe.ScaleColPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/scale_col_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    return x.with_columns(\n        (self.scale_factor * narwhals.col(self.col)).alias(self.col)\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/select_pipe/","title":"select_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/select_pipe/#mecfs_bio.build_system.task.pipes.select_pipe","title":"mecfs_bio.build_system.task.pipes.select_pipe","text":"<p>Classes:</p> <ul> <li> <code>SelectColPipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/select_pipe/#mecfs_bio.build_system.task.pipes.select_pipe.SelectColPipe","title":"SelectColPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>cols_to_select</code>               (<code>list[str]</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/select_pipe/#mecfs_bio.build_system.task.pipes.select_pipe.SelectColPipe.cols_to_select","title":"cols_to_select  <code>instance-attribute</code>","text":"<pre><code>cols_to_select: list[str]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/select_pipe/#mecfs_bio.build_system.task.pipes.select_pipe.SelectColPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/select_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    y = x.select(*self.cols_to_select)\n    return y\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/set_col_pipe/","title":"set_col_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/set_col_pipe/#mecfs_bio.build_system.task.pipes.set_col_pipe","title":"mecfs_bio.build_system.task.pipes.set_col_pipe","text":"<p>Classes:</p> <ul> <li> <code>SetColToConstantPipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/set_col_pipe/#mecfs_bio.build_system.task.pipes.set_col_pipe.SetColToConstantPipe","title":"SetColToConstantPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>col_name</code>               (<code>str</code>)           \u2013            </li> <li> <code>constant</code>               (<code>str | int | float</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/set_col_pipe/#mecfs_bio.build_system.task.pipes.set_col_pipe.SetColToConstantPipe.col_name","title":"col_name  <code>instance-attribute</code>","text":"<pre><code>col_name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/set_col_pipe/#mecfs_bio.build_system.task.pipes.set_col_pipe.SetColToConstantPipe.constant","title":"constant  <code>instance-attribute</code>","text":"<pre><code>constant: str | int | float\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/set_col_pipe/#mecfs_bio.build_system.task.pipes.set_col_pipe.SetColToConstantPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/set_col_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    return x.with_columns(narwhals.lit(self.constant).alias(self.col_name))\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/shifted_log_pipe/","title":"shifted_log_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/shifted_log_pipe/#mecfs_bio.build_system.task.pipes.shifted_log_pipe","title":"mecfs_bio.build_system.task.pipes.shifted_log_pipe","text":"<p>Classes:</p> <ul> <li> <code>ShiftedLogPipe</code>           \u2013            </li> <li> <code>ShiftedLogPipeInclude</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/shifted_log_pipe/#mecfs_bio.build_system.task.pipes.shifted_log_pipe.ShiftedLogPipe","title":"ShiftedLogPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>base</code>               (<code>int</code>)           \u2013            </li> <li> <code>cols_to_exclude</code>               (<code>Sequence[str]</code>)           \u2013            </li> <li> <code>pseudocount</code>               (<code>float</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/shifted_log_pipe/#mecfs_bio.build_system.task.pipes.shifted_log_pipe.ShiftedLogPipe.base","title":"base  <code>instance-attribute</code>","text":"<pre><code>base: int\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/shifted_log_pipe/#mecfs_bio.build_system.task.pipes.shifted_log_pipe.ShiftedLogPipe.cols_to_exclude","title":"cols_to_exclude  <code>instance-attribute</code>","text":"<pre><code>cols_to_exclude: Sequence[str]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/shifted_log_pipe/#mecfs_bio.build_system.task.pipes.shifted_log_pipe.ShiftedLogPipe.pseudocount","title":"pseudocount  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>pseudocount: float = 1\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/shifted_log_pipe/#mecfs_bio.build_system.task.pipes.shifted_log_pipe.ShiftedLogPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/shifted_log_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    schema = x.collect_schema()\n    for col_name in schema.keys():\n        if col_name not in self.cols_to_exclude:\n            x = x.with_columns(\n                (narwhals.col(col_name) + self.pseudocount)\n                .log(base=self.base)\n                .alias(col_name)\n            )\n\n    return x\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/shifted_log_pipe/#mecfs_bio.build_system.task.pipes.shifted_log_pipe.ShiftedLogPipeInclude","title":"ShiftedLogPipeInclude","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>base</code>               (<code>int</code>)           \u2013            </li> <li> <code>cols_to_include</code>               (<code>Sequence[str]</code>)           \u2013            </li> <li> <code>pseudocount</code>               (<code>float</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/shifted_log_pipe/#mecfs_bio.build_system.task.pipes.shifted_log_pipe.ShiftedLogPipeInclude.base","title":"base  <code>instance-attribute</code>","text":"<pre><code>base: int\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/shifted_log_pipe/#mecfs_bio.build_system.task.pipes.shifted_log_pipe.ShiftedLogPipeInclude.cols_to_include","title":"cols_to_include  <code>instance-attribute</code>","text":"<pre><code>cols_to_include: Sequence[str]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/shifted_log_pipe/#mecfs_bio.build_system.task.pipes.shifted_log_pipe.ShiftedLogPipeInclude.pseudocount","title":"pseudocount  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>pseudocount: float = 1\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/shifted_log_pipe/#mecfs_bio.build_system.task.pipes.shifted_log_pipe.ShiftedLogPipeInclude.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/shifted_log_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    for col_name in self.cols_to_include:\n        x = x.with_columns(\n            (narwhals.col(col_name) + self.pseudocount)\n            .log(base=self.base)\n            .alias(col_name)\n        )\n    return x\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/sort_pipe/","title":"sort_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/sort_pipe/#mecfs_bio.build_system.task.pipes.sort_pipe","title":"mecfs_bio.build_system.task.pipes.sort_pipe","text":"<p>Classes:</p> <ul> <li> <code>SortPipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/sort_pipe/#mecfs_bio.build_system.task.pipes.sort_pipe.SortPipe","title":"SortPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>by</code>               (<code>Sequence[str]</code>)           \u2013            </li> <li> <code>desc</code>               (<code>Sequence[bool] | bool</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/sort_pipe/#mecfs_bio.build_system.task.pipes.sort_pipe.SortPipe.by","title":"by  <code>instance-attribute</code>","text":"<pre><code>by: Sequence[str]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/sort_pipe/#mecfs_bio.build_system.task.pipes.sort_pipe.SortPipe.desc","title":"desc  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>desc: Sequence[bool] | bool = False\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/sort_pipe/#mecfs_bio.build_system.task.pipes.sort_pipe.SortPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/sort_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    return x.sort(by=self.by, descending=self.desc)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_lowercase_pipe/","title":"str_lowercase_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/str_lowercase_pipe/#mecfs_bio.build_system.task.pipes.str_lowercase_pipe","title":"mecfs_bio.build_system.task.pipes.str_lowercase_pipe","text":"<p>Classes:</p> <ul> <li> <code>StrLowercasePipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_lowercase_pipe/#mecfs_bio.build_system.task.pipes.str_lowercase_pipe.StrLowercasePipe","title":"StrLowercasePipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>new_column_name</code>               (<code>str</code>)           \u2013            </li> <li> <code>target_column</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_lowercase_pipe/#mecfs_bio.build_system.task.pipes.str_lowercase_pipe.StrLowercasePipe.new_column_name","title":"new_column_name  <code>instance-attribute</code>","text":"<pre><code>new_column_name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_lowercase_pipe/#mecfs_bio.build_system.task.pipes.str_lowercase_pipe.StrLowercasePipe.target_column","title":"target_column  <code>instance-attribute</code>","text":"<pre><code>target_column: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_lowercase_pipe/#mecfs_bio.build_system.task.pipes.str_lowercase_pipe.StrLowercasePipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/str_lowercase_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    return x.with_columns(\n        narwhals.col(self.target_column)\n        .str.to_lowercase()\n        .alias(self.new_column_name)\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_replace_pipe/","title":"str_replace_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/str_replace_pipe/#mecfs_bio.build_system.task.pipes.str_replace_pipe","title":"mecfs_bio.build_system.task.pipes.str_replace_pipe","text":"<p>Classes:</p> <ul> <li> <code>StrReplacePipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_replace_pipe/#mecfs_bio.build_system.task.pipes.str_replace_pipe.StrReplacePipe","title":"StrReplacePipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>new_column_name</code>               (<code>str</code>)           \u2013            </li> <li> <code>replace_what</code>               (<code>str</code>)           \u2013            </li> <li> <code>replace_with</code>               (<code>str</code>)           \u2013            </li> <li> <code>target_column</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_replace_pipe/#mecfs_bio.build_system.task.pipes.str_replace_pipe.StrReplacePipe.new_column_name","title":"new_column_name  <code>instance-attribute</code>","text":"<pre><code>new_column_name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_replace_pipe/#mecfs_bio.build_system.task.pipes.str_replace_pipe.StrReplacePipe.replace_what","title":"replace_what  <code>instance-attribute</code>","text":"<pre><code>replace_what: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_replace_pipe/#mecfs_bio.build_system.task.pipes.str_replace_pipe.StrReplacePipe.replace_with","title":"replace_with  <code>instance-attribute</code>","text":"<pre><code>replace_with: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_replace_pipe/#mecfs_bio.build_system.task.pipes.str_replace_pipe.StrReplacePipe.target_column","title":"target_column  <code>instance-attribute</code>","text":"<pre><code>target_column: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_replace_pipe/#mecfs_bio.build_system.task.pipes.str_replace_pipe.StrReplacePipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/str_replace_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    return x.with_columns(\n        narwhals.col(self.target_column)\n        .str.replace_all(self.replace_what, self.replace_with)\n        .alias(self.new_column_name)\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_split_col/","title":"str_split_col","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/str_split_col/#mecfs_bio.build_system.task.pipes.str_split_col","title":"mecfs_bio.build_system.task.pipes.str_split_col","text":"<p>Classes:</p> <ul> <li> <code>SplitColPipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_split_col/#mecfs_bio.build_system.task.pipes.str_split_col.SplitColPipe","title":"SplitColPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>col_to_split</code>               (<code>str</code>)           \u2013            </li> <li> <code>new_col_name</code>               (<code>str</code>)           \u2013            </li> <li> <code>split_by</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_split_col/#mecfs_bio.build_system.task.pipes.str_split_col.SplitColPipe.col_to_split","title":"col_to_split  <code>instance-attribute</code>","text":"<pre><code>col_to_split: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_split_col/#mecfs_bio.build_system.task.pipes.str_split_col.SplitColPipe.new_col_name","title":"new_col_name  <code>instance-attribute</code>","text":"<pre><code>new_col_name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_split_col/#mecfs_bio.build_system.task.pipes.str_split_col.SplitColPipe.split_by","title":"split_by  <code>instance-attribute</code>","text":"<pre><code>split_by: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_split_col/#mecfs_bio.build_system.task.pipes.str_split_col.SplitColPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/str_split_col.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    return x.with_columns(\n        narwhals.col(self.col_to_split)\n        .str.split(self.split_by)\n        .alias(self.new_col_name)\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_split_exact_col/","title":"str_split_exact_col","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/str_split_exact_col/#mecfs_bio.build_system.task.pipes.str_split_exact_col","title":"mecfs_bio.build_system.task.pipes.str_split_exact_col","text":"<p>Classes:</p> <ul> <li> <code>SplitExactColPipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_split_exact_col/#mecfs_bio.build_system.task.pipes.str_split_exact_col.SplitExactColPipe","title":"SplitExactColPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>col_to_split</code>               (<code>str</code>)           \u2013            </li> <li> <code>new_col_names</code>               (<code>tuple[str, ...]</code>)           \u2013            </li> <li> <code>split_by</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_split_exact_col/#mecfs_bio.build_system.task.pipes.str_split_exact_col.SplitExactColPipe.col_to_split","title":"col_to_split  <code>instance-attribute</code>","text":"<pre><code>col_to_split: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_split_exact_col/#mecfs_bio.build_system.task.pipes.str_split_exact_col.SplitExactColPipe.new_col_names","title":"new_col_names  <code>instance-attribute</code>","text":"<pre><code>new_col_names: tuple[str, ...]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_split_exact_col/#mecfs_bio.build_system.task.pipes.str_split_exact_col.SplitExactColPipe.split_by","title":"split_by  <code>instance-attribute</code>","text":"<pre><code>split_by: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/str_split_exact_col/#mecfs_bio.build_system.task.pipes.str_split_exact_col.SplitExactColPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/str_split_exact_col.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    xp = (\n        x.collect()\n        .to_polars()\n        .with_columns(\n            pl.col(self.col_to_split)\n            .str.split_exact(self.split_by, n=len(self.new_col_names) - 1)\n            .struct.rename_fields(self.new_col_names)\n            .alias(\"fields\")\n        )\n        .unnest(\"fields\")\n    )\n    return narwhals.from_native(xp).lazy()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/uniquepipe/","title":"uniquepipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/uniquepipe/#mecfs_bio.build_system.task.pipes.uniquepipe","title":"mecfs_bio.build_system.task.pipes.uniquepipe","text":"<p>Classes:</p> <ul> <li> <code>UniquePipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/uniquepipe/#mecfs_bio.build_system.task.pipes.uniquepipe.UniquePipe","title":"UniquePipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>by</code>               (<code>Sequence[str]</code>)           \u2013            </li> <li> <code>keep</code>               (<code>UniqueKeepStrategy</code>)           \u2013            </li> <li> <code>order_by</code>               (<code>str | Sequence[str] | None</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/uniquepipe/#mecfs_bio.build_system.task.pipes.uniquepipe.UniquePipe.by","title":"by  <code>instance-attribute</code>","text":"<pre><code>by: Sequence[str]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/uniquepipe/#mecfs_bio.build_system.task.pipes.uniquepipe.UniquePipe.keep","title":"keep  <code>instance-attribute</code>","text":"<pre><code>keep: UniqueKeepStrategy\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/uniquepipe/#mecfs_bio.build_system.task.pipes.uniquepipe.UniquePipe.order_by","title":"order_by  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>order_by: str | Sequence[str] | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/uniquepipe/#mecfs_bio.build_system.task.pipes.uniquepipe.UniquePipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/uniquepipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    return x.unique(subset=list(self.by), keep=self.keep, order_by=self.order_by)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/unnest_pipe/","title":"unnest_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/unnest_pipe/#mecfs_bio.build_system.task.pipes.unnest_pipe","title":"mecfs_bio.build_system.task.pipes.unnest_pipe","text":"<p>Classes:</p> <ul> <li> <code>UNNestPipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/unnest_pipe/#mecfs_bio.build_system.task.pipes.unnest_pipe.UNNestPipe","title":"UNNestPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>col_to_unnest</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/unnest_pipe/#mecfs_bio.build_system.task.pipes.unnest_pipe.UNNestPipe.col_to_unnest","title":"col_to_unnest  <code>instance-attribute</code>","text":"<pre><code>col_to_unnest: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/unnest_pipe/#mecfs_bio.build_system.task.pipes.unnest_pipe.UNNestPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/unnest_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    return x.explode(self.col_to_unnest)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/unpivot_pipe/","title":"unpivot_pipe","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/unpivot_pipe/#mecfs_bio.build_system.task.pipes.unpivot_pipe","title":"mecfs_bio.build_system.task.pipes.unpivot_pipe","text":"<p>Pipe to convert dataframe from wide to long format.</p> <p>Classes:</p> <ul> <li> <code>UnPivotPipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/unpivot_pipe/#mecfs_bio.build_system.task.pipes.unpivot_pipe.UnPivotPipe","title":"UnPivotPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>index</code>               (<code>str | list[str] | None</code>)           \u2013            </li> <li> <code>on</code>               (<code>str | list[str] | None</code>)           \u2013            </li> <li> <code>value_name</code>               (<code>str</code>)           \u2013            </li> <li> <code>variable_name</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/unpivot_pipe/#mecfs_bio.build_system.task.pipes.unpivot_pipe.UnPivotPipe.index","title":"index  <code>instance-attribute</code>","text":"<pre><code>index: str | list[str] | None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/unpivot_pipe/#mecfs_bio.build_system.task.pipes.unpivot_pipe.UnPivotPipe.on","title":"on  <code>instance-attribute</code>","text":"<pre><code>on: str | list[str] | None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/unpivot_pipe/#mecfs_bio.build_system.task.pipes.unpivot_pipe.UnPivotPipe.value_name","title":"value_name  <code>instance-attribute</code>","text":"<pre><code>value_name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/unpivot_pipe/#mecfs_bio.build_system.task.pipes.unpivot_pipe.UnPivotPipe.variable_name","title":"variable_name  <code>instance-attribute</code>","text":"<pre><code>variable_name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/unpivot_pipe/#mecfs_bio.build_system.task.pipes.unpivot_pipe.UnPivotPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/unpivot_pipe.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    return x.unpivot(\n        on=self.on,\n        index=self.index,\n        variable_name=self.variable_name,\n        value_name=self.value_name,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/winsorize_all/","title":"winsorize_all","text":""},{"location":"reference/mecfs_bio/build_system/task/pipes/winsorize_all/#mecfs_bio.build_system.task.pipes.winsorize_all","title":"mecfs_bio.build_system.task.pipes.winsorize_all","text":"<p>Classes:</p> <ul> <li> <code>WinsorizeAllPipe</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/winsorize_all/#mecfs_bio.build_system.task.pipes.winsorize_all.WinsorizeAllPipe","title":"WinsorizeAllPipe","text":"<p>               Bases: <code>DataProcessingPipe</code></p> <p>Methods:</p> <ul> <li> <code>process</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>cols_to_exclude</code>               (<code>Sequence[str]</code>)           \u2013            </li> <li> <code>max_value</code>               (<code>float</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/pipes/winsorize_all/#mecfs_bio.build_system.task.pipes.winsorize_all.WinsorizeAllPipe.cols_to_exclude","title":"cols_to_exclude  <code>instance-attribute</code>","text":"<pre><code>cols_to_exclude: Sequence[str]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/winsorize_all/#mecfs_bio.build_system.task.pipes.winsorize_all.WinsorizeAllPipe.max_value","title":"max_value  <code>instance-attribute</code>","text":"<pre><code>max_value: float\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/pipes/winsorize_all/#mecfs_bio.build_system.task.pipes.winsorize_all.WinsorizeAllPipe.process","title":"process","text":"<pre><code>process(x: LazyFrame) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/pipes/winsorize_all.py</code> <pre><code>def process(self, x: narwhals.LazyFrame) -&gt; narwhals.LazyFrame:\n    x = x.collect().to_polars()\n    schema = x.collect_schema()\n    for col_name in schema.keys():\n        if col_name not in self.cols_to_exclude:\n            x = x.with_columns(\n                pl.col(col_name).clip(upper_bound=self.max_value).alias(col_name)\n            )\n\n    return narwhals.from_native(x.lazy())\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/plot_mr_effect_measure_task/","title":"plot_mr_effect_measure_task","text":""},{"location":"reference/mecfs_bio/build_system/task/plot_mr_effect_measure_task/#mecfs_bio.build_system.task.plot_mr_effect_measure_task","title":"mecfs_bio.build_system.task.plot_mr_effect_measure_task","text":"<p>Create an effect measure plot using zepid</p> <p>Classes:</p> <ul> <li> <code>EffectMeasurePlotConfig</code>           \u2013            </li> <li> <code>PlotMREffectMeasure</code>           \u2013            <p>Task to create an effect measure plot</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/plot_mr_effect_measure_task/#mecfs_bio.build_system.task.plot_mr_effect_measure_task.EffectMeasurePlotConfig","title":"EffectMeasurePlotConfig","text":"<p>Attributes:</p> <ul> <li> <code>effect_size_col</code>               (<code>str</code>)           \u2013            </li> <li> <code>effect_size_label</code>               (<code>str</code>)           \u2013            </li> <li> <code>figsize</code>               (<code>tuple[float, float]</code>)           \u2013            </li> <li> <code>ref_line_center</code>               (<code>float</code>)           \u2013            </li> <li> <code>se_col</code>               (<code>str</code>)           \u2013            </li> <li> <code>t_adjust</code>               (<code>float</code>)           \u2013            </li> <li> <code>title</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>y_label</code>               (<code>str</code>)           \u2013            </li> <li> <code>y_label_col</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/plot_mr_effect_measure_task/#mecfs_bio.build_system.task.plot_mr_effect_measure_task.EffectMeasurePlotConfig.effect_size_col","title":"effect_size_col  <code>instance-attribute</code>","text":"<pre><code>effect_size_col: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/plot_mr_effect_measure_task/#mecfs_bio.build_system.task.plot_mr_effect_measure_task.EffectMeasurePlotConfig.effect_size_label","title":"effect_size_label  <code>instance-attribute</code>","text":"<pre><code>effect_size_label: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/plot_mr_effect_measure_task/#mecfs_bio.build_system.task.plot_mr_effect_measure_task.EffectMeasurePlotConfig.figsize","title":"figsize  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>figsize: tuple[float, float] = (7, 3)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/plot_mr_effect_measure_task/#mecfs_bio.build_system.task.plot_mr_effect_measure_task.EffectMeasurePlotConfig.ref_line_center","title":"ref_line_center  <code>instance-attribute</code>","text":"<pre><code>ref_line_center: float\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/plot_mr_effect_measure_task/#mecfs_bio.build_system.task.plot_mr_effect_measure_task.EffectMeasurePlotConfig.se_col","title":"se_col  <code>instance-attribute</code>","text":"<pre><code>se_col: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/plot_mr_effect_measure_task/#mecfs_bio.build_system.task.plot_mr_effect_measure_task.EffectMeasurePlotConfig.t_adjust","title":"t_adjust  <code>instance-attribute</code>","text":"<pre><code>t_adjust: float\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/plot_mr_effect_measure_task/#mecfs_bio.build_system.task.plot_mr_effect_measure_task.EffectMeasurePlotConfig.title","title":"title  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>title: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/plot_mr_effect_measure_task/#mecfs_bio.build_system.task.plot_mr_effect_measure_task.EffectMeasurePlotConfig.y_label","title":"y_label  <code>instance-attribute</code>","text":"<pre><code>y_label: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/plot_mr_effect_measure_task/#mecfs_bio.build_system.task.plot_mr_effect_measure_task.EffectMeasurePlotConfig.y_label_col","title":"y_label_col  <code>instance-attribute</code>","text":"<pre><code>y_label_col: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/plot_mr_effect_measure_task/#mecfs_bio.build_system.task.plot_mr_effect_measure_task.PlotMREffectMeasure","title":"PlotMREffectMeasure","text":"<p>               Bases: <code>Task</code></p> <p>Task to create an effect measure plot Useful for example to show the results of Mendelian Randomization</p> <p>See: https://zepid.readthedocs.io/en/latest/Reference/Graphics.html?highlight=effectmeasureplot</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>config</code>               (<code>EffectMeasurePlotConfig</code>)           \u2013            </li> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>pre_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>source_df_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>source_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>source_meta</code>               (<code>Meta</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/plot_mr_effect_measure_task/#mecfs_bio.build_system.task.plot_mr_effect_measure_task.PlotMREffectMeasure.config","title":"config  <code>instance-attribute</code>","text":"<pre><code>config: EffectMeasurePlotConfig\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/plot_mr_effect_measure_task/#mecfs_bio.build_system.task.plot_mr_effect_measure_task.PlotMREffectMeasure.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/plot_mr_effect_measure_task/#mecfs_bio.build_system.task.plot_mr_effect_measure_task.PlotMREffectMeasure.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/plot_mr_effect_measure_task/#mecfs_bio.build_system.task.plot_mr_effect_measure_task.PlotMREffectMeasure.pre_pipe","title":"pre_pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>pre_pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/plot_mr_effect_measure_task/#mecfs_bio.build_system.task.plot_mr_effect_measure_task.PlotMREffectMeasure.source_df_task","title":"source_df_task  <code>instance-attribute</code>","text":"<pre><code>source_df_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/plot_mr_effect_measure_task/#mecfs_bio.build_system.task.plot_mr_effect_measure_task.PlotMREffectMeasure.source_id","title":"source_id  <code>property</code>","text":"<pre><code>source_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/plot_mr_effect_measure_task/#mecfs_bio.build_system.task.plot_mr_effect_measure_task.PlotMREffectMeasure.source_meta","title":"source_meta  <code>property</code>","text":"<pre><code>source_meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/plot_mr_effect_measure_task/#mecfs_bio.build_system.task.plot_mr_effect_measure_task.PlotMREffectMeasure.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    source_df_task: Task,\n    config: EffectMeasurePlotConfig,\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/plot_mr_effect_measure_task.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    source_df_task: Task,\n    config: EffectMeasurePlotConfig,\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n):\n    source_meta = source_df_task.meta\n    assert isinstance(source_meta, ResultTableMeta)\n    meta = GWASPlotDirectoryMeta(\n        trait=source_meta.trait,\n        project=source_meta.project,\n        id=AssetId(asset_id),\n    )\n    return cls(\n        source_df_task=source_df_task,\n        config=config,\n        meta=meta,\n        pre_pipe=pre_pipe,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/plot_mr_effect_measure_task/#mecfs_bio.build_system.task.plot_mr_effect_measure_task.PlotMREffectMeasure.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/plot_mr_effect_measure_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    source_asset = fetch(self.source_id)\n    df = (\n        self.pre_pipe.process(\n            scan_dataframe_asset(source_asset, meta=self.source_meta)\n        )\n        .collect()\n        .to_pandas()\n    )\n    df = df.sort_values(by=self.config.effect_size_col)\n    mean = df[self.config.effect_size_col]\n    se = df[self.config.se_col]\n    lower = mean - 1.95 * se\n    upper = mean + 1.95 * se\n    p = EffectMeasurePlot(\n        label=df[self.config.y_label_col].tolist(),\n        effect_measure=mean.tolist(),\n        lcl=lower.tolist(),\n        ucl=upper.tolist(),\n    )\n    p.labels(\n        center=self.config.ref_line_center,\n        effectmeasure=self.config.effect_size_label,\n    )\n    ax = p.plot(\n        figsize=self.config.figsize,\n        t_adjuster=self.config.t_adjust,\n    )\n    if self.config.title is not None:\n        plt.title(self.config.title)\n    ax.spines[\"top\"].set_visible(False)\n    ax.spines[\"right\"].set_visible(False)\n    ax.spines[\"bottom\"].set_visible(True)\n    ax.spines[\"left\"].set_visible(False)\n    plt.savefig(scratch_dir / \"effect_measure_plot.png\", bbox_inches=\"tight\")\n    return DirectoryAsset(scratch_dir)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/","title":"r_tasks","text":""},{"location":"reference/mecfs_bio/build_system/task/r_tasks/#mecfs_bio.build_system.task.r_tasks","title":"mecfs_bio.build_system.task.r_tasks","text":"<p>Tasks that call R libraries.</p> <p>Modules:</p> <ul> <li> <code>susie_r_finemap_task</code>           \u2013            <p>Finemap a GWAS locus using SUSIE</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/","title":"susie_r_finemap_task","text":""},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task","title":"mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task","text":"<p>Finemap a GWAS locus using SUSIE</p> <p>Classes:</p> <ul> <li> <code>BroadInstituteFormatLDMatrix</code>           \u2013            <p>Wraps a task to recovery an LD matrix stored in Broad Institute Format.</p> </li> <li> <code>SusieRFinemapTask</code>           \u2013            <p>This task uses susie_rss function from the R library susieR to fine map a GWAS at a locus.</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>align_gwas_and_ld</code>             \u2013              <p>Slice the reference LD matrix and the GWAS data so that they only include genetic variants in their intersection</p> </li> <li> <code>apply_subsample</code>             \u2013              <p>Subsample gwasdata</p> </li> <li> <code>check_symmetric</code>             \u2013              </li> <li> <code>convert_r_named_list_to_python_dict</code>             \u2013              </li> <li> <code>extract_cs_data_tables</code>             \u2013              </li> <li> <code>filter_variants_based_on_diagnostics</code>             \u2013              <p>Filter out variants that show evidence of inconsistency between the GWAS and LD matrix</p> </li> <li> <code>make_psd_corr</code>             \u2013              <p>Make a correlation matrix positive semidefinite</p> </li> <li> <code>r_to_py_recursive</code>             \u2013              </li> <li> <code>write_result</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>ADJUSTMENT_VALUE_FILENAME</code>           \u2013            </li> <li> <code>ALPHA_COLUMN_NAME</code>           \u2013            </li> <li> <code>ALPHA_FILENAME</code>           \u2013            </li> <li> <code>COMBINED_CS_FILENAME</code>           \u2013            </li> <li> <code>CS_COLUMN</code>           \u2013            </li> <li> <code>CS_DATA_SUBDIR</code>           \u2013            </li> <li> <code>FILTERED_GWAS_FILENAME</code>           \u2013            </li> <li> <code>FILTERED_LD_FILENAME</code>           \u2013            </li> <li> <code>KRIGING_PLOT_FILENAME</code>           \u2013            </li> <li> <code>KRIGING_TABLE_FILENAME</code>           \u2013            </li> <li> <code>LDMatrixSource</code>           \u2013            </li> <li> <code>MU2_COLUMN_NAME</code>           \u2013            </li> <li> <code>MU2_FILENAME</code>           \u2013            </li> <li> <code>MU_COLUMN_NAME</code>           \u2013            </li> <li> <code>MU_FILENAME</code>           \u2013            </li> <li> <code>NO_CS_FOUND_FILENAME</code>           \u2013            </li> <li> <code>PIP_COLUMN</code>           \u2013            </li> <li> <code>PIP_FILENAME</code>           \u2013            </li> <li> <code>PURITY_FILENAME</code>           \u2013            </li> <li> <code>SETS_FILENAME</code>           \u2013            </li> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.ADJUSTMENT_VALUE_FILENAME","title":"ADJUSTMENT_VALUE_FILENAME  <code>module-attribute</code>","text":"<pre><code>ADJUSTMENT_VALUE_FILENAME = 'adjustment_value.parquet'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.ALPHA_COLUMN_NAME","title":"ALPHA_COLUMN_NAME  <code>module-attribute</code>","text":"<pre><code>ALPHA_COLUMN_NAME = 'alpha'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.ALPHA_FILENAME","title":"ALPHA_FILENAME  <code>module-attribute</code>","text":"<pre><code>ALPHA_FILENAME = 'alpha.parquet'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.COMBINED_CS_FILENAME","title":"COMBINED_CS_FILENAME  <code>module-attribute</code>","text":"<pre><code>COMBINED_CS_FILENAME = 'combined_cs.parquet'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.CS_COLUMN","title":"CS_COLUMN  <code>module-attribute</code>","text":"<pre><code>CS_COLUMN = 'cs'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.CS_DATA_SUBDIR","title":"CS_DATA_SUBDIR  <code>module-attribute</code>","text":"<pre><code>CS_DATA_SUBDIR = 'credible_set_data'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.FILTERED_GWAS_FILENAME","title":"FILTERED_GWAS_FILENAME  <code>module-attribute</code>","text":"<pre><code>FILTERED_GWAS_FILENAME = 'filtered_gwas.parquet'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.FILTERED_LD_FILENAME","title":"FILTERED_LD_FILENAME  <code>module-attribute</code>","text":"<pre><code>FILTERED_LD_FILENAME = 'filtered_ld.npy'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.KRIGING_PLOT_FILENAME","title":"KRIGING_PLOT_FILENAME  <code>module-attribute</code>","text":"<pre><code>KRIGING_PLOT_FILENAME = 'kriging_diagnostic_plot.png'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.KRIGING_TABLE_FILENAME","title":"KRIGING_TABLE_FILENAME  <code>module-attribute</code>","text":"<pre><code>KRIGING_TABLE_FILENAME = 'kriging_diagnostic_table.parquet'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.LDMatrixSource","title":"LDMatrixSource  <code>module-attribute</code>","text":"<pre><code>LDMatrixSource = BroadInstituteFormatLDMatrix\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.MU2_COLUMN_NAME","title":"MU2_COLUMN_NAME  <code>module-attribute</code>","text":"<pre><code>MU2_COLUMN_NAME = 'mu2'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.MU2_FILENAME","title":"MU2_FILENAME  <code>module-attribute</code>","text":"<pre><code>MU2_FILENAME = 'mu2.parquet'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.MU_COLUMN_NAME","title":"MU_COLUMN_NAME  <code>module-attribute</code>","text":"<pre><code>MU_COLUMN_NAME = 'mu'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.MU_FILENAME","title":"MU_FILENAME  <code>module-attribute</code>","text":"<pre><code>MU_FILENAME = 'mu.parquet'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.NO_CS_FOUND_FILENAME","title":"NO_CS_FOUND_FILENAME  <code>module-attribute</code>","text":"<pre><code>NO_CS_FOUND_FILENAME = 'no_credible_sets_foun.txt'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.PIP_COLUMN","title":"PIP_COLUMN  <code>module-attribute</code>","text":"<pre><code>PIP_COLUMN = 'PIP'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.PIP_FILENAME","title":"PIP_FILENAME  <code>module-attribute</code>","text":"<pre><code>PIP_FILENAME = 'pip.parquet'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.PURITY_FILENAME","title":"PURITY_FILENAME  <code>module-attribute</code>","text":"<pre><code>PURITY_FILENAME = 'purity.parquet'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.SETS_FILENAME","title":"SETS_FILENAME  <code>module-attribute</code>","text":"<pre><code>SETS_FILENAME = 'sets.yaml'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.BroadInstituteFormatLDMatrix","title":"BroadInstituteFormatLDMatrix","text":"<p>Wraps a task to recovery an LD matrix stored in Broad Institute Format. This means that only the lower triangular portion is stored, and the diagonal is halved. To recover the full LD matrix, compute M +M^T</p> <p>Attributes:</p> <ul> <li> <code>task</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.BroadInstituteFormatLDMatrix.task","title":"task  <code>instance-attribute</code>","text":"<pre><code>task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.SusieRFinemapTask","title":"SusieRFinemapTask","text":"<p>               Bases: <code>Task</code></p> <p>This task uses susie_rss function from the R library susieR to fine map a GWAS at a locus. It requires an LD matrix from a closely matched reference panel</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>effective_sample_size</code>               (<code>float</code>)           \u2013            </li> <li> <code>gwas_data_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>gwas_data_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>ld_labels_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>ld_labels_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>ld_matrix_source</code>               (<code>LDMatrixSource</code>)           \u2013            </li> <li> <code>log_lr_filtering_threshold</code>               (<code>float</code>)           \u2013            </li> <li> <code>max_credible_sets</code>               (<code>int</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>subsample</code>               (<code>int | None</code>)           \u2013            </li> <li> <code>z_score_filtering_threshold</code>               (<code>float</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.SusieRFinemapTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.SusieRFinemapTask.effective_sample_size","title":"effective_sample_size  <code>instance-attribute</code>","text":"<pre><code>effective_sample_size: float\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.SusieRFinemapTask.gwas_data_pipe","title":"gwas_data_pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>gwas_data_pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.SusieRFinemapTask.gwas_data_task","title":"gwas_data_task  <code>instance-attribute</code>","text":"<pre><code>gwas_data_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.SusieRFinemapTask.ld_labels_pipe","title":"ld_labels_pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>ld_labels_pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.SusieRFinemapTask.ld_labels_task","title":"ld_labels_task  <code>instance-attribute</code>","text":"<pre><code>ld_labels_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.SusieRFinemapTask.ld_matrix_source","title":"ld_matrix_source  <code>instance-attribute</code>","text":"<pre><code>ld_matrix_source: LDMatrixSource\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.SusieRFinemapTask.log_lr_filtering_threshold","title":"log_lr_filtering_threshold  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>log_lr_filtering_threshold: float = 2.0\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.SusieRFinemapTask.max_credible_sets","title":"max_credible_sets  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>max_credible_sets: int = 10\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.SusieRFinemapTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.SusieRFinemapTask.subsample","title":"subsample  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>subsample: int | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.SusieRFinemapTask.z_score_filtering_threshold","title":"z_score_filtering_threshold  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>z_score_filtering_threshold: float = 2.0\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.SusieRFinemapTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    gwas_data_task: Task,\n    ld_labels_task: Task,\n    ld_matrix_source: LDMatrixSource,\n    effective_sample_size: float,\n    gwas_data_pipe: DataProcessingPipe = IdentityPipe(),\n    ld_labels_pipe: DataProcessingPipe = IdentityPipe(),\n    subsample: int | None = None,\n    max_credible_sets: int = 10,\n    log_lr_filtering_threshold: float = 2.0,\n    z_score_filtering_threshold: float = 2.0,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    gwas_data_task: Task,\n    ld_labels_task: Task,\n    ld_matrix_source: LDMatrixSource,\n    effective_sample_size: float,\n    gwas_data_pipe: DataProcessingPipe = IdentityPipe(),\n    ld_labels_pipe: DataProcessingPipe = IdentityPipe(),\n    subsample: int | None = None,\n    max_credible_sets: int = 10,\n    log_lr_filtering_threshold: float = 2.0,\n    z_score_filtering_threshold: float = 2.0,\n):\n    source_meta = gwas_data_task.meta\n    meta: Meta\n    if isinstance(source_meta, FilteredGWASDataMeta):\n        meta = ResultDirectoryMeta(\n            id=AssetId(asset_id),\n            trait=source_meta.trait,\n            project=source_meta.project,\n            sub_dir=PurePath(\"analysis\"),\n        )\n    else:\n        raise NotImplementedError(f\"No handler for meta {source_meta} implemented\")\n    return cls(\n        meta=meta,\n        gwas_data_task=gwas_data_task,\n        ld_labels_task=ld_labels_task,\n        ld_matrix_source=ld_matrix_source,\n        effective_sample_size=effective_sample_size,\n        gwas_data_pipe=gwas_data_pipe,\n        ld_labels_pipe=ld_labels_pipe,\n        max_credible_sets=max_credible_sets,\n        subsample=subsample,\n        log_lr_filtering_threshold=log_lr_filtering_threshold,\n        z_score_filtering_threshold=z_score_filtering_threshold,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.SusieRFinemapTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    susie_package = importr(\"susieR\")\n    ggplot2 = importr(\"ggplot2\")\n    conv = ro.default_converter + pandas2ri.converter + numpy2ri.converter\n\n    gwas_asset = fetch(self.gwas_data_task.asset_id)\n    gwas_table = (\n        self.gwas_data_pipe.process(\n            scan_dataframe_asset(gwas_asset, self.gwas_data_task.meta)\n        )\n        .collect()\n        .to_polars()\n    )\n\n    ld_labels_asset = fetch(self.ld_labels_task.asset_id)\n    ld_labels_table = (\n        self.ld_labels_pipe.process(\n            scan_dataframe_asset(ld_labels_asset, self.ld_labels_task.meta)\n        )\n        .collect()\n        .to_polars()\n    )\n\n    ld_matrix_asset = fetch(self.ld_matrix_source.task.asset_id)\n    assert isinstance(ld_matrix_asset, FileAsset)\n    partial_ld_matrix_sparse = _load_partial_ld_matrix(path=ld_matrix_asset.path)\n\n    gwas_table, ld_labels_table, ld_matrix = align_gwas_and_ld(\n        gwas=gwas_table,\n        ld_labels=ld_labels_table,\n        partial_ld_matrix_sparse=partial_ld_matrix_sparse,\n    )\n    del partial_ld_matrix_sparse\n    gwas_table, ld_labels_table, ld_matrix = apply_subsample(\n        gwas_table, ld_labels_table, ld_matrix, subsample=self.subsample\n    )\n    assert len(gwas_table) == len(ld_labels_table) == len(ld_matrix)\n    logger.debug(f\"Dimensions of LD matrix to use: {ld_matrix.shape}\")\n\n    ld_matrix = make_psd_corr(ld_matrix)\n\n    zscores_pandas = (\n        gwas_table[GWASLAB_BETA_COL] / gwas_table[GWASLAB_SE_COL]\n    ).to_pandas()\n\n    with localconverter(conv):\n        zscores_r = ro.conversion.get_conversion().py2rpy(zscores_pandas)\n        ld_matrix_r = ro.conversion.get_conversion().py2rpy(ld_matrix)\n        logger.debug(\"Running Summary Statistics/ LD matrix diagnostics\")\n        adjustment = susie_package.estimate_s_rss(\n            zscores_r, ld_matrix_r, n=int(self.effective_sample_size)\n        )\n        logger.debug(f\"LD matrix adjustment parameter is: {adjustment}\")\n    diagnostic_table = _make_diagnostic_plot_and_table(\n        zscores_r=zscores_r,\n        ld_matrix_r=ld_matrix_r,\n        effective_sample_size=int(self.effective_sample_size),\n        susie_package=susie_package,\n        ggplot2_package=ggplot2,\n        scratch_dir=scratch_dir,\n    )\n\n    gwas_table, ld_matrix = filter_variants_based_on_diagnostics(\n        gwas_table=gwas_table,\n        ld_matrix=ld_matrix,\n        diagnostic_table=diagnostic_table,\n        log_lr_threshold=self.log_lr_filtering_threshold,\n        z_score_threshold=self.z_score_filtering_threshold,\n    )\n\n    ld_matrix = (1 - adjustment) * ld_matrix + adjustment * np.eye(\n        ld_matrix.shape[0]\n    )\n    check_symmetric(ld_matrix)\n    with localconverter(conv):\n        zscores_pandas = (\n            gwas_table[GWASLAB_BETA_COL] / gwas_table[GWASLAB_SE_COL]\n        ).to_pandas()\n        zscores_r = ro.conversion.get_conversion().py2rpy(zscores_pandas)\n        ld_matrix_r = ro.conversion.get_conversion().py2rpy(ld_matrix)\n    _save_adjustment(adjustment=float(adjustment), scratch_dir=scratch_dir)\n\n    logger.debug(\"Running SUSIE\")\n    susie_result = susie_package.susie_rss(\n        zscores_r,\n        ld_matrix_r,\n        n=int(self.effective_sample_size),\n        L=self.max_credible_sets,\n    )\n    py_result = convert_r_named_list_to_python_dict(susie_result)\n    _check_converged(py_result)\n    write_result(\n        scratch_dir,\n        py_result=py_result,\n        gwas_table=gwas_table,\n        ld_matrix=ld_matrix,\n        L=self.max_credible_sets,\n    )\n\n    del ld_matrix\n    del gwas_table\n    del susie_result\n\n    # Force Python GC\n    gc.collect()\n\n    # Force R GC\n    ro.r(\"gc()\")\n    return DirectoryAsset(scratch_dir)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.align_gwas_and_ld","title":"align_gwas_and_ld","text":"<pre><code>align_gwas_and_ld(\n    gwas: DataFrame,\n    ld_labels: DataFrame,\n    partial_ld_matrix_sparse: csr_matrix,\n) -&gt; tuple[pl.DataFrame, pl.DataFrame, np.ndarray]\n</code></pre> <p>Slice the reference LD matrix and the GWAS data so that they only include genetic variants in their intersection</p> Source code in <code>mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task.py</code> <pre><code>def align_gwas_and_ld(\n    gwas: pl.DataFrame, ld_labels: pl.DataFrame, partial_ld_matrix_sparse: csr_matrix\n) -&gt; tuple[pl.DataFrame, pl.DataFrame, np.ndarray]:\n    \"\"\"\n    Slice the reference LD matrix and the GWAS data so that they only include genetic variants in their intersection\n    \"\"\"\n    gwas = gwas.sort(by=GWASLAB_POS_COL)\n    gwas = gwas.with_row_index(name=\"gwas_index\")\n    ld_labels = ld_labels.with_row_index(name=\"ld_index\")\n    joined = gwas.join(\n        ld_labels,\n        on=[\n            GWASLAB_CHROM_COL,\n            GWASLAB_POS_COL,\n            GWASLAB_EFFECT_ALLELE_COL,\n            GWASLAB_NON_EFFECT_ALLELE_COL,\n        ],\n        maintain_order=\"left\",\n    )\n    keep_ld_index = joined[\"ld_index\"].to_numpy()\n    partial_ld_matrix_sparse = partial_ld_matrix_sparse[keep_ld_index, :][\n        :, keep_ld_index\n    ]\n    partial_ld_matrix_dense = partial_ld_matrix_sparse.toarray()\n    ld_matrix = partial_ld_matrix_dense + partial_ld_matrix_dense.T\n\n    ld_labels = ld_labels[joined[\"ld_index\"]].drop(\"ld_index\")\n\n    assert ld_matrix.shape[0] == len(ld_labels)\n    assert (abs(ld_matrix.diagonal() - 1)).max() &lt;= 1e-4\n    return (\n        gwas[joined[\"gwas_index\"]].drop(\"gwas_index\"),\n        ld_labels,\n        ld_matrix,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.apply_subsample","title":"apply_subsample","text":"<pre><code>apply_subsample(\n    gwas_table: DataFrame,\n    ld_labels: DataFrame,\n    ld_matrix: ndarray,\n    subsample: int | None,\n) -&gt; tuple[pl.DataFrame, pl.DataFrame, np.ndarray]\n</code></pre> <p>Subsample gwasdata</p> Source code in <code>mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task.py</code> <pre><code>def apply_subsample(\n    gwas_table: pl.DataFrame,\n    ld_labels: pl.DataFrame,\n    ld_matrix: np.ndarray,\n    subsample: int | None,\n) -&gt; tuple[pl.DataFrame, pl.DataFrame, np.ndarray]:\n    \"\"\"\n    Subsample gwasdata\n    \"\"\"\n    if subsample is None:\n        return gwas_table, ld_labels, ld_matrix\n    logger.debug(\"Subsampling...\")\n    return (\n        gwas_table[::subsample],\n        ld_labels[::subsample],\n        ld_matrix[::subsample, ::subsample],\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.check_symmetric","title":"check_symmetric","text":"<pre><code>check_symmetric(array: ndarray, tol=1e-06)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task.py</code> <pre><code>def check_symmetric(array: np.ndarray, tol=1e-6):\n    assert np.max(np.abs(array - array.T)) &lt;= tol\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.convert_r_named_list_to_python_dict","title":"convert_r_named_list_to_python_dict","text":"<pre><code>convert_r_named_list_to_python_dict(rdata) -&gt; dict\n</code></pre> Source code in <code>mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task.py</code> <pre><code>def convert_r_named_list_to_python_dict(rdata) -&gt; dict:\n    return dict(zip(rdata.names, list(rdata)))\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.extract_cs_data_tables","title":"extract_cs_data_tables","text":"<pre><code>extract_cs_data_tables(\n    alpha: ndarray,\n    mu: ndarray,\n    pip: ndarray,\n    sets: dict,\n    gt: DataFrame,\n) -&gt; dict[str, pl.DataFrame]\n</code></pre> Source code in <code>mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task.py</code> <pre><code>def extract_cs_data_tables(\n    alpha: np.ndarray,\n    mu: np.ndarray,\n    pip: np.ndarray,\n    sets: dict,\n    gt: pl.DataFrame,\n) -&gt; dict[str, pl.DataFrame]:\n    cs_data_tables = {}\n    for set_name, set_values in sets[\"cs\"].items():\n        set_number = int(set_name.replace(\"L\", \"\")) - 1\n        set_values = (\n            np.array(set_values).reshape(-1) - 1\n        )  # Since r uses 1-based indexing\n        gwas_for_set: pl.DataFrame = gt[set_values]\n        alpha_for_set = pl.Series(\n            values=alpha[set_number, set_values].reshape(-1), name=ALPHA_COLUMN_NAME\n        )\n        mu_for_set = pl.Series(\n            values=mu[set_number, set_values].reshape(-1), name=MU_COLUMN_NAME\n        )\n        pip_for_set = pl.Series(values=pip[set_values].reshape(-1), name=PIP_COLUMN)\n        gwas_for_set = gwas_for_set.with_columns(alpha_for_set, mu_for_set, pip_for_set)\n        logger.debug(\n            f\"Credible set {set_name}\\n {gwas_for_set.sort(by=PIP_COLUMN, descending=True)}\"\n        )\n        cs_data_tables[set_name] = gwas_for_set.with_columns(\n            pl.lit(set_name).alias(CS_COLUMN)\n        )\n    return cs_data_tables\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.filter_variants_based_on_diagnostics","title":"filter_variants_based_on_diagnostics","text":"<pre><code>filter_variants_based_on_diagnostics(\n    gwas_table: DataFrame,\n    ld_matrix: ndarray,\n    diagnostic_table: DataFrame,\n    log_lr_threshold: float = 2.0,\n    z_score_threshold: float = 2.0,\n) -&gt; tuple[pl.DataFrame, np.ndarray]\n</code></pre> <p>Filter out variants that show evidence of inconsistency between the GWAS and LD matrix</p> <p>According to Zou et al. (2022), filtering out these variants is  valid correction strategy</p> <p>See the supplementary material to the paper for an in depth discussion of the filtering strategy.</p> Source code in <code>mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task.py</code> <pre><code>def filter_variants_based_on_diagnostics(\n    gwas_table: pl.DataFrame,\n    ld_matrix: np.ndarray,\n    diagnostic_table: pl.DataFrame,\n    log_lr_threshold: float = 2.0,\n    z_score_threshold: float = 2.0,\n) -&gt; tuple[pl.DataFrame, np.ndarray]:\n    \"\"\"\n    Filter out variants that show evidence of inconsistency between the GWAS and LD matrix\n\n    According to Zou et al. (2022), filtering out these variants is  valid correction strategy\n\n    See the supplementary material to the paper for an in depth discussion of the filtering strategy.\n    \"\"\"\n\n    # Ensure diagnostic table aligns with inputs\n    if len(diagnostic_table) != len(gwas_table):\n        raise ValueError(\n            f\"Dimension mismatch: Diagnostic table has {len(diagnostic_table)} rows, \"\n            f\"but GWAS table has {len(gwas_table)} rows.\"\n        )\n\n    bad_variant_mask = (diagnostic_table[\"logLR\"] &gt; log_lr_threshold) &amp; (\n        diagnostic_table[\"z\"].abs() &gt; z_score_threshold\n    )\n\n    n_removed = bad_variant_mask.sum()\n\n    if n_removed == 0:\n        logger.debug(\"Diagnostics passed: No inconsistent variants found.\")\n        return gwas_table, ld_matrix\n\n    logger.warning(\n        f\"Diagnostics failed for {n_removed} variants. \"\n        f\"Filtering them out based on logLR &gt; {log_lr_threshold} and |z| &gt; {z_score_threshold}.\"\n    )\n\n    bad_indices = np.where(bad_variant_mask)[0]\n    removed_variants = gwas_table[bad_indices]\n    for row in removed_variants.iter_rows(named=True):\n        logger.debug(f\"Removing inconsistent variant: {row} \")\n\n    keep_indices = np.where(~bad_variant_mask)[0]\n\n    gwas_table_filtered = gwas_table[keep_indices]\n\n    ld_matrix_filtered = ld_matrix[keep_indices][:, keep_indices]\n\n    return gwas_table_filtered, ld_matrix_filtered\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.make_psd_corr","title":"make_psd_corr","text":"<pre><code>make_psd_corr(\n    matrix: ndarray, tol: float = 0.0001\n) -&gt; np.ndarray\n</code></pre> <p>Make a correlation matrix positive semidefinite</p> Source code in <code>mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task.py</code> <pre><code>def make_psd_corr(matrix: np.ndarray, tol: float = 1e-4) -&gt; np.ndarray:\n    \"\"\"\n    Make a correlation matrix positive semidefinite\n\n    \"\"\"\n    logger.debug(\"ensuring LD matrix is positive definite\")\n    eigs, eigvecs = np.linalg.eigh(matrix)\n    if (eigs &gt;= tol).all():\n        logger.debug(f\"eigenvalues exceed {tol}.  No adjustment necessary.\")\n        return matrix\n    logger.debug(f\"Smallest eigenvalue is {np.min(eigs)} &lt; {tol}.  Applying adjustment\")\n\n    eigs[eigs &lt; tol] = tol\n    reconstructed = eigvecs @ np.diag(eigs) @ eigvecs.T\n    d = np.diag(reconstructed)\n    reconstructed = reconstructed / np.sqrt(d.reshape(-1, 1) * d.reshape(1, -1))\n    assert abs(np.diag(reconstructed) - 1).max() &lt;= 1e-5\n    return reconstructed\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.r_to_py_recursive","title":"r_to_py_recursive","text":"<pre><code>r_to_py_recursive(r_obj)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task.py</code> <pre><code>def r_to_py_recursive(r_obj):\n    conv = ro.default_converter + pandas2ri.converter + numpy2ri.converter\n    if isinstance(r_obj, ro.DataFrame):\n        with localconverter(conv):\n            alpha = ro.conversion.get_conversion().rpy2py(r_obj)\n        return pandas2ri.rpy2py(r_obj)\n\n    if isinstance(r_obj, ro.ListVector):\n        names = r_obj.names\n\n        if names is None:\n            return [r_to_py_recursive(item) for item in r_obj]\n\n        return {name: r_to_py_recursive(r_obj.rx2(name)) for name in names}\n\n    try:\n        if hasattr(r_obj, \"__len__\"):\n            if len(r_obj) == 1:\n                return r_obj[0]\n            return list(r_obj)\n    except:\n        pass\n\n    return r_obj\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task/#mecfs_bio.build_system.task.r_tasks.susie_r_finemap_task.write_result","title":"write_result","text":"<pre><code>write_result(\n    directory: Path,\n    py_result: dict,\n    gwas_table: DataFrame,\n    L: int,\n    ld_matrix: ndarray,\n) -&gt; None\n</code></pre> Source code in <code>mecfs_bio/build_system/task/r_tasks/susie_r_finemap_task.py</code> <pre><code>def write_result(\n    directory: Path,\n    py_result: dict,\n    gwas_table: pl.DataFrame,\n    L: int,\n    ld_matrix: np.ndarray,\n) -&gt; None:\n    gwas_table.write_parquet(directory / FILTERED_GWAS_FILENAME)\n    np.save(directory / FILTERED_LD_FILENAME, ld_matrix)\n    gt = gwas_table.select(\n        [\n            GWASLAB_CHROM_COL,\n            GWASLAB_POS_COL,\n            GWASLAB_EFFECT_ALLELE_COL,\n            GWASLAB_NON_EFFECT_ALLELE_COL,\n        ]\n    )\n    credible_set_names = [f\"L{i}\" for i in range(1, L + 1)]\n    variant_names = [\n        f\"ch{chrom}_{pos}_{ea}_{nea}\"\n        for chrom, pos, ea, nea in zip(\n            gt[GWASLAB_CHROM_COL],\n            gt[GWASLAB_POS_COL],\n            gt[GWASLAB_EFFECT_ALLELE_COL],\n            gt[GWASLAB_NON_EFFECT_ALLELE_COL],\n        )\n    ]\n\n    conv = ro.default_converter + pandas2ri.converter + numpy2ri.converter\n\n    sets = r_to_py_recursive(py_result[\"sets\"])\n    with localconverter(conv):\n        alpha = ro.conversion.get_conversion().rpy2py(py_result[\"alpha\"])\n        pip = ro.conversion.get_conversion().rpy2py(py_result[\"pip\"])\n        mu = ro.conversion.get_conversion().rpy2py(py_result[\"mu\"])\n        mu2 = ro.conversion.get_conversion().rpy2py(py_result[\"mu2\"])\n\n    pd.DataFrame(alpha, columns=variant_names, index=credible_set_names).to_parquet(\n        directory / ALPHA_FILENAME\n    )\n    pd.DataFrame(pip, index=variant_names, columns=[PIP_COLUMN]).to_parquet(\n        directory / PIP_FILENAME\n    )\n    pd.DataFrame(mu, columns=variant_names, index=credible_set_names).to_parquet(\n        directory / MU_FILENAME\n    )\n    pd.DataFrame(mu2, columns=variant_names, index=credible_set_names).to_parquet(\n        directory / MU2_FILENAME\n    )\n\n    subdir = directory / CS_DATA_SUBDIR\n    subdir.mkdir(parents=True, exist_ok=True)\n    if \"purity\" not in sets:\n        logger.debug(\"No credible sets found. Aborting.\")\n        (directory / NO_CS_FOUND_FILENAME).write_text(\"no credible sets found\")\n        dummy_cs_df = pd.DataFrame(\n            {\n                ALPHA_COLUMN_NAME: [],\n                MU_COLUMN_NAME: [],\n                PIP_COLUMN: [],\n                CS_COLUMN: [],\n                GWASLAB_CHROM_COL: [],\n                GWASLAB_POS_COL: [],\n                GWASLAB_EFFECT_ALLELE_COL: [],\n                GWASLAB_NON_EFFECT_ALLELE_COL: [],\n            }\n        )\n        dummy_cs_df.to_parquet(directory / COMBINED_CS_FILENAME)\n    else:\n        pd.DataFrame(sets[\"purity\"]).to_parquet(directory / PURITY_FILENAME)\n        sets.pop(\"purity\")\n        with open(directory / \"sets.yaml\", \"w\") as f:\n            yaml.dump(\n                sets,\n                f,\n                sort_keys=True,\n                default_flow_style=False,\n                allow_unicode=True,\n            )\n        logger.debug(f\"Found {len(sets['cs'])} credible sets\")\n        cs_data_tables = extract_cs_data_tables(\n            alpha=alpha, mu=mu, pip=pip, sets=sets, gt=gt\n        )\n        for name, cs_table in cs_data_tables.items():\n            cs_table.write_parquet(subdir / f\"{name}.parquet\")\n\n        #     cs_data_tables.append(\n        #         gwas_for_set.with_columns(pl.lit(set_name).alias(CS_COLUMN))\n        #     )\n        pl.concat(list(cs_data_tables.values()), how=\"vertical\").sort(\n            by=[CS_COLUMN, PIP_COLUMN], descending=[False, True]\n        ).select(\n            pl.col(CS_COLUMN),\n            pl.exclude(CS_COLUMN),  # bring credible set column to front\n        ).write_parquet(directory / COMBINED_CS_FILENAME)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_cepo_task/","title":"specificity_cepo_task","text":""},{"location":"reference/mecfs_bio/build_system/task/specificity_cepo_task/#mecfs_bio.build_system.task.specificity_cepo_task","title":"mecfs_bio.build_system.task.specificity_cepo_task","text":"<p>Classes:</p> <ul> <li> <code>PrepareSpecificityCepo</code>           \u2013            <p>Task to compute the specificity of genes for cell types using the CEPO specificity metric.</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>DIFFERENTIAL_STABILITY</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/specificity_cepo_task/#mecfs_bio.build_system.task.specificity_cepo_task.DIFFERENTIAL_STABILITY","title":"DIFFERENTIAL_STABILITY  <code>module-attribute</code>","text":"<pre><code>DIFFERENTIAL_STABILITY = 'differential_stability'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_cepo_task/#mecfs_bio.build_system.task.specificity_cepo_task.PrepareSpecificityCepo","title":"PrepareSpecificityCepo","text":"<p>               Bases: <code>Task</code></p> <p>Task to compute the specificity of genes for cell types using the CEPO specificity metric.</p> <p>The CEPO metric is based on differential stability: a gene is considered specific for a cell type if its expression in stable in that cell type, but not other cell types</p> <p>see Kim, Hani Jieun, et al. \"Cepo uncovers cell identity through differential stability.\" bioRxiv (2021): 2021-01.</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>cell_col</code>               (<code>str</code>)           \u2013            </li> <li> <code>cell_type_col</code>               (<code>str</code>)           \u2013            </li> <li> <code>count_col</code>               (<code>str</code>)           \u2013            </li> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>epsilon</code>               (<code>float</code>)           \u2013            </li> <li> <code>gene_col</code>               (<code>str</code>)           \u2013            </li> <li> <code>long_count_df_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>min_cells_per_type</code>               (<code>int</code>)           \u2013            </li> <li> <code>out_format</code>               (<code>OutFormat</code>)           \u2013            </li> <li> <code>post_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>pre_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/specificity_cepo_task/#mecfs_bio.build_system.task.specificity_cepo_task.PrepareSpecificityCepo.cell_col","title":"cell_col  <code>instance-attribute</code>","text":"<pre><code>cell_col: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_cepo_task/#mecfs_bio.build_system.task.specificity_cepo_task.PrepareSpecificityCepo.cell_type_col","title":"cell_type_col  <code>instance-attribute</code>","text":"<pre><code>cell_type_col: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_cepo_task/#mecfs_bio.build_system.task.specificity_cepo_task.PrepareSpecificityCepo.count_col","title":"count_col  <code>instance-attribute</code>","text":"<pre><code>count_col: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_cepo_task/#mecfs_bio.build_system.task.specificity_cepo_task.PrepareSpecificityCepo.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_cepo_task/#mecfs_bio.build_system.task.specificity_cepo_task.PrepareSpecificityCepo.epsilon","title":"epsilon  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>epsilon: float = 0.0001\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_cepo_task/#mecfs_bio.build_system.task.specificity_cepo_task.PrepareSpecificityCepo.gene_col","title":"gene_col  <code>instance-attribute</code>","text":"<pre><code>gene_col: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_cepo_task/#mecfs_bio.build_system.task.specificity_cepo_task.PrepareSpecificityCepo.long_count_df_task","title":"long_count_df_task  <code>instance-attribute</code>","text":"<pre><code>long_count_df_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_cepo_task/#mecfs_bio.build_system.task.specificity_cepo_task.PrepareSpecificityCepo.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_cepo_task/#mecfs_bio.build_system.task.specificity_cepo_task.PrepareSpecificityCepo.min_cells_per_type","title":"min_cells_per_type  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>min_cells_per_type: int = 0\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_cepo_task/#mecfs_bio.build_system.task.specificity_cepo_task.PrepareSpecificityCepo.out_format","title":"out_format  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>out_format: OutFormat = ParquetOutFormat()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_cepo_task/#mecfs_bio.build_system.task.specificity_cepo_task.PrepareSpecificityCepo.post_pipe","title":"post_pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>post_pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_cepo_task/#mecfs_bio.build_system.task.specificity_cepo_task.PrepareSpecificityCepo.pre_pipe","title":"pre_pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>pre_pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_cepo_task/#mecfs_bio.build_system.task.specificity_cepo_task.PrepareSpecificityCepo.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    long_count_df_task: Task,\n    cell_type_col: str,\n    count_col: str,\n    gene_col: str,\n    cell_col: str,\n    min_cells_per_type: int,\n    epsilon: float = 0.0001,\n    out_format: OutFormat = ParquetOutFormat(),\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n    post_pipe: DataProcessingPipe = IdentityPipe(),\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/specificity_cepo_task.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    long_count_df_task: Task,\n    cell_type_col: str,\n    count_col: str,\n    gene_col: str,\n    cell_col: str,\n    min_cells_per_type: int,\n    epsilon: float = 0.0001,\n    out_format: OutFormat = ParquetOutFormat(),\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n    post_pipe: DataProcessingPipe = IdentityPipe(),\n):\n    extension, read_spec = get_extension_and_read_spec_from_format(\n        out_format=out_format\n    )\n    source_meta = long_count_df_task.meta\n    if isinstance(source_meta, ReferenceFileMeta):\n        meta = ReferenceFileMeta(\n            group=source_meta.group,\n            sub_group=source_meta.sub_group,\n            sub_folder=source_meta.sub_folder,\n            id=AssetId(asset_id),\n            filename=None,\n            extension=extension,\n            read_spec=read_spec,\n        )\n    else:\n        raise ValueError(f\"Unknown meta: {source_meta}\")\n    return cls(\n        meta=meta,\n        long_count_df_task=long_count_df_task,\n        cell_type_col=cell_type_col,\n        count_col=count_col,\n        gene_col=gene_col,\n        epsilon=epsilon,\n        out_format=out_format,\n        pre_pipe=pre_pipe,\n        post_pipe=post_pipe,\n        cell_col=cell_col,\n        min_cells_per_type=min_cells_per_type,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_cepo_task/#mecfs_bio.build_system.task.specificity_cepo_task.PrepareSpecificityCepo.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/specificity_cepo_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    long_count_df_asset = fetch(self.long_count_df_task.asset_id)\n\n    df = scan_dataframe_asset(\n        long_count_df_asset, meta=self.long_count_df_task.meta\n    )\n    df = self.pre_pipe.process(df)\n\n    df = filter_by_cell_count(\n        df,\n        cell_type_col=self.cell_type_col,\n        cell_col=self.cell_col,\n        min_cells=self.min_cells_per_type,\n    )\n    df = filter_missing_genes(df, gene_col=self.gene_col, count_col=self.count_col)\n    num_genes = df.select(narwhals.col(self.gene_col).n_unique()).collect().item()\n    _check_not_sparse(df=df, cell_col=self.cell_col, gene_col=self.gene_col)\n    df = _compute_inv_coef_prop_zero(\n        df=df,\n        cell_type_col=self.cell_type_col,\n        count_col=self.count_col,\n        gene_col=self.gene_col,\n        epsilon=self.epsilon,\n    )\n    df = _compute_ranks(df=df, cell_type_col=self.cell_type_col)\n    df = _compute_stability(\n        df=df,\n        num_genes=num_genes,\n    )\n    df = _compute_differential_stability(\n        df=df,\n        cell_type_col=self.cell_type_col,\n        gene_col=self.gene_col,\n    )\n    df = df.select([self.cell_type_col, self.gene_col, DIFFERENTIAL_STABILITY])\n    df = self.post_pipe.process(df)\n    out_path = scratch_dir / \"out\"\n    if isinstance(self.out_format, CSVOutFormat):\n        df.collect().to_pandas().to_csv(\n            out_path, index=False, sep=self.out_format.sep\n        )\n    elif isinstance(self.out_format, ParquetOutFormat):\n        df.sink_parquet(out_path)\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_frac_task/","title":"specificity_frac_task","text":""},{"location":"reference/mecfs_bio/build_system/task/specificity_frac_task/#mecfs_bio.build_system.task.specificity_frac_task","title":"mecfs_bio.build_system.task.specificity_frac_task","text":"<p>Classes:</p> <ul> <li> <code>PrepareSpecificityFraction</code>           \u2013            <p>Task to compute the specificity of genes for cell types using the fractional specificity metric.</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>filter_by_cell_count</code>             \u2013              </li> <li> <code>filter_missing_genes</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>NORMALIZED_MEAN</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/specificity_frac_task/#mecfs_bio.build_system.task.specificity_frac_task.NORMALIZED_MEAN","title":"NORMALIZED_MEAN  <code>module-attribute</code>","text":"<pre><code>NORMALIZED_MEAN = 'normalized_mean'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_frac_task/#mecfs_bio.build_system.task.specificity_frac_task.PrepareSpecificityFraction","title":"PrepareSpecificityFraction","text":"<p>               Bases: <code>Task</code></p> <p>Task to compute the specificity of genes for cell types using the fractional specificity metric.</p> <p>In this metric, the specificity of a gene for a cell type is (mean expression in cell type)/(sum over all cell types of mean expression in those cell types)</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>cell_col</code>               (<code>str</code>)           \u2013            </li> <li> <code>cell_type_col</code>               (<code>str</code>)           \u2013            </li> <li> <code>count_col</code>               (<code>str</code>)           \u2013            </li> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>gene_col</code>               (<code>str</code>)           \u2013            </li> <li> <code>long_count_df_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>min_cells_per_type</code>               (<code>int</code>)           \u2013            </li> <li> <code>out_format</code>               (<code>OutFormat</code>)           \u2013            </li> <li> <code>post_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>pre_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/specificity_frac_task/#mecfs_bio.build_system.task.specificity_frac_task.PrepareSpecificityFraction.cell_col","title":"cell_col  <code>instance-attribute</code>","text":"<pre><code>cell_col: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_frac_task/#mecfs_bio.build_system.task.specificity_frac_task.PrepareSpecificityFraction.cell_type_col","title":"cell_type_col  <code>instance-attribute</code>","text":"<pre><code>cell_type_col: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_frac_task/#mecfs_bio.build_system.task.specificity_frac_task.PrepareSpecificityFraction.count_col","title":"count_col  <code>instance-attribute</code>","text":"<pre><code>count_col: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_frac_task/#mecfs_bio.build_system.task.specificity_frac_task.PrepareSpecificityFraction.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_frac_task/#mecfs_bio.build_system.task.specificity_frac_task.PrepareSpecificityFraction.gene_col","title":"gene_col  <code>instance-attribute</code>","text":"<pre><code>gene_col: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_frac_task/#mecfs_bio.build_system.task.specificity_frac_task.PrepareSpecificityFraction.long_count_df_task","title":"long_count_df_task  <code>instance-attribute</code>","text":"<pre><code>long_count_df_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_frac_task/#mecfs_bio.build_system.task.specificity_frac_task.PrepareSpecificityFraction.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_frac_task/#mecfs_bio.build_system.task.specificity_frac_task.PrepareSpecificityFraction.min_cells_per_type","title":"min_cells_per_type  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>min_cells_per_type: int = 0\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_frac_task/#mecfs_bio.build_system.task.specificity_frac_task.PrepareSpecificityFraction.out_format","title":"out_format  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>out_format: OutFormat = ParquetOutFormat()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_frac_task/#mecfs_bio.build_system.task.specificity_frac_task.PrepareSpecificityFraction.post_pipe","title":"post_pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>post_pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_frac_task/#mecfs_bio.build_system.task.specificity_frac_task.PrepareSpecificityFraction.pre_pipe","title":"pre_pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>pre_pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_frac_task/#mecfs_bio.build_system.task.specificity_frac_task.PrepareSpecificityFraction.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    long_count_df_task: Task,\n    cell_type_col: str,\n    count_col: str,\n    gene_col: str,\n    cell_col: str,\n    min_cells_per_type: int,\n    out_format: OutFormat = ParquetOutFormat(),\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n    post_pipe: DataProcessingPipe = IdentityPipe(),\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/specificity_frac_task.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    long_count_df_task: Task,\n    cell_type_col: str,\n    count_col: str,\n    gene_col: str,\n    cell_col: str,\n    min_cells_per_type: int,\n    out_format: OutFormat = ParquetOutFormat(),\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n    post_pipe: DataProcessingPipe = IdentityPipe(),\n):\n    extension, read_spec = get_extension_and_read_spec_from_format(\n        out_format=out_format\n    )\n    source_meta = long_count_df_task.meta\n    if isinstance(source_meta, ReferenceFileMeta):\n        meta = ReferenceFileMeta(\n            group=source_meta.group,\n            sub_group=source_meta.sub_group,\n            sub_folder=source_meta.sub_folder,\n            id=AssetId(asset_id),\n            filename=None,\n            extension=extension,\n            read_spec=read_spec,\n        )\n    else:\n        raise ValueError(f\"Unknown meta: {source_meta}\")\n    return cls(\n        meta=meta,\n        long_count_df_task=long_count_df_task,\n        cell_type_col=cell_type_col,\n        count_col=count_col,\n        gene_col=gene_col,\n        out_format=out_format,\n        pre_pipe=pre_pipe,\n        post_pipe=post_pipe,\n        cell_col=cell_col,\n        min_cells_per_type=min_cells_per_type,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_frac_task/#mecfs_bio.build_system.task.specificity_frac_task.PrepareSpecificityFraction.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/specificity_frac_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    long_count_df_asset = fetch(self.long_count_df_task.asset_id)\n\n    df = scan_dataframe_asset(\n        long_count_df_asset, meta=self.long_count_df_task.meta\n    )\n    df = self.pre_pipe.process(df)\n    df = filter_by_cell_count(\n        df,\n        cell_type_col=self.cell_type_col,\n        cell_col=self.cell_col,\n        min_cells=self.min_cells_per_type,\n    )\n    df = filter_missing_genes(df, gene_col=self.gene_col, count_col=self.count_col)\n    df = _compute_cell_type_means(\n        df,\n        cell_type_col=self.cell_type_col,\n        count_col=self.count_col,\n        gene_col=self.gene_col,\n    )\n    df = _compute_normalized_mean(\n        df=df,\n        gene_col=self.gene_col,\n    )\n    df = df.select([self.cell_type_col, self.gene_col, NORMALIZED_MEAN])\n    df = self.post_pipe.process(df)\n    out_path = scratch_dir / \"out\"\n    if isinstance(self.out_format, CSVOutFormat):\n        df.collect().to_pandas().to_csv(\n            out_path, index=False, sep=self.out_format.sep\n        )\n    elif isinstance(self.out_format, ParquetOutFormat):\n        df.sink_parquet(out_path)\n    return FileAsset(out_path)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_frac_task/#mecfs_bio.build_system.task.specificity_frac_task.filter_by_cell_count","title":"filter_by_cell_count","text":"<pre><code>filter_by_cell_count(\n    df: LazyFrame,\n    cell_type_col: str,\n    cell_col: str,\n    min_cells: int,\n) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/specificity_frac_task.py</code> <pre><code>def filter_by_cell_count(\n    df: narwhals.LazyFrame, cell_type_col: str, cell_col: str, min_cells: int\n) -&gt; narwhals.LazyFrame:\n    cc = df.group_by(cell_type_col).agg(\n        narwhals.col(cell_col).n_unique().alias(\"__cell_count\")\n    )\n    cc = cc.filter(narwhals.col(\"__cell_count\") &gt;= min_cells)\n    return df.join(cc, on=cell_type_col)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/specificity_frac_task/#mecfs_bio.build_system.task.specificity_frac_task.filter_missing_genes","title":"filter_missing_genes","text":"<pre><code>filter_missing_genes(\n    df: LazyFrame, gene_col: str, count_col: str\n) -&gt; narwhals.LazyFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/specificity_frac_task.py</code> <pre><code>def filter_missing_genes(\n    df: narwhals.LazyFrame,\n    gene_col: str,\n    count_col: str,\n) -&gt; narwhals.LazyFrame:\n    nz = df.group_by(gene_col).agg(\n        (narwhals.col(count_col) &gt; 0).sum().alias(\"nonzero_count\")\n    )\n    nz = nz.filter(narwhals.col(\"nonzero_count\") &gt; 0)\n    return df.join(nz, on=gene_col)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/","title":"susie_stacked_plot_task","text":""},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task","title":"mecfs_bio.build_system.task.susie_stacked_plot_task","text":"<p>A Task and associated helper methods to plot the results and context of SUSIE fine mapping using stacked panels.</p> <p>Classes:</p> <ul> <li> <code>BinOptions</code>           \u2013            </li> <li> <code>HeatmapOptions</code>           \u2013            </li> <li> <code>RegionSelectDefault</code>           \u2013            </li> <li> <code>RegionSelectOverride</code>           \u2013            </li> <li> <code>SusieStackPlotTask</code>           \u2013            <p>Create a plot to illustrate the results of a SUSIE run on a given locus.</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>draw_manhattan_track</code>             \u2013              <p>Generated with Gemini and then modified.</p> </li> <li> <code>get_array_and_edges_for_ld_heatmap</code>             \u2013              <p>Use xarray to bin LD data to facilitate creation of an LD heatmap</p> </li> <li> <code>get_region</code>             \u2013              <p>Determine the plotting region based on RegionSelect options</p> </li> <li> <code>plot_gene_tracks</code>             \u2013              <p>Generated With Gemini</p> </li> <li> <code>plot_ld_heatmap</code>             \u2013              </li> <li> <code>plot_locus_tracks_matplotlib</code>             \u2013              <p>Helper function to create the matplotlib plot consisting of stacked panels</p> </li> <li> <code>plot_susie_track</code>             \u2013              <p>Plot SUSIE pip using a bar graph colored by credible set</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>GENE_INFO_CHROM_COL</code>           \u2013            </li> <li> <code>GENE_INFO_END_COL</code>           \u2013            </li> <li> <code>GENE_INFO_NAME_COL</code>           \u2013            </li> <li> <code>GENE_INFO_START_COL</code>           \u2013            </li> <li> <code>GENE_INFO_STRAND_COL</code>           \u2013            </li> <li> <code>HeatMapPlotMode</code>           \u2013            </li> <li> <code>RegionSelect</code>           \u2013            </li> <li> <code>logger</code>           \u2013            </li> <li> <code>seaborn_rocket_cmap</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.GENE_INFO_CHROM_COL","title":"GENE_INFO_CHROM_COL  <code>module-attribute</code>","text":"<pre><code>GENE_INFO_CHROM_COL = 'chrom'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.GENE_INFO_END_COL","title":"GENE_INFO_END_COL  <code>module-attribute</code>","text":"<pre><code>GENE_INFO_END_COL = 'gene_end'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.GENE_INFO_NAME_COL","title":"GENE_INFO_NAME_COL  <code>module-attribute</code>","text":"<pre><code>GENE_INFO_NAME_COL = 'gene_name'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.GENE_INFO_START_COL","title":"GENE_INFO_START_COL  <code>module-attribute</code>","text":"<pre><code>GENE_INFO_START_COL = 'gene_start'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.GENE_INFO_STRAND_COL","title":"GENE_INFO_STRAND_COL  <code>module-attribute</code>","text":"<pre><code>GENE_INFO_STRAND_COL = 'strand'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.HeatMapPlotMode","title":"HeatMapPlotMode  <code>module-attribute</code>","text":"<pre><code>HeatMapPlotMode = Literal['ld2', 'ld_abs']\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.RegionSelect","title":"RegionSelect  <code>module-attribute</code>","text":"<pre><code>RegionSelect = RegionSelectOverride | RegionSelectDefault\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.seaborn_rocket_cmap","title":"seaborn_rocket_cmap  <code>module-attribute</code>","text":"<pre><code>seaborn_rocket_cmap = color_palette('rocket', n_colors=256)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.BinOptions","title":"BinOptions","text":"<p>Attributes:</p> <ul> <li> <code>num_bins</code>               (<code>int</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.BinOptions.num_bins","title":"num_bins  <code>instance-attribute</code>","text":"<pre><code>num_bins: int\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.HeatmapOptions","title":"HeatmapOptions","text":"<p>Attributes:</p> <ul> <li> <code>cmap</code>               (<code>str | ListedColormap</code>)           \u2013            </li> <li> <code>heatmap_bin_options</code>               (<code>BinOptions | None</code>)           \u2013            </li> <li> <code>mode</code>               (<code>HeatMapPlotMode</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.HeatmapOptions.cmap","title":"cmap  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>cmap: str | ListedColormap = 'plasma'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.HeatmapOptions.heatmap_bin_options","title":"heatmap_bin_options  <code>instance-attribute</code>","text":"<pre><code>heatmap_bin_options: BinOptions | None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.HeatmapOptions.mode","title":"mode  <code>instance-attribute</code>","text":"<pre><code>mode: HeatMapPlotMode\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.RegionSelectDefault","title":"RegionSelectDefault","text":""},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.RegionSelectOverride","title":"RegionSelectOverride","text":"<p>Attributes:</p> <ul> <li> <code>chrom</code>               (<code>int</code>)           \u2013            </li> <li> <code>end</code>               (<code>int</code>)           \u2013            </li> <li> <code>start</code>               (<code>int</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.RegionSelectOverride.chrom","title":"chrom  <code>instance-attribute</code>","text":"<pre><code>chrom: int\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.RegionSelectOverride.end","title":"end  <code>instance-attribute</code>","text":"<pre><code>end: int\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.RegionSelectOverride.start","title":"start  <code>instance-attribute</code>","text":"<pre><code>start: int\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.SusieStackPlotTask","title":"SusieStackPlotTask","text":"<p>               Bases: <code>Task</code></p> <p>Create a plot to illustrate the results of a SUSIE run on a given locus. The resulting plot is a stack of panels showing - LD structure - marginal associations (i.e. Manhattan plot) - SUSIE PIPs - Genes</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>gene_info_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>gene_info_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>heatmap_options</code>               (<code>HeatmapOptions</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>region_mode</code>               (<code>RegionSelect</code>)           \u2013            </li> <li> <code>susie_task</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.SusieStackPlotTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.SusieStackPlotTask.gene_info_pipe","title":"gene_info_pipe  <code>instance-attribute</code>","text":"<pre><code>gene_info_pipe: DataProcessingPipe\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.SusieStackPlotTask.gene_info_task","title":"gene_info_task  <code>instance-attribute</code>","text":"<pre><code>gene_info_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.SusieStackPlotTask.heatmap_options","title":"heatmap_options  <code>instance-attribute</code>","text":"<pre><code>heatmap_options: HeatmapOptions\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.SusieStackPlotTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.SusieStackPlotTask.region_mode","title":"region_mode  <code>instance-attribute</code>","text":"<pre><code>region_mode: RegionSelect\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.SusieStackPlotTask.susie_task","title":"susie_task  <code>instance-attribute</code>","text":"<pre><code>susie_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.SusieStackPlotTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    susie_task: Task,\n    gene_info_task: Task,\n    gene_info_pipe: DataProcessingPipe,\n    region_mode: RegionSelect,\n    heatmap_options: HeatmapOptions,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/susie_stacked_plot_task.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    susie_task: Task,\n    gene_info_task: Task,\n    gene_info_pipe: DataProcessingPipe,\n    region_mode: RegionSelect,\n    heatmap_options: HeatmapOptions,\n):\n    src_meta = susie_task.meta\n    assert isinstance(src_meta, ResultDirectoryMeta)\n    meta = GWASPlotFileMeta(\n        trait=src_meta.trait,\n        project=src_meta.project,\n        id=AssetId(asset_id),\n        extension=\".png\",\n    )\n    return cls(\n        meta=meta,\n        susie_task=susie_task,\n        gene_info_task=gene_info_task,\n        gene_info_pipe=gene_info_pipe,\n        region_mode=region_mode,\n        heatmap_options=heatmap_options,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.SusieStackPlotTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/susie_stacked_plot_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    susie_asset = fetch(self.susie_task.asset_id)\n    assert isinstance(susie_asset, DirectoryAsset)\n    susie_dir = susie_asset.path\n    if (susie_dir / NO_CS_FOUND_FILENAME).exists():\n        logger.debug(\"No credible sets to plot. Skipping susie panel.\")\n        (scratch_dir / NO_CS_FOUND_FILENAME).write_text(\"No credible sets.\")\n        susie_df = None\n    else:\n        susie_df = pl.read_parquet(susie_dir / COMBINED_CS_FILENAME)\n\n    gene_info_asset = fetch(self.gene_info_task.asset_id)\n    assert isinstance(gene_info_asset, FileAsset)\n    gene_info_df = (\n        self.gene_info_pipe.process(\n            scan_dataframe_asset(gene_info_asset, self.gene_info_task.meta)\n        )\n        .collect()\n        .to_polars()\n    )\n\n    chrom, start, end = get_region(self.region_mode, susie_output_path=susie_dir)\n    gene_info_df = gene_info_df.filter(\n        pl.col(GENE_INFO_CHROM_COL).cast(String()) == pl.lit(chrom).cast(String())\n    )\n    loaded = pl.read_parquet(susie_dir / FILTERED_GWAS_FILENAME)\n\n    fig = plot_locus_tracks_matplotlib(\n        gwas_df=_gwas_pipe.process_eager_polars(loaded),\n        susie_cs_df=susie_df,\n        ld_np=np.load(susie_dir / FILTERED_LD_FILENAME),\n        gene_df=gene_info_df,\n        start_bp=start,\n        end_bp=end,\n        chrom=chrom,\n        heatmap_options=self.heatmap_options,\n    )\n    out_path = scratch_dir\n    write_plots_to_dir(out_path, {\"plot\": fig})\n    del fig\n    del loaded\n    del gene_info_df\n    gc.collect()\n    return FileAsset(out_path / \"plot.png\")\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.draw_manhattan_track","title":"draw_manhattan_track","text":"<pre><code>draw_manhattan_track(\n    fig,\n    target_gridspec_cell,\n    colorbar_axis,\n    gwas_df: DataFrame,\n    ld2_colors: ndarray,\n    gwas_pos_col: str,\n    lead: int,\n    gwas_mlog10p_col: str,\n    min_y: int = 2,\n    break_at: float = 20.0,\n    max_break_proportion: float = 0.5,\n    saturation_point: float = 100.0,\n    significance_threshold: float = 7.8239087,\n)\n</code></pre> <p>Generated with Gemini and then modified.</p> <p>Draws a Manhattan plot into the provided GridSpec cell. Automatically handles axis breaking if values exceed 'break_at'.</p> Source code in <code>mecfs_bio/build_system/task/susie_stacked_plot_task.py</code> <pre><code>def draw_manhattan_track(\n    fig,\n    target_gridspec_cell,  # e.g. gs[0, 0]\n    colorbar_axis,\n    gwas_df: pl.DataFrame,\n    ld2_colors: np.ndarray,  # Pre-calculated colors for the scatter points\n    gwas_pos_col: str,\n    lead: int,\n    gwas_mlog10p_col: str,\n    min_y: int = 2,\n    break_at: float = 20.0,\n    max_break_proportion: float = 0.5,  # Cap the top section at 50% height\n    saturation_point: float = 100.0,  # Point where we reach max height proportion\n    significance_threshold: float = 7.8239087,\n):\n    \"\"\"\n    Generated with Gemini and then modified.\n\n    Draws a Manhattan plot into the provided GridSpec cell.\n    Automatically handles axis breaking if values exceed 'break_at'.\n    \"\"\"\n\n    # 1. Determine Dynamic Ratios\n    max_val = gwas_df[gwas_mlog10p_col].to_numpy().max()\n\n    # Logic: Calculate what % of height the top part gets.\n    # If max_val &lt; 20, top gets 0%.\n    # If max_val &gt; 100, top gets 50%.\n    # In between, scale linearly.\n    if max_val &lt;= break_at:\n        top_fraction = 0\n    else:\n        # Linear interpolation\n        slope = max_break_proportion / (saturation_point - break_at)\n        top_fraction = slope * (max_val - break_at)\n        # Clamp between a minimum visibility (e.g. 0.2) and max_break_proportion\n        # If it's barely over 20, we still need enough space to draw ticks, so we set a floor.\n        top_fraction = max(0.25, min(max_break_proportion, top_fraction))\n\n    # 2. Case A: Standard Plot (No Break)\n    if top_fraction == 0:\n        ax = fig.add_subplot(target_gridspec_cell)\n        sc = ax.scatter(\n            gwas_df[gwas_pos_col],\n            gwas_df[gwas_mlog10p_col],\n            s=10,\n            c=ld2_colors,\n            linewidths=0,\n            cmap=\"plasma\",\n        )\n        ax.set_ylabel(r\"$-\\log_{10}(p)$\")\n\n        ax.scatter(\n            gwas_df[gwas_pos_col][lead],\n            gwas_df[gwas_mlog10p_col][lead],\n            s=35,\n            marker=\"^\",\n            c=\"black\",\n        )\n        ax.axhline(\n            y=significance_threshold,\n            color=\"grey\",\n            linestyle=\"--\",\n            linewidth=1.5,\n            label=\"Significance Threshold\",\n        )\n        ax.set_ylim(min_y, (gwas_df[gwas_mlog10p_col]).to_numpy().max() * 1.05)\n\n    else:\n        # 3. Case B: Broken Axis (Nested GridSpec)\n        # Create a nested grid INSIDE the target cell\n        # height_ratios takes relative weights.\n        # If top_fraction is 0.3, bottom is 0.7.\n        gs_inner = gridspec.GridSpecFromSubplotSpec(\n            nrows=2,\n            ncols=1,\n            subplot_spec=target_gridspec_cell,\n            height_ratios=[top_fraction, 1.0 - top_fraction],\n            hspace=0.05,  # Tiny gap for the break marks\n        )\n\n        ax_top = fig.add_subplot(gs_inner[0])\n        ax_bottom = fig.add_subplot(gs_inner[1], sharex=ax_top)\n\n        # Plot data on BOTH\n        # (Optimization: You could filter data for ax_top, but scatter is fast enough usually)\n        for ax in [ax_top, ax_bottom]:\n            sc = ax.scatter(\n                gwas_df[gwas_pos_col],\n                gwas_df[gwas_mlog10p_col],\n                s=10,\n                c=ld2_colors,\n                linewidths=0,\n                cmap=\"plasma\",\n            )\n\n        ax_top.scatter(\n            gwas_df[gwas_pos_col][lead],\n            gwas_df[gwas_mlog10p_col][lead],\n            s=35,\n            marker=\"^\",\n            c=\"black\",\n        )\n\n        ax_bottom.axhline(\n            y=significance_threshold,\n            color=\"grey\",\n            linestyle=\"--\",\n            linewidth=1.5,\n            label=\"Significance Threshold\",\n        )\n\n        # Set Limits\n        # Bottom: 0 to 20\n        ax_bottom.set_ylim(min_y, break_at)\n        # Top: 20 to Max\n        ax_top.set_ylim(break_at, max_val * 1.05)\n\n        # Visual Styling for the Break\n        # Hide the spines between them\n        ax_bottom.spines[\"top\"].set_visible(False)\n        ax_bottom.spines[\"right\"].set_visible(False)\n        ax_top.spines[\"bottom\"].set_visible(False)\n        ax_top.spines[\"right\"].set_visible(False)\n\n        # Remove x-ticks from top\n        ax_top.tick_params(labelbottom=False, bottom=False)\n\n        # Draw Diagonal \"Cut\" Lines\n        d = 0.006\n        kwargs = dict(transform=ax_top.transAxes, color=\"k\", clip_on=False)\n        ax_top.plot((-d, +d), (-d, +d), **kwargs)  # top-left\n        ax_top.plot((1 - d, 1 + d), (-d, +d), **kwargs)  # top-right\n\n        kwargs.update(transform=ax_bottom.transAxes)\n        ax_bottom.plot((-d, +d), (1 - d, 1 + d), **kwargs)  # bottom-left\n        ax_bottom.plot((1 - d, 1 + d), (1 - d, 1 + d), **kwargs)  # bottom-right\n\n        # Label: Center it on the \"entire\" side using figure coords is best,\n        # or just place it on the top axis to be safe.\n        ax_top.set_ylabel(r\"$-\\log_{10}(p)$\")\n        # Ensure bottom axis label doesn't conflict\n        ax_bottom.set_ylabel(\"\")\n        ax = ax_bottom\n        # Return the bottom axis so other tracks can link their x-axis to it\n\n    cbar = fig.colorbar(sc, cax=colorbar_axis, shrink=0.4)\n    cbar.set_label(r\"$r^2$ with lead\")\n    return ax  # Return the single axis for x-linking later\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.get_array_and_edges_for_ld_heatmap","title":"get_array_and_edges_for_ld_heatmap","text":"<pre><code>get_array_and_edges_for_ld_heatmap(\n    ld_abs: ndarray,\n    pos: ndarray,\n    bin_options: BinOptions | None = None,\n) -&gt; tuple[np.ndarray, np.ndarray]\n</code></pre> <p>Use xarray to bin LD data to facilitate creation of an LD heatmap</p> Source code in <code>mecfs_bio/build_system/task/susie_stacked_plot_task.py</code> <pre><code>def get_array_and_edges_for_ld_heatmap(\n    ld_abs: np.ndarray,\n    pos: np.ndarray,\n    bin_options: BinOptions | None = None,\n) -&gt; tuple[np.ndarray, np.ndarray]:\n    \"\"\"\n    Use xarray to bin LD data to facilitate creation of an LD heatmap\n    \"\"\"\n    da = xr.DataArray(\n        ld_abs,\n        coords={\n            \"x\": pos,\n            \"y\": pos,\n        },\n        dims=[\"x\", \"y\"],\n    )\n    if bin_options is not None:\n        da = (\n            da.groupby_bins(\n                \"x\",\n                bins=bin_options.num_bins,\n            )\n            .mean()\n            .groupby_bins(\"y\", bins=bin_options.num_bins)\n            .mean()\n        )\n        da = da.rename({\"x_bins\": \"x\", \"y_bins\": \"y\"})\n        da.coords[\"x\"] = [i.mid for i in da.coords[\"x\"].values]\n        da.coords[\"y\"] = [i.mid for i in da.coords[\"y\"].values]\n    else:\n        da = da.groupby(\"x\").mean().groupby(\"y\").mean()\n\n    new_pos = da.coords[\"x\"].to_numpy()\n    mid = (new_pos[:-1] + new_pos[1:]) / 2.0\n    first = new_pos[0] - (mid[0] - new_pos[0])\n    last = new_pos[-1] + (new_pos[-1] - mid[-1])\n    edges = np.concatenate([[first], mid, [last]])\n    return da.to_numpy(), edges\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.get_region","title":"get_region","text":"<pre><code>get_region(\n    mode: RegionSelect, susie_output_path: Path\n) -&gt; tuple[int, int, int]\n</code></pre> <p>Determine the plotting region based on RegionSelect options</p> Source code in <code>mecfs_bio/build_system/task/susie_stacked_plot_task.py</code> <pre><code>def get_region(mode: RegionSelect, susie_output_path: Path) -&gt; tuple[int, int, int]:\n    \"\"\"\n    Determine the plotting region based on RegionSelect options\n    \"\"\"\n    if isinstance(mode, RegionSelectOverride):\n        return mode.chrom, mode.start, mode.end\n    df = pl.read_parquet(susie_output_path / FILTERED_GWAS_FILENAME)\n    assert df[GWASLAB_CHROM_COL].n_unique() == 1\n    chrom = df[GWASLAB_CHROM_COL][0]\n    start = int(max(int(df[GWASLAB_POS_COL].to_numpy().min()) - 1, 0))\n    end = int(df[GWASLAB_POS_COL].to_numpy().max() + 2)\n    return (\n        chrom,\n        start,\n        end,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.plot_gene_tracks","title":"plot_gene_tracks","text":"<pre><code>plot_gene_tracks(\n    ax,\n    gene_df: DataFrame,\n    start_bp: int,\n    end_bp: int,\n    gene_start_col: str,\n    gene_end_col: str,\n    gene_name_col: str,\n    gene_strand_col: str,\n    font_size: int = 9,\n    min_dist_between_genes: float = 0.03,\n)\n</code></pre> <p>Generated With Gemini Plots gene tracks with smart label centering and collision avoidance.</p> Source code in <code>mecfs_bio/build_system/task/susie_stacked_plot_task.py</code> <pre><code>def plot_gene_tracks(\n    ax,\n    gene_df: pl.DataFrame,\n    start_bp: int,\n    end_bp: int,\n    gene_start_col: str,\n    gene_end_col: str,\n    gene_name_col: str,\n    gene_strand_col: str,\n    font_size: int = 9,\n    min_dist_between_genes: float = 0.03,  # Slightly increased buffer\n):\n    \"\"\"\n    Generated With Gemini\n    Plots gene tracks with smart label centering and collision avoidance.\n    \"\"\"\n    # 1. Filter genes\n    region_df = gene_df.filter(\n        (pl.col(gene_end_col) &gt;= start_bp) &amp; (pl.col(gene_start_col) &lt;= end_bp)\n    ).sort(gene_start_col)\n\n    if region_df.height == 0:\n        ax.text(0.5, 0.5, \"No genes in region\", transform=ax.transAxes, ha=\"center\")\n        ax.set_yticks([])\n        return\n\n    # 2. Setup Packing Parameters\n    total_bp = end_bp - start_bp\n    # Heuristic: How many bp does one character take up?\n    # You might need to tune '0.015' based on your specific figure width/dpi\n    char_width_factor = 0.015\n    bp_per_char = total_bp * char_width_factor\n    min_gap = total_bp * min_dist_between_genes\n\n    lanes: list = []\n    gene_placements: list = []\n\n    for row in region_df.iter_rows(named=True):\n        g_start = max(start_bp, row[gene_start_col])\n        g_end = min(end_bp, row[gene_end_col])\n        g_name = row[gene_name_col]\n\n        # --- NEW LOGIC: Calculate Text Dimensions &amp; Position ---\n        text_width_bp = len(g_name) * bp_per_char\n        gene_width_bp = g_end - g_start\n\n        # Decision: Center label or Left-align?\n        if gene_width_bp &gt; text_width_bp:\n            # Case A: Gene is longer than text -&gt; CENTER text\n            text_x = (g_start + g_end) / 2\n            ha = \"center\"\n            # Visual end is just the gene end (text is inside)\n            visual_end = g_end + min_gap\n        else:\n            # Case B: Gene is short -&gt; LEFT-ALIGN text at start\n            text_x = g_start\n            ha = \"left\"\n            # Visual end is the text end\n            visual_end = g_start + text_width_bp + min_gap\n            # Ensure we don't accidentally clip the gene if they are nearly same size\n            visual_end = max(visual_end, g_end + min_gap)\n\n        # --- Packing Algorithm ---\n        y_level = -1\n        for i, lane_end in enumerate(lanes):\n            if lane_end &lt; g_start:\n                y_level = i\n                lanes[i] = visual_end\n                break\n\n        if y_level == -1:\n            lanes.append(visual_end)\n            y_level = len(lanes) - 1\n\n        gene_placements.append(\n            {\n                \"start\": row[gene_start_col],\n                \"end\": row[gene_end_col],\n                \"name\": g_name,\n                \"strand\": row[gene_strand_col],\n                \"y\": y_level,\n                \"text_x\": text_x,\n                \"ha\": ha,\n            }\n        )\n\n    # 3. Plotting\n    n_lanes = len(lanes)\n    ax.set_ylim(-0.5, n_lanes + 0.5)\n\n    if n_lanes &gt; 10:\n        font_size = max(6, font_size - 2)\n\n    for g in gene_placements:\n        y = g[\"y\"]\n        # Gene Body\n        ax.plot([g[\"start\"], g[\"end\"]], [y, y], color=\"navy\", lw=1.5)\n\n        # Exon/End Ticks\n        tick_h = 0.2\n        ax.plot([g[\"start\"], g[\"start\"]], [y - tick_h, y + tick_h], color=\"navy\", lw=1)\n        ax.plot([g[\"end\"], g[\"end\"]], [y - tick_h, y + tick_h], color=\"navy\", lw=1)\n\n        # Strand Arrow\n        mid = (max(start_bp, g[\"start\"]) + min(end_bp, g[\"end\"])) / 2\n        marker = \"&gt;\" if g[\"strand\"] == \"+\" else \"&lt;\"\n        ax.scatter([mid], [y], marker=marker, color=\"navy\", s=30, zorder=10)\n\n        # Label with Background Box\n        # We use a white 'bbox' with alpha=0.8 to hide any lines crossing behind the text\n        ax.text(\n            g[\"text_x\"],\n            y + 0.35,\n            g[\"name\"],\n            ha=g[\"ha\"],\n            va=\"center\",\n            fontsize=font_size,\n            style=\"italic\",\n            bbox=dict(boxstyle=\"round,pad=0.1\", fc=\"white\", ec=\"none\", alpha=0.8),\n            zorder=20,  # Ensure text sits on top of lines\n        )\n\n    ax.set_yticks([])\n    ax.invert_yaxis()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.plot_ld_heatmap","title":"plot_ld_heatmap","text":"<pre><code>plot_ld_heatmap(\n    ld_np: ndarray,\n    gwas_df: DataFrame,\n    options: HeatmapOptions,\n    ax_ld,\n    fig,\n    ld_cax,\n    gwas_pos_col: str = GWASLAB_POS_COL,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/susie_stacked_plot_task.py</code> <pre><code>def plot_ld_heatmap(\n    ld_np: np.ndarray,\n    gwas_df: pl.DataFrame,\n    options: HeatmapOptions,\n    ax_ld,\n    fig,\n    ld_cax,\n    gwas_pos_col: str = GWASLAB_POS_COL,\n):\n    if options.mode == \"ld_abs\":\n        to_plot: np.ndarray = abs(ld_np)\n    elif options.mode == \"ld2\":\n        to_plot = ld_np**2\n    else:\n        raise ValueError(f\"Unknown mode: {options.mode}\")\n    ar, edges = get_array_and_edges_for_ld_heatmap(\n        ld_abs=to_plot,\n        pos=gwas_df[gwas_pos_col].to_numpy(),\n        bin_options=options.heatmap_bin_options,\n    )\n\n    mesh = ax_ld.pcolormesh(\n        edges, edges, ar, shading=\"auto\", vmin=0, vmax=1, cmap=options.cmap\n    )\n    ax_ld.set_ylabel(\"bp\")\n    ax_ld.set_ylim(float(edges[0]), float(edges[-1]))\n\n    cbar = fig.colorbar(mesh, cax=ld_cax, shrink=0.8)\n    label = r\"$|r|$\" if options.mode == \"ld_abs\" else \"$r^2$\"\n    cbar.set_label(label)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.plot_locus_tracks_matplotlib","title":"plot_locus_tracks_matplotlib","text":"<pre><code>plot_locus_tracks_matplotlib(\n    gwas_df: DataFrame,\n    susie_cs_df: DataFrame | None,\n    ld_np: ndarray,\n    gene_df: DataFrame,\n    start_bp: int,\n    end_bp: int,\n    chrom: int,\n    heatmap_options: HeatmapOptions,\n    *,\n    gwas_pos_col: str = GWASLAB_POS_COL,\n    gwas_mlog10p_col: str = GWASLAB_MLOG10P_COL,\n    susie_pos_col: str = GWASLAB_POS_COL,\n    susie_pip_col: str = PIP_COLUMN,\n    susie_cs_col: str = CS_COLUMN,\n    gene_start_col: str = GENE_INFO_START_COL,\n    gene_end_col: str = GENE_INFO_END_COL,\n    gene_name_col: str = GENE_INFO_NAME_COL,\n    gene_strand_col: str = GENE_INFO_STRAND_COL,\n    max_mlog10p: float = 200,\n) -&gt; Figure\n</code></pre> <p>Helper function to create the matplotlib plot consisting of stacked panels</p> Source code in <code>mecfs_bio/build_system/task/susie_stacked_plot_task.py</code> <pre><code>def plot_locus_tracks_matplotlib(\n    gwas_df: pl.DataFrame,\n    susie_cs_df: pl.DataFrame | None,\n    ld_np: np.ndarray,\n    gene_df: pl.DataFrame,\n    start_bp: int,\n    end_bp: int,\n    chrom: int,\n    heatmap_options: HeatmapOptions,\n    # heatmap_bin_options: BinOptions | None,\n    *,\n    gwas_pos_col: str = GWASLAB_POS_COL,\n    gwas_mlog10p_col: str = GWASLAB_MLOG10P_COL,\n    susie_pos_col: str = GWASLAB_POS_COL,\n    susie_pip_col: str = PIP_COLUMN,\n    susie_cs_col: str = CS_COLUMN,\n    gene_start_col: str = GENE_INFO_START_COL,\n    gene_end_col: str = GENE_INFO_END_COL,\n    gene_name_col: str = GENE_INFO_NAME_COL,\n    gene_strand_col: str = GENE_INFO_STRAND_COL,\n    max_mlog10p: float = 200,\n) -&gt; Figure:\n    \"\"\"\n    Helper function to create the matplotlib plot consisting of stacked panels\n\n    \"\"\"\n\n    gwas_df = gwas_df.with_columns(\n        pl.min_horizontal(pl.lit(max_mlog10p), pl.col(GWASLAB_MLOG10P_COL)).alias(\n            GWASLAB_MLOG10P_COL\n        ),\n    )\n\n    lead = int(np.argmax(gwas_df[gwas_mlog10p_col]))\n\n    ld2_slice = ld_np[lead, :] ** 2\n\n    # initialize figure with 4 by 2 grid.  Right column is used for legends and colorbars\n    fig = plt.figure(figsize=(12, 9))\n    gs = gridspec.GridSpec(\n        nrows=4,\n        ncols=2,\n        height_ratios=[1.8, 2.2, 1.6, 1.4],\n        width_ratios=[1.0, 0.1],\n        hspace=0.08,\n        wspace=0.05,\n    )\n\n    # colorbars\n    ld_cax_container = fig.add_subplot(gs[0, 1])\n    ld_cax_container.axis(\"off\")\n    manh_cax_container = fig.add_subplot(gs[1, 1])\n    manh_cax_container.axis(\"off\")\n    ld_cax = inset_axes(\n        ld_cax_container,\n        width=\"50%\",\n        height=\"50%\",\n        loc=\"center left\",  # Anchor it to the left side of the container\n        borderpad=0,  # No padding between anchor and axis\n    )\n    manh_cax = inset_axes(\n        manh_cax_container,\n        width=\"50%\",\n        height=\"50%\",\n        loc=\"center left\",  # Anchor it to the left side of the container\n        borderpad=0,  # No padding between anchor and axis\n    )\n\n    # manhattan plot\n    ax_manh = draw_manhattan_track(\n        fig=fig,\n        target_gridspec_cell=gs[1, 0],\n        gwas_df=gwas_df,\n        ld2_colors=ld2_slice,  # Pass the color array\n        gwas_pos_col=gwas_pos_col,\n        gwas_mlog10p_col=gwas_mlog10p_col,\n        break_at=20.0,\n        max_break_proportion=0.5,\n        lead=lead,\n        colorbar_axis=manh_cax,\n    )\n\n    # setup other axis\n    ax_ld = fig.add_subplot(gs[0, 0], sharex=ax_manh)\n    ax_pip = fig.add_subplot(gs[2, 0], sharex=ax_manh)\n    ax_gene = fig.add_subplot(gs[3, 0], sharex=ax_manh)\n\n    pip_legend_ax = fig.add_subplot(gs[2, 1])\n    pip_legend_ax.axis(\"off\")\n\n    # 2: SUSIE track\n    plot_susie_track(\n        susie_cs_df=susie_cs_df,\n        pip_legend_ax=pip_legend_ax,\n        ax_pip=ax_pip,\n        susie_pip_col=susie_pip_col,\n        susie_pos_col=susie_pos_col,\n        susie_cs_col=susie_cs_col,\n    )\n    # #3 ld heatmap track\n    plot_ld_heatmap(\n        ld_np=ld_np,\n        gwas_df=gwas_df,\n        options=heatmap_options,\n        ax_ld=ax_ld,\n        fig=fig,\n        ld_cax=ld_cax,\n        gwas_pos_col=gwas_pos_col,\n    )\n    # 4: Gene tracks\n    plot_gene_tracks(\n        ax=ax_gene,\n        gene_df=gene_df,\n        start_bp=start_bp,\n        end_bp=end_bp,\n        gene_start_col=gene_start_col,\n        gene_end_col=gene_end_col,\n        gene_name_col=gene_name_col,\n        gene_strand_col=gene_strand_col,\n    )\n\n    # axis config\n    ax_gene.set_xlim(start_bp - 1, end_bp + 1)\n    ax_gene.set_xlabel(f\"Chromosome {chrom} (bp)\")\n\n    for ax in [ax_manh, ax_pip, ax_ld]:\n        plt.setp(ax.get_xticklabels(), visible=False)\n        ax.tick_params(\n            axis=\"x\",  # changes apply to the x-axis\n            which=\"both\",  # major and minor ticks\n            bottom=False,  # ticks along the bottom edge are off\n            top=False,  # ticks along the top edge are off\n            labelbottom=False,  # labels along the bottom edge are off\n        )\n\n    for ax in [ax_manh, ax_pip, ax_ld, ax_gene]:\n        ax.spines[\"top\"].set_visible(False)\n        ax.spines[\"right\"].set_visible(False)\n        if ax == ax_gene:\n            ax.spines[\"left\"].set_visible(False)\n\n    return fig\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/susie_stacked_plot_task/#mecfs_bio.build_system.task.susie_stacked_plot_task.plot_susie_track","title":"plot_susie_track","text":"<pre><code>plot_susie_track(\n    susie_cs_df: DataFrame | None,\n    ax_pip,\n    pip_legend_ax,\n    susie_cs_col: str = CS_COLUMN,\n    susie_pip_col: str = PIP_COLUMN,\n    susie_pos_col: str = GWASLAB_POS_COL,\n)\n</code></pre> <p>Plot SUSIE pip using a bar graph colored by credible set</p> Source code in <code>mecfs_bio/build_system/task/susie_stacked_plot_task.py</code> <pre><code>def plot_susie_track(\n    susie_cs_df: pl.DataFrame | None,\n    ax_pip,\n    pip_legend_ax,\n    susie_cs_col: str = CS_COLUMN,\n    susie_pip_col: str = PIP_COLUMN,\n    susie_pos_col: str = GWASLAB_POS_COL,\n):\n    \"\"\"\n    Plot SUSIE pip using a bar graph colored by credible set\n    \"\"\"\n    if susie_cs_df is None:\n        return\n    pip_traces = []\n    palette = list(TABLEAU_COLORS.values())\n    if len(susie_cs_df) &gt; 0:\n        for i, (cs, sub) in enumerate(\n            susie_cs_df.group_by(susie_cs_col, maintain_order=True)\n        ):\n            color = palette[i % len(palette)]\n            ax_pip.vlines(\n                sub[susie_pos_col].to_numpy(),\n                0.0,\n                sub[susie_pip_col].to_numpy(),\n                linewidth=1.5,\n                label=f\"CS {i + 1}\",\n                color=color,\n            )\n            handle = Line2D([0], [0], color=color, lw=2, label=f\"CS {i + 1}\")\n            pip_traces.append(handle)\n            # pip_trace_labels.append(f\"CS {i+1}\")\n        # ax_pip.legend(loc=\"upper right\", fontsize=8, frameon=False, ncols=2)\n        pip_legend_ax.legend(\n            handles=pip_traces,\n            loc=\"center left\",  # Vertically centered in the panel\n            borderaxespad=0,  # Tight alignment to the left edge\n            frameon=False,  # Clean look (no box)\n            fontsize=9,\n        )\n    ax_pip.set_ylabel(\"PIP (SUSIE)\")\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/","title":"two_sample_mr_task","text":""},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task","title":"mecfs_bio.build_system.task.two_sample_mr_task","text":"<p>Task to apply two sample mendelian randomization to GWAS data, together with associated axillary functions.</p> <p>Classes:</p> <ul> <li> <code>ClumpOptions</code>           \u2013            </li> <li> <code>MRInputColSpec</code>           \u2013            </li> <li> <code>MRReportOptions</code>           \u2013            </li> <li> <code>SteigerFilteringOptions</code>           \u2013            </li> <li> <code>TwoSampleMRConfig</code>           \u2013            </li> <li> <code>TwoSampleMRResult</code>           \u2013            </li> <li> <code>TwoSampleMRTask</code>           \u2013            <p>Task to run mendelian randomization using the R package TwoSampleMR.</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>convert_outcome_and_exposure_to_r</code>             \u2013              </li> <li> <code>format_data</code>             \u2013              </li> <li> <code>format_data_no_conversion</code>             \u2013              </li> <li> <code>gen_mr_report</code>             \u2013              </li> <li> <code>harmonize_data</code>             \u2013              </li> <li> <code>harmonize_data_no_conversion</code>             \u2013              </li> <li> <code>optionally_clump_exposure_data</code>             \u2013              </li> <li> <code>optionally_clump_exposure_data_no_conversion</code>             \u2013              </li> <li> <code>pre_filter_outcome_variants</code>             \u2013              </li> <li> <code>run_tsmr_on_formatted_data</code>             \u2013              </li> <li> <code>run_tsmr_on_harmonized_data</code>             \u2013              </li> <li> <code>run_tsmr_on_harmonized_data_no_conversion</code>             \u2013              </li> <li> <code>run_two_sample_mr</code>             \u2013              </li> <li> <code>steiger_filtering_write_output</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>GWASLAB_MR_INPUT_COL_SPEC</code>           \u2013            </li> <li> <code>IgnoreOrRaise</code>           \u2013            </li> <li> <code>MAIN_RESULT_DF_PATH</code>           \u2013            </li> <li> <code>NEEDED_COLS</code>           \u2013            </li> <li> <code>REPORT_SUBDIR_PATH</code>           \u2013            </li> <li> <code>RPackageType</code>           \u2013            </li> <li> <code>STEIGER_RESULT_PATH</code>           \u2013            </li> <li> <code>SUN_ET_AL_MR_INPUT_COL_SPEC_hg37</code>           \u2013            </li> <li> <code>TSM_BETA_COL</code>           \u2013            </li> <li> <code>TSM_CHR_COL</code>           \u2013            </li> <li> <code>TSM_EAF_COL</code>           \u2013            </li> <li> <code>TSM_EFFECT_ALLELE_COL</code>           \u2013            </li> <li> <code>TSM_N_CASE</code>           \u2013            </li> <li> <code>TSM_N_CONTROL</code>           \u2013            </li> <li> <code>TSM_OTHER_ALLELE_COL</code>           \u2013            </li> <li> <code>TSM_OUTPUT_B_COL</code>           \u2013            </li> <li> <code>TSM_OUTPUT_EXPOSURE_COL</code>           \u2013            </li> <li> <code>TSM_OUTPUT_METHOD_COL</code>           \u2013            </li> <li> <code>TSM_OUTPUT_NSNP_COL</code>           \u2013            </li> <li> <code>TSM_OUTPUT_P_COL</code>           \u2013            </li> <li> <code>TSM_OUTPUT_SE_COL</code>           \u2013            </li> <li> <code>TSM_OUTPUT_STEIGER_DIR_COL</code>           \u2013            </li> <li> <code>TSM_OUTPUT_STEIGER_P_COL</code>           \u2013            </li> <li> <code>TSM_PHENOTYPE</code>           \u2013            </li> <li> <code>TSM_POS_COL</code>           \u2013            </li> <li> <code>TSM_P_VALUE</code>           \u2013            </li> <li> <code>TSM_RSID_COL</code>           \u2013            </li> <li> <code>TSM_SAMPLE_SIZE_COL</code>           \u2013            </li> <li> <code>TSM_SE_COL</code>           \u2013            </li> <li> <code>TSM_UNITS_COL</code>           \u2013            </li> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.GWASLAB_MR_INPUT_COL_SPEC","title":"GWASLAB_MR_INPUT_COL_SPEC  <code>module-attribute</code>","text":"<pre><code>GWASLAB_MR_INPUT_COL_SPEC = MRInputColSpec(\n    rsid_col=GWASLAB_RSID_COL,\n    beta_col=GWASLAB_BETA_COL,\n    se_col=GWASLAB_SE_COL,\n    ea_col=GWASLAB_EFFECT_ALLELE_COL,\n    nea_col=GWASLAB_NON_EFFECT_ALLELE_COL,\n    eaf_col=GWASLAB_EFFECT_ALLELE_FREQ_COL,\n    phenotype_col=None,\n    pos_col=GWASLAB_POS_COL,\n    chrom_col=GWASLAB_CHROM_COL,\n    n_case_col=GWASLAB_N_CASE_COL,\n    n_control_col=GWASLAB_N_CONTROL_COL,\n    pval_col=GWASLAB_P_COL,\n    errors=\"ignore\",\n)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.IgnoreOrRaise","title":"IgnoreOrRaise  <code>module-attribute</code>","text":"<pre><code>IgnoreOrRaise = Literal['ignore', 'raise']\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.MAIN_RESULT_DF_PATH","title":"MAIN_RESULT_DF_PATH  <code>module-attribute</code>","text":"<pre><code>MAIN_RESULT_DF_PATH = 'mr_result.csv'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.NEEDED_COLS","title":"NEEDED_COLS  <code>module-attribute</code>","text":"<pre><code>NEEDED_COLS = [\n    TSM_RSID_COL,\n    TSM_BETA_COL,\n    TSM_SE_COL,\n    TSM_EFFECT_ALLELE_COL,\n]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.REPORT_SUBDIR_PATH","title":"REPORT_SUBDIR_PATH  <code>module-attribute</code>","text":"<pre><code>REPORT_SUBDIR_PATH = PurePath('reports')\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.RPackageType","title":"RPackageType  <code>module-attribute</code>","text":"<pre><code>RPackageType = Union[InstalledSTPackage, InstalledPackage]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.STEIGER_RESULT_PATH","title":"STEIGER_RESULT_PATH  <code>module-attribute</code>","text":"<pre><code>STEIGER_RESULT_PATH = PurePath('steiger_result.csv')\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.SUN_ET_AL_MR_INPUT_COL_SPEC_hg37","title":"SUN_ET_AL_MR_INPUT_COL_SPEC_hg37  <code>module-attribute</code>","text":"<pre><code>SUN_ET_AL_MR_INPUT_COL_SPEC_hg37 = MRInputColSpec(\n    rsid_col=\"rsID\",\n    beta_col=\"BETA\",\n    se_col=\"SE\",\n    ea_col=\"A1\",\n    nea_col=\"A0\",\n    eaf_col=\"A1FREQ\",\n    phenotype_col=\"protein_exposure_id\",\n    chrom_col=\"CHROM_hg37\",\n    pos_col=\"GENPOS_hg37\",\n    pval_col=GWASLAB_P_COL,\n)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TSM_BETA_COL","title":"TSM_BETA_COL  <code>module-attribute</code>","text":"<pre><code>TSM_BETA_COL = 'beta'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TSM_CHR_COL","title":"TSM_CHR_COL  <code>module-attribute</code>","text":"<pre><code>TSM_CHR_COL = 'chr'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TSM_EAF_COL","title":"TSM_EAF_COL  <code>module-attribute</code>","text":"<pre><code>TSM_EAF_COL = 'eaf'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TSM_EFFECT_ALLELE_COL","title":"TSM_EFFECT_ALLELE_COL  <code>module-attribute</code>","text":"<pre><code>TSM_EFFECT_ALLELE_COL = 'effect_allele'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TSM_N_CASE","title":"TSM_N_CASE  <code>module-attribute</code>","text":"<pre><code>TSM_N_CASE = 'ncase'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TSM_N_CONTROL","title":"TSM_N_CONTROL  <code>module-attribute</code>","text":"<pre><code>TSM_N_CONTROL = 'ncontrol'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TSM_OTHER_ALLELE_COL","title":"TSM_OTHER_ALLELE_COL  <code>module-attribute</code>","text":"<pre><code>TSM_OTHER_ALLELE_COL = 'other_allele'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TSM_OUTPUT_B_COL","title":"TSM_OUTPUT_B_COL  <code>module-attribute</code>","text":"<pre><code>TSM_OUTPUT_B_COL = 'b'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TSM_OUTPUT_EXPOSURE_COL","title":"TSM_OUTPUT_EXPOSURE_COL  <code>module-attribute</code>","text":"<pre><code>TSM_OUTPUT_EXPOSURE_COL = 'exposure'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TSM_OUTPUT_METHOD_COL","title":"TSM_OUTPUT_METHOD_COL  <code>module-attribute</code>","text":"<pre><code>TSM_OUTPUT_METHOD_COL = 'method'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TSM_OUTPUT_NSNP_COL","title":"TSM_OUTPUT_NSNP_COL  <code>module-attribute</code>","text":"<pre><code>TSM_OUTPUT_NSNP_COL = 'nsnp'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TSM_OUTPUT_P_COL","title":"TSM_OUTPUT_P_COL  <code>module-attribute</code>","text":"<pre><code>TSM_OUTPUT_P_COL = 'pval'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TSM_OUTPUT_SE_COL","title":"TSM_OUTPUT_SE_COL  <code>module-attribute</code>","text":"<pre><code>TSM_OUTPUT_SE_COL = 'se'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TSM_OUTPUT_STEIGER_DIR_COL","title":"TSM_OUTPUT_STEIGER_DIR_COL  <code>module-attribute</code>","text":"<pre><code>TSM_OUTPUT_STEIGER_DIR_COL = 'steiger_dir'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TSM_OUTPUT_STEIGER_P_COL","title":"TSM_OUTPUT_STEIGER_P_COL  <code>module-attribute</code>","text":"<pre><code>TSM_OUTPUT_STEIGER_P_COL = 'steiger_pval'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TSM_PHENOTYPE","title":"TSM_PHENOTYPE  <code>module-attribute</code>","text":"<pre><code>TSM_PHENOTYPE = 'Phenotype'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TSM_POS_COL","title":"TSM_POS_COL  <code>module-attribute</code>","text":"<pre><code>TSM_POS_COL = 'position'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TSM_P_VALUE","title":"TSM_P_VALUE  <code>module-attribute</code>","text":"<pre><code>TSM_P_VALUE = 'pval'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TSM_RSID_COL","title":"TSM_RSID_COL  <code>module-attribute</code>","text":"<pre><code>TSM_RSID_COL = 'SNP'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TSM_SAMPLE_SIZE_COL","title":"TSM_SAMPLE_SIZE_COL  <code>module-attribute</code>","text":"<pre><code>TSM_SAMPLE_SIZE_COL = 'samplesize'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TSM_SE_COL","title":"TSM_SE_COL  <code>module-attribute</code>","text":"<pre><code>TSM_SE_COL = 'se'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TSM_UNITS_COL","title":"TSM_UNITS_COL  <code>module-attribute</code>","text":"<pre><code>TSM_UNITS_COL = 'units'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.ClumpOptions","title":"ClumpOptions","text":""},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.MRInputColSpec","title":"MRInputColSpec","text":"<p>Methods:</p> <ul> <li> <code>make_renamer</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>beta_col</code>               (<code>str</code>)           \u2013            </li> <li> <code>chrom_col</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>ea_col</code>               (<code>str</code>)           \u2013            </li> <li> <code>eaf_col</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>errors</code>               (<code>IgnoreOrRaise</code>)           \u2013            </li> <li> <code>n_case_col</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>n_control_col</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>nea_col</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>phenotype_col</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>pos_col</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>pval_col</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>rsid_col</code>               (<code>str</code>)           \u2013            </li> <li> <code>sample_size_col</code>               (<code>str | None</code>)           \u2013            </li> <li> <code>se_col</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.MRInputColSpec.beta_col","title":"beta_col  <code>instance-attribute</code>","text":"<pre><code>beta_col: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.MRInputColSpec.chrom_col","title":"chrom_col  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>chrom_col: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.MRInputColSpec.ea_col","title":"ea_col  <code>instance-attribute</code>","text":"<pre><code>ea_col: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.MRInputColSpec.eaf_col","title":"eaf_col  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>eaf_col: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.MRInputColSpec.errors","title":"errors  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>errors: IgnoreOrRaise = 'raise'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.MRInputColSpec.n_case_col","title":"n_case_col  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>n_case_col: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.MRInputColSpec.n_control_col","title":"n_control_col  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>n_control_col: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.MRInputColSpec.nea_col","title":"nea_col  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>nea_col: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.MRInputColSpec.phenotype_col","title":"phenotype_col  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>phenotype_col: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.MRInputColSpec.pos_col","title":"pos_col  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>pos_col: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.MRInputColSpec.pval_col","title":"pval_col  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>pval_col: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.MRInputColSpec.rsid_col","title":"rsid_col  <code>instance-attribute</code>","text":"<pre><code>rsid_col: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.MRInputColSpec.sample_size_col","title":"sample_size_col  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>sample_size_col: str | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.MRInputColSpec.se_col","title":"se_col  <code>instance-attribute</code>","text":"<pre><code>se_col: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.MRInputColSpec.make_renamer","title":"make_renamer","text":"<pre><code>make_renamer() -&gt; dict[str, str]\n</code></pre> Source code in <code>mecfs_bio/build_system/task/two_sample_mr_task.py</code> <pre><code>def make_renamer(self) -&gt; dict[str, str]:\n    base = {\n        self.rsid_col: TSM_RSID_COL,\n        self.beta_col: TSM_BETA_COL,\n        self.se_col: TSM_SE_COL,\n        self.ea_col: TSM_EFFECT_ALLELE_COL,\n    }\n    if self.nea_col is not None:\n        base[self.nea_col] = TSM_OTHER_ALLELE_COL\n    if self.eaf_col is not None:\n        base[self.eaf_col] = TSM_EAF_COL\n    if self.chrom_col is not None:\n        base[self.chrom_col] = TSM_CHR_COL\n    if self.pos_col is not None:\n        base[self.pos_col] = TSM_POS_COL\n    if self.phenotype_col is not None:\n        base[self.phenotype_col] = TSM_PHENOTYPE\n    if self.pval_col is not None:\n        base[self.pval_col] = TSM_P_VALUE\n    if self.n_case_col is not None:\n        base[self.n_case_col] = TSM_N_CASE\n    if self.n_control_col is not None:\n        base[self.n_control_col] = TSM_N_CONTROL\n    if self.sample_size_col is not None:\n        base[self.sample_size_col] = TSM_SAMPLE_SIZE_COL\n    return base\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.MRReportOptions","title":"MRReportOptions","text":""},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.SteigerFilteringOptions","title":"SteigerFilteringOptions","text":"<p>Attributes:</p> <ul> <li> <code>drop_failures</code>               (<code>bool</code>)           \u2013            </li> <li> <code>p_value_thresh</code>               (<code>float | None</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.SteigerFilteringOptions.drop_failures","title":"drop_failures  <code>instance-attribute</code>","text":"<pre><code>drop_failures: bool\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.SteigerFilteringOptions.p_value_thresh","title":"p_value_thresh  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>p_value_thresh: float | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRConfig","title":"TwoSampleMRConfig","text":"<p>Attributes:</p> <ul> <li> <code>clump_exposure_data</code>               (<code>ClumpOptions | None</code>)           \u2013            </li> <li> <code>pre_filter_outcome_variants</code>               (<code>bool</code>)           \u2013            </li> <li> <code>report_options</code>               (<code>MRReportOptions | None</code>)           \u2013            </li> <li> <code>steiger_filter</code>               (<code>SteigerFilteringOptions | None</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRConfig.clump_exposure_data","title":"clump_exposure_data  <code>instance-attribute</code>","text":"<pre><code>clump_exposure_data: ClumpOptions | None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRConfig.pre_filter_outcome_variants","title":"pre_filter_outcome_variants  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>pre_filter_outcome_variants: bool = False\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRConfig.report_options","title":"report_options  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>report_options: MRReportOptions | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRConfig.steiger_filter","title":"steiger_filter  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>steiger_filter: SteigerFilteringOptions | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRResult","title":"TwoSampleMRResult","text":"<p>Attributes:</p> <ul> <li> <code>result</code>               (<code>DataFrame</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRResult.result","title":"result  <code>instance-attribute</code>","text":"<pre><code>result: DataFrame\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRTask","title":"TwoSampleMRTask","text":"<p>               Bases: <code>Task</code></p> <p>Task to run mendelian randomization using the R package TwoSampleMR. This R package is accessed through Python via rpy2.</p> <p>Note that some of the calls to the TSMR library below (like clumping) require access to the OpenGWAS database.  This in turn requires an access token. You can get a token here: https://api.opengwas.io/ Add to your .Renviron file the following line: OPENGWAS_JWT=</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>config</code>               (<code>TwoSampleMRConfig</code>)           \u2013            </li> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>exposure_col_spec</code>               (<code>MRInputColSpec | None</code>)           \u2013            </li> <li> <code>exposure_data_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>exposure_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>exposure_meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>exposure_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>mr_method_list</code>               (<code>list[str] | None</code>)           \u2013            </li> <li> <code>outcome_col_spec</code>               (<code>MRInputColSpec | None</code>)           \u2013            </li> <li> <code>outcome_data_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>outcome_id</code>               (<code>AssetId</code>)           \u2013            </li> <li> <code>outcome_meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>outcome_pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRTask.config","title":"config  <code>instance-attribute</code>","text":"<pre><code>config: TwoSampleMRConfig\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRTask.exposure_col_spec","title":"exposure_col_spec  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>exposure_col_spec: MRInputColSpec | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRTask.exposure_data_task","title":"exposure_data_task  <code>instance-attribute</code>","text":"<pre><code>exposure_data_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRTask.exposure_id","title":"exposure_id  <code>property</code>","text":"<pre><code>exposure_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRTask.exposure_meta","title":"exposure_meta  <code>property</code>","text":"<pre><code>exposure_meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRTask.exposure_pipe","title":"exposure_pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>exposure_pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRTask.mr_method_list","title":"mr_method_list  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>mr_method_list: list[str] | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRTask.outcome_col_spec","title":"outcome_col_spec  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>outcome_col_spec: MRInputColSpec | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRTask.outcome_data_task","title":"outcome_data_task  <code>instance-attribute</code>","text":"<pre><code>outcome_data_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRTask.outcome_id","title":"outcome_id  <code>property</code>","text":"<pre><code>outcome_id: AssetId\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRTask.outcome_meta","title":"outcome_meta  <code>property</code>","text":"<pre><code>outcome_meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRTask.outcome_pipe","title":"outcome_pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>outcome_pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    asset_id: str,\n    outcome_data_task: Task,\n    exposure_data_task: Task,\n    config: TwoSampleMRConfig,\n    exposure_pipe: DataProcessingPipe,\n    outcome_pipe: DataProcessingPipe,\n    exposure_col_spec: MRInputColSpec,\n    outcome_col_spec: MRInputColSpec,\n    method_list: list[str] | None = None,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/two_sample_mr_task.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    asset_id: str,\n    outcome_data_task: Task,\n    exposure_data_task: Task,\n    config: TwoSampleMRConfig,\n    exposure_pipe: DataProcessingPipe,\n    outcome_pipe: DataProcessingPipe,\n    exposure_col_spec: MRInputColSpec,\n    outcome_col_spec: MRInputColSpec,\n    method_list: list[str] | None = None,\n):\n    outcome_meta = outcome_data_task.meta\n    assert isinstance(outcome_meta, FilteredGWASDataMeta)\n    meta = ResultDirectoryMeta(\n        id=AssetId(asset_id),\n        trait=outcome_meta.trait,\n        project=outcome_meta.project,\n    )\n    return cls(\n        meta=meta,\n        outcome_data_task=outcome_data_task,\n        exposure_data_task=exposure_data_task,\n        config=config,\n        exposure_pipe=exposure_pipe,\n        outcome_pipe=outcome_pipe,\n        exposure_col_spec=exposure_col_spec,\n        outcome_col_spec=outcome_col_spec,\n        mr_method_list=method_list,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.TwoSampleMRTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/two_sample_mr_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    tsmr = importr(\"TwoSampleMR\")\n    conv = ro.default_converter + pandas2ri.converter\n\n    exposure_asset = fetch(self.exposure_id)\n    outcome_asset = fetch(self.outcome_id)\n\n    logger.debug(\"loading exposure and outcome dataframes...\")\n    exposure_df = (\n        self.exposure_pipe.process(\n            scan_dataframe_asset(exposure_asset, meta=self.exposure_meta)\n        )\n        .collect()\n        .to_pandas()\n    )\n    outcome_df = (\n        self.outcome_pipe.process(\n            scan_dataframe_asset(outcome_asset, meta=self.outcome_meta)\n        )\n        .collect()\n        .to_pandas()\n    )\n\n    logger.debug(\"Renaming columns...\")\n\n    if self.exposure_col_spec is not None:\n        exposure_df = exposure_df.rename(\n            columns=self.exposure_col_spec.make_renamer(),\n            errors=self.exposure_col_spec.errors,\n        )\n\n    if self.outcome_col_spec is not None:\n        outcome_df = outcome_df.rename(\n            columns=self.outcome_col_spec.make_renamer(),\n            errors=self.outcome_col_spec.errors,\n        )\n\n    assert set(NEEDED_COLS) &lt;= set(exposure_df.columns)\n    assert set(NEEDED_COLS) &lt;= set(outcome_df.columns)\n\n    outcome_df = pre_filter_outcome_variants(\n        exposure_df=exposure_df, outcome_df=outcome_df, config=self.config\n    )\n\n    exposure_rdf, outcome_rdf = convert_outcome_and_exposure_to_r(\n        exposure_df=exposure_df, outcome_df=outcome_df\n    )\n\n    f_exposure_rdf, f_outcome_rdf = format_data_no_conversion(\n        exposure_rdf, outcome_rdf, tsmr=tsmr\n    )\n\n    f_exposure_rdf = optionally_clump_exposure_data_no_conversion(\n        formatted_exposure=f_exposure_rdf,\n        clump_options=self.config.clump_exposure_data,\n        tsmr=tsmr,\n    )\n\n    harmonized = harmonize_data_no_conversion(\n        formatted_exposure=f_exposure_rdf,\n        formatted_outcome=f_outcome_rdf,\n        tsmr=tsmr,\n    )\n\n    harmonized = steiger_filtering_write_output(\n        harmonized=harmonized,\n        options=self.config.steiger_filter,\n        scratch_dir=scratch_dir,\n        tsmr=tsmr,\n    )\n\n    # with localconverter(conv):\n    #     harm_py = ro.conversion.get_conversion().rpy2py(harmonized)\n    gen_mr_report(\n        harmonized=harmonized,\n        options=self.config.report_options,\n        target_dir=scratch_dir / REPORT_SUBDIR_PATH,\n        tsmr=tsmr,\n    )\n\n    result_rdf = run_tsmr_on_harmonized_data_no_conversion(\n        harmonized=harmonized, tsmr=tsmr, method_list=self.mr_method_list\n    )\n    logger.info(\"Converting R dataframe to pandas dataframe...\")\n    with localconverter(conv):\n        result_df = ro.conversion.get_conversion().rpy2py(result_rdf)\n\n    result_df.to_csv(scratch_dir / MAIN_RESULT_DF_PATH, index=False)\n    return DirectoryAsset(scratch_dir)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.convert_outcome_and_exposure_to_r","title":"convert_outcome_and_exposure_to_r","text":"<pre><code>convert_outcome_and_exposure_to_r(\n    exposure_df: DataFrame, outcome_df: DataFrame\n) -&gt; tuple[RDataFrame, RDataFrame]\n</code></pre> Source code in <code>mecfs_bio/build_system/task/two_sample_mr_task.py</code> <pre><code>def convert_outcome_and_exposure_to_r(\n    exposure_df: pd.DataFrame,\n    outcome_df: pd.DataFrame,\n) -&gt; tuple[RDataFrame, RDataFrame]:\n    conv = ro.default_converter + pandas2ri.converter\n\n    with localconverter(conv):\n        logger.debug(\"converting exposure to r...\")\n        exposure_rdf = ro.conversion.get_conversion().py2rpy(exposure_df)\n        logger.debug(\"converting outcome to r...\")\n        outcome_rdf = ro.conversion.get_conversion().py2rpy(outcome_df)\n    return exposure_rdf, outcome_rdf\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.format_data","title":"format_data","text":"<pre><code>format_data(\n    exposure_df: DataFrame,\n    outcome_df: DataFrame,\n    tsmr: RPackageType,\n) -&gt; tuple[pd.DataFrame, pd.DataFrame]\n</code></pre> Source code in <code>mecfs_bio/build_system/task/two_sample_mr_task.py</code> <pre><code>def format_data(\n    exposure_df: pd.DataFrame,\n    outcome_df: pd.DataFrame,\n    tsmr: RPackageType,\n) -&gt; tuple[pd.DataFrame, pd.DataFrame]:\n    conv = ro.default_converter + pandas2ri.converter\n\n    with localconverter(conv):\n        logger.debug(\"formatting exposure...\")\n        formatted_exposure = tsmr.format_data(\n            exposure_df,\n            type=\"exposure\",\n        )\n\n        logger.debug(\"formatting outcome...\")\n        formatted_outcome = tsmr.format_data(outcome_df, type=\"outcome\")\n        return formatted_exposure, formatted_outcome\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.format_data_no_conversion","title":"format_data_no_conversion","text":"<pre><code>format_data_no_conversion(\n    exposure_rdf: DataFrame,\n    outcome_rdf: DataFrame,\n    tsmr: RPackageType,\n) -&gt; tuple[RDataFrame, RDataFrame]\n</code></pre> Source code in <code>mecfs_bio/build_system/task/two_sample_mr_task.py</code> <pre><code>def format_data_no_conversion(\n    exposure_rdf: RDataFrame,\n    outcome_rdf: RDataFrame,\n    tsmr: RPackageType,\n) -&gt; tuple[RDataFrame, RDataFrame]:\n    logger.debug(\"formatting exposure...\")\n    formatted_exposure = tsmr.format_data(\n        exposure_rdf,\n        type=\"exposure\",\n    )\n\n    logger.debug(\"formatting outcome...\")\n    formatted_outcome = tsmr.format_data(outcome_rdf, type=\"outcome\")\n    return formatted_exposure, formatted_outcome\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.gen_mr_report","title":"gen_mr_report","text":"<pre><code>gen_mr_report(\n    harmonized: DataFrame,\n    options: MRReportOptions | None,\n    target_dir: Path,\n    tsmr: RPackageType,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/two_sample_mr_task.py</code> <pre><code>def gen_mr_report(\n    harmonized: RDataFrame,\n    options: MRReportOptions | None,\n    target_dir: Path,\n    tsmr: RPackageType,\n):\n    if options is None:\n        return\n    tsmr.mr_report(harmonized, str(target_dir))\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.harmonize_data","title":"harmonize_data","text":"<pre><code>harmonize_data(\n    formatted_exposure: DataFrame,\n    formatted_outcome: DataFrame,\n    tsmr: RPackageType,\n) -&gt; pd.DataFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/two_sample_mr_task.py</code> <pre><code>def harmonize_data(\n    formatted_exposure: pd.DataFrame,\n    formatted_outcome: pd.DataFrame,\n    tsmr: RPackageType,\n) -&gt; pd.DataFrame:\n    conv = ro.default_converter + pandas2ri.converter\n    with localconverter(conv):\n        logger.debug(\"Harmonizing outcome and exposure...\")\n        harmonized = tsmr.harmonise_data(formatted_exposure, formatted_outcome)\n        return harmonized\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.harmonize_data_no_conversion","title":"harmonize_data_no_conversion","text":"<pre><code>harmonize_data_no_conversion(\n    formatted_exposure: DataFrame,\n    formatted_outcome: DataFrame,\n    tsmr: RPackageType,\n) -&gt; RDataFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/two_sample_mr_task.py</code> <pre><code>def harmonize_data_no_conversion(\n    formatted_exposure: RDataFrame,\n    formatted_outcome: RDataFrame,\n    tsmr: RPackageType,\n) -&gt; RDataFrame:\n    logger.debug(\"Harmonizing outcome and exposure...\")\n    harmonized = tsmr.harmonise_data(formatted_exposure, formatted_outcome)\n    return harmonized\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.optionally_clump_exposure_data","title":"optionally_clump_exposure_data","text":"<pre><code>optionally_clump_exposure_data(\n    formatted_exposure: DataFrame,\n    clump_options: ClumpOptions | None,\n    tsmr: RPackageType,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/two_sample_mr_task.py</code> <pre><code>def optionally_clump_exposure_data(\n    formatted_exposure: pd.DataFrame,\n    clump_options: ClumpOptions | None,\n    tsmr: RPackageType,\n):\n    if clump_options is None:\n        return formatted_exposure\n    logger.debug(f\"shape of exposure df before clumping:{formatted_exposure.shape}\")\n    conv = ro.default_converter + pandas2ri.converter\n    with localconverter(conv):\n        formatted_exposure = tsmr.clump_data(\n            formatted_exposure,\n        )\n    logger.debug(f\"shape of exposure df after clumping:{formatted_exposure.shape}\")\n    return formatted_exposure\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.optionally_clump_exposure_data_no_conversion","title":"optionally_clump_exposure_data_no_conversion","text":"<pre><code>optionally_clump_exposure_data_no_conversion(\n    formatted_exposure: DataFrame,\n    clump_options: ClumpOptions | None,\n    tsmr: RPackageType,\n) -&gt; RDataFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/two_sample_mr_task.py</code> <pre><code>def optionally_clump_exposure_data_no_conversion(\n    formatted_exposure: RDataFrame,\n    clump_options: ClumpOptions | None,\n    tsmr: RPackageType,\n) -&gt; RDataFrame:\n    if clump_options is None:\n        return formatted_exposure\n    logger.debug(\"clumping\")\n    formatted_exposure = tsmr.clump_data(\n        formatted_exposure,\n    )\n\n    logger.debug(\" done clumping\")\n\n    return formatted_exposure\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.pre_filter_outcome_variants","title":"pre_filter_outcome_variants","text":"<pre><code>pre_filter_outcome_variants(\n    exposure_df: DataFrame,\n    outcome_df: DataFrame,\n    config: TwoSampleMRConfig,\n) -&gt; pd.DataFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/two_sample_mr_task.py</code> <pre><code>def pre_filter_outcome_variants(\n    exposure_df: pd.DataFrame, outcome_df: pd.DataFrame, config: TwoSampleMRConfig\n) -&gt; pd.DataFrame:\n    if not config.pre_filter_outcome_variants:\n        return outcome_df\n    logger.debug(\"filtering outcome variants...\")\n    return outcome_df.loc[outcome_df[TSM_RSID_COL].isin(exposure_df[TSM_RSID_COL])]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.run_tsmr_on_formatted_data","title":"run_tsmr_on_formatted_data","text":"<pre><code>run_tsmr_on_formatted_data(\n    formatted_exposure: DataFrame,\n    formatted_outcome: DataFrame,\n    config: TwoSampleMRConfig,\n    tsmr: RPackageType,\n) -&gt; TwoSampleMRResult\n</code></pre> Source code in <code>mecfs_bio/build_system/task/two_sample_mr_task.py</code> <pre><code>def run_tsmr_on_formatted_data(\n    formatted_exposure: pd.DataFrame,\n    formatted_outcome: pd.DataFrame,\n    config: TwoSampleMRConfig,\n    tsmr: RPackageType,\n) -&gt; TwoSampleMRResult:\n    conv = ro.default_converter + pandas2ri.converter\n\n    with localconverter(conv):\n        if config.clump_exposure_data:\n            logger.debug(\"Clumping exposure data...\")\n            formatted_exposure = tsmr.clump_data(formatted_exposure)\n        logger.debug(\"Harmonizing outcome and exposure...\")\n        harmonized = tsmr.harmonise_data(formatted_exposure, formatted_outcome)\n        return run_tsmr_on_harmonized_data(harmonized=harmonized, tsmr=tsmr)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.run_tsmr_on_harmonized_data","title":"run_tsmr_on_harmonized_data","text":"<pre><code>run_tsmr_on_harmonized_data(\n    harmonized: DataFrame, tsmr: RPackageType\n) -&gt; TwoSampleMRResult\n</code></pre> Source code in <code>mecfs_bio/build_system/task/two_sample_mr_task.py</code> <pre><code>def run_tsmr_on_harmonized_data(\n    harmonized: pd.DataFrame,\n    tsmr: RPackageType,\n) -&gt; TwoSampleMRResult:\n    conv = ro.default_converter + pandas2ri.converter\n    with localconverter(conv):\n        logger.debug(\"performing Mendelian randomization...\")\n        output = tsmr.mr(harmonized)\n        return TwoSampleMRResult(output)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.run_tsmr_on_harmonized_data_no_conversion","title":"run_tsmr_on_harmonized_data_no_conversion","text":"<pre><code>run_tsmr_on_harmonized_data_no_conversion(\n    harmonized: DataFrame,\n    tsmr: RPackageType,\n    method_list: list[str] | None = None,\n) -&gt; RDataFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/two_sample_mr_task.py</code> <pre><code>def run_tsmr_on_harmonized_data_no_conversion(\n    harmonized: RDataFrame,\n    tsmr: RPackageType,\n    method_list: list[str] | None = None,\n) -&gt; RDataFrame:\n    logger.debug(\"performing Mendelian randomization...\")\n    if method_list is None:\n        method_dict = {}\n    else:\n        method_dict = {\"method_list\": method_list}\n    output = tsmr.mr(harmonized, **method_dict)\n    return output\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.run_two_sample_mr","title":"run_two_sample_mr","text":"<pre><code>run_two_sample_mr(\n    exposure_df: DataFrame,\n    outcome_df: DataFrame,\n    config: TwoSampleMRConfig,\n) -&gt; TwoSampleMRResult\n</code></pre> Source code in <code>mecfs_bio/build_system/task/two_sample_mr_task.py</code> <pre><code>def run_two_sample_mr(\n    exposure_df: pd.DataFrame,\n    outcome_df: pd.DataFrame,\n    config: TwoSampleMRConfig,\n) -&gt; TwoSampleMRResult:\n    tsmr = importr(\"TwoSampleMR\")\n    # base = importr('base')\n    formatted_exposure, formatted_outcome = format_data(\n        exposure_df, outcome_df, tsmr=tsmr\n    )\n    return run_tsmr_on_formatted_data(\n        formatted_exposure, formatted_outcome, config, tsmr=tsmr\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/two_sample_mr_task/#mecfs_bio.build_system.task.two_sample_mr_task.steiger_filtering_write_output","title":"steiger_filtering_write_output","text":"<pre><code>steiger_filtering_write_output(\n    harmonized: DataFrame,\n    options: SteigerFilteringOptions | None,\n    scratch_dir: Path,\n    tsmr: RPackageType,\n) -&gt; RDataFrame\n</code></pre> Source code in <code>mecfs_bio/build_system/task/two_sample_mr_task.py</code> <pre><code>def steiger_filtering_write_output(\n    harmonized: RDataFrame,\n    options: SteigerFilteringOptions | None,\n    scratch_dir: Path,\n    tsmr: RPackageType,\n) -&gt; RDataFrame:\n    if options is None:\n        return harmonized\n    logger.debug(\"Performing steiger filtering\")\n    filtered = tsmr.steiger_filtering(harmonized)\n    conv = ro.default_converter + pandas2ri.converter\n    with localconverter(conv):\n        py_filtered = ro.conversion.get_conversion().rpy2py(filtered)\n        assert not py_filtered[TSM_OUTPUT_STEIGER_P_COL].isnull().any()\n        prerows = len(py_filtered)\n        logger.debug(f\"Pre steiger filtering df has {prerows} rows\")\n        py_filtered.to_csv(scratch_dir / STEIGER_RESULT_PATH, index=False)\n        if options.drop_failures:\n            py_filtered = py_filtered.loc[py_filtered[TSM_OUTPUT_STEIGER_DIR_COL]]\n            if options.p_value_thresh is not None:\n                py_filtered = py_filtered.loc[\n                    py_filtered[TSM_OUTPUT_STEIGER_P_COL] &lt;= options.p_value_thresh\n                ]\n            harmonized = ro.conversion.get_conversion().py2rpy(py_filtered)\n\n        logger.debug(\n            f\"Post steiger filtering df has {len(py_filtered)} rows, after dropping {prerows - len(py_filtered)}\"\n        )\n        return harmonized\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/","title":"upset_plot_task","text":""},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/#mecfs_bio.build_system.task.upset_plot_task","title":"mecfs_bio.build_system.task.upset_plot_task","text":"<p>Create an upset plot to describe the intersection of sets represented as dataframe columns See: https://en.wikipedia.org/wiki/UpSet_plot</p> <p>Classes:</p> <ul> <li> <code>DirSetSource</code>           \u2013            </li> <li> <code>FileSetSource</code>           \u2013            </li> <li> <code>UpSetPlotTask</code>           \u2013            <p>Create an upset plot to describe the intersection of sets represented as dataframe columns</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>load_contents</code>             \u2013              </li> <li> <code>write_blank_png</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>SetSource</code>           \u2013            </li> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/#mecfs_bio.build_system.task.upset_plot_task.SetSource","title":"SetSource  <code>module-attribute</code>","text":"<pre><code>SetSource = FileSetSource | DirSetSource\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/#mecfs_bio.build_system.task.upset_plot_task.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/#mecfs_bio.build_system.task.upset_plot_task.DirSetSource","title":"DirSetSource","text":"<p>Attributes:</p> <ul> <li> <code>col_name</code>               (<code>str</code>)           \u2013            </li> <li> <code>file_in_dir</code>               (<code>PurePath</code>)           \u2013            </li> <li> <code>name</code>               (<code>str</code>)           \u2013            </li> <li> <code>pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>read_spec</code>               (<code>DataFrameReadSpec</code>)           \u2013            </li> <li> <code>task</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/#mecfs_bio.build_system.task.upset_plot_task.DirSetSource.col_name","title":"col_name  <code>instance-attribute</code>","text":"<pre><code>col_name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/#mecfs_bio.build_system.task.upset_plot_task.DirSetSource.file_in_dir","title":"file_in_dir  <code>instance-attribute</code>","text":"<pre><code>file_in_dir: PurePath\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/#mecfs_bio.build_system.task.upset_plot_task.DirSetSource.name","title":"name  <code>instance-attribute</code>","text":"<pre><code>name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/#mecfs_bio.build_system.task.upset_plot_task.DirSetSource.pipe","title":"pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/#mecfs_bio.build_system.task.upset_plot_task.DirSetSource.read_spec","title":"read_spec  <code>instance-attribute</code>","text":"<pre><code>read_spec: DataFrameReadSpec\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/#mecfs_bio.build_system.task.upset_plot_task.DirSetSource.task","title":"task  <code>instance-attribute</code>","text":"<pre><code>task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/#mecfs_bio.build_system.task.upset_plot_task.FileSetSource","title":"FileSetSource","text":"<p>Attributes:</p> <ul> <li> <code>col_name</code>               (<code>str</code>)           \u2013            </li> <li> <code>name</code>               (<code>str</code>)           \u2013            </li> <li> <code>pipe</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>task</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/#mecfs_bio.build_system.task.upset_plot_task.FileSetSource.col_name","title":"col_name  <code>instance-attribute</code>","text":"<pre><code>col_name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/#mecfs_bio.build_system.task.upset_plot_task.FileSetSource.name","title":"name  <code>instance-attribute</code>","text":"<pre><code>name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/#mecfs_bio.build_system.task.upset_plot_task.FileSetSource.pipe","title":"pipe  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>pipe: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/#mecfs_bio.build_system.task.upset_plot_task.FileSetSource.task","title":"task  <code>instance-attribute</code>","text":"<pre><code>task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/#mecfs_bio.build_system.task.upset_plot_task.UpSetPlotTask","title":"UpSetPlotTask","text":"<p>               Bases: <code>Task</code></p> <p>Create an upset plot to describe the intersection of sets represented as dataframe columns See: https://en.wikipedia.org/wiki/UpSet_plot</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>execute</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>deps</code>               (<code>list[Task]</code>)           \u2013            </li> <li> <code>meta</code>               (<code>Meta</code>)           \u2013            </li> <li> <code>set_sources</code>               (<code>Sequence[SetSource]</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/#mecfs_bio.build_system.task.upset_plot_task.UpSetPlotTask.deps","title":"deps  <code>property</code>","text":"<pre><code>deps: list[Task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/#mecfs_bio.build_system.task.upset_plot_task.UpSetPlotTask.meta","title":"meta  <code>property</code>","text":"<pre><code>meta: Meta\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/#mecfs_bio.build_system.task.upset_plot_task.UpSetPlotTask.set_sources","title":"set_sources  <code>instance-attribute</code>","text":"<pre><code>set_sources: Sequence[SetSource]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/#mecfs_bio.build_system.task.upset_plot_task.UpSetPlotTask.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(asset_id: str, set_sources: Sequence[SetSource])\n</code></pre> Source code in <code>mecfs_bio/build_system/task/upset_plot_task.py</code> <pre><code>@classmethod\ndef create(cls, asset_id: str, set_sources: Sequence[SetSource]):\n    assert len(set_sources) &gt;= 1\n    source_meta = set_sources[0].task.meta\n    if isinstance(source_meta, ResultDirectoryMeta):\n        meta = GWASPlotFileMeta(\n            trait=source_meta.trait,\n            project=source_meta.project,\n            extension=\".png\",\n            id=AssetId(asset_id),\n        )\n        return cls(\n            meta=meta,\n            set_sources=set_sources,\n        )\n    raise ValueError(f\"Unknown source meta {source_meta}\")\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/#mecfs_bio.build_system.task.upset_plot_task.UpSetPlotTask.execute","title":"execute","text":"<pre><code>execute(scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset\n</code></pre> Source code in <code>mecfs_bio/build_system/task/upset_plot_task.py</code> <pre><code>def execute(self, scratch_dir: Path, fetch: Fetch, wf: WF) -&gt; Asset:\n    contents_dict = {\n        item.name: load_contents(item, fetch=fetch) for item in self.set_sources\n    }\n    sets = from_contents(contents_dict)\n    if len(sets) == 0:\n        write_blank_png(scratch_dir / \"sets.png\")\n        logger.debug(\n            \"No sets to intersect.  Writing a blank png file as a placeholder.\"\n        )\n        return FileAsset(scratch_dir / \"sets.png\")\n    UpSet(\n        sets,\n        show_counts=True,\n    ).plot(\n        # fig\n    )\n    write_plots_to_dir(\n        scratch_dir,\n        {\n            \"upset\": plt.gcf(),\n        },\n    )\n    return FileAsset(scratch_dir / \"upset.png\")\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/#mecfs_bio.build_system.task.upset_plot_task.load_contents","title":"load_contents","text":"<pre><code>load_contents(\n    set_source: SetSource, fetch: Fetch\n) -&gt; list[str]\n</code></pre> Source code in <code>mecfs_bio/build_system/task/upset_plot_task.py</code> <pre><code>def load_contents(set_source: SetSource, fetch: Fetch) -&gt; list[str]:\n    if isinstance(set_source, FileSetSource):\n        asset = fetch(set_source.task.asset_id)\n        df = (\n            set_source.pipe.process(\n                scan_dataframe_asset(asset, meta=set_source.task.meta)\n            )\n            .collect()\n            .to_pandas()\n        )\n        return df[set_source.col_name].tolist()\n    elif isinstance(set_source, DirSetSource):\n        asset = fetch(set_source.task.asset_id)\n        assert isinstance(asset, DirectoryAsset)\n        df = (\n            set_source.pipe.process(\n                scan_dataframe(\n                    path=asset.path / set_source.file_in_dir, spec=set_source.read_spec\n                )\n            )\n            .collect()\n            .to_pandas()\n        )\n        return df[set_source.col_name].tolist()\n    else:\n        raise ValueError(\"Unknown set source\")\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task/upset_plot_task/#mecfs_bio.build_system.task.upset_plot_task.write_blank_png","title":"write_blank_png","text":"<pre><code>write_blank_png(pth: Path)\n</code></pre> Source code in <code>mecfs_bio/build_system/task/upset_plot_task.py</code> <pre><code>def write_blank_png(pth: Path):\n    width = 200\n    height = 100\n    pixel_data = array.array(\"B\", [255] * (width * height))\n\n    with open(pth, \"wb\") as f:\n        w = png.Writer(width, height, greyscale=True, bitdepth=8)\n        w.write(f, [pixel_data[i * width : (i + 1) * width] for i in range(height)])\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/","title":"task_generator","text":""},{"location":"reference/mecfs_bio/build_system/task_generator/#mecfs_bio.build_system.task_generator","title":"mecfs_bio.build_system.task_generator","text":"<p>A Task generator concisely generates multiple inter-related tasks with a few lines of code.</p> <p>Modules:</p> <ul> <li> <code>magma_task_generator</code>           \u2013            </li> <li> <code>master_gene_list_task_generator</code>           \u2013            </li> <li> <code>sldsc_task_generator</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/","title":"magma_task_generator","text":""},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator","title":"mecfs_bio.build_system.task_generator.magma_task_generator","text":"<p>Classes:</p> <ul> <li> <code>GGetSettings</code>           \u2013            </li> <li> <code>MagmaTaskGeneratorFromRaw</code>           \u2013            <p>As above, but starts from raw data.</p> </li> <li> <code>MagmaTaskGeneratorFromRawCompute37RSIDs</code>           \u2013            <p>As above, but assumes RSIDs are either not present,</p> </li> <li> <code>StandardMagmaTaskGenerator</code>           \u2013            <p>A Task Generator that generates all the Tasks required to perform the main steps of the MAGMA workflow, up to plotting the results of tissue-specific gene-set analysis</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.GGetSettings","title":"GGetSettings","text":"<p>Attributes:</p> <ul> <li> <code>limit_genes</code>               (<code>int | None</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.GGetSettings.limit_genes","title":"limit_genes  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>limit_genes: int | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.MagmaTaskGeneratorFromRaw","title":"MagmaTaskGeneratorFromRaw","text":"<p>As above, but starts from raw data. Assumes raw data already includes RSIDs</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>inner</code>               (<code>StandardMagmaTaskGenerator</code>)           \u2013            </li> <li> <code>parquet_file_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>sumstats_task</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.MagmaTaskGeneratorFromRaw.inner","title":"inner  <code>instance-attribute</code>","text":"<pre><code>inner: StandardMagmaTaskGenerator\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.MagmaTaskGeneratorFromRaw.parquet_file_task","title":"parquet_file_task  <code>instance-attribute</code>","text":"<pre><code>parquet_file_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.MagmaTaskGeneratorFromRaw.sumstats_task","title":"sumstats_task  <code>instance-attribute</code>","text":"<pre><code>sumstats_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.MagmaTaskGeneratorFromRaw.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    raw_gwas_data_task: Task,\n    fmt: GwaslabKnownFormat | GWASLabColumnSpecifiers,\n    magma_binary_task: Task,\n    gene_loc_file_task: Task,\n    magma_ld_ref_task: Task,\n    tissue_expression_gene_set_task: Task,\n    base_name: str,\n    sample_size: int,\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n    post_pipe: DataProcessingPipe = IdentityPipe(),\n    ld_ref_file_stem: str = \"g1000_eur\",\n    genome_build: GenomeBuildMode = \"infer\",\n    gene_thesaurus_task: Task | None = None,\n    gget_settings: GGetSettings | None = GGetSettings(50),\n    number_of_bars: int = 20,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task_generator/magma_task_generator.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    raw_gwas_data_task: Task,\n    fmt: GwaslabKnownFormat | GWASLabColumnSpecifiers,\n    magma_binary_task: Task,\n    gene_loc_file_task: Task,\n    magma_ld_ref_task: Task,\n    tissue_expression_gene_set_task: Task,\n    base_name: str,\n    sample_size: int,\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n    post_pipe: DataProcessingPipe = IdentityPipe(),\n    ld_ref_file_stem: str = \"g1000_eur\",\n    genome_build: GenomeBuildMode = \"infer\",\n    gene_thesaurus_task: Task | None = None,\n    gget_settings: GGetSettings | None = GGetSettings(50),\n    number_of_bars: int = 20,\n):\n    sumstats_task = GWASLabCreateSumstatsTask(\n        df_source_task=raw_gwas_data_task,\n        asset_id=AssetId(base_name + \"_sumstats_37\"),\n        basic_check=True,\n        genome_build=genome_build,\n        liftover_to=\"19\",\n        fmt=fmt,\n        pre_pipe=pre_pipe,\n    )\n    parquet_file_task = GwasLabSumstatsToTableTask.create_from_source_task(\n        source_tsk=sumstats_task,\n        asset_id=base_name + \"_parquet_table_from_sumstats\",\n        sub_dir=\"processed\",\n        pipe=post_pipe,\n    )\n    return cls(\n        sumstats_task=sumstats_task,\n        parquet_file_task=parquet_file_task,\n        inner=StandardMagmaTaskGenerator.create(\n            gwas_parquet_with_rsids_task=parquet_file_task,\n            magma_binary_task=magma_binary_task,\n            gene_loc_file_task=gene_loc_file_task,\n            magma_ld_ref_task=magma_ld_ref_task,\n            tissue_expression_gene_set_task=tissue_expression_gene_set_task,\n            base_name=base_name,\n            sample_size=sample_size,\n            ld_ref_file_stem=ld_ref_file_stem,\n            gene_thesaurus_task=gene_thesaurus_task,\n            gget_settings=gget_settings,\n            number_of_bars=number_of_bars,\n        ),\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.MagmaTaskGeneratorFromRawCompute37RSIDs","title":"MagmaTaskGeneratorFromRawCompute37RSIDs","text":"<p>As above, but assumes RSIDs are either not present, or present but invalid because the data needs to be lifter over to assembly 37</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>assign_rsids_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>inner</code>               (<code>StandardMagmaTaskGenerator</code>)           \u2013            </li> <li> <code>parquet_file_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>sumstats_task</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.MagmaTaskGeneratorFromRawCompute37RSIDs.assign_rsids_task","title":"assign_rsids_task  <code>instance-attribute</code>","text":"<pre><code>assign_rsids_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.MagmaTaskGeneratorFromRawCompute37RSIDs.inner","title":"inner  <code>instance-attribute</code>","text":"<pre><code>inner: StandardMagmaTaskGenerator\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.MagmaTaskGeneratorFromRawCompute37RSIDs.parquet_file_task","title":"parquet_file_task  <code>instance-attribute</code>","text":"<pre><code>parquet_file_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.MagmaTaskGeneratorFromRawCompute37RSIDs.sumstats_task","title":"sumstats_task  <code>instance-attribute</code>","text":"<pre><code>sumstats_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.MagmaTaskGeneratorFromRawCompute37RSIDs.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    raw_gwas_data_task: Task,\n    fmt: GwaslabKnownFormat | GWASLabColumnSpecifiers,\n    magma_binary_task: Task,\n    gene_loc_file_task: Task,\n    magma_ld_ref_task: Task,\n    snp151_database_file_task: Task,\n    tissue_expression_gene_set_task: Task,\n    base_name: str,\n    sample_size: int,\n    pipe: DataProcessingPipe = IdentityPipe(),\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n    ld_ref_file_stem: str = \"g1000_eur\",\n    genome_build: GenomeBuildMode = \"infer\",\n    gget_settings: GGetSettings | None = GGetSettings(\n        limit_genes=50\n    ),\n    number_of_bars: int = 20,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task_generator/magma_task_generator.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    raw_gwas_data_task: Task,\n    fmt: GwaslabKnownFormat | GWASLabColumnSpecifiers,\n    magma_binary_task: Task,\n    gene_loc_file_task: Task,\n    magma_ld_ref_task: Task,\n    snp151_database_file_task: Task,\n    tissue_expression_gene_set_task: Task,\n    base_name: str,\n    sample_size: int,\n    pipe: DataProcessingPipe = IdentityPipe(),\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n    ld_ref_file_stem: str = \"g1000_eur\",\n    genome_build: GenomeBuildMode = \"infer\",\n    gget_settings: GGetSettings | None = GGetSettings(limit_genes=50),\n    number_of_bars: int = 20,\n):\n    sumstats_task = GWASLabCreateSumstatsTask(\n        df_source_task=raw_gwas_data_task,\n        asset_id=AssetId(base_name + \"_sumstats_37\"),\n        basic_check=True,\n        genome_build=genome_build,\n        liftover_to=\"19\",\n        fmt=fmt,\n        pre_pipe=pre_pipe,\n    )\n    parquet_file_task = GwasLabSumstatsToTableTask.create_from_source_task(\n        source_tsk=sumstats_task,\n        asset_id=base_name + \"_parquet_table_from_sumstats\",\n        sub_dir=\"processed\",\n        pipe=pipe,\n    )\n    assign_rsids_37_task = AssignRSIDSToSNPsViaSNP151Task.create(\n        snp151_database_file_task=snp151_database_file_task,\n        raw_snp_data_task=parquet_file_task,\n        asset_id=base_name + \"_assign_rsids\",\n        valid_chroms=HG19_SNP151_VALID_CHROMS,\n        chrom_replace_rules=CHROM_RENAME_RULES,\n    )\n\n    return cls(\n        sumstats_task=sumstats_task,\n        parquet_file_task=parquet_file_task,\n        inner=StandardMagmaTaskGenerator.create(\n            gwas_parquet_with_rsids_task=assign_rsids_37_task,\n            magma_binary_task=magma_binary_task,\n            gene_loc_file_task=gene_loc_file_task,\n            magma_ld_ref_task=magma_ld_ref_task,\n            tissue_expression_gene_set_task=tissue_expression_gene_set_task,\n            base_name=base_name,\n            sample_size=sample_size,\n            ld_ref_file_stem=ld_ref_file_stem,\n            gget_settings=gget_settings,\n            number_of_bars=number_of_bars,\n        ),\n        assign_rsids_task=assign_rsids_37_task,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.StandardMagmaTaskGenerator","title":"StandardMagmaTaskGenerator","text":"<p>A Task Generator that generates all the Tasks required to perform the main steps of the MAGMA workflow, up to plotting the results of tissue-specific gene-set analysis</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>terminal_tasks</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>annotations_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>bar_plot_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>filtered_gene_analysis_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>gene_analysis_extracted_result_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>gene_analysis_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>gene_set_analysis_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>gget_labeled_filtered_gene_analysis_task</code>               (<code>Task | None</code>)           \u2013            </li> <li> <code>markdown_gget_labeled_filtered_gene_analysis_task</code>               (<code>Task | None</code>)           \u2013            </li> <li> <code>p_value_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>snp_loc_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>thesaurus_labeled_filtered_gene_analysis_task</code>               (<code>Task | None</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.StandardMagmaTaskGenerator.annotations_task","title":"annotations_task  <code>instance-attribute</code>","text":"<pre><code>annotations_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.StandardMagmaTaskGenerator.bar_plot_task","title":"bar_plot_task  <code>instance-attribute</code>","text":"<pre><code>bar_plot_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.StandardMagmaTaskGenerator.filtered_gene_analysis_task","title":"filtered_gene_analysis_task  <code>instance-attribute</code>","text":"<pre><code>filtered_gene_analysis_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.StandardMagmaTaskGenerator.gene_analysis_extracted_result_task","title":"gene_analysis_extracted_result_task  <code>instance-attribute</code>","text":"<pre><code>gene_analysis_extracted_result_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.StandardMagmaTaskGenerator.gene_analysis_task","title":"gene_analysis_task  <code>instance-attribute</code>","text":"<pre><code>gene_analysis_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.StandardMagmaTaskGenerator.gene_set_analysis_task","title":"gene_set_analysis_task  <code>instance-attribute</code>","text":"<pre><code>gene_set_analysis_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.StandardMagmaTaskGenerator.gget_labeled_filtered_gene_analysis_task","title":"gget_labeled_filtered_gene_analysis_task  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>gget_labeled_filtered_gene_analysis_task: Task | None = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.StandardMagmaTaskGenerator.markdown_gget_labeled_filtered_gene_analysis_task","title":"markdown_gget_labeled_filtered_gene_analysis_task  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>markdown_gget_labeled_filtered_gene_analysis_task: (\n    Task | None\n) = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.StandardMagmaTaskGenerator.p_value_task","title":"p_value_task  <code>instance-attribute</code>","text":"<pre><code>p_value_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.StandardMagmaTaskGenerator.snp_loc_task","title":"snp_loc_task  <code>instance-attribute</code>","text":"<pre><code>snp_loc_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.StandardMagmaTaskGenerator.thesaurus_labeled_filtered_gene_analysis_task","title":"thesaurus_labeled_filtered_gene_analysis_task  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>thesaurus_labeled_filtered_gene_analysis_task: (\n    Task | None\n) = None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.StandardMagmaTaskGenerator.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    gwas_parquet_with_rsids_task: Task,\n    magma_binary_task: Task,\n    gene_loc_file_task: Task,\n    magma_ld_ref_task: Task,\n    tissue_expression_gene_set_task: Task,\n    base_name: str,\n    sample_size: int,\n    ld_ref_file_stem: str = \"g1000_eur\",\n    gene_thesaurus_task: Task | None = None,\n    gget_settings: GGetSettings | None = GGetSettings(\n        limit_genes=50\n    ),\n    number_of_bars: int = 20,\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task_generator/magma_task_generator.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    gwas_parquet_with_rsids_task: Task,\n    magma_binary_task: Task,\n    gene_loc_file_task: Task,\n    magma_ld_ref_task: Task,\n    tissue_expression_gene_set_task: Task,\n    base_name: str,\n    sample_size: int,\n    ld_ref_file_stem: str = \"g1000_eur\",\n    gene_thesaurus_task: Task | None = None,\n    gget_settings: GGetSettings | None = GGetSettings(limit_genes=50),\n    number_of_bars: int = 20,\n):\n    p_value_task = (\n        MagmaSNPFileTask.create_for_magma_snp_p_value_file_compute_if_needed(\n            gwas_parquet_with_rsids_task=gwas_parquet_with_rsids_task,\n            asset_id=base_name + \"_magma_snp_p_values\",\n        )\n    )\n    snp_loc_task = MagmaSNPFileTask.create_for_magma_snp_pos_file(\n        gwas_parquet_with_rsids_task=gwas_parquet_with_rsids_task,\n        asset_id=base_name + \"_magma_snp_locs\",\n    )\n    annotations_task = MagmaAnnotateTask.create(\n        asset_id=base_name + \"_magma_annotations\",\n        magma_binary_task=magma_binary_task,\n        snp_loc_file_task=snp_loc_task,\n        gene_loc_file_task=gene_loc_file_task,\n    )\n    gene_analysis_task = MagmaGeneAnalysisTask.create(\n        asset_id=base_name + \"_magma_gene_analysis\",\n        magma_annotation_task=annotations_task,\n        magma_p_value_task=p_value_task,\n        magma_binary_task=magma_binary_task,\n        magma_ld_ref_task=magma_ld_ref_task,\n        ld_ref_file_stem=ld_ref_file_stem,\n        sample_size=sample_size,\n    )\n    extracted_gene_analysis_result_task = (\n        CopyFileFromDirectoryTask.create_result_table(\n            asset_id=base_name + \"_copy_gene_analysis_result\",\n            source_directory_task=gene_analysis_task,\n            path_inside_directory=PurePath(\n                GENE_ANALYSIS_OUTPUT_STEM_NAME + \".genes.out\"\n            ),\n            extension=\".txt\",\n            read_spec=DataFrameReadSpec(\n                DataFrameWhiteSpaceSepTextFormat(comment_code=\"#\")\n            ),\n        )\n    )\n\n    tissue_gene_set_analysis = MagmaGeneSetAnalysisTask.create(\n        asset_id=base_name + \"_magma_tissue_gene_set_analysis\",\n        magma_gene_analysis_task=gene_analysis_task,\n        magma_binary_task=magma_binary_task,\n        gene_set_task=tissue_expression_gene_set_task,\n        set_or_covar=\"covar\",\n        sub_dir=PurePath(\"analysis\"),\n        model_params=ModelParams(\n            direction_covar=\"greater\", condition_hide=[\"Average\"]\n        ),\n    )\n    bar_plot_task = MAGMAPlotGeneSetResult.create(\n        gene_set_analysis_task=tissue_gene_set_analysis,\n        asset_id=base_name + \"_magma_bar_plot\",\n        number_of_bars=number_of_bars,\n    )\n\n    filtered_gene_task = (\n        MultipleTestingTableTask.create_from_magma_gene_analysis_task(\n            asset_id=base_name + \"_magma_gene_analysis_filtered\",\n            alpha=0.01,\n            method=\"fdr_bh\",\n            source_task=gene_analysis_task,\n        )\n    )\n    if gene_thesaurus_task is not None:\n        labeled_filtered_gene_task = JoinDataFramesTask.create_from_result_df(\n            asset_id=base_name + \"_magma_gene_analysis_filtered_labeled\",\n            result_df_task=filtered_gene_task,\n            reference_df_task=gene_thesaurus_task,\n            how=\"left\",\n            left_on=[\"GENE\"],\n            right_on=[\"Gene stable ID\"],\n        )\n    else:\n        labeled_filtered_gene_task = None\n\n    if gget_settings is not None:\n        gget_labeled_gene_task = FetchGGetInfoTask.create(\n            source_df_task=filtered_gene_task,\n            ensembl_id_col=\"GENE\",\n            asset_id=base_name + \"_magma_gene_analysis_with_gget_info\",\n            genes_to_use=gget_settings.limit_genes,\n        )\n        markdown_gget_labeled_task = (\n            ConvertDataFrameToMarkdownTask.create_from_result_table_task(\n                source_task=gget_labeled_gene_task,\n                asset_id=base_name\n                + \"_magma_gene_analysis_with_gget_info_markdown_table\",\n                pipe=SelectColPipe(\n                    [\n                        \"GENE\",\n                        \"CHR\",\n                        \"P\",\n                        \"subcellular_localisation\",\n                        \"ncbi_description\",\n                        \"uniprot_description\",\n                        \"ensembl_description\",\n                    ]\n                ),\n            )\n        )\n    else:\n        gget_labeled_gene_task = None\n        markdown_gget_labeled_task = None\n\n    return cls(\n        p_value_task=p_value_task,\n        snp_loc_task=snp_loc_task,\n        annotations_task=annotations_task,\n        gene_analysis_task=gene_analysis_task,\n        gene_set_analysis_task=tissue_gene_set_analysis,\n        bar_plot_task=bar_plot_task,\n        filtered_gene_analysis_task=filtered_gene_task,\n        thesaurus_labeled_filtered_gene_analysis_task=labeled_filtered_gene_task,\n        gget_labeled_filtered_gene_analysis_task=gget_labeled_gene_task,\n        markdown_gget_labeled_filtered_gene_analysis_task=markdown_gget_labeled_task,\n        gene_analysis_extracted_result_task=extracted_gene_analysis_result_task,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/magma_task_generator/#mecfs_bio.build_system.task_generator.magma_task_generator.StandardMagmaTaskGenerator.terminal_tasks","title":"terminal_tasks","text":"<pre><code>terminal_tasks() -&gt; list[Task]\n</code></pre> Source code in <code>mecfs_bio/build_system/task_generator/magma_task_generator.py</code> <pre><code>def terminal_tasks(self) -&gt; list[Task]:\n    result = [self.bar_plot_task, self.gene_analysis_task]\n    if self.markdown_gget_labeled_filtered_gene_analysis_task is not None:\n        result.append(self.markdown_gget_labeled_filtered_gene_analysis_task)\n    return result\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/master_gene_list_task_generator/","title":"master_gene_list_task_generator","text":""},{"location":"reference/mecfs_bio/build_system/task_generator/master_gene_list_task_generator/#mecfs_bio.build_system.task_generator.master_gene_list_task_generator","title":"mecfs_bio.build_system.task_generator.master_gene_list_task_generator","text":"<p>Classes:</p> <ul> <li> <code>MasterGeneListTasks</code>           \u2013            </li> </ul> <p>Functions:</p> <ul> <li> <code>generate_master_gene_list_tasks</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task_generator/master_gene_list_task_generator/#mecfs_bio.build_system.task_generator.master_gene_list_task_generator.MasterGeneListTasks","title":"MasterGeneListTasks","text":"<p>Methods:</p> <ul> <li> <code>terminal_tasks</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>combine_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>gget_label_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>markdown_task</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task_generator/master_gene_list_task_generator/#mecfs_bio.build_system.task_generator.master_gene_list_task_generator.MasterGeneListTasks.combine_task","title":"combine_task  <code>instance-attribute</code>","text":"<pre><code>combine_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/master_gene_list_task_generator/#mecfs_bio.build_system.task_generator.master_gene_list_task_generator.MasterGeneListTasks.gget_label_task","title":"gget_label_task  <code>instance-attribute</code>","text":"<pre><code>gget_label_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/master_gene_list_task_generator/#mecfs_bio.build_system.task_generator.master_gene_list_task_generator.MasterGeneListTasks.markdown_task","title":"markdown_task  <code>instance-attribute</code>","text":"<pre><code>markdown_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/master_gene_list_task_generator/#mecfs_bio.build_system.task_generator.master_gene_list_task_generator.MasterGeneListTasks.terminal_tasks","title":"terminal_tasks","text":"<pre><code>terminal_tasks() -&gt; list[Task]\n</code></pre> Source code in <code>mecfs_bio/build_system/task_generator/master_gene_list_task_generator.py</code> <pre><code>def terminal_tasks(self) -&gt; list[Task]:\n    return [self.markdown_task]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/master_gene_list_task_generator/#mecfs_bio.build_system.task_generator.master_gene_list_task_generator.generate_master_gene_list_tasks","title":"generate_master_gene_list_tasks","text":"<pre><code>generate_master_gene_list_tasks(\n    base_name: str,\n    gene_sources: Sequence[SrcGeneList],\n    max_genes_to_use: int = 100,\n) -&gt; MasterGeneListTasks\n</code></pre> Source code in <code>mecfs_bio/build_system/task_generator/master_gene_list_task_generator.py</code> <pre><code>def generate_master_gene_list_tasks(\n    base_name: str, gene_sources: Sequence[SrcGeneList], max_genes_to_use: int = 100\n) -&gt; MasterGeneListTasks:\n    combine_task = CombineGeneListsTask.create(\n        asset_id=base_name + \"_combine_gene_lists\",\n        src_gene_lists=gene_sources,\n        out_format=ParquetOutFormat(),\n    )\n    gget_label_task = FetchGGetInfoTask.create(\n        asset_id=base_name + \"_master_gene_list_with_gget\",\n        source_df_task=combine_task,\n        ensembl_id_col=ENSEMBL_ID_LABEL,\n        post_pipe=SortPipe([ENSEMBL_ID_LABEL]),\n        out_format=ParquetOutFormat(),\n        genes_to_use=max_genes_to_use,\n    )\n    markdown_task = ConvertDataFrameToMarkdownTask.create_from_result_table_task(\n        gget_label_task,\n        base_name + \"_combined_gene_list_markdown\",\n        pipe=CompositePipe(\n            [\n                SelectColPipe(\n                    [\n                        ENSEMBL_ID_LABEL,\n                        \"sources\",\n                        \"uniprot_id\",\n                        \"primary_gene_name\",\n                        \"subcellular_localisation\",\n                        \"ensembl_description\",\n                        \"uniprot_description\",\n                        \"ncbi_description\",\n                    ]\n                ),\n                DropNullsPipe([ENSEMBL_ID_LABEL]),\n            ]\n        ),\n    )\n    return MasterGeneListTasks(\n        combine_task=combine_task,\n        gget_label_task=gget_label_task,\n        markdown_task=markdown_task,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/","title":"sldsc_task_generator","text":""},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/#mecfs_bio.build_system.task_generator.sldsc_task_generator","title":"mecfs_bio.build_system.task_generator.sldsc_task_generator","text":"<p>Classes:</p> <ul> <li> <code>CellAnalysisTaskGroup</code>           \u2013            </li> <li> <code>CellOrTissueLabelRecord</code>           \u2013            </li> <li> <code>PartitionedLDScoresRecord</code>           \u2013            </li> <li> <code>SLDSCTaskGenerator</code>           \u2013            <p>Task generator to apply cell- and tissue-type specific Stratified Linkage Disequilibrium Score Regression</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/#mecfs_bio.build_system.task_generator.sldsc_task_generator.CellAnalysisTaskGroup","title":"CellAnalysisTaskGroup","text":"<p>Methods:</p> <ul> <li> <code>terminal_tasks</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>add_categories_task</code>               (<code>Task | None</code>)           \u2013            </li> <li> <code>cell_analysis_task</code>               (<code>CellAnalysisByLDSCTask</code>)           \u2013            </li> <li> <code>multiple_testing_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>multiple_testing_task_markdown</code>               (<code>Task</code>)           \u2013            </li> <li> <code>plot_task</code>               (<code>Task | None</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/#mecfs_bio.build_system.task_generator.sldsc_task_generator.CellAnalysisTaskGroup.add_categories_task","title":"add_categories_task  <code>instance-attribute</code>","text":"<pre><code>add_categories_task: Task | None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/#mecfs_bio.build_system.task_generator.sldsc_task_generator.CellAnalysisTaskGroup.cell_analysis_task","title":"cell_analysis_task  <code>instance-attribute</code>","text":"<pre><code>cell_analysis_task: CellAnalysisByLDSCTask\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/#mecfs_bio.build_system.task_generator.sldsc_task_generator.CellAnalysisTaskGroup.multiple_testing_task","title":"multiple_testing_task  <code>instance-attribute</code>","text":"<pre><code>multiple_testing_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/#mecfs_bio.build_system.task_generator.sldsc_task_generator.CellAnalysisTaskGroup.multiple_testing_task_markdown","title":"multiple_testing_task_markdown  <code>instance-attribute</code>","text":"<pre><code>multiple_testing_task_markdown: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/#mecfs_bio.build_system.task_generator.sldsc_task_generator.CellAnalysisTaskGroup.plot_task","title":"plot_task  <code>instance-attribute</code>","text":"<pre><code>plot_task: Task | None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/#mecfs_bio.build_system.task_generator.sldsc_task_generator.CellAnalysisTaskGroup.terminal_tasks","title":"terminal_tasks","text":"<pre><code>terminal_tasks() -&gt; list[Task]\n</code></pre> Source code in <code>mecfs_bio/build_system/task_generator/sldsc_task_generator.py</code> <pre><code>def terminal_tasks(self) -&gt; list[Task]:\n    result = [self.multiple_testing_task_markdown]\n    if self.plot_task is not None:\n        result.append(self.plot_task)\n    return result\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/#mecfs_bio.build_system.task_generator.sldsc_task_generator.CellOrTissueLabelRecord","title":"CellOrTissueLabelRecord","text":"<p>Attributes:</p> <ul> <li> <code>cell_or_tissue_label_task</code>               (<code>Task</code>)           \u2013            </li> <li> <code>left_join_on</code>               (<code>str</code>)           \u2013            </li> <li> <code>pipe_left</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>pipe_right</code>               (<code>DataProcessingPipe</code>)           \u2013            </li> <li> <code>right_join_on</code>               (<code>str</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/#mecfs_bio.build_system.task_generator.sldsc_task_generator.CellOrTissueLabelRecord.cell_or_tissue_label_task","title":"cell_or_tissue_label_task  <code>instance-attribute</code>","text":"<pre><code>cell_or_tissue_label_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/#mecfs_bio.build_system.task_generator.sldsc_task_generator.CellOrTissueLabelRecord.left_join_on","title":"left_join_on  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>left_join_on: str = 'Name'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/#mecfs_bio.build_system.task_generator.sldsc_task_generator.CellOrTissueLabelRecord.pipe_left","title":"pipe_left  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>pipe_left: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/#mecfs_bio.build_system.task_generator.sldsc_task_generator.CellOrTissueLabelRecord.pipe_right","title":"pipe_right  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>pipe_right: DataProcessingPipe = IdentityPipe()\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/#mecfs_bio.build_system.task_generator.sldsc_task_generator.CellOrTissueLabelRecord.right_join_on","title":"right_join_on  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>right_join_on: str = 'Tissue_Or_Cell'\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/#mecfs_bio.build_system.task_generator.sldsc_task_generator.PartitionedLDScoresRecord","title":"PartitionedLDScoresRecord","text":"<p>Attributes:</p> <ul> <li> <code>cell_or_tissue_labels_task</code>               (<code>CellOrTissueLabelRecord | None</code>)           \u2013            </li> <li> <code>entry_name</code>               (<code>str</code>)           \u2013            </li> <li> <code>ref_ld_chr_cts_filename</code>               (<code>str</code>)           \u2013            </li> <li> <code>ref_ld_chr_cts_task</code>               (<code>Task</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/#mecfs_bio.build_system.task_generator.sldsc_task_generator.PartitionedLDScoresRecord.cell_or_tissue_labels_task","title":"cell_or_tissue_labels_task  <code>instance-attribute</code>","text":"<pre><code>cell_or_tissue_labels_task: CellOrTissueLabelRecord | None\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/#mecfs_bio.build_system.task_generator.sldsc_task_generator.PartitionedLDScoresRecord.entry_name","title":"entry_name  <code>instance-attribute</code>","text":"<pre><code>entry_name: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/#mecfs_bio.build_system.task_generator.sldsc_task_generator.PartitionedLDScoresRecord.ref_ld_chr_cts_filename","title":"ref_ld_chr_cts_filename  <code>instance-attribute</code>","text":"<pre><code>ref_ld_chr_cts_filename: str\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/#mecfs_bio.build_system.task_generator.sldsc_task_generator.PartitionedLDScoresRecord.ref_ld_chr_cts_task","title":"ref_ld_chr_cts_task  <code>instance-attribute</code>","text":"<pre><code>ref_ld_chr_cts_task: Task\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/#mecfs_bio.build_system.task_generator.sldsc_task_generator.SLDSCTaskGenerator","title":"SLDSCTaskGenerator","text":"<p>Task generator to apply cell- and tissue-type specific Stratified Linkage Disequilibrium Score Regression    to dataset as described in</p> <p>\"Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types.\" Nature genetics 50.4 (2018): 621-629.</p> <p>Assumption is that a variety of different partitioning datasets will be applied to a single set of GWAS data.</p> <p>Methods:</p> <ul> <li> <code>create</code>             \u2013              </li> <li> <code>get_terminal_tasks</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>partitioned_tasks</code>               (<code>Mapping[str, CellAnalysisTaskGroup]</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/#mecfs_bio.build_system.task_generator.sldsc_task_generator.SLDSCTaskGenerator.partitioned_tasks","title":"partitioned_tasks  <code>instance-attribute</code>","text":"<pre><code>partitioned_tasks: Mapping[str, CellAnalysisTaskGroup]\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/#mecfs_bio.build_system.task_generator.sldsc_task_generator.SLDSCTaskGenerator.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    base_name: str,\n    source_sumstats_task: Task,\n    ref_ld_chr_task: Task,\n    ref_ld_chr_inner_dirname: str,\n    w_ld_chr_task: Task,\n    w_ld_chr_inner_dirname: str,\n    partitioned_entries: list[PartitionedLDScoresRecord],\n    multiple_testing_alpha: float,\n    multiple_testing_method: Method,\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n)\n</code></pre> Source code in <code>mecfs_bio/build_system/task_generator/sldsc_task_generator.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    base_name: str,\n    source_sumstats_task: Task,\n    ref_ld_chr_task: Task,\n    ref_ld_chr_inner_dirname: str,\n    w_ld_chr_task: Task,\n    w_ld_chr_inner_dirname: str,\n    partitioned_entries: list[PartitionedLDScoresRecord],\n    multiple_testing_alpha: float,\n    multiple_testing_method: Method,\n    pre_pipe: DataProcessingPipe = IdentityPipe(),\n):\n    cell_analysis_task_groups = {}\n    for entry in partitioned_entries:\n        cell_task = CellAnalysisByLDSCTask.create(\n            asset_id=base_name\n            + \"_\"\n            + entry.entry_name\n            + \"_cell_analysis_by_s_ldsc\",\n            source_sumstats_task=source_sumstats_task,\n            ref_ld_chr_cts_task=entry.ref_ld_chr_cts_task,\n            ref_ld_chr_cts_filename=entry.ref_ld_chr_cts_filename,\n            ref_ld_chr_task=ref_ld_chr_task,\n            ref_ld_chr_inner_dirname=ref_ld_chr_inner_dirname,\n            w_ld_chr_task=w_ld_chr_task,\n            w_ld_chr_inner_dirname=w_ld_chr_inner_dirname,\n            pre_pipe=pre_pipe,\n        )\n        multiple_testing_task = (\n            MultipleTestingTableTask.create_from_result_table_task(\n                asset_id=base_name\n                + \"_\"\n                + entry.entry_name\n                + \"_s_ldsc_multiple_testing_correction\",\n                alpha=multiple_testing_alpha,\n                p_value_column=\"Coefficient_P_value\",\n                source_task=cell_task,\n                apply_filter=False,\n                method=multiple_testing_method,\n            )\n        )\n        multiple_testing_markdown = (\n            ConvertDataFrameToMarkdownTask.create_from_result_table_task(\n                source_task=multiple_testing_task,\n                asset_id=base_name\n                + \"_\"\n                + entry.entry_name\n                + \"_s_ldsc_cell_analysis_md_table\",\n                pipe=DropColPipe([\"_Corrected P Value_\", \"Coefficient_std_error\"]),\n            )\n        )\n        if entry.cell_or_tissue_labels_task is not None:\n            add_labels_task = JoinDataFramesTask.create_from_result_df(\n                asset_id=base_name + \"_\" + entry.entry_name + \"_add_labels\",\n                result_df_task=multiple_testing_task,\n                reference_df_task=entry.cell_or_tissue_labels_task.cell_or_tissue_label_task,\n                how=\"left\",\n                left_on=[entry.cell_or_tissue_labels_task.left_join_on],\n                right_on=[entry.cell_or_tissue_labels_task.right_join_on],\n                df_1_pipe=entry.cell_or_tissue_labels_task.pipe_left,\n                df_2_pipe=entry.cell_or_tissue_labels_task.pipe_right,\n            )\n            plot_task = SLDSCScatterPlotTask.create(\n                asset_id=base_name\n                + \"_\"\n                + entry.entry_name\n                + \"_cell_analysis_s_ldsc_plot\",\n                source_task=add_labels_task,\n            )\n        else:\n            add_labels_task = None\n            plot_task = None\n        cell_analysis_task_groups[entry.entry_name] = CellAnalysisTaskGroup(\n            cell_analysis_task=cell_task,\n            multiple_testing_task=multiple_testing_task,\n            add_categories_task=add_labels_task,\n            plot_task=plot_task,\n            multiple_testing_task_markdown=multiple_testing_markdown,\n        )\n    return cls(cell_analysis_task_groups)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/task_generator/sldsc_task_generator/#mecfs_bio.build_system.task_generator.sldsc_task_generator.SLDSCTaskGenerator.get_terminal_tasks","title":"get_terminal_tasks","text":"<pre><code>get_terminal_tasks() -&gt; Sequence[Task]\n</code></pre> Source code in <code>mecfs_bio/build_system/task_generator/sldsc_task_generator.py</code> <pre><code>def get_terminal_tasks(self) -&gt; Sequence[Task]:\n    result = []\n    for item in self.partitioned_tasks.values():\n        result.extend(item.terminal_tasks())\n    return result\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/tasks/","title":"tasks","text":""},{"location":"reference/mecfs_bio/build_system/tasks/#mecfs_bio.build_system.tasks","title":"mecfs_bio.build_system.tasks","text":"<p>A \"Tasks\" is a collection that maps each asset id to the Task that materializes the corresponding Asset. Used by the schedulers in the build system.</p> <p>Modules:</p> <ul> <li> <code>base_tasks</code>           \u2013            </li> <li> <code>simple_tasks</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/tasks/base_tasks/","title":"base_tasks","text":""},{"location":"reference/mecfs_bio/build_system/tasks/base_tasks/#mecfs_bio.build_system.tasks.base_tasks","title":"mecfs_bio.build_system.tasks.base_tasks","text":"<p>Classes:</p> <ul> <li> <code>Tasks</code>           \u2013            <p>Collection associating an asset_id with a task that can produce the corresponding asset.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/tasks/base_tasks/#mecfs_bio.build_system.tasks.base_tasks.Tasks","title":"Tasks","text":"<p>               Bases: <code>ABC</code>, <code>Mapping[AssetId, Task]</code></p> <p>Collection associating an asset_id with a task that can produce the corresponding asset.</p>"},{"location":"reference/mecfs_bio/build_system/tasks/simple_tasks/","title":"simple_tasks","text":""},{"location":"reference/mecfs_bio/build_system/tasks/simple_tasks/#mecfs_bio.build_system.tasks.simple_tasks","title":"mecfs_bio.build_system.tasks.simple_tasks","text":"<p>Classes:</p> <ul> <li> <code>SimpleTasks</code>           \u2013            </li> </ul> <p>Functions:</p> <ul> <li> <code>find_tasks</code>             \u2013              <p>Build a SimpleTasks object by walking the task graph</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/tasks/simple_tasks/#mecfs_bio.build_system.tasks.simple_tasks.SimpleTasks","title":"SimpleTasks","text":"<p>               Bases: <code>Tasks</code></p>"},{"location":"reference/mecfs_bio/build_system/tasks/simple_tasks/#mecfs_bio.build_system.tasks.simple_tasks.find_tasks","title":"find_tasks","text":"<pre><code>find_tasks(target_tasks: list[Task]) -&gt; SimpleTasks\n</code></pre> <p>Build a SimpleTasks object by walking the task graph</p> Source code in <code>mecfs_bio/build_system/tasks/simple_tasks.py</code> <pre><code>def find_tasks(target_tasks: list[Task]) -&gt; SimpleTasks:\n    \"\"\"\n    Build a SimpleTasks object by walking the task graph\n    \"\"\"\n    _tasks: dict[AssetId, Task] = {}\n    visited = set()\n\n    def explore_task(t: Task):\n        visited.add(t.asset_id)\n        for dep in t.deps:\n            if dep.asset_id not in visited:\n                explore_task(dep)\n        if t.asset_id in _tasks and (t != _tasks[t.asset_id]):\n            raise ValueError(\n                f\"Found two tasks with asset id  {t.asset_id}.  tasks are {t} and {_tasks[t.asset_id]}\"\n            )\n        _tasks[t.asset_id] = t\n\n    for task in target_tasks:\n        explore_task(task)\n    return SimpleTasks(_tasks)\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/wf/","title":"wf","text":""},{"location":"reference/mecfs_bio/build_system/wf/#mecfs_bio.build_system.wf","title":"mecfs_bio.build_system.wf","text":"<p>A WF (or Workflow) is an interface tasks can use to download files.</p> <p>Modules:</p> <ul> <li> <code>base_wf</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/build_system/wf/base_wf/","title":"base_wf","text":""},{"location":"reference/mecfs_bio/build_system/wf/base_wf/#mecfs_bio.build_system.wf.base_wf","title":"mecfs_bio.build_system.wf.base_wf","text":"<p>Classes:</p> <ul> <li> <code>RobustDownloadWF</code>           \u2013            </li> <li> <code>SimpleWF</code>           \u2013            </li> <li> <code>WF</code>           \u2013            <p>An interface to the external world.</p> </li> </ul>"},{"location":"reference/mecfs_bio/build_system/wf/base_wf/#mecfs_bio.build_system.wf.base_wf.RobustDownloadWF","title":"RobustDownloadWF","text":"<p>               Bases: <code>WF</code></p> <p>Methods:</p> <ul> <li> <code>download_from_url</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/wf/base_wf/#mecfs_bio.build_system.wf.base_wf.RobustDownloadWF.download_from_url","title":"download_from_url","text":"<pre><code>download_from_url(\n    url: str, local_path: Path, md5_hash: str | None\n) -&gt; None\n</code></pre> Source code in <code>mecfs_bio/build_system/wf/base_wf.py</code> <pre><code>def download_from_url(\n    self, url: str, local_path: Path, md5_hash: str | None\n) -&gt; None:\n    robust_download_with_aria(\n        md5sum=md5_hash,\n        url=url,\n        dest=local_path,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/wf/base_wf/#mecfs_bio.build_system.wf.base_wf.SimpleWF","title":"SimpleWF","text":"<p>               Bases: <code>WF</code></p> <p>Methods:</p> <ul> <li> <code>download_from_url</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/wf/base_wf/#mecfs_bio.build_system.wf.base_wf.SimpleWF.download_from_url","title":"download_from_url","text":"<pre><code>download_from_url(\n    url: str, local_path: Path, md5_hash: str | None\n) -&gt; None\n</code></pre> Source code in <code>mecfs_bio/build_system/wf/base_wf.py</code> <pre><code>def download_from_url(\n    self, url: str, local_path: Path, md5_hash: str | None\n) -&gt; None:\n    # py3_wget attempts to read the whole file to check md5.  doesn't work for large files.  So implement my own check\n    py3_wget.download_file(\n        url=url,\n        output_path=local_path,\n    )\n    verify_hash(\n        downloaded_file=local_path,\n        expected_hash=md5_hash,\n    )\n</code></pre>"},{"location":"reference/mecfs_bio/build_system/wf/base_wf/#mecfs_bio.build_system.wf.base_wf.WF","title":"WF","text":"<p>               Bases: <code>ABC</code></p> <p>An interface to the external world. Currently only used for downloading files. May be extended in the future .</p> <p>Methods:</p> <ul> <li> <code>download_from_url</code>             \u2013              </li> </ul>"},{"location":"reference/mecfs_bio/build_system/wf/base_wf/#mecfs_bio.build_system.wf.base_wf.WF.download_from_url","title":"download_from_url","text":"<pre><code>download_from_url(\n    url: str, local_path: Path, md5_hash: str | None\n) -&gt; None\n</code></pre> Source code in <code>mecfs_bio/build_system/wf/base_wf.py</code> <pre><code>def download_from_url(\n    self, url: str, local_path: Path, md5_hash: str | None\n) -&gt; None:\n    pass\n</code></pre>"},{"location":"reference/mecfs_bio/constants/","title":"constants","text":""},{"location":"reference/mecfs_bio/constants/#mecfs_bio.constants","title":"mecfs_bio.constants","text":"<p>Global constants.</p> <p>Modules:</p> <ul> <li> <code>gh_constants</code>           \u2013            </li> <li> <code>gwaslab_constants</code>           \u2013            </li> <li> <code>magma_constants</code>           \u2013            </li> <li> <code>sun_et_al_pqtl_constants</code>           \u2013            </li> <li> <code>uniprot_constants</code>           \u2013            </li> <li> <code>xr_constants</code>           \u2013            <p>Constants used when representing gene expression and related data in the xarray framework.</p> </li> </ul>"},{"location":"reference/mecfs_bio/constants/gh_constants/","title":"gh_constants","text":""},{"location":"reference/mecfs_bio/constants/gh_constants/#mecfs_bio.constants.gh_constants","title":"mecfs_bio.constants.gh_constants","text":"<p>Attributes:</p> <ul> <li> <code>GH_REPO_NAME</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/constants/gh_constants/#mecfs_bio.constants.gh_constants.GH_REPO_NAME","title":"GH_REPO_NAME  <code>module-attribute</code>","text":"<pre><code>GH_REPO_NAME = 'trafalmadorian97/mecfs_bioinformatics'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/","title":"gwaslab_constants","text":""},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants","title":"mecfs_bio.constants.gwaslab_constants","text":"<p>Attributes:</p> <ul> <li> <code>GWASLAB_BETA_COL</code>           \u2013            </li> <li> <code>GWASLAB_CHISQ_COL</code>           \u2013            </li> <li> <code>GWASLAB_CHROM_COL</code>           \u2013            </li> <li> <code>GWASLAB_EFFECT_ALLELE_COL</code>           \u2013            </li> <li> <code>GWASLAB_EFFECT_ALLELE_FREQ_COL</code>           \u2013            </li> <li> <code>GWASLAB_EUR_1K_GENOMES_NAME_19</code>           \u2013            </li> <li> <code>GWASLAB_EUR_1K_GENOMES_NAME_38</code>               (<code>GWASLabVCFRefFile</code>)           \u2013            </li> <li> <code>GWASLAB_HUMAN_GENOME_NAME_19</code>           \u2013            </li> <li> <code>GWASLAB_HUMAN_GENOME_NAME_38</code>           \u2013            </li> <li> <code>GWASLAB_INFO_SCORE_COL</code>           \u2013            </li> <li> <code>GWASLAB_MLOG10P_COL</code>           \u2013            </li> <li> <code>GWASLAB_NON_EFFECT_ALLELE_COL</code>           \u2013            </li> <li> <code>GWASLAB_N_CASE_COL</code>           \u2013            </li> <li> <code>GWASLAB_N_CONTROL_COL</code>           \u2013            </li> <li> <code>GWASLAB_ODDS_RATIO_COL</code>           \u2013            </li> <li> <code>GWASLAB_POS_COL</code>           \u2013            </li> <li> <code>GWASLAB_P_COL</code>           \u2013            </li> <li> <code>GWASLAB_RSID_COL</code>           \u2013            </li> <li> <code>GWASLAB_SAMPLE_SIZE_COLUMN</code>           \u2013            </li> <li> <code>GWASLAB_SE_COL</code>           \u2013            </li> <li> <code>GWASLAB_SNPID_COL</code>           \u2013            </li> <li> <code>GWASLAB_STATUS_COL</code>           \u2013            </li> <li> <code>GWASLabVCFRefFile</code>           \u2013            </li> <li> <code>GwaslabKnownFormat</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GWASLAB_BETA_COL","title":"GWASLAB_BETA_COL  <code>module-attribute</code>","text":"<pre><code>GWASLAB_BETA_COL = 'BETA'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GWASLAB_CHISQ_COL","title":"GWASLAB_CHISQ_COL  <code>module-attribute</code>","text":"<pre><code>GWASLAB_CHISQ_COL = 'CHISQ'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GWASLAB_CHROM_COL","title":"GWASLAB_CHROM_COL  <code>module-attribute</code>","text":"<pre><code>GWASLAB_CHROM_COL = 'CHR'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GWASLAB_EFFECT_ALLELE_COL","title":"GWASLAB_EFFECT_ALLELE_COL  <code>module-attribute</code>","text":"<pre><code>GWASLAB_EFFECT_ALLELE_COL = 'EA'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GWASLAB_EFFECT_ALLELE_FREQ_COL","title":"GWASLAB_EFFECT_ALLELE_FREQ_COL  <code>module-attribute</code>","text":"<pre><code>GWASLAB_EFFECT_ALLELE_FREQ_COL = 'EAF'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GWASLAB_EUR_1K_GENOMES_NAME_19","title":"GWASLAB_EUR_1K_GENOMES_NAME_19  <code>module-attribute</code>","text":"<pre><code>GWASLAB_EUR_1K_GENOMES_NAME_19 = '1kg_eur_hg19'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GWASLAB_EUR_1K_GENOMES_NAME_38","title":"GWASLAB_EUR_1K_GENOMES_NAME_38  <code>module-attribute</code>","text":"<pre><code>GWASLAB_EUR_1K_GENOMES_NAME_38: GWASLabVCFRefFile = (\n    \"1kg_eur_hg38\"\n)\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GWASLAB_HUMAN_GENOME_NAME_19","title":"GWASLAB_HUMAN_GENOME_NAME_19  <code>module-attribute</code>","text":"<pre><code>GWASLAB_HUMAN_GENOME_NAME_19 = 'ucsc_genome_hg19'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GWASLAB_HUMAN_GENOME_NAME_38","title":"GWASLAB_HUMAN_GENOME_NAME_38  <code>module-attribute</code>","text":"<pre><code>GWASLAB_HUMAN_GENOME_NAME_38 = 'ucsc_genome_hg38'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GWASLAB_INFO_SCORE_COL","title":"GWASLAB_INFO_SCORE_COL  <code>module-attribute</code>","text":"<pre><code>GWASLAB_INFO_SCORE_COL = 'INFO'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GWASLAB_MLOG10P_COL","title":"GWASLAB_MLOG10P_COL  <code>module-attribute</code>","text":"<pre><code>GWASLAB_MLOG10P_COL = 'MLOG10P'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GWASLAB_NON_EFFECT_ALLELE_COL","title":"GWASLAB_NON_EFFECT_ALLELE_COL  <code>module-attribute</code>","text":"<pre><code>GWASLAB_NON_EFFECT_ALLELE_COL = 'NEA'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GWASLAB_N_CASE_COL","title":"GWASLAB_N_CASE_COL  <code>module-attribute</code>","text":"<pre><code>GWASLAB_N_CASE_COL = 'N_CASE'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GWASLAB_N_CONTROL_COL","title":"GWASLAB_N_CONTROL_COL  <code>module-attribute</code>","text":"<pre><code>GWASLAB_N_CONTROL_COL = 'N_CONTROL'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GWASLAB_ODDS_RATIO_COL","title":"GWASLAB_ODDS_RATIO_COL  <code>module-attribute</code>","text":"<pre><code>GWASLAB_ODDS_RATIO_COL = 'OR'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GWASLAB_POS_COL","title":"GWASLAB_POS_COL  <code>module-attribute</code>","text":"<pre><code>GWASLAB_POS_COL = 'POS'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GWASLAB_P_COL","title":"GWASLAB_P_COL  <code>module-attribute</code>","text":"<pre><code>GWASLAB_P_COL = 'P'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GWASLAB_RSID_COL","title":"GWASLAB_RSID_COL  <code>module-attribute</code>","text":"<pre><code>GWASLAB_RSID_COL = 'rsID'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GWASLAB_SAMPLE_SIZE_COLUMN","title":"GWASLAB_SAMPLE_SIZE_COLUMN  <code>module-attribute</code>","text":"<pre><code>GWASLAB_SAMPLE_SIZE_COLUMN = 'N'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GWASLAB_SE_COL","title":"GWASLAB_SE_COL  <code>module-attribute</code>","text":"<pre><code>GWASLAB_SE_COL = 'SE'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GWASLAB_SNPID_COL","title":"GWASLAB_SNPID_COL  <code>module-attribute</code>","text":"<pre><code>GWASLAB_SNPID_COL = 'SNPID'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GWASLAB_STATUS_COL","title":"GWASLAB_STATUS_COL  <code>module-attribute</code>","text":"<pre><code>GWASLAB_STATUS_COL = 'STATUS'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GWASLabVCFRefFile","title":"GWASLabVCFRefFile  <code>module-attribute</code>","text":"<pre><code>GWASLabVCFRefFile = Literal['1kg_eur_hg38', '1kg_eur_hg19']\n</code></pre>"},{"location":"reference/mecfs_bio/constants/gwaslab_constants/#mecfs_bio.constants.gwaslab_constants.GwaslabKnownFormat","title":"GwaslabKnownFormat  <code>module-attribute</code>","text":"<pre><code>GwaslabKnownFormat = Literal[\n    \"gwaslab\", \"regenie\", \"gwascatalog\"\n]\n</code></pre>"},{"location":"reference/mecfs_bio/constants/magma_constants/","title":"magma_constants","text":""},{"location":"reference/mecfs_bio/constants/magma_constants/#mecfs_bio.constants.magma_constants","title":"mecfs_bio.constants.magma_constants","text":"<p>Attributes:</p> <ul> <li> <code>MAGMA_GENE_COL</code>           \u2013            </li> <li> <code>MAGMA_MODEL_COLUMN</code>           \u2013            </li> <li> <code>MAGMA_P_COLUMN</code>           \u2013            </li> <li> <code>MAGMA_VARIABLE_COLUMN</code>           \u2013            </li> <li> <code>MAGMA_Z_COLUMN</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/constants/magma_constants/#mecfs_bio.constants.magma_constants.MAGMA_GENE_COL","title":"MAGMA_GENE_COL  <code>module-attribute</code>","text":"<pre><code>MAGMA_GENE_COL = 'GENE'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/magma_constants/#mecfs_bio.constants.magma_constants.MAGMA_MODEL_COLUMN","title":"MAGMA_MODEL_COLUMN  <code>module-attribute</code>","text":"<pre><code>MAGMA_MODEL_COLUMN = 'MODEL'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/magma_constants/#mecfs_bio.constants.magma_constants.MAGMA_P_COLUMN","title":"MAGMA_P_COLUMN  <code>module-attribute</code>","text":"<pre><code>MAGMA_P_COLUMN = 'P'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/magma_constants/#mecfs_bio.constants.magma_constants.MAGMA_VARIABLE_COLUMN","title":"MAGMA_VARIABLE_COLUMN  <code>module-attribute</code>","text":"<pre><code>MAGMA_VARIABLE_COLUMN = 'VARIABLE'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/magma_constants/#mecfs_bio.constants.magma_constants.MAGMA_Z_COLUMN","title":"MAGMA_Z_COLUMN  <code>module-attribute</code>","text":"<pre><code>MAGMA_Z_COLUMN = 'ZSTAT'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/sun_et_al_pqtl_constants/","title":"sun_et_al_pqtl_constants","text":""},{"location":"reference/mecfs_bio/constants/sun_et_al_pqtl_constants/#mecfs_bio.constants.sun_et_al_pqtl_constants","title":"mecfs_bio.constants.sun_et_al_pqtl_constants","text":"<p>Attributes:</p> <ul> <li> <code>SUN_ASSAY_TARGET</code>           \u2013            </li> <li> <code>SUN_CIS</code>           \u2013            </li> <li> <code>SUN_CIS_TRANS_COL</code>           \u2013            </li> <li> <code>SUN_MLOG10_P_COL</code>           \u2013            </li> <li> <code>SUN_TARGET_UNIPROT</code>           \u2013            </li> <li> <code>SUN_TRANS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/constants/sun_et_al_pqtl_constants/#mecfs_bio.constants.sun_et_al_pqtl_constants.SUN_ASSAY_TARGET","title":"SUN_ASSAY_TARGET  <code>module-attribute</code>","text":"<pre><code>SUN_ASSAY_TARGET = 'Assay Target'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/sun_et_al_pqtl_constants/#mecfs_bio.constants.sun_et_al_pqtl_constants.SUN_CIS","title":"SUN_CIS  <code>module-attribute</code>","text":"<pre><code>SUN_CIS = 'cis'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/sun_et_al_pqtl_constants/#mecfs_bio.constants.sun_et_al_pqtl_constants.SUN_CIS_TRANS_COL","title":"SUN_CIS_TRANS_COL  <code>module-attribute</code>","text":"<pre><code>SUN_CIS_TRANS_COL = 'cis/trans'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/sun_et_al_pqtl_constants/#mecfs_bio.constants.sun_et_al_pqtl_constants.SUN_MLOG10_P_COL","title":"SUN_MLOG10_P_COL  <code>module-attribute</code>","text":"<pre><code>SUN_MLOG10_P_COL = 'log10(p)'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/sun_et_al_pqtl_constants/#mecfs_bio.constants.sun_et_al_pqtl_constants.SUN_TARGET_UNIPROT","title":"SUN_TARGET_UNIPROT  <code>module-attribute</code>","text":"<pre><code>SUN_TARGET_UNIPROT = 'Target UniProt'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/sun_et_al_pqtl_constants/#mecfs_bio.constants.sun_et_al_pqtl_constants.SUN_TRANS","title":"SUN_TRANS  <code>module-attribute</code>","text":"<pre><code>SUN_TRANS = 'trans'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/uniprot_constants/","title":"uniprot_constants","text":""},{"location":"reference/mecfs_bio/constants/uniprot_constants/#mecfs_bio.constants.uniprot_constants","title":"mecfs_bio.constants.uniprot_constants","text":"<p>Attributes:</p> <ul> <li> <code>UNIPROT_DAT_FUNCTION_COL</code>           \u2013            </li> <li> <code>UNIPROT_DAT_ID_COL</code>           \u2013            </li> <li> <code>UNIPROT_DAT_SUBCELLULAR_LOC_COL</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/constants/uniprot_constants/#mecfs_bio.constants.uniprot_constants.UNIPROT_DAT_FUNCTION_COL","title":"UNIPROT_DAT_FUNCTION_COL  <code>module-attribute</code>","text":"<pre><code>UNIPROT_DAT_FUNCTION_COL = 'Function [CC]'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/uniprot_constants/#mecfs_bio.constants.uniprot_constants.UNIPROT_DAT_ID_COL","title":"UNIPROT_DAT_ID_COL  <code>module-attribute</code>","text":"<pre><code>UNIPROT_DAT_ID_COL = 'Entry'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/uniprot_constants/#mecfs_bio.constants.uniprot_constants.UNIPROT_DAT_SUBCELLULAR_LOC_COL","title":"UNIPROT_DAT_SUBCELLULAR_LOC_COL  <code>module-attribute</code>","text":"<pre><code>UNIPROT_DAT_SUBCELLULAR_LOC_COL = (\n    \"Subcellular location [CC]\"\n)\n</code></pre>"},{"location":"reference/mecfs_bio/constants/xr_constants/","title":"xr_constants","text":""},{"location":"reference/mecfs_bio/constants/xr_constants/#mecfs_bio.constants.xr_constants","title":"mecfs_bio.constants.xr_constants","text":"<p>Constants used when representing gene expression and related data in the xarray framework.</p> <p>Attributes:</p> <ul> <li> <code>XR_GENE_DIMENSION</code>           \u2013            </li> <li> <code>XR_SPECIFICITY_MATRIX</code>           \u2013            </li> <li> <code>XR_TISSUE_DIMENSION</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/constants/xr_constants/#mecfs_bio.constants.xr_constants.XR_GENE_DIMENSION","title":"XR_GENE_DIMENSION  <code>module-attribute</code>","text":"<pre><code>XR_GENE_DIMENSION = 'GENE'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/xr_constants/#mecfs_bio.constants.xr_constants.XR_SPECIFICITY_MATRIX","title":"XR_SPECIFICITY_MATRIX  <code>module-attribute</code>","text":"<pre><code>XR_SPECIFICITY_MATRIX = 'specificity_matrix'\n</code></pre>"},{"location":"reference/mecfs_bio/constants/xr_constants/#mecfs_bio.constants.xr_constants.XR_TISSUE_DIMENSION","title":"XR_TISSUE_DIMENSION  <code>module-attribute</code>","text":"<pre><code>XR_TISSUE_DIMENSION = 'TISSUE'\n</code></pre>"},{"location":"reference/mecfs_bio/figures/","title":"figures","text":""},{"location":"reference/mecfs_bio/figures/#mecfs_bio.figures","title":"mecfs_bio.figures","text":"<p>Functionality to generate plots and tables from build system assets, and upload them to Github.</p> <p>This approach allows plots and tables in documentation to be generated programmatically, instead of manually.</p> <p>Benefits of automatic figure generation: - The full lineage of all plots and tables can be fully interrogated. - Improvements in the code used to generate a class of figures can easily be propagated to all figures of that class.</p> <p>Modules:</p> <ul> <li> <code>fig_constants</code>           \u2013            </li> <li> <code>figure_exporter</code>           \u2013            </li> <li> <code>figure_tasks</code>           \u2013            </li> <li> <code>key_scripts</code>           \u2013            <p>Key script used to operate the programmatic figure system</p> </li> </ul>"},{"location":"reference/mecfs_bio/figures/fig_constants/","title":"fig_constants","text":""},{"location":"reference/mecfs_bio/figures/fig_constants/#mecfs_bio.figures.fig_constants","title":"mecfs_bio.figures.fig_constants","text":"<p>Attributes:</p> <ul> <li> <code>FIGURES_ARCHIVE_TITLE</code>           \u2013            </li> <li> <code>FIGURE_DIRECTORY</code>           \u2013            </li> <li> <code>FIGURE_GITHUB_RELEASE_TAG</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/figures/fig_constants/#mecfs_bio.figures.fig_constants.FIGURES_ARCHIVE_TITLE","title":"FIGURES_ARCHIVE_TITLE  <code>module-attribute</code>","text":"<pre><code>FIGURES_ARCHIVE_TITLE = 'figures'\n</code></pre>"},{"location":"reference/mecfs_bio/figures/fig_constants/#mecfs_bio.figures.fig_constants.FIGURE_DIRECTORY","title":"FIGURE_DIRECTORY  <code>module-attribute</code>","text":"<pre><code>FIGURE_DIRECTORY = Path('docs/_figs')\n</code></pre>"},{"location":"reference/mecfs_bio/figures/fig_constants/#mecfs_bio.figures.fig_constants.FIGURE_GITHUB_RELEASE_TAG","title":"FIGURE_GITHUB_RELEASE_TAG  <code>module-attribute</code>","text":"<pre><code>FIGURE_GITHUB_RELEASE_TAG = 'figures'\n</code></pre>"},{"location":"reference/mecfs_bio/figures/figure_exporter/","title":"figure_exporter","text":""},{"location":"reference/mecfs_bio/figures/figure_exporter/#mecfs_bio.figures.figure_exporter","title":"mecfs_bio.figures.figure_exporter","text":"<p>Classes:</p> <ul> <li> <code>FigureExporter</code>           \u2013            <p>Responsible for invoking the build system to generate Assets corresponding to figures, then copying those assets to the figure directory.</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>get_fig_path</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/figures/figure_exporter/#mecfs_bio.figures.figure_exporter.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/figures/figure_exporter/#mecfs_bio.figures.figure_exporter.FigureExporter","title":"FigureExporter","text":"<p>Responsible for invoking the build system to generate Assets corresponding to figures, then copying those assets to the figure directory.</p> <p>Methods:</p> <ul> <li> <code>export</code>             \u2013              </li> </ul> <p>Attributes:</p> <ul> <li> <code>runner</code>               (<code>Callable[[Sequence[Task]], Mapping[AssetId, Asset]]</code>)           \u2013            </li> <li> <code>tracer</code>               (<code>Tracer</code>)           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/figures/figure_exporter/#mecfs_bio.figures.figure_exporter.FigureExporter.runner","title":"runner  <code>instance-attribute</code>","text":"<pre><code>runner: Callable[[Sequence[Task]], Mapping[AssetId, Asset]]\n</code></pre>"},{"location":"reference/mecfs_bio/figures/figure_exporter/#mecfs_bio.figures.figure_exporter.FigureExporter.tracer","title":"tracer  <code>instance-attribute</code>","text":"<pre><code>tracer: Tracer\n</code></pre>"},{"location":"reference/mecfs_bio/figures/figure_exporter/#mecfs_bio.figures.figure_exporter.FigureExporter.export","title":"export","text":"<pre><code>export(to_export: Sequence[Task], fig_dir: Path) -&gt; None\n</code></pre> Source code in <code>mecfs_bio/figures/figure_exporter.py</code> <pre><code>def export(self, to_export: Sequence[Task], fig_dir: Path) -&gt; None:\n    fig_dir.mkdir(parents=True, exist_ok=True)\n    meta_list = []\n    for task in to_export:\n        assert isinstance(\n            task.meta, GWASPlotFileMeta\n        )  # figures must be files, not directories\n        meta_list.append(task.meta)\n    result = self.runner(\n        to_export,\n    )\n    for task, meta in zip(to_export, meta_list):\n        asset = result[task.asset_id]\n        assert isinstance(asset, FileAsset)\n        src = asset.path\n        dst = get_fig_path(meta=meta, fig_dir=fig_dir)\n        shutil.copy(src, dst)\n        logger.debug(f\"Figure asset {task.asset_id} copied to {dst}.\")\n</code></pre>"},{"location":"reference/mecfs_bio/figures/figure_exporter/#mecfs_bio.figures.figure_exporter.get_fig_path","title":"get_fig_path","text":"<pre><code>get_fig_path(meta: GWASPlotFileMeta, fig_dir: Path) -&gt; Path\n</code></pre> Source code in <code>mecfs_bio/figures/figure_exporter.py</code> <pre><code>def get_fig_path(meta: GWASPlotFileMeta, fig_dir: Path) -&gt; Path:\n    return fig_dir / (meta.asset_id + meta.extension)\n</code></pre>"},{"location":"reference/mecfs_bio/figures/figure_tasks/","title":"figure_tasks","text":""},{"location":"reference/mecfs_bio/figures/figure_tasks/#mecfs_bio.figures.figure_tasks","title":"mecfs_bio.figures.figure_tasks","text":"<p>Attributes:</p> <ul> <li> <code>ALL_FIGURE_TASKS</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/figures/figure_tasks/#mecfs_bio.figures.figure_tasks.ALL_FIGURE_TASKS","title":"ALL_FIGURE_TASKS  <code>module-attribute</code>","text":"<pre><code>ALL_FIGURE_TASKS = [CT_LDSC_INITIAL_PLOT]\n</code></pre>"},{"location":"reference/mecfs_bio/figures/key_scripts/","title":"key_scripts","text":""},{"location":"reference/mecfs_bio/figures/key_scripts/#mecfs_bio.figures.key_scripts","title":"mecfs_bio.figures.key_scripts","text":"<p>Key script used to operate the programmatic figure system</p> <p>Modules:</p> <ul> <li> <code>generate_figures</code>           \u2013            <p>Use the build system to generate the figure assets, then copy them to the figure directory.</p> </li> <li> <code>pull_figures</code>           \u2013            <p>Download figures from Github, merging them with contents of the local figure directory.</p> </li> <li> <code>push_figures</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/figures/key_scripts/generate_figures/","title":"generate_figures","text":""},{"location":"reference/mecfs_bio/figures/key_scripts/generate_figures/#mecfs_bio.figures.key_scripts.generate_figures","title":"mecfs_bio.figures.key_scripts.generate_figures","text":"<p>Use the build system to generate the figure assets, then copy them to the figure directory.</p> <p>Functions:</p> <ul> <li> <code>generate_figures</code>             \u2013              <p>Use the build system to generate the figure assets, then copy them to the figure directory.</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>FIGURE_EXPORTER</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/figures/key_scripts/generate_figures/#mecfs_bio.figures.key_scripts.generate_figures.FIGURE_EXPORTER","title":"FIGURE_EXPORTER  <code>module-attribute</code>","text":"<pre><code>FIGURE_EXPORTER = FigureExporter(\n    runner=_runner_func, tracer=_imo_hasher_128\n)\n</code></pre>"},{"location":"reference/mecfs_bio/figures/key_scripts/generate_figures/#mecfs_bio.figures.key_scripts.generate_figures.generate_figures","title":"generate_figures","text":"<pre><code>generate_figures(tasks: list[Task])\n</code></pre> <p>Use the build system to generate the figure assets, then copy them to the figure directory.</p> Source code in <code>mecfs_bio/figures/key_scripts/generate_figures.py</code> <pre><code>def generate_figures(tasks: list[Task]):\n    \"\"\"\n    Use the build system to generate the figure assets, then copy them to the figure directory.\n    \"\"\"\n    FIGURE_EXPORTER.export(tasks, fig_dir=FIGURE_DIRECTORY)\n</code></pre>"},{"location":"reference/mecfs_bio/figures/key_scripts/pull_figures/","title":"pull_figures","text":""},{"location":"reference/mecfs_bio/figures/key_scripts/pull_figures/#mecfs_bio.figures.key_scripts.pull_figures","title":"mecfs_bio.figures.key_scripts.pull_figures","text":"<p>Download figures from Github, merging them with contents of the local figure directory.</p> <p>Functions:</p> <ul> <li> <code>pull_figures</code>             \u2013              <p>Download figures from Github, merging them with contents of the local figure directory.</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/figures/key_scripts/pull_figures/#mecfs_bio.figures.key_scripts.pull_figures.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/figures/key_scripts/pull_figures/#mecfs_bio.figures.key_scripts.pull_figures.pull_figures","title":"pull_figures","text":"<pre><code>pull_figures(\n    tag: str = FIGURE_GITHUB_RELEASE_TAG,\n    repo_name: str = GH_REPO_NAME,\n    fig_dir: Path = FIGURE_DIRECTORY,\n    title: str = FIGURES_ARCHIVE_TITLE,\n    use_gh_cli: bool = False,\n)\n</code></pre> <p>Download figures from Github, merging them with contents of the local figure directory.</p> Source code in <code>mecfs_bio/figures/key_scripts/pull_figures.py</code> <pre><code>def pull_figures(\n    tag: str = FIGURE_GITHUB_RELEASE_TAG,\n    repo_name: str = GH_REPO_NAME,\n    fig_dir: Path = FIGURE_DIRECTORY,\n    title: str = FIGURES_ARCHIVE_TITLE,\n    use_gh_cli: bool = False,\n):\n    \"\"\"\n    Download figures from Github, merging them with contents of the local figure directory.\n    \"\"\"\n    fig_dir.mkdir(parents=True, exist_ok=True)\n\n    if use_gh_cli and not does_release_exist(repo_name=repo_name, release_tag=tag):\n        logger.debug(\n            f\"No release with the tag '{tag}' exists in repository {repo_name}.  Nothing to download.\"\n        )\n        return\n    with tempfile.TemporaryDirectory() as tmpdir:\n        staging_dir = Path(tmpdir)\n        logger.debug(f\"Downloading {tag} to {staging_dir}\")\n        if use_gh_cli:\n            download_release_to_dir(\n                release_tag=tag,\n                dir_path=staging_dir,\n                repo_name=repo_name,\n            )\n        else:\n            download_release_to_dir_no_auth(\n                release_tag=tag,\n                repo_name=repo_name,\n                title=title,\n                dir_path=staging_dir,\n            )\n\n        logger.debug(\"download complete\")\n        logger.debug(\n            \"Overlaying existing figures on downloaded figures in staging directory.\"\n        )\n        shutil.copytree(fig_dir, staging_dir, dirs_exist_ok=True)\n        logger.debug(\n            f\"Copying figures back from staging directory to figures directory {fig_dir}.\"\n        )\n        shutil.copytree(staging_dir, fig_dir, dirs_exist_ok=True)\n</code></pre>"},{"location":"reference/mecfs_bio/figures/key_scripts/push_figures/","title":"push_figures","text":""},{"location":"reference/mecfs_bio/figures/key_scripts/push_figures/#mecfs_bio.figures.key_scripts.push_figures","title":"mecfs_bio.figures.key_scripts.push_figures","text":"<p>Functions:</p> <ul> <li> <code>push_figures</code>             \u2013              <p>Merge the contents of the local figure directory with figures stored on Github, then upload to Github the result of this merge.</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>logger</code>           \u2013            </li> </ul>"},{"location":"reference/mecfs_bio/figures/key_scripts/push_figures/#mecfs_bio.figures.key_scripts.push_figures.logger","title":"logger  <code>module-attribute</code>","text":"<pre><code>logger = get_logger()\n</code></pre>"},{"location":"reference/mecfs_bio/figures/key_scripts/push_figures/#mecfs_bio.figures.key_scripts.push_figures.push_figures","title":"push_figures","text":"<pre><code>push_figures(\n    tag: str = FIGURE_GITHUB_RELEASE_TAG,\n    repo_name: str = GH_REPO_NAME,\n    fig_dir: Path = FIGURE_DIRECTORY,\n)\n</code></pre> <p>Merge the contents of the local figure directory with figures stored on Github, then upload to Github the result of this merge.</p> Source code in <code>mecfs_bio/figures/key_scripts/push_figures.py</code> <pre><code>def push_figures(\n    tag: str = FIGURE_GITHUB_RELEASE_TAG,\n    repo_name: str = GH_REPO_NAME,\n    fig_dir: Path = FIGURE_DIRECTORY,\n):\n    \"\"\"\n    Merge the contents of the local figure directory with figures stored on Github, then upload to Github the result of this merge.\n    \"\"\"\n    fig_dir.mkdir(parents=True, exist_ok=True)\n    pull_figures(\n        tag=tag,\n        repo_name=repo_name,\n        fig_dir=fig_dir,\n    )\n    release_from_dir(\n        release_tag=tag,\n        dir_path=fig_dir,\n        title=FIGURES_ARCHIVE_TITLE,\n        repo_name=repo_name,\n        draft=False,\n    )\n    logger.debug(\"Figures successfully uploaded\")\n</code></pre>"}]}